(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=e(s);fetch(s.href,l)}})();function oC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Zv={exports:{}},ag={};var U4;function $w(){if(U4)return ag;U4=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var f in s)f!=="key"&&(l[f]=s[f])}else l=s;return s=l.ref,{$$typeof:n,type:i,key:c,ref:s!==void 0?s:null,props:l}}return ag.Fragment=t,ag.jsx=e,ag.jsxs=e,ag}var z4;function tR(){return z4||(z4=1,Zv.exports=$w()),Zv.exports}var I=tR(),$v={exports:{}},pe={};var B4;function eR(){if(B4)return pe;B4=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),T=Symbol.iterator;function x(W){return W===null||typeof W!="object"?null:(W=T&&W[T]||W["@@iterator"],typeof W=="function"?W:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},O=Object.assign,M={};function H(W,ft,bt){this.props=W,this.context=ft,this.refs=M,this.updater=bt||R}H.prototype.isReactComponent={},H.prototype.setState=function(W,ft){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,ft,"setState")},H.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function B(){}B.prototype=H.prototype;function Y(W,ft,bt){this.props=W,this.context=ft,this.refs=M,this.updater=bt||R}var $=Y.prototype=new B;$.constructor=Y,O($,H.prototype),$.isPureReactComponent=!0;var nt=Array.isArray;function X(){}var L={H:null,A:null,T:null,S:null},k=Object.prototype.hasOwnProperty;function V(W,ft,bt){var Ft=bt.ref;return{$$typeof:n,type:W,key:ft,ref:Ft!==void 0?Ft:null,props:bt}}function q(W,ft){return V(W.type,ft,W.props)}function Q(W){return typeof W=="object"&&W!==null&&W.$$typeof===n}function F(W){var ft={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(bt){return ft[bt]})}var G=/\/+/g;function Ot(W,ft){return typeof W=="object"&&W!==null&&W.key!=null?F(""+W.key):ft.toString(36)}function Vt(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(X,X):(W.status="pending",W.then(function(ft){W.status==="pending"&&(W.status="fulfilled",W.value=ft)},function(ft){W.status==="pending"&&(W.status="rejected",W.reason=ft)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function tt(W,ft,bt,Ft,qt){var re=typeof W;(re==="undefined"||re==="boolean")&&(W=null);var ne=!1;if(W===null)ne=!0;else switch(re){case"bigint":case"string":case"number":ne=!0;break;case"object":switch(W.$$typeof){case n:case t:ne=!0;break;case A:return ne=W._init,tt(ne(W._payload),ft,bt,Ft,qt)}}if(ne)return qt=qt(W),ne=Ft===""?"."+Ot(W,0):Ft,nt(qt)?(bt="",ne!=null&&(bt=ne.replace(G,"$&/")+"/"),tt(qt,ft,bt,"",function(bi){return bi})):qt!=null&&(Q(qt)&&(qt=q(qt,bt+(qt.key==null||W&&W.key===qt.key?"":(""+qt.key).replace(G,"$&/")+"/")+ne)),ft.push(qt)),1;ne=0;var qe=Ft===""?".":Ft+":";if(nt(W))for(var De=0;De<W.length;De++)Ft=W[De],re=qe+Ot(Ft,De),ne+=tt(Ft,ft,bt,re,qt);else if(De=x(W),typeof De=="function")for(W=De.call(W),De=0;!(Ft=W.next()).done;)Ft=Ft.value,re=qe+Ot(Ft,De++),ne+=tt(Ft,ft,bt,re,qt);else if(re==="object"){if(typeof W.then=="function")return tt(Vt(W),ft,bt,Ft,qt);throw ft=String(W),Error("Objects are not valid as a React child (found: "+(ft==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":ft)+"). If you meant to render a collection of children, use an array instead.")}return ne}function At(W,ft,bt){if(W==null)return W;var Ft=[],qt=0;return tt(W,Ft,"","",function(re){return ft.call(bt,re,qt++)}),Ft}function yt(W){if(W._status===-1){var ft=W._result;ft=ft(),ft.then(function(bt){(W._status===0||W._status===-1)&&(W._status=1,W._result=bt)},function(bt){(W._status===0||W._status===-1)&&(W._status=2,W._result=bt)}),W._status===-1&&(W._status=0,W._result=ft)}if(W._status===1)return W._result.default;throw W._result}var Mt=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ft=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(ft))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)},Qt={map:At,forEach:function(W,ft,bt){At(W,function(){ft.apply(this,arguments)},bt)},count:function(W){var ft=0;return At(W,function(){ft++}),ft},toArray:function(W){return At(W,function(ft){return ft})||[]},only:function(W){if(!Q(W))throw Error("React.Children.only expected to receive a single React element child.");return W}};return pe.Activity=E,pe.Children=Qt,pe.Component=H,pe.Fragment=e,pe.Profiler=s,pe.PureComponent=Y,pe.StrictMode=i,pe.Suspense=m,pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,pe.__COMPILER_RUNTIME={__proto__:null,c:function(W){return L.H.useMemoCache(W)}},pe.cache=function(W){return function(){return W.apply(null,arguments)}},pe.cacheSignal=function(){return null},pe.cloneElement=function(W,ft,bt){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var Ft=O({},W.props),qt=W.key;if(ft!=null)for(re in ft.key!==void 0&&(qt=""+ft.key),ft)!k.call(ft,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&ft.ref===void 0||(Ft[re]=ft[re]);var re=arguments.length-2;if(re===1)Ft.children=bt;else if(1<re){for(var ne=Array(re),qe=0;qe<re;qe++)ne[qe]=arguments[qe+2];Ft.children=ne}return V(W.type,qt,Ft)},pe.createContext=function(W){return W={$$typeof:c,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:l,_context:W},W},pe.createElement=function(W,ft,bt){var Ft,qt={},re=null;if(ft!=null)for(Ft in ft.key!==void 0&&(re=""+ft.key),ft)k.call(ft,Ft)&&Ft!=="key"&&Ft!=="__self"&&Ft!=="__source"&&(qt[Ft]=ft[Ft]);var ne=arguments.length-2;if(ne===1)qt.children=bt;else if(1<ne){for(var qe=Array(ne),De=0;De<ne;De++)qe[De]=arguments[De+2];qt.children=qe}if(W&&W.defaultProps)for(Ft in ne=W.defaultProps,ne)qt[Ft]===void 0&&(qt[Ft]=ne[Ft]);return V(W,re,qt)},pe.createRef=function(){return{current:null}},pe.forwardRef=function(W){return{$$typeof:f,render:W}},pe.isValidElement=Q,pe.lazy=function(W){return{$$typeof:A,_payload:{_status:-1,_result:W},_init:yt}},pe.memo=function(W,ft){return{$$typeof:g,type:W,compare:ft===void 0?null:ft}},pe.startTransition=function(W){var ft=L.T,bt={};L.T=bt;try{var Ft=W(),qt=L.S;qt!==null&&qt(bt,Ft),typeof Ft=="object"&&Ft!==null&&typeof Ft.then=="function"&&Ft.then(X,Mt)}catch(re){Mt(re)}finally{ft!==null&&bt.types!==null&&(ft.types=bt.types),L.T=ft}},pe.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},pe.use=function(W){return L.H.use(W)},pe.useActionState=function(W,ft,bt){return L.H.useActionState(W,ft,bt)},pe.useCallback=function(W,ft){return L.H.useCallback(W,ft)},pe.useContext=function(W){return L.H.useContext(W)},pe.useDebugValue=function(){},pe.useDeferredValue=function(W,ft){return L.H.useDeferredValue(W,ft)},pe.useEffect=function(W,ft){return L.H.useEffect(W,ft)},pe.useEffectEvent=function(W){return L.H.useEffectEvent(W)},pe.useId=function(){return L.H.useId()},pe.useImperativeHandle=function(W,ft,bt){return L.H.useImperativeHandle(W,ft,bt)},pe.useInsertionEffect=function(W,ft){return L.H.useInsertionEffect(W,ft)},pe.useLayoutEffect=function(W,ft){return L.H.useLayoutEffect(W,ft)},pe.useMemo=function(W,ft){return L.H.useMemo(W,ft)},pe.useOptimistic=function(W,ft){return L.H.useOptimistic(W,ft)},pe.useReducer=function(W,ft,bt){return L.H.useReducer(W,ft,bt)},pe.useRef=function(W){return L.H.useRef(W)},pe.useState=function(W){return L.H.useState(W)},pe.useSyncExternalStore=function(W,ft,bt){return L.H.useSyncExternalStore(W,ft,bt)},pe.useTransition=function(){return L.H.useTransition()},pe.version="19.2.4",pe}var j4;function D1(){return j4||(j4=1,$v.exports=eR()),$v.exports}var j=D1();const Ki=oC(j);var t2={exports:{}},rg={},e2={exports:{}},n2={};var H4;function nR(){return H4||(H4=1,(function(n){function t(tt,At){var yt=tt.length;tt.push(At);t:for(;0<yt;){var Mt=yt-1>>>1,Qt=tt[Mt];if(0<s(Qt,At))tt[Mt]=At,tt[yt]=Qt,yt=Mt;else break t}}function e(tt){return tt.length===0?null:tt[0]}function i(tt){if(tt.length===0)return null;var At=tt[0],yt=tt.pop();if(yt!==At){tt[0]=yt;t:for(var Mt=0,Qt=tt.length,W=Qt>>>1;Mt<W;){var ft=2*(Mt+1)-1,bt=tt[ft],Ft=ft+1,qt=tt[Ft];if(0>s(bt,yt))Ft<Qt&&0>s(qt,bt)?(tt[Mt]=qt,tt[Ft]=yt,Mt=Ft):(tt[Mt]=bt,tt[ft]=yt,Mt=ft);else if(Ft<Qt&&0>s(qt,yt))tt[Mt]=qt,tt[Ft]=yt,Mt=Ft;else break t}}return At}function s(tt,At){var yt=tt.sortIndex-At.sortIndex;return yt!==0?yt:tt.id-At.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,f=c.now();n.unstable_now=function(){return c.now()-f}}var m=[],g=[],A=1,E=null,T=3,x=!1,R=!1,O=!1,M=!1,H=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;function $(tt){for(var At=e(g);At!==null;){if(At.callback===null)i(g);else if(At.startTime<=tt)i(g),At.sortIndex=At.expirationTime,t(m,At);else break;At=e(g)}}function nt(tt){if(O=!1,$(tt),!R)if(e(m)!==null)R=!0,X||(X=!0,F());else{var At=e(g);At!==null&&Vt(nt,At.startTime-tt)}}var X=!1,L=-1,k=5,V=-1;function q(){return M?!0:!(n.unstable_now()-V<k)}function Q(){if(M=!1,X){var tt=n.unstable_now();V=tt;var At=!0;try{t:{R=!1,O&&(O=!1,B(L),L=-1),x=!0;var yt=T;try{e:{for($(tt),E=e(m);E!==null&&!(E.expirationTime>tt&&q());){var Mt=E.callback;if(typeof Mt=="function"){E.callback=null,T=E.priorityLevel;var Qt=Mt(E.expirationTime<=tt);if(tt=n.unstable_now(),typeof Qt=="function"){E.callback=Qt,$(tt),At=!0;break e}E===e(m)&&i(m),$(tt)}else i(m);E=e(m)}if(E!==null)At=!0;else{var W=e(g);W!==null&&Vt(nt,W.startTime-tt),At=!1}}break t}finally{E=null,T=yt,x=!1}At=void 0}}finally{At?F():X=!1}}}var F;if(typeof Y=="function")F=function(){Y(Q)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Ot=G.port2;G.port1.onmessage=Q,F=function(){Ot.postMessage(null)}}else F=function(){H(Q,0)};function Vt(tt,At){L=H(function(){tt(n.unstable_now())},At)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(tt){tt.callback=null},n.unstable_forceFrameRate=function(tt){0>tt||125<tt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<tt?Math.floor(1e3/tt):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(tt){switch(T){case 1:case 2:case 3:var At=3;break;default:At=T}var yt=T;T=At;try{return tt()}finally{T=yt}},n.unstable_requestPaint=function(){M=!0},n.unstable_runWithPriority=function(tt,At){switch(tt){case 1:case 2:case 3:case 4:case 5:break;default:tt=3}var yt=T;T=tt;try{return At()}finally{T=yt}},n.unstable_scheduleCallback=function(tt,At,yt){var Mt=n.unstable_now();switch(typeof yt=="object"&&yt!==null?(yt=yt.delay,yt=typeof yt=="number"&&0<yt?Mt+yt:Mt):yt=Mt,tt){case 1:var Qt=-1;break;case 2:Qt=250;break;case 5:Qt=1073741823;break;case 4:Qt=1e4;break;default:Qt=5e3}return Qt=yt+Qt,tt={id:A++,callback:At,priorityLevel:tt,startTime:yt,expirationTime:Qt,sortIndex:-1},yt>Mt?(tt.sortIndex=yt,t(g,tt),e(m)===null&&tt===e(g)&&(O?(B(L),L=-1):O=!0,Vt(nt,yt-Mt))):(tt.sortIndex=Qt,t(m,tt),R||x||(R=!0,X||(X=!0,F()))),tt},n.unstable_shouldYield=q,n.unstable_wrapCallback=function(tt){var At=T;return function(){var yt=T;T=At;try{return tt.apply(this,arguments)}finally{T=yt}}}})(n2)),n2}var G4;function ZA(){return G4||(G4=1,e2.exports=nR()),e2.exports}var i2={exports:{}},Xs={};var q4;function iR(){if(q4)return Xs;q4=1;var n=D1();function t(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)g+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(m,g,A){var E=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:E==null?null:""+E,children:m,containerInfo:g,implementation:A}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Xs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Xs.createPortal=function(m,g){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(t(299));return l(m,g,null,A)},Xs.flushSync=function(m){var g=c.T,A=i.p;try{if(c.T=null,i.p=2,m)return m()}finally{c.T=g,i.p=A,i.d.f()}},Xs.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(m,g))},Xs.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},Xs.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var A=g.as,E=f(A,g.crossOrigin),T=typeof g.integrity=="string"?g.integrity:void 0,x=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;A==="style"?i.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:E,integrity:T,fetchPriority:x}):A==="script"&&i.d.X(m,{crossOrigin:E,integrity:T,fetchPriority:x,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Xs.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var A=f(g.as,g.crossOrigin);i.d.M(m,{crossOrigin:A,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(m)},Xs.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var A=g.as,E=f(A,g.crossOrigin);i.d.L(m,A,{crossOrigin:E,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Xs.preloadModule=function(m,g){if(typeof m=="string")if(g){var A=f(g.as,g.crossOrigin);i.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:A,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(m)},Xs.requestFormReset=function(m){i.d.r(m)},Xs.unstable_batchedUpdates=function(m,g){return m(g)},Xs.useFormState=function(m,g,A){return c.H.useFormState(m,g,A)},Xs.useFormStatus=function(){return c.H.useHostTransitionStatus()},Xs.version="19.2.4",Xs}var F4;function sR(){if(F4)return i2.exports;F4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),i2.exports=iR(),i2.exports}var Y4;function aR(){if(Y4)return rg;Y4=1;var n=ZA(),t=D1(),e=sR();function i(a){var r="https://react.dev/errors/"+a;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)r+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+a+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function l(a){var r=a,h=a;if(a.alternate)for(;r.return;)r=r.return;else{a=r;do r=a,(r.flags&4098)!==0&&(h=r.return),a=r.return;while(a)}return r.tag===3?h:null}function c(a){if(a.tag===13){var r=a.memoizedState;if(r===null&&(a=a.alternate,a!==null&&(r=a.memoizedState)),r!==null)return r.dehydrated}return null}function f(a){if(a.tag===31){var r=a.memoizedState;if(r===null&&(a=a.alternate,a!==null&&(r=a.memoizedState)),r!==null)return r.dehydrated}return null}function m(a){if(l(a)!==a)throw Error(i(188))}function g(a){var r=a.alternate;if(!r){if(r=l(a),r===null)throw Error(i(188));return r!==a?null:a}for(var h=a,d=r;;){var v=h.return;if(v===null)break;var S=v.alternate;if(S===null){if(d=v.return,d!==null){h=d;continue}break}if(v.child===S.child){for(S=v.child;S;){if(S===h)return m(v),a;if(S===d)return m(v),r;S=S.sibling}throw Error(i(188))}if(h.return!==d.return)h=v,d=S;else{for(var N=!1,U=v.child;U;){if(U===h){N=!0,h=v,d=S;break}if(U===d){N=!0,d=v,h=S;break}U=U.sibling}if(!N){for(U=S.child;U;){if(U===h){N=!0,h=S,d=v;break}if(U===d){N=!0,d=S,h=v;break}U=U.sibling}if(!N)throw Error(i(189))}}if(h.alternate!==d)throw Error(i(190))}if(h.tag!==3)throw Error(i(188));return h.stateNode.current===h?a:r}function A(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a;for(a=a.child;a!==null;){if(r=A(a),r!==null)return r;a=a.sibling}return null}var E=Object.assign,T=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),R=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),H=Symbol.for("react.profiler"),B=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),nt=Symbol.for("react.suspense"),X=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),q=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function F(a){return a===null||typeof a!="object"?null:(a=Q&&a[Q]||a["@@iterator"],typeof a=="function"?a:null)}var G=Symbol.for("react.client.reference");function Ot(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===G?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case O:return"Fragment";case H:return"Profiler";case M:return"StrictMode";case nt:return"Suspense";case X:return"SuspenseList";case V:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case R:return"Portal";case Y:return a.displayName||"Context";case B:return(a._context.displayName||"Context")+".Consumer";case $:var r=a.render;return a=a.displayName,a||(a=r.displayName||r.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case L:return r=a.displayName||null,r!==null?r:Ot(a.type)||"Memo";case k:r=a._payload,a=a._init;try{return Ot(a(r))}catch{}}return null}var Vt=Array.isArray,tt=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,At=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,yt={pending:!1,data:null,method:null,action:null},Mt=[],Qt=-1;function W(a){return{current:a}}function ft(a){0>Qt||(a.current=Mt[Qt],Mt[Qt]=null,Qt--)}function bt(a,r){Qt++,Mt[Qt]=a.current,a.current=r}var Ft=W(null),qt=W(null),re=W(null),ne=W(null);function qe(a,r){switch(bt(re,r),bt(qt,a),bt(Ft,null),r.nodeType){case 9:case 11:a=(a=r.documentElement)&&(a=a.namespaceURI)?l4(a):0;break;default:if(a=r.tagName,r=r.namespaceURI)r=l4(r),a=o4(r,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}ft(Ft),bt(Ft,a)}function De(){ft(Ft),ft(qt),ft(re)}function bi(a){a.memoizedState!==null&&bt(ne,a);var r=Ft.current,h=o4(r,a.type);r!==h&&(bt(qt,a),bt(Ft,h))}function ea(a){qt.current===a&&(ft(Ft),ft(qt)),ne.current===a&&(ft(ne),eg._currentValue=yt)}var Nt,Zi;function $i(a){if(Nt===void 0)try{throw Error()}catch(h){var r=h.stack.trim().match(/\n( *(at )?)/);Nt=r&&r[1]||"",Zi=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Nt+a+Zi}var Ze=!1;function Bi(a,r){if(!a||Ze)return"";Ze=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(r){var Tt=function(){throw Error()};if(Object.defineProperty(Tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Tt,[])}catch(gt){var ct=gt}Reflect.construct(a,[],Tt)}else{try{Tt.call()}catch(gt){ct=gt}a.call(Tt.prototype)}}else{try{throw Error()}catch(gt){ct=gt}(Tt=a())&&typeof Tt.catch=="function"&&Tt.catch(function(){})}}catch(gt){if(gt&&ct&&typeof gt.stack=="string")return[gt.stack,ct.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=d.DetermineComponentFrameRoot(),N=S[0],U=S[1];if(N&&U){var J=N.split(`
`),ot=U.split(`
`);for(v=d=0;d<J.length&&!J[d].includes("DetermineComponentFrameRoot");)d++;for(;v<ot.length&&!ot[v].includes("DetermineComponentFrameRoot");)v++;if(d===J.length||v===ot.length)for(d=J.length-1,v=ot.length-1;1<=d&&0<=v&&J[d]!==ot[v];)v--;for(;1<=d&&0<=v;d--,v--)if(J[d]!==ot[v]){if(d!==1||v!==1)do if(d--,v--,0>v||J[d]!==ot[v]){var _t=`
`+J[d].replace(" at new "," at ");return a.displayName&&_t.includes("<anonymous>")&&(_t=_t.replace("<anonymous>",a.displayName)),_t}while(1<=d&&0<=v);break}}}finally{Ze=!1,Error.prepareStackTrace=h}return(h=a?a.displayName||a.name:"")?$i(h):""}function ds(a,r){switch(a.tag){case 26:case 27:case 5:return $i(a.type);case 16:return $i("Lazy");case 13:return a.child!==r&&r!==null?$i("Suspense Fallback"):$i("Suspense");case 19:return $i("SuspenseList");case 0:case 15:return Bi(a.type,!1);case 11:return Bi(a.type.render,!1);case 1:return Bi(a.type,!0);case 31:return $i("Activity");default:return""}}function ql(a){try{var r="",h=null;do r+=ds(a,h),h=a,a=a.return;while(a);return r}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}var Ka=Object.prototype.hasOwnProperty,Ls=n.unstable_scheduleCallback,Wa=n.unstable_cancelCallback,ks=n.unstable_shouldYield,Ln=n.unstable_requestPaint,Qn=n.unstable_now,Vo=n.unstable_getCurrentPriorityLevel,kn=n.unstable_ImmediatePriority,Cn=n.unstable_UserBlockingPriority,Ps=n.unstable_NormalPriority,ms=n.unstable_LowPriority,_a=n.unstable_IdlePriority,Xu=n.log,vr=n.unstable_setDisableYieldValue,Ja=null,di=null;function ps(a){if(typeof Xu=="function"&&vr(a),di&&typeof di.setStrictMode=="function")try{di.setStrictMode(Ja,a)}catch{}}var ji=Math.clz32?Math.clz32:Bo,Uo=Math.log,zo=Math.LN2;function Bo(a){return a>>>=0,a===0?32:31-(Uo(a)/zo|0)|0}var Za=256,Vs=262144,ht=4194304;function St(a){var r=a&42;if(r!==0)return r;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return a&261888;case 262144:case 524288:case 1048576:case 2097152:return a&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function jt(a,r,h){var d=a.pendingLanes;if(d===0)return 0;var v=0,S=a.suspendedLanes,N=a.pingedLanes;a=a.warmLanes;var U=d&134217727;return U!==0?(d=U&~S,d!==0?v=St(d):(N&=U,N!==0?v=St(N):h||(h=U&~a,h!==0&&(v=St(h))))):(U=d&~S,U!==0?v=St(U):N!==0?v=St(N):h||(h=d&~a,h!==0&&(v=St(h)))),v===0?0:r!==0&&r!==v&&(r&S)===0&&(S=v&-v,h=r&-r,S>=h||S===32&&(h&4194048)!==0)?r:v}function Bt(a,r){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&r)===0}function Jt(a,r){switch(a){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xe(){var a=ht;return ht<<=1,(ht&62914560)===0&&(ht=4194304),a}function Pn(a){for(var r=[],h=0;31>h;h++)r.push(a);return r}function ts(a,r){a.pendingLanes|=r,r!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Vn(a,r,h,d,v,S){var N=a.pendingLanes;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=h,a.entangledLanes&=h,a.errorRecoveryDisabledLanes&=h,a.shellSuspendCounter=0;var U=a.entanglements,J=a.expirationTimes,ot=a.hiddenUpdates;for(h=N&~h;0<h;){var _t=31-ji(h),Tt=1<<_t;U[_t]=0,J[_t]=-1;var ct=ot[_t];if(ct!==null)for(ot[_t]=null,_t=0;_t<ct.length;_t++){var gt=ct[_t];gt!==null&&(gt.lane&=-536870913)}h&=~Tt}d!==0&&ya(a,d,0),S!==0&&v===0&&a.tag!==0&&(a.suspendedLanes|=S&~(N&~r))}function ya(a,r,h){a.pendingLanes|=r,a.suspendedLanes&=~r;var d=31-ji(r);a.entangledLanes|=r,a.entanglements[d]=a.entanglements[d]|1073741824|h&261930}function $a(a,r){var h=a.entangledLanes|=r;for(a=a.entanglements;h;){var d=31-ji(h),v=1<<d;v&r|a[d]&r&&(a[d]|=r),h&=~v}}function sl(a,r){var h=r&-r;return h=(h&42)!==0?1:Fl(h),(h&(a.suspendedLanes|r))!==0?0:h}function Fl(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Yl(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function tr(){var a=At.p;return a!==0?a:(a=window.event,a===void 0?32:I4(a.type))}function Ar(a,r){var h=At.p;try{return At.p=a,r()}finally{At.p=h}}var er=Math.random().toString(36).slice(2),vn="__reactFiber$"+er,mi="__reactProps$"+er,va="__reactContainer$"+er,gs="__reactEvents$"+er,Hi="__reactListeners$"+er,Ql="__reactHandles$"+er,jo="__reactResources$"+er,na="__reactMarker$"+er;function nr(a){delete a[vn],delete a[mi],delete a[gs],delete a[Hi],delete a[Ql]}function Er(a){var r=a[vn];if(r)return r;for(var h=a.parentNode;h;){if(r=h[va]||h[vn]){if(h=r.alternate,r.child!==null||h!==null&&h.child!==null)for(a=p4(a);a!==null;){if(h=a[vn])return h;a=p4(a)}return r}a=h,h=a.parentNode}return null}function Sr(a){if(a=a[vn]||a[va]){var r=a.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return a}return null}function Xl(a){var r=a.tag;if(r===5||r===26||r===27||r===6)return a.stateNode;throw Error(i(33))}function ia(a){var r=a[jo];return r||(r=a[jo]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function Un(a){a[na]=!0}var sa=new Set,Tr={};function es(a,r){Gi(a,r),Gi(a+"Capture",r)}function Gi(a,r){for(Tr[a]=r,a=0;a<r.length;a++)sa.add(r[a])}var _s=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kl={},hn={};function Ku(a){return Ka.call(hn,a)?!0:Ka.call(Kl,a)?!1:_s.test(a)?hn[a]=!0:(Kl[a]=!0,!1)}function br(a,r,h){if(Ku(r))if(h===null)a.removeAttribute(r);else{switch(typeof h){case"undefined":case"function":case"symbol":a.removeAttribute(r);return;case"boolean":var d=r.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){a.removeAttribute(r);return}}a.setAttribute(r,""+h)}}function al(a,r,h){if(h===null)a.removeAttribute(r);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(r);return}a.setAttribute(r,""+h)}}function aa(a,r,h,d){if(d===null)a.removeAttribute(h);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}a.setAttributeNS(r,h,""+d)}}function ys(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Wu(a){var r=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function wh(a,r,h){var d=Object.getOwnPropertyDescriptor(a.constructor.prototype,r);if(!a.hasOwnProperty(r)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var v=d.get,S=d.set;return Object.defineProperty(a,r,{configurable:!0,get:function(){return v.call(this)},set:function(N){h=""+N,S.call(this,N)}}),Object.defineProperty(a,r,{enumerable:d.enumerable}),{getValue:function(){return h},setValue:function(N){h=""+N},stopTracking:function(){a._valueTracker=null,delete a[r]}}}}function Wl(a){if(!a._valueTracker){var r=Wu(a)?"checked":"value";a._valueTracker=wh(a,r,""+a[r])}}function pi(a){if(!a)return!1;var r=a._valueTracker;if(!r)return!0;var h=r.getValue(),d="";return a&&(d=Wu(a)?a.checked?"true":"false":a.value),a=d,a!==h?(r.setValue(a),!0):!1}function fn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Aa=/[\n"\\]/g;function dn(a){return a.replace(Aa,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function ir(a,r,h,d,v,S,N,U){a.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?a.type=N:a.removeAttribute("type"),r!=null?N==="number"?(r===0&&a.value===""||a.value!=r)&&(a.value=""+ys(r)):a.value!==""+ys(r)&&(a.value=""+ys(r)):N!=="submit"&&N!=="reset"||a.removeAttribute("value"),r!=null?Us(a,N,ys(r)):h!=null?Us(a,N,ys(h)):d!=null&&a.removeAttribute("value"),v==null&&S!=null&&(a.defaultChecked=!!S),v!=null&&(a.checked=v&&typeof v!="function"&&typeof v!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?a.name=""+ys(U):a.removeAttribute("name")}function rl(a,r,h,d,v,S,N,U){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(a.type=S),r!=null||h!=null){if(!(S!=="submit"&&S!=="reset"||r!=null)){Wl(a);return}h=h!=null?""+ys(h):"",r=r!=null?""+ys(r):h,U||r===a.value||(a.value=r),a.defaultValue=r}d=d??v,d=typeof d!="function"&&typeof d!="symbol"&&!!d,a.checked=U?a.checked:!!d,a.defaultChecked=!!d,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(a.name=N),Wl(a)}function Us(a,r,h){r==="number"&&fn(a.ownerDocument)===a||a.defaultValue===""+h||(a.defaultValue=""+h)}function ke(a,r,h,d){if(a=a.options,r){r={};for(var v=0;v<h.length;v++)r["$"+h[v]]=!0;for(h=0;h<a.length;h++)v=r.hasOwnProperty("$"+a[h].value),a[h].selected!==v&&(a[h].selected=v),v&&d&&(a[h].defaultSelected=!0)}else{for(h=""+ys(h),r=null,v=0;v<a.length;v++){if(a[v].value===h){a[v].selected=!0,d&&(a[v].defaultSelected=!0);return}r!==null||a[v].disabled||(r=a[v])}r!==null&&(r.selected=!0)}}function ll(a,r,h){if(r!=null&&(r=""+ys(r),r!==a.value&&(a.value=r),h==null)){a.defaultValue!==r&&(a.defaultValue=r);return}a.defaultValue=h!=null?""+ys(h):""}function Cr(a,r,h,d){if(r==null){if(d!=null){if(h!=null)throw Error(i(92));if(Vt(d)){if(1<d.length)throw Error(i(93));d=d[0]}h=d}h==null&&(h=""),r=h}h=ys(r),a.defaultValue=h,d=a.textContent,d===h&&d!==""&&d!==null&&(a.value=d),Wl(a)}function ra(a,r){if(r){var h=a.firstChild;if(h&&h===a.lastChild&&h.nodeType===3){h.nodeValue=r;return}}a.textContent=r}var Zf=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ju(a,r,h){var d=r.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?d?a.setProperty(r,""):r==="float"?a.cssFloat="":a[r]="":d?a.setProperty(r,h):typeof h!="number"||h===0||Zf.has(r)?r==="float"?a.cssFloat=h:a[r]=(""+h).trim():a[r]=h+"px"}function Rh(a,r,h){if(r!=null&&typeof r!="object")throw Error(i(62));if(a=a.style,h!=null){for(var d in h)!h.hasOwnProperty(d)||r!=null&&r.hasOwnProperty(d)||(d.indexOf("--")===0?a.setProperty(d,""):d==="float"?a.cssFloat="":a[d]="");for(var v in r)d=r[v],r.hasOwnProperty(v)&&h[v]!==d&&Ju(a,v,d)}else for(var S in r)r.hasOwnProperty(S)&&Ju(a,S,r[S])}function Zu(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $f=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xh=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function sr(a){return xh.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Ci(){}var Ho=null;function Go(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var wr=null,vs=null;function Nh(a){var r=Sr(a);if(r&&(a=r.stateNode)){var h=a[mi]||null;t:switch(a=r.stateNode,r.type){case"input":if(ir(a,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),r=h.name,h.type==="radio"&&r!=null){for(h=a;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+dn(""+r)+'"][type="radio"]'),r=0;r<h.length;r++){var d=h[r];if(d!==a&&d.form===a.form){var v=d[mi]||null;if(!v)throw Error(i(90));ir(d,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(r=0;r<h.length;r++)d=h[r],d.form===a.form&&pi(d)}break t;case"textarea":ll(a,h.value,h.defaultValue);break t;case"select":r=h.value,r!=null&&ke(a,!!h.multiple,r,!1)}}}var $u=!1;function Dh(a,r,h){if($u)return a(r,h);$u=!0;try{var d=a(r);return d}finally{if($u=!1,(wr!==null||vs!==null)&&(fr(),wr&&(r=wr,a=vs,vs=wr=null,Nh(r),a)))for(r=0;r<a.length;r++)Nh(a[r])}}function As(a,r){var h=a.stateNode;if(h===null)return null;var d=h[mi]||null;if(d===null)return null;h=d[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(a=a.type,d=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!d;break t;default:a=!1}if(a)return null;if(h&&typeof h!="function")throw Error(i(231,r,typeof h));return h}var Ea=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ih=!1;if(Ea)try{var ar={};Object.defineProperty(ar,"passive",{get:function(){Ih=!0}}),window.addEventListener("test",ar,ar),window.removeEventListener("test",ar,ar)}catch{Ih=!1}var wi=null,qo=null,la=null;function rr(){if(la)return la;var a,r=qo,h=r.length,d,v="value"in wi?wi.value:wi.textContent,S=v.length;for(a=0;a<h&&r[a]===v[a];a++);var N=h-a;for(d=1;d<=N&&r[h-d]===v[S-d];d++);return la=v.slice(a,1<d?1-d:void 0)}function Jl(a){var r=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&r===13&&(a=13)):a=r,a===10&&(a=13),32<=a||a===13?a:0}function Rr(){return!0}function An(){return!1}function qi(a){function r(h,d,v,S,N){this._reactName=h,this._targetInst=v,this.type=d,this.nativeEvent=S,this.target=N,this.currentTarget=null;for(var U in a)a.hasOwnProperty(U)&&(h=a[U],this[U]=h?h(S):S[U]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Rr:An,this.isPropagationStopped=An,this}return E(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Rr)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Rr)},persist:function(){},isPersistent:Rr}),r}var xr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zl=qi(xr),ol=E({},xr,{view:0,detail:0}),Oh=qi(ol),Nr,Fo,ns,ul=E({},ol,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hl,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==ns&&(ns&&a.type==="mousemove"?(Nr=a.screenX-ns.screenX,Fo=a.screenY-ns.screenY):Fo=Nr=0,ns=a),Nr)},movementY:function(a){return"movementY"in a?a.movementY:Fo}}),Mh=qi(ul),$l=E({},ul,{dataTransfer:0}),Lh=qi($l),Yo=E({},ol,{relatedTarget:0}),cl=qi(Yo),kh=E({},xr,{animationName:0,elapsedTime:0,pseudoElement:0}),tc=qi(kh),Xm=E({},xr,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Ph=qi(Xm),lr=E({},xr,{data:0}),Qo=qi(lr),Xo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ec={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ic(a){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(a):(a=nc[a])?!!r[a]:!1}function hl(){return ic}var Vh=E({},ol,{key:function(a){if(a.key){var r=Xo[a.key]||a.key;if(r!=="Unidentified")return r}return a.type==="keypress"?(a=Jl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?ec[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hl,charCode:function(a){return a.type==="keypress"?Jl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Jl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Dr=qi(Vh),Sa=E({},ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sc=qi(Sa),ac=E({},ol,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hl}),Uh=qi(ac),zh=E({},xr,{propertyName:0,elapsedTime:0,pseudoElement:0}),rc=qi(zh),Ke=E({},ul,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Bh=qi(Ke),jh=E({},xr,{newState:0,oldState:0}),fl=qi(jh),_=[9,13,27,32],w=Ea&&"CompositionEvent"in window,D=null;Ea&&"documentMode"in document&&(D=document.documentMode);var z=Ea&&"TextEvent"in window&&!D,rt=Ea&&(!w||D&&8<D&&11>=D),pt=" ",Lt=!1;function Fe(a,r){switch(a){case"keyup":return _.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $n(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var ye=!1;function gi(a,r){switch(a){case"compositionend":return $n(r);case"keypress":return r.which!==32?null:(Lt=!0,pt);case"textInput":return a=r.data,a===pt&&Lt?null:a;default:return null}}function oi(a,r){if(ye)return a==="compositionend"||!w&&Fe(a,r)?(a=rr(),la=qo=wi=null,ye=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return rt&&r.locale!=="ko"?null:r.data;default:return null}}var Ir={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Es(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r==="input"?!!Ir[a.type]:r==="textarea"}function dl(a,r,h,d){wr?vs?vs.push(d):vs=[d]:wr=d,r=Q_(r,"onChange"),0<r.length&&(h=new Zl("onChange","change",null,h,d),a.push({event:h,listeners:r}))}var Ta=null,Ko=null;function G0(a){e4(a,0)}function lc(a){var r=Xl(a);if(pi(r))return a}function Km(a,r){if(a==="change")return r}var Or=!1;if(Ea){var Hh;if(Ea){var Wm="oninput"in document;if(!Wm){var Jm=document.createElement("div");Jm.setAttribute("oninput","return;"),Wm=typeof Jm.oninput=="function"}Hh=Wm}else Hh=!1;Or=Hh&&(!document.documentMode||9<document.documentMode)}function ba(){Ta&&(Ta.detachEvent("onpropertychange",Gh),Ko=Ta=null)}function Gh(a){if(a.propertyName==="value"&&lc(Ko)){var r=[];dl(r,Ko,a,Go(a)),Dh(G0,r)}}function q0(a,r,h){a==="focusin"?(ba(),Ta=r,Ko=h,Ta.attachEvent("onpropertychange",Gh)):a==="focusout"&&ba()}function Zm(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return lc(Ko)}function F0(a,r){if(a==="click")return lc(r)}function Y0(a,r){if(a==="input"||a==="change")return lc(r)}function $m(a,r){return a===r&&(a!==0||1/a===1/r)||a!==a&&r!==r}var Ss=typeof Object.is=="function"?Object.is:$m;function oc(a,r){if(Ss(a,r))return!0;if(typeof a!="object"||a===null||typeof r!="object"||r===null)return!1;var h=Object.keys(a),d=Object.keys(r);if(h.length!==d.length)return!1;for(d=0;d<h.length;d++){var v=h[d];if(!Ka.call(r,v)||!Ss(a[v],r[v]))return!1}return!0}function qh(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function uc(a,r){var h=qh(a);a=0;for(var d;h;){if(h.nodeType===3){if(d=a+h.textContent.length,a<=r&&d>=r)return{node:h,offset:r-a};a=d}t:{for(;h;){if(h.nextSibling){h=h.nextSibling;break t}h=h.parentNode}h=void 0}h=qh(h)}}function mn(a,r){return a&&r?a===r?!0:a&&a.nodeType===3?!1:r&&r.nodeType===3?mn(a,r.parentNode):"contains"in a?a.contains(r):a.compareDocumentPosition?!!(a.compareDocumentPosition(r)&16):!1:!1}function Q0(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var r=fn(a.document);r instanceof a.HTMLIFrameElement;){try{var h=typeof r.contentWindow.location.href=="string"}catch{h=!1}if(h)a=r.contentWindow;else break;r=fn(a.document)}return r}function tp(a){var r=a&&a.nodeName&&a.nodeName.toLowerCase();return r&&(r==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||r==="textarea"||a.contentEditable==="true")}var X0=Ea&&"documentMode"in document&&11>=document.documentMode,Mr=null,Lr=null,cc=null,td=!1;function hc(a,r,h){var d=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;td||Mr==null||Mr!==fn(d)||(d=Mr,"selectionStart"in d&&tp(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),cc&&oc(cc,d)||(cc=d,d=Q_(Lr,"onSelect"),0<d.length&&(r=new Zl("onSelect","select",null,r,h),a.push({event:r,listeners:d}),r.target=Mr)))}function is(a,r){var h={};return h[a.toLowerCase()]=r.toLowerCase(),h["Webkit"+a]="webkit"+r,h["Moz"+a]="moz"+r,h}var Wo={animationend:is("Animation","AnimationEnd"),animationiteration:is("Animation","AnimationIteration"),animationstart:is("Animation","AnimationStart"),transitionrun:is("Transition","TransitionRun"),transitionstart:is("Transition","TransitionStart"),transitioncancel:is("Transition","TransitionCancel"),transitionend:is("Transition","TransitionEnd")},Fh={},ep={};Ea&&(ep=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function ml(a){if(Fh[a])return Fh[a];if(!Wo[a])return a;var r=Wo[a],h;for(h in r)if(r.hasOwnProperty(h)&&h in ep)return Fh[a]=r[h];return a}var ed=ml("animationend"),Yh=ml("animationiteration"),np=ml("animationstart"),K0=ml("transitionrun"),Ev=ml("transitionstart"),W0=ml("transitioncancel"),ip=ml("transitionend"),Ca=new Map,Qh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qh.push("scrollEnd");function wa(a,r){Ca.set(a,r),es(r,[a])}var Xh=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},Ra=[],pl=0,Ri=0;function Kh(){for(var a=pl,r=Ri=pl=0;r<a;){var h=Ra[r];Ra[r++]=null;var d=Ra[r];Ra[r++]=null;var v=Ra[r];Ra[r++]=null;var S=Ra[r];if(Ra[r++]=null,d!==null&&v!==null){var N=d.pending;N===null?v.next=v:(v.next=N.next,N.next=v),d.pending=v}S!==0&&to(h,v,S)}}function xi(a,r,h,d){Ra[pl++]=a,Ra[pl++]=r,Ra[pl++]=h,Ra[pl++]=d,Ri|=d,a.lanes|=d,a=a.alternate,a!==null&&(a.lanes|=d)}function nd(a,r,h,d){return xi(a,r,h,d),xa(a)}function Ts(a,r){return xi(a,null,null,r),xa(a)}function to(a,r,h){a.lanes|=h;var d=a.alternate;d!==null&&(d.lanes|=h);for(var v=!1,S=a.return;S!==null;)S.childLanes|=h,d=S.alternate,d!==null&&(d.childLanes|=h),S.tag===22&&(a=S.stateNode,a===null||a._visibility&1||(v=!0)),a=S,S=S.return;return a.tag===3?(S=a.stateNode,v&&r!==null&&(v=31-ji(h),a=S.hiddenUpdates,d=a[v],d===null?a[v]=[r]:d.push(r),r.lane=h|536870912),S):null}function xa(a){if(50<Ao)throw Ao=0,pu=null,Error(i(185));for(var r=a.return;r!==null;)a=r,r=a.return;return a.tag===3?a.stateNode:null}var eo={};function sp(a,r,h,d){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(a,r,h,d){return new sp(a,r,h,d)}function id(a){return a=a.prototype,!(!a||!a.isReactComponent)}function zs(a,r){var h=a.alternate;return h===null?(h=zn(a.tag,r,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=r,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&65011712,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,r=a.dependencies,h.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h.refCleanup=a.refCleanup,h}function fc(a,r){a.flags&=65011714;var h=a.alternate;return h===null?(a.childLanes=0,a.lanes=r,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=h.childLanes,a.lanes=h.lanes,a.child=h.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=h.memoizedProps,a.memoizedState=h.memoizedState,a.updateQueue=h.updateQueue,a.type=h.type,r=h.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),a}function kr(a,r,h,d,v,S){var N=0;if(d=a,typeof a=="function")id(a)&&(N=1);else if(typeof a=="string")N=jw(a,h,Ft.current)?26:a==="html"||a==="head"||a==="body"?27:5;else t:switch(a){case V:return a=zn(31,h,r,v),a.elementType=V,a.lanes=S,a;case O:return no(h.children,v,S,r);case M:N=8,v|=24;break;case H:return a=zn(12,h,r,v|2),a.elementType=H,a.lanes=S,a;case nt:return a=zn(13,h,r,v),a.elementType=nt,a.lanes=S,a;case X:return a=zn(19,h,r,v),a.elementType=X,a.lanes=S,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case Y:N=10;break t;case B:N=9;break t;case $:N=11;break t;case L:N=14;break t;case k:N=16,d=null;break t}N=29,h=Error(i(130,a===null?"null":typeof a,"")),d=null}return r=zn(N,h,r,v),r.elementType=a,r.type=d,r.lanes=S,r}function no(a,r,h,d){return a=zn(7,a,d,r),a.lanes=h,a}function sd(a,r,h){return a=zn(6,a,null,r),a.lanes=h,a}function dc(a){var r=zn(18,null,null,0);return r.stateNode=a,r}function ad(a,r,h){return r=zn(4,a.children!==null?a.children:[],a.key,r),r.lanes=h,r.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},r}var Wh=new WeakMap;function oa(a,r){if(typeof a=="object"&&a!==null){var h=Wh.get(a);return h!==void 0?h:(r={value:a,source:r,stack:ql(r)},Wh.set(a,r),r)}return{value:a,source:r,stack:ql(r)}}var io=[],so=0,mc=null,pc=0,Bs=[],wn=0,gl=null,Bn=1,or="";function Pr(a,r){io[so++]=pc,io[so++]=mc,mc=a,pc=r}function J0(a,r,h){Bs[wn++]=Bn,Bs[wn++]=or,Bs[wn++]=gl,gl=a;var d=Bn;a=or;var v=32-ji(d)-1;d&=~(1<<v),h+=1;var S=32-ji(r)+v;if(30<S){var N=v-v%5;S=(d&(1<<N)-1).toString(32),d>>=N,v-=N,Bn=1<<32-ji(r)+v|h<<v|d,or=S+a}else Bn=1<<S|h<<v|d,or=a}function Vr(a){a.return!==null&&(Pr(a,1),J0(a,1,0))}function rd(a){for(;a===mc;)mc=io[--so],io[so]=null,pc=io[--so],io[so]=null;for(;a===gl;)gl=Bs[--wn],Bs[wn]=null,or=Bs[--wn],Bs[wn]=null,Bn=Bs[--wn],Bs[wn]=null}function ld(a,r){Bs[wn++]=Bn,Bs[wn++]=or,Bs[wn++]=gl,Bn=r.id,or=r.overflow,gl=a}var Xn=null,pn=null,Ie=!1,_l=null,ua=!1,gc=Error(i(519));function Ur(a){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zr(oa(r,a)),gc}function Z0(a){var r=a.stateNode,h=a.type,d=a.memoizedProps;switch(r[vn]=a,r[mi]=d,h){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(h=0;h<ja.length;h++)Ve(ja[h],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":Ve("invalid",r),rl(r,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0);break;case"select":Ve("invalid",r);break;case"textarea":Ve("invalid",r),Cr(r,d.value,d.defaultValue,d.children)}h=d.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||r.textContent===""+h||d.suppressHydrationWarning===!0||a4(r.textContent,h)?(d.popover!=null&&(Ve("beforetoggle",r),Ve("toggle",r)),d.onScroll!=null&&Ve("scroll",r),d.onScrollEnd!=null&&Ve("scrollend",r),d.onClick!=null&&(r.onclick=Ci),r=!0):r=!1,r||Ur(a,!0)}function $0(a){for(Xn=a.return;Xn;)switch(Xn.tag){case 5:case 31:case 13:ua=!1;return;case 27:case 3:ua=!0;return;default:Xn=Xn.return}}function _c(a){if(a!==Xn)return!1;if(!Ie)return $0(a),Ie=!0,!1;var r=a.tag,h;if((h=r!==3&&r!==27)&&((h=r===5)&&(h=a.type,h=!(h!=="form"&&h!=="button")||Vv(a.type,a.memoizedProps)),h=!h),h&&pn&&Ur(a),$0(a),r===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));pn=m4(a)}else if(r===31){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(317));pn=m4(a)}else r===27?(r=pn,Vc(a.type)?(a=Hv,Hv=null,pn=a):pn=r):pn=Xn?$r(a.stateNode.nextSibling):null;return!0}function ao(){pn=Xn=null,Ie=!1}function od(){var a=_l;return a!==null&&(Wn===null?Wn=a:Wn.push.apply(Wn,a),_l=null),a}function zr(a){_l===null?_l=[a]:_l.push(a)}var yc=W(null),ro=null,Br=null;function yl(a,r,h){bt(yc,r._currentValue),r._currentValue=h}function jr(a){a._currentValue=yc.current,ft(yc)}function ud(a,r,h){for(;a!==null;){var d=a.alternate;if((a.childLanes&r)!==r?(a.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),a===h)break;a=a.return}}function cd(a,r,h,d){var v=a.child;for(v!==null&&(v.return=a);v!==null;){var S=v.dependencies;if(S!==null){var N=v.child;S=S.firstContext;t:for(;S!==null;){var U=S;S=v;for(var J=0;J<r.length;J++)if(U.context===r[J]){S.lanes|=h,U=S.alternate,U!==null&&(U.lanes|=h),ud(S.return,h,a),d||(N=null);break t}S=U.next}}else if(v.tag===18){if(N=v.return,N===null)throw Error(i(341));N.lanes|=h,S=N.alternate,S!==null&&(S.lanes|=h),ud(N,h,a),N=null}else N=v.child;if(N!==null)N.return=v;else for(N=v;N!==null;){if(N===a){N=null;break}if(v=N.sibling,v!==null){v.return=N.return,N=v;break}N=N.return}v=N}}function Hr(a,r,h,d){a=null;for(var v=r,S=!1;v!==null;){if(!S){if((v.flags&524288)!==0)S=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var N=v.alternate;if(N===null)throw Error(i(387));if(N=N.memoizedProps,N!==null){var U=v.type;Ss(v.pendingProps.value,N.value)||(a!==null?a.push(U):a=[U])}}else if(v===ne.current){if(N=v.alternate,N===null)throw Error(i(387));N.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(a!==null?a.push(eg):a=[eg])}v=v.return}a!==null&&cd(r,a,h,d),r.flags|=262144}function Jh(a){for(a=a.firstContext;a!==null;){if(!Ss(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function lo(a){ro=a,Br=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function ae(a){return t_(ro,a)}function vc(a,r){return ro===null&&lo(a),t_(a,r)}function t_(a,r){var h=r._currentValue;if(r={context:r,memoizedValue:h,next:null},Br===null){if(a===null)throw Error(i(308));Br=r,a.dependencies={lanes:0,firstContext:r},a.flags|=524288}else Br=Br.next=r;return h}var e_=typeof AbortController<"u"?AbortController:function(){var a=[],r=this.signal={aborted:!1,addEventListener:function(h,d){a.push(d)}};this.abort=function(){r.aborted=!0,a.forEach(function(h){return h()})}},Sv=n.unstable_scheduleCallback,Tv=n.unstable_NormalPriority,ui={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ap(){return{controller:new e_,data:new Map,refCount:0}}function Jo(a){a.refCount--,a.refCount===0&&Sv(Tv,function(){a.controller.abort()})}var ca=null,hd=0,vl=0,Na=null;function rp(a,r){if(ca===null){var h=ca=[];hd=0,vl=dt(),Na={status:"pending",value:void 0,then:function(d){h.push(d)}}}return hd++,r.then(lp,lp),r}function lp(){if(--hd===0&&ca!==null){Na!==null&&(Na.status="fulfilled");var a=ca;ca=null,vl=0,Na=null;for(var r=0;r<a.length;r++)(0,a[r])()}}function op(a,r){var h=[],d={status:"pending",value:null,reason:null,then:function(v){h.push(v)}};return a.then(function(){d.status="fulfilled",d.value=r;for(var v=0;v<h.length;v++)(0,h[v])(r)},function(v){for(d.status="rejected",d.reason=v,v=0;v<h.length;v++)(0,h[v])(void 0)}),d}var n_=tt.S;tt.S=function(a,r){Kp=Qn(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&rp(a,r),n_!==null&&n_(a,r)};var oo=W(null);function fd(){var a=oo.current;return a!==null?a:ue.pooledCache}function Zh(a,r){r===null?bt(oo,oo.current):bt(oo,r.pool)}function up(){var a=fd();return a===null?null:{parent:ui._currentValue,pool:a}}var Zo=Error(i(460)),$h=Error(i(474)),ve=Error(i(542)),dd={then:function(){}};function js(a){return a=a.status,a==="fulfilled"||a==="rejected"}function md(a,r,h){switch(h=a[h],h===void 0?a.push(r):h!==r&&(r.then(Ci,Ci),r=h),r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,eu(a),a;default:if(typeof r.status=="string")r.then(Ci,Ci);else{if(a=ue,a!==null&&100<a.shellSuspendCounter)throw Error(i(482));a=r,a.status="pending",a.then(function(d){if(r.status==="pending"){var v=r;v.status="fulfilled",v.value=d}},function(d){if(r.status==="pending"){var v=r;v.status="rejected",v.reason=d}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw a=r.reason,eu(a),a}throw Gr=r,Zo}}function $o(a){try{var r=a._init;return r(a._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Gr=h,Zo):h}}var Gr=null;function tu(){if(Gr===null)throw Error(i(459));var a=Gr;return Gr=null,a}function eu(a){if(a===Zo||a===ve)throw Error(i(483))}var nu=null,iu=0;function tf(a){var r=iu;return iu+=1,nu===null&&(nu=[]),md(nu,a,r)}function Da(a,r){r=r.props.ref,a.ref=r!==void 0?r:null}function Ac(a,r){throw r.$$typeof===T?Error(i(525)):(a=Object.prototype.toString.call(r),Error(i(31,a==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":a)))}function pd(a){function r(it,et){if(a){var lt=it.deletions;lt===null?(it.deletions=[et],it.flags|=16):lt.push(et)}}function h(it,et){if(!a)return null;for(;et!==null;)r(it,et),et=et.sibling;return null}function d(it){for(var et=new Map;it!==null;)it.key!==null?et.set(it.key,it):et.set(it.index,it),it=it.sibling;return et}function v(it,et){return it=zs(it,et),it.index=0,it.sibling=null,it}function S(it,et,lt){return it.index=lt,a?(lt=it.alternate,lt!==null?(lt=lt.index,lt<et?(it.flags|=67108866,et):lt):(it.flags|=67108866,et)):(it.flags|=1048576,et)}function N(it){return a&&it.alternate===null&&(it.flags|=67108866),it}function U(it,et,lt,vt){return et===null||et.tag!==6?(et=sd(lt,it.mode,vt),et.return=it,et):(et=v(et,lt),et.return=it,et)}function J(it,et,lt,vt){var te=lt.type;return te===O?_t(it,et,lt.props.children,vt,lt.key):et!==null&&(et.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===k&&$o(te)===et.type)?(et=v(et,lt.props),Da(et,lt),et.return=it,et):(et=kr(lt.type,lt.key,lt.props,null,it.mode,vt),Da(et,lt),et.return=it,et)}function ot(it,et,lt,vt){return et===null||et.tag!==4||et.stateNode.containerInfo!==lt.containerInfo||et.stateNode.implementation!==lt.implementation?(et=ad(lt,it.mode,vt),et.return=it,et):(et=v(et,lt.children||[]),et.return=it,et)}function _t(it,et,lt,vt,te){return et===null||et.tag!==7?(et=no(lt,it.mode,vt,te),et.return=it,et):(et=v(et,lt),et.return=it,et)}function Tt(it,et,lt){if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return et=sd(""+et,it.mode,lt),et.return=it,et;if(typeof et=="object"&&et!==null){switch(et.$$typeof){case x:return lt=kr(et.type,et.key,et.props,null,it.mode,lt),Da(lt,et),lt.return=it,lt;case R:return et=ad(et,it.mode,lt),et.return=it,et;case k:return et=$o(et),Tt(it,et,lt)}if(Vt(et)||F(et))return et=no(et,it.mode,lt,null),et.return=it,et;if(typeof et.then=="function")return Tt(it,tf(et),lt);if(et.$$typeof===Y)return Tt(it,vc(it,et),lt);Ac(it,et)}return null}function ct(it,et,lt,vt){var te=et!==null?et.key:null;if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return te!==null?null:U(it,et,""+lt,vt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case x:return lt.key===te?J(it,et,lt,vt):null;case R:return lt.key===te?ot(it,et,lt,vt):null;case k:return lt=$o(lt),ct(it,et,lt,vt)}if(Vt(lt)||F(lt))return te!==null?null:_t(it,et,lt,vt,null);if(typeof lt.then=="function")return ct(it,et,tf(lt),vt);if(lt.$$typeof===Y)return ct(it,et,vc(it,lt),vt);Ac(it,lt)}return null}function gt(it,et,lt,vt,te){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return it=it.get(lt)||null,U(et,it,""+vt,te);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case x:return it=it.get(vt.key===null?lt:vt.key)||null,J(et,it,vt,te);case R:return it=it.get(vt.key===null?lt:vt.key)||null,ot(et,it,vt,te);case k:return vt=$o(vt),gt(it,et,lt,vt,te)}if(Vt(vt)||F(vt))return it=it.get(lt)||null,_t(et,it,vt,te,null);if(typeof vt.then=="function")return gt(it,et,lt,tf(vt),te);if(vt.$$typeof===Y)return gt(it,et,lt,vc(et,vt),te);Ac(et,vt)}return null}function Xt(it,et,lt,vt){for(var te=null,We=null,Kt=et,Se=et=0,Be=null;Kt!==null&&Se<lt.length;Se++){Kt.index>Se?(Be=Kt,Kt=null):Be=Kt.sibling;var Je=ct(it,Kt,lt[Se],vt);if(Je===null){Kt===null&&(Kt=Be);break}a&&Kt&&Je.alternate===null&&r(it,Kt),et=S(Je,et,Se),We===null?te=Je:We.sibling=Je,We=Je,Kt=Be}if(Se===lt.length)return h(it,Kt),Ie&&Pr(it,Se),te;if(Kt===null){for(;Se<lt.length;Se++)Kt=Tt(it,lt[Se],vt),Kt!==null&&(et=S(Kt,et,Se),We===null?te=Kt:We.sibling=Kt,We=Kt);return Ie&&Pr(it,Se),te}for(Kt=d(Kt);Se<lt.length;Se++)Be=gt(Kt,it,Se,lt[Se],vt),Be!==null&&(a&&Be.alternate!==null&&Kt.delete(Be.key===null?Se:Be.key),et=S(Be,et,Se),We===null?te=Be:We.sibling=Be,We=Be);return a&&Kt.forEach(function(Hc){return r(it,Hc)}),Ie&&Pr(it,Se),te}function se(it,et,lt,vt){if(lt==null)throw Error(i(151));for(var te=null,We=null,Kt=et,Se=et=0,Be=null,Je=lt.next();Kt!==null&&!Je.done;Se++,Je=lt.next()){Kt.index>Se?(Be=Kt,Kt=null):Be=Kt.sibling;var Hc=ct(it,Kt,Je.value,vt);if(Hc===null){Kt===null&&(Kt=Be);break}a&&Kt&&Hc.alternate===null&&r(it,Kt),et=S(Hc,et,Se),We===null?te=Hc:We.sibling=Hc,We=Hc,Kt=Be}if(Je.done)return h(it,Kt),Ie&&Pr(it,Se),te;if(Kt===null){for(;!Je.done;Se++,Je=lt.next())Je=Tt(it,Je.value,vt),Je!==null&&(et=S(Je,et,Se),We===null?te=Je:We.sibling=Je,We=Je);return Ie&&Pr(it,Se),te}for(Kt=d(Kt);!Je.done;Se++,Je=lt.next())Je=gt(Kt,it,Se,Je.value,vt),Je!==null&&(a&&Je.alternate!==null&&Kt.delete(Je.key===null?Se:Je.key),et=S(Je,et,Se),We===null?te=Je:We.sibling=Je,We=Je);return a&&Kt.forEach(function(Zw){return r(it,Zw)}),Ie&&Pr(it,Se),te}function yn(it,et,lt,vt){if(typeof lt=="object"&&lt!==null&&lt.type===O&&lt.key===null&&(lt=lt.props.children),typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case x:t:{for(var te=lt.key;et!==null;){if(et.key===te){if(te=lt.type,te===O){if(et.tag===7){h(it,et.sibling),vt=v(et,lt.props.children),vt.return=it,it=vt;break t}}else if(et.elementType===te||typeof te=="object"&&te!==null&&te.$$typeof===k&&$o(te)===et.type){h(it,et.sibling),vt=v(et,lt.props),Da(vt,lt),vt.return=it,it=vt;break t}h(it,et);break}else r(it,et);et=et.sibling}lt.type===O?(vt=no(lt.props.children,it.mode,vt,lt.key),vt.return=it,it=vt):(vt=kr(lt.type,lt.key,lt.props,null,it.mode,vt),Da(vt,lt),vt.return=it,it=vt)}return N(it);case R:t:{for(te=lt.key;et!==null;){if(et.key===te)if(et.tag===4&&et.stateNode.containerInfo===lt.containerInfo&&et.stateNode.implementation===lt.implementation){h(it,et.sibling),vt=v(et,lt.children||[]),vt.return=it,it=vt;break t}else{h(it,et);break}else r(it,et);et=et.sibling}vt=ad(lt,it.mode,vt),vt.return=it,it=vt}return N(it);case k:return lt=$o(lt),yn(it,et,lt,vt)}if(Vt(lt))return Xt(it,et,lt,vt);if(F(lt)){if(te=F(lt),typeof te!="function")throw Error(i(150));return lt=te.call(lt),se(it,et,lt,vt)}if(typeof lt.then=="function")return yn(it,et,tf(lt),vt);if(lt.$$typeof===Y)return yn(it,et,vc(it,lt),vt);Ac(it,lt)}return typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint"?(lt=""+lt,et!==null&&et.tag===6?(h(it,et.sibling),vt=v(et,lt),vt.return=it,it=vt):(h(it,et),vt=sd(lt,it.mode,vt),vt.return=it,it=vt),N(it)):h(it,et)}return function(it,et,lt,vt){try{iu=0;var te=yn(it,et,lt,vt);return nu=null,te}catch(Kt){if(Kt===Zo||Kt===ve)throw Kt;var We=zn(29,Kt,null,it.mode);return We.lanes=vt,We.return=it,We}}}var Al=pd(!0),gd=pd(!1),bs=!1;function ef(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cp(a,r){a=a.updateQueue,r.updateQueue===a&&(r.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function El(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function uo(a,r,h){var d=a.updateQueue;if(d===null)return null;if(d=d.shared,(Wt&2)!==0){var v=d.pending;return v===null?r.next=r:(r.next=v.next,v.next=r),d.pending=r,r=xa(a),to(a,null,h),r}return xi(a,d,r,h),xa(a)}function co(a,r,h){if(r=r.updateQueue,r!==null&&(r=r.shared,(h&4194048)!==0)){var d=r.lanes;d&=a.pendingLanes,h|=d,r.lanes=h,$a(a,h)}}function $t(a,r){var h=a.updateQueue,d=a.alternate;if(d!==null&&(d=d.updateQueue,h===d)){var v=null,S=null;if(h=h.firstBaseUpdate,h!==null){do{var N={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};S===null?v=S=N:S=S.next=N,h=h.next}while(h!==null);S===null?v=S=r:S=S.next=r}else v=S=r;h={baseState:d.baseState,firstBaseUpdate:v,lastBaseUpdate:S,shared:d.shared,callbacks:d.callbacks},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=r:a.next=r,h.lastBaseUpdate=r}var hp=!1;function nf(){if(hp){var a=Na;if(a!==null)throw a}}function Ec(a,r,h,d){hp=!1;var v=a.updateQueue;bs=!1;var S=v.firstBaseUpdate,N=v.lastBaseUpdate,U=v.shared.pending;if(U!==null){v.shared.pending=null;var J=U,ot=J.next;J.next=null,N===null?S=ot:N.next=ot,N=J;var _t=a.alternate;_t!==null&&(_t=_t.updateQueue,U=_t.lastBaseUpdate,U!==N&&(U===null?_t.firstBaseUpdate=ot:U.next=ot,_t.lastBaseUpdate=J))}if(S!==null){var Tt=v.baseState;N=0,_t=ot=J=null,U=S;do{var ct=U.lane&-536870913,gt=ct!==U.lane;if(gt?(_e&ct)===ct:(d&ct)===ct){ct!==0&&ct===vl&&(hp=!0),_t!==null&&(_t=_t.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});t:{var Xt=a,se=U;ct=r;var yn=h;switch(se.tag){case 1:if(Xt=se.payload,typeof Xt=="function"){Tt=Xt.call(yn,Tt,ct);break t}Tt=Xt;break t;case 3:Xt.flags=Xt.flags&-65537|128;case 0:if(Xt=se.payload,ct=typeof Xt=="function"?Xt.call(yn,Tt,ct):Xt,ct==null)break t;Tt=E({},Tt,ct);break t;case 2:bs=!0}}ct=U.callback,ct!==null&&(a.flags|=64,gt&&(a.flags|=8192),gt=v.callbacks,gt===null?v.callbacks=[ct]:gt.push(ct))}else gt={lane:ct,tag:U.tag,payload:U.payload,callback:U.callback,next:null},_t===null?(ot=_t=gt,J=Tt):_t=_t.next=gt,N|=ct;if(U=U.next,U===null){if(U=v.shared.pending,U===null)break;gt=U,U=gt.next,gt.next=null,v.lastBaseUpdate=gt,v.shared.pending=null}}while(!0);_t===null&&(J=Tt),v.baseState=J,v.firstBaseUpdate=ot,v.lastBaseUpdate=_t,S===null&&(v.shared.lanes=0),Wr|=N,a.lanes=N,a.memoizedState=Tt}}function Sc(a,r){if(typeof a!="function")throw Error(i(191,a));a.call(r)}function i_(a,r){var h=a.callbacks;if(h!==null)for(a.callbacks=null,a=0;a<h.length;a++)Sc(h[a],r)}var Tc=W(null),_d=W(0);function s_(a,r){a=ma,bt(_d,a),bt(Tc,r),ma=a|r.baseLanes}function fp(){bt(_d,ma),bt(Tc,Tc.current)}function sf(){ma=_d.current,ft(Tc),ft(_d)}var Hs=W(null),Cs=null;function Sl(a){var r=a.alternate;bt(Oe,Oe.current&1),bt(Hs,a),Cs===null&&(r===null||Tc.current!==null||r.memoizedState!==null)&&(Cs=a)}function dp(a){bt(Oe,Oe.current),bt(Hs,a),Cs===null&&(Cs=a)}function a_(a){a.tag===22?(bt(Oe,Oe.current),bt(Hs,a),Cs===null&&(Cs=a)):Gs()}function Gs(){bt(Oe,Oe.current),bt(Hs,Hs.current)}function ti(a){ft(Hs),Cs===a&&(Cs=null),ft(Oe)}var Oe=W(0);function ha(a){for(var r=a;r!==null;){if(r.tag===13){var h=r.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Bv(h)||jv(h)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Rn=0,de=null,rn=null,Ce=null,Ia=!1,bc=!1,su=!1,yd=0,af=0,Cc=null,mp=0;function jn(){throw Error(i(321))}function pp(a,r){if(r===null)return!1;for(var h=0;h<r.length&&h<a.length;h++)if(!Ss(a[h],r[h]))return!1;return!0}function vd(a,r,h,d,v,S){return Rn=S,de=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,tt.H=a===null||a.memoizedState===null?V_:kp,su=!1,S=h(d,v),su=!1,bc&&(S=au(r,h,d,v)),r_(a),S}function r_(a){tt.H=wc;var r=rn!==null&&rn.next!==null;if(Rn=0,Ce=rn=de=null,Ia=!1,af=0,Cc=null,r)throw Error(i(300));a===null||ci||(a=a.dependencies,a!==null&&Jh(a)&&(ci=!0))}function au(a,r,h,d){de=a;var v=0;do{if(bc&&(Cc=null),af=0,bc=!1,25<=v)throw Error(i(301));if(v+=1,Ce=rn=null,a.updateQueue!=null){var S=a.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}tt.H=Oa,S=r(h,d)}while(bc);return S}function ru(){var a=tt.H,r=a.useState()[0];return r=typeof r.then=="function"?rf(r):r,a=a.useState()[0],(rn!==null?rn.memoizedState:null)!==a&&(de.flags|=1024),r}function gp(){var a=yd!==0;return yd=0,a}function _p(a,r,h){r.updateQueue=a.updateQueue,r.flags&=-2053,a.lanes&=~h}function yp(a){if(Ia){for(a=a.memoizedState;a!==null;){var r=a.queue;r!==null&&(r.pending=null),a=a.next}Ia=!1}Rn=0,Ce=rn=de=null,bc=!1,af=yd=0,Cc=null}function _i(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ce===null?de.memoizedState=Ce=a:Ce=Ce.next=a,Ce}function ei(){if(rn===null){var a=de.alternate;a=a!==null?a.memoizedState:null}else a=rn.next;var r=Ce===null?de.memoizedState:Ce.next;if(r!==null)Ce=r,rn=a;else{if(a===null)throw de.alternate===null?Error(i(467)):Error(i(310));rn=a,a={memoizedState:rn.memoizedState,baseState:rn.baseState,baseQueue:rn.baseQueue,queue:rn.queue,next:null},Ce===null?de.memoizedState=Ce=a:Ce=Ce.next=a}return Ce}function Ad(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rf(a){var r=af;return af+=1,Cc===null&&(Cc=[]),a=md(Cc,a,r),r=de,(Ce===null?r.memoizedState:Ce.next)===null&&(r=r.alternate,tt.H=r===null||r.memoizedState===null?V_:kp),a}function ho(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return rf(a);if(a.$$typeof===Y)return ae(a)}throw Error(i(438,String(a)))}function vp(a){var r=null,h=de.updateQueue;if(h!==null&&(r=h.memoCache),r==null){var d=de.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(r={data:d.data.map(function(v){return v.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),h===null&&(h=Ad(),de.updateQueue=h),h.memoCache=r,h=r.data[r.index],h===void 0)for(h=r.data[r.index]=Array(a),d=0;d<a;d++)h[d]=q;return r.index++,h}function Tl(a,r){return typeof r=="function"?r(a):r}function Ed(a){var r=ei();return Ap(r,rn,a)}function Ap(a,r,h){var d=a.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=h;var v=a.baseQueue,S=d.pending;if(S!==null){if(v!==null){var N=v.next;v.next=S.next,S.next=N}r.baseQueue=v=S,d.pending=null}if(S=a.baseState,v===null)a.memoizedState=S;else{r=v.next;var U=N=null,J=null,ot=r,_t=!1;do{var Tt=ot.lane&-536870913;if(Tt!==ot.lane?(_e&Tt)===Tt:(Rn&Tt)===Tt){var ct=ot.revertLane;if(ct===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null}),Tt===vl&&(_t=!0);else if((Rn&ct)===ct){ot=ot.next,ct===vl&&(_t=!0);continue}else Tt={lane:0,revertLane:ot.revertLane,gesture:null,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null},J===null?(U=J=Tt,N=S):J=J.next=Tt,de.lanes|=ct,Wr|=ct;Tt=ot.action,su&&h(S,Tt),S=ot.hasEagerState?ot.eagerState:h(S,Tt)}else ct={lane:Tt,revertLane:ot.revertLane,gesture:ot.gesture,action:ot.action,hasEagerState:ot.hasEagerState,eagerState:ot.eagerState,next:null},J===null?(U=J=ct,N=S):J=J.next=ct,de.lanes|=Tt,Wr|=Tt;ot=ot.next}while(ot!==null&&ot!==r);if(J===null?N=S:J.next=U,!Ss(S,a.memoizedState)&&(ci=!0,_t&&(h=Na,h!==null)))throw h;a.memoizedState=S,a.baseState=N,a.baseQueue=J,d.lastRenderedState=S}return v===null&&(d.lanes=0),[a.memoizedState,d.dispatch]}function Ep(a){var r=ei(),h=r.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=a;var d=h.dispatch,v=h.pending,S=r.memoizedState;if(v!==null){h.pending=null;var N=v=v.next;do S=a(S,N.action),N=N.next;while(N!==v);Ss(S,r.memoizedState)||(ci=!0),r.memoizedState=S,r.baseQueue===null&&(r.baseState=S),h.lastRenderedState=S}return[S,d]}function l_(a,r,h){var d=de,v=ei(),S=Ie;if(S){if(h===void 0)throw Error(i(407));h=h()}else h=r();var N=!Ss((rn||v).memoizedState,h);if(N&&(v.memoizedState=h,ci=!0),v=v.queue,Np(c_.bind(null,d,v,a),[a]),v.getSnapshot!==r||N||Ce!==null&&Ce.memoizedState.tag&1){if(d.flags|=2048,fo(9,{destroy:void 0},u_.bind(null,d,v,h,r),null),ue===null)throw Error(i(349));S||(Rn&127)!==0||o_(d,r,h)}return h}function o_(a,r,h){a.flags|=16384,a={getSnapshot:r,value:h},r=de.updateQueue,r===null?(r=Ad(),de.updateQueue=r,r.stores=[a]):(h=r.stores,h===null?r.stores=[a]:h.push(a))}function u_(a,r,h,d){r.value=h,r.getSnapshot=d,h_(r)&&f_(a)}function c_(a,r,h){return h(function(){h_(r)&&f_(a)})}function h_(a){var r=a.getSnapshot;a=a.value;try{var h=r();return!Ss(a,h)}catch{return!0}}function f_(a){var r=Ts(a,2);r!==null&&Ee(r,a,2)}function Sp(a){var r=_i();if(typeof a=="function"){var h=a;if(a=h(),su){ps(!0);try{h()}finally{ps(!1)}}}return r.memoizedState=r.baseState=a,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:a},r}function Tp(a,r,h,d){return a.baseState=h,Ap(a,rn,typeof d=="function"?d:Tl)}function bv(a,r,h,d,v){if(Cd(a))throw Error(i(485));if(a=r.action,a!==null){var S={payload:v,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){S.listeners.push(N)}};tt.T!==null?h(!0):S.isTransition=!1,d(S),h=r.pending,h===null?(S.next=r.pending=S,d_(r,S)):(S.next=h.next,r.pending=h.next=S)}}function d_(a,r){var h=r.action,d=r.payload,v=a.state;if(r.isTransition){var S=tt.T,N={};tt.T=N;try{var U=h(v,d),J=tt.S;J!==null&&J(N,U),m_(a,r,U)}catch(ot){bp(a,r,ot)}finally{S!==null&&N.types!==null&&(S.types=N.types),tt.T=S}}else try{S=h(v,d),m_(a,r,S)}catch(ot){bp(a,r,ot)}}function m_(a,r,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(d){p_(a,r,d)},function(d){return bp(a,r,d)}):p_(a,r,h)}function p_(a,r,h){r.status="fulfilled",r.value=h,g_(r),a.state=h,r=a.pending,r!==null&&(h=r.next,h===r?a.pending=null:(h=h.next,r.next=h,d_(a,h)))}function bp(a,r,h){var d=a.pending;if(a.pending=null,d!==null){d=d.next;do r.status="rejected",r.reason=h,g_(r),r=r.next;while(r!==d)}a.action=null}function g_(a){a=a.listeners;for(var r=0;r<a.length;r++)(0,a[r])()}function Cp(a,r){return r}function wp(a,r){if(Ie){var h=ue.formState;if(h!==null){t:{var d=de;if(Ie){if(pn){e:{for(var v=pn,S=ua;v.nodeType!==8;){if(!S){v=null;break e}if(v=$r(v.nextSibling),v===null){v=null;break e}}S=v.data,v=S==="F!"||S==="F"?v:null}if(v){pn=$r(v.nextSibling),d=v.data==="F!";break t}}Ur(d)}d=!1}d&&(r=h[0])}}return h=_i(),h.memoizedState=h.baseState=r,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Cp,lastRenderedState:r},h.queue=d,h=L_.bind(null,de,d),d.dispatch=h,d=Sp(!1),S=Lp.bind(null,de,!1,d.queue),d=_i(),v={state:r,dispatch:null,action:a,pending:null},d.queue=v,h=bv.bind(null,de,v,S,h),v.dispatch=h,d.memoizedState=a,[r,h,!1]}function __(a){var r=ei();return Rp(r,rn,a)}function Rp(a,r,h){if(r=Ap(a,r,Cp)[0],a=Ed(Tl)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var d=rf(r)}catch(N){throw N===Zo?ve:N}else d=r;r=ei();var v=r.queue,S=v.dispatch;return h!==r.memoizedState&&(de.flags|=2048,fo(9,{destroy:void 0},y_.bind(null,v,h),null)),[d,S,a]}function y_(a,r){a.action=r}function xp(a){var r=ei(),h=rn;if(h!==null)return Rp(r,h,a);ei(),r=r.memoizedState,h=ei();var d=h.queue.dispatch;return h.memoizedState=a,[r,d,!1]}function fo(a,r,h,d){return a={tag:a,create:h,deps:d,inst:r,next:null},r=de.updateQueue,r===null&&(r=Ad(),de.updateQueue=r),h=r.lastEffect,h===null?r.lastEffect=a.next=a:(d=h.next,h.next=a,a.next=d,r.lastEffect=a),a}function Sd(){return ei().memoizedState}function Td(a,r,h,d){var v=_i();de.flags|=a,v.memoizedState=fo(1|r,{destroy:void 0},h,d===void 0?null:d)}function bd(a,r,h,d){var v=ei();d=d===void 0?null:d;var S=v.memoizedState.inst;rn!==null&&d!==null&&pp(d,rn.memoizedState.deps)?v.memoizedState=fo(r,S,h,d):(de.flags|=a,v.memoizedState=fo(1|r,S,h,d))}function v_(a,r){Td(8390656,8,a,r)}function Np(a,r){bd(2048,8,a,r)}function A_(a){de.flags|=4;var r=de.updateQueue;if(r===null)r=Ad(),de.updateQueue=r,r.events=[a];else{var h=r.events;h===null?r.events=[a]:h.push(a)}}function E_(a){var r=ei().memoizedState;return A_({ref:r,nextImpl:a}),function(){if((Wt&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function S_(a,r){return bd(4,2,a,r)}function T_(a,r){return bd(4,4,a,r)}function b_(a,r){if(typeof r=="function"){a=a();var h=r(a);return function(){typeof h=="function"?h():r(null)}}if(r!=null)return a=a(),r.current=a,function(){r.current=null}}function C_(a,r,h){h=h!=null?h.concat([a]):null,bd(4,4,b_.bind(null,r,a),h)}function Dp(){}function w_(a,r){var h=ei();r=r===void 0?null:r;var d=h.memoizedState;return r!==null&&pp(r,d[1])?d[0]:(h.memoizedState=[a,r],a)}function R_(a,r){var h=ei();r=r===void 0?null:r;var d=h.memoizedState;if(r!==null&&pp(r,d[1]))return d[0];if(d=a(),su){ps(!0);try{a()}finally{ps(!1)}}return h.memoizedState=[d,r],d}function Ip(a,r,h){return h===void 0||(Rn&1073741824)!==0&&(_e&261930)===0?a.memoizedState=r:(a.memoizedState=h,a=Te(),de.lanes|=a,Wr|=a,h)}function x_(a,r,h,d){return Ss(h,r)?h:Tc.current!==null?(a=Ip(a,h,d),Ss(a,r)||(ci=!0),a):(Rn&42)===0||(Rn&1073741824)!==0&&(_e&261930)===0?(ci=!0,a.memoizedState=h):(a=Te(),de.lanes|=a,Wr|=a,r)}function N_(a,r,h,d,v){var S=At.p;At.p=S!==0&&8>S?S:8;var N=tt.T,U={};tt.T=U,Lp(a,!1,r,h);try{var J=v(),ot=tt.S;if(ot!==null&&ot(U,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var _t=op(J,d);lf(a,r,_t,ga(a))}else lf(a,r,d,ga(a))}catch(Tt){lf(a,r,{then:function(){},status:"rejected",reason:Tt},ga())}finally{At.p=S,N!==null&&U.types!==null&&(N.types=U.types),tt.T=N}}function Cv(){}function Op(a,r,h,d){if(a.tag!==5)throw Error(i(476));var v=D_(a).queue;N_(a,v,r,yt,h===null?Cv:function(){return I_(a),h(d)})}function D_(a){var r=a.memoizedState;if(r!==null)return r;r={memoizedState:yt,baseState:yt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:yt},next:null};var h={};return r.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tl,lastRenderedState:h},next:null},a.memoizedState=r,a=a.alternate,a!==null&&(a.memoizedState=r),r}function I_(a){var r=D_(a);r.next===null&&(r=a.alternate.memoizedState),lf(a,r.next.queue,{},ga())}function Mp(){return ae(eg)}function O_(){return ei().memoizedState}function M_(){return ei().memoizedState}function wv(a){for(var r=a.return;r!==null;){switch(r.tag){case 24:case 3:var h=ga();a=El(h);var d=uo(r,a,h);d!==null&&(Ee(d,r,h),co(d,r,h)),r={cache:ap()},a.payload=r;return}r=r.return}}function Rv(a,r,h){var d=ga();h={lane:d,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Cd(a)?k_(r,h):(h=nd(a,r,h,d),h!==null&&(Ee(h,a,d),P_(h,r,d)))}function L_(a,r,h){var d=ga();lf(a,r,h,d)}function lf(a,r,h,d){var v={lane:d,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Cd(a))k_(r,v);else{var S=a.alternate;if(a.lanes===0&&(S===null||S.lanes===0)&&(S=r.lastRenderedReducer,S!==null))try{var N=r.lastRenderedState,U=S(N,h);if(v.hasEagerState=!0,v.eagerState=U,Ss(U,N))return xi(a,r,v,0),ue===null&&Kh(),!1}catch{}if(h=nd(a,r,v,d),h!==null)return Ee(h,a,d),P_(h,r,d),!0}return!1}function Lp(a,r,h,d){if(d={lane:2,revertLane:dt(),gesture:null,action:d,hasEagerState:!1,eagerState:null,next:null},Cd(a)){if(r)throw Error(i(479))}else r=nd(a,h,d,2),r!==null&&Ee(r,a,2)}function Cd(a){var r=a.alternate;return a===de||r!==null&&r===de}function k_(a,r){bc=Ia=!0;var h=a.pending;h===null?r.next=r:(r.next=h.next,h.next=r),a.pending=r}function P_(a,r,h){if((h&4194048)!==0){var d=r.lanes;d&=a.pendingLanes,h|=d,r.lanes=h,$a(a,h)}}var wc={readContext:ae,use:ho,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useLayoutEffect:jn,useInsertionEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useSyncExternalStore:jn,useId:jn,useHostTransitionStatus:jn,useFormState:jn,useActionState:jn,useOptimistic:jn,useMemoCache:jn,useCacheRefresh:jn};wc.useEffectEvent=jn;var V_={readContext:ae,use:ho,useCallback:function(a,r){return _i().memoizedState=[a,r===void 0?null:r],a},useContext:ae,useEffect:v_,useImperativeHandle:function(a,r,h){h=h!=null?h.concat([a]):null,Td(4194308,4,b_.bind(null,r,a),h)},useLayoutEffect:function(a,r){return Td(4194308,4,a,r)},useInsertionEffect:function(a,r){Td(4,2,a,r)},useMemo:function(a,r){var h=_i();r=r===void 0?null:r;var d=a();if(su){ps(!0);try{a()}finally{ps(!1)}}return h.memoizedState=[d,r],d},useReducer:function(a,r,h){var d=_i();if(h!==void 0){var v=h(r);if(su){ps(!0);try{h(r)}finally{ps(!1)}}}else v=r;return d.memoizedState=d.baseState=v,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:v},d.queue=a,a=a.dispatch=Rv.bind(null,de,a),[d.memoizedState,a]},useRef:function(a){var r=_i();return a={current:a},r.memoizedState=a},useState:function(a){a=Sp(a);var r=a.queue,h=L_.bind(null,de,r);return r.dispatch=h,[a.memoizedState,h]},useDebugValue:Dp,useDeferredValue:function(a,r){var h=_i();return Ip(h,a,r)},useTransition:function(){var a=Sp(!1);return a=N_.bind(null,de,a.queue,!0,!1),_i().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,r,h){var d=de,v=_i();if(Ie){if(h===void 0)throw Error(i(407));h=h()}else{if(h=r(),ue===null)throw Error(i(349));(_e&127)!==0||o_(d,r,h)}v.memoizedState=h;var S={value:h,getSnapshot:r};return v.queue=S,v_(c_.bind(null,d,S,a),[a]),d.flags|=2048,fo(9,{destroy:void 0},u_.bind(null,d,S,h,r),null),h},useId:function(){var a=_i(),r=ue.identifierPrefix;if(Ie){var h=or,d=Bn;h=(d&~(1<<32-ji(d)-1)).toString(32)+h,r="_"+r+"R_"+h,h=yd++,0<h&&(r+="H"+h.toString(32)),r+="_"}else h=mp++,r="_"+r+"r_"+h.toString(32)+"_";return a.memoizedState=r},useHostTransitionStatus:Mp,useFormState:wp,useActionState:wp,useOptimistic:function(a){var r=_i();r.memoizedState=r.baseState=a;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=h,r=Lp.bind(null,de,!0,h),h.dispatch=r,[a,r]},useMemoCache:vp,useCacheRefresh:function(){return _i().memoizedState=wv.bind(null,de)},useEffectEvent:function(a){var r=_i(),h={impl:a};return r.memoizedState=h,function(){if((Wt&2)!==0)throw Error(i(440));return h.impl.apply(void 0,arguments)}}},kp={readContext:ae,use:ho,useCallback:w_,useContext:ae,useEffect:Np,useImperativeHandle:C_,useInsertionEffect:S_,useLayoutEffect:T_,useMemo:R_,useReducer:Ed,useRef:Sd,useState:function(){return Ed(Tl)},useDebugValue:Dp,useDeferredValue:function(a,r){var h=ei();return x_(h,rn.memoizedState,a,r)},useTransition:function(){var a=Ed(Tl)[0],r=ei().memoizedState;return[typeof a=="boolean"?a:rf(a),r]},useSyncExternalStore:l_,useId:O_,useHostTransitionStatus:Mp,useFormState:__,useActionState:__,useOptimistic:function(a,r){var h=ei();return Tp(h,rn,a,r)},useMemoCache:vp,useCacheRefresh:M_};kp.useEffectEvent=E_;var Oa={readContext:ae,use:ho,useCallback:w_,useContext:ae,useEffect:Np,useImperativeHandle:C_,useInsertionEffect:S_,useLayoutEffect:T_,useMemo:R_,useReducer:Ep,useRef:Sd,useState:function(){return Ep(Tl)},useDebugValue:Dp,useDeferredValue:function(a,r){var h=ei();return rn===null?Ip(h,a,r):x_(h,rn.memoizedState,a,r)},useTransition:function(){var a=Ep(Tl)[0],r=ei().memoizedState;return[typeof a=="boolean"?a:rf(a),r]},useSyncExternalStore:l_,useId:O_,useHostTransitionStatus:Mp,useFormState:xp,useActionState:xp,useOptimistic:function(a,r){var h=ei();return rn!==null?Tp(h,rn,a,r):(h.baseState=a,[a,h.queue.dispatch])},useMemoCache:vp,useCacheRefresh:M_};Oa.useEffectEvent=E_;function wd(a,r,h,d){r=a.memoizedState,h=h(d,r),h=h==null?r:E({},r,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var of={enqueueSetState:function(a,r,h){a=a._reactInternals;var d=ga(),v=El(d);v.payload=r,h!=null&&(v.callback=h),r=uo(a,v,d),r!==null&&(Ee(r,a,d),co(r,a,d))},enqueueReplaceState:function(a,r,h){a=a._reactInternals;var d=ga(),v=El(d);v.tag=1,v.payload=r,h!=null&&(v.callback=h),r=uo(a,v,d),r!==null&&(Ee(r,a,d),co(r,a,d))},enqueueForceUpdate:function(a,r){a=a._reactInternals;var h=ga(),d=El(h);d.tag=2,r!=null&&(d.callback=r),r=uo(a,d,h),r!==null&&(Ee(r,a,h),co(r,a,h))}};function Pp(a,r,h,d,v,S,N){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(d,S,N):r.prototype&&r.prototype.isPureReactComponent?!oc(h,d)||!oc(v,S):!0}function Vp(a,r,h,d){a=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(h,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(h,d),r.state!==a&&of.enqueueReplaceState(r,r.state,null)}function mo(a,r){var h=r;if("ref"in r){h={};for(var d in r)d!=="ref"&&(h[d]=r[d])}if(a=a.defaultProps){h===r&&(h=E({},h));for(var v in a)h[v]===void 0&&(h[v]=a[v])}return h}function U_(a){Xh(a)}function Up(a){console.error(a)}function zp(a){Xh(a)}function Rd(a,r){try{var h=a.onUncaughtError;h(r.value,{componentStack:r.stack})}catch(d){setTimeout(function(){throw d})}}function z_(a,r,h){try{var d=a.onCaughtError;d(h.value,{componentStack:h.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function Bp(a,r,h){return h=El(h),h.tag=3,h.payload={element:null},h.callback=function(){Rd(a,r)},h}function jp(a){return a=El(a),a.tag=3,a}function B_(a,r,h,d){var v=h.type.getDerivedStateFromError;if(typeof v=="function"){var S=d.value;a.payload=function(){return v(S)},a.callback=function(){z_(r,h,d)}}var N=h.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(a.callback=function(){z_(r,h,d),typeof v!="function"&&(si===null?si=new Set([this]):si.add(this));var U=d.stack;this.componentDidCatch(d.value,{componentStack:U!==null?U:""})})}function yi(a,r,h,d,v){if(h.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(r=h.alternate,r!==null&&Hr(r,h,v,!0),h=Hs.current,h!==null){switch(h.tag){case 31:case 13:return Cs===null?Mc():h.alternate===null&&Hn===0&&(Hn=3),h.flags&=-257,h.flags|=65536,h.lanes=v,d===dd?h.flags|=16384:(r=h.updateQueue,r===null?h.updateQueue=new Set([d]):r.add(d),Af(a,d,v)),!1;case 22:return h.flags|=65536,d===dd?h.flags|=16384:(r=h.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([d])},h.updateQueue=r):(h=r.retryQueue,h===null?r.retryQueue=new Set([d]):h.add(d)),Af(a,d,v)),!1}throw Error(i(435,h.tag))}return Af(a,d,v),Mc(),!1}if(Ie)return r=Hs.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=v,d!==gc&&(a=Error(i(422),{cause:d}),zr(oa(a,h)))):(d!==gc&&(r=Error(i(423),{cause:d}),zr(oa(r,h))),a=a.current.alternate,a.flags|=65536,v&=-v,a.lanes|=v,d=oa(d,h),v=Bp(a.stateNode,d,v),$t(a,v),Hn!==4&&(Hn=2)),!1;var S=Error(i(520),{cause:d});if(S=oa(S,h),mu===null?mu=[S]:mu.push(S),Hn!==4&&(Hn=2),r===null)return!0;d=oa(d,h),h=r;do{switch(h.tag){case 3:return h.flags|=65536,a=v&-v,h.lanes|=a,a=Bp(h.stateNode,d,a),$t(h,a),!1;case 1:if(r=h.type,S=h.stateNode,(h.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(si===null||!si.has(S))))return h.flags|=65536,v&=-v,h.lanes|=v,v=jp(v),B_(v,a,h,d),$t(h,v),!1}h=h.return}while(h!==null);return!1}var xd=Error(i(461)),ci=!1;function Ni(a,r,h,d){r.child=a===null?gd(r,null,h,d):Al(r,a.child,h,d)}function Hp(a,r,h,d,v){h=h.render;var S=r.ref;if("ref"in d){var N={};for(var U in d)U!=="ref"&&(N[U]=d[U])}else N=d;return lo(r),d=vd(a,r,h,N,S,v),U=gp(),a!==null&&!ci?(_p(a,r,v),ni(a,r,v)):(Ie&&U&&Vr(r),r.flags|=1,Ni(a,r,d,v),r.child)}function lu(a,r,h,d,v){if(a===null){var S=h.type;return typeof S=="function"&&!id(S)&&S.defaultProps===void 0&&h.compare===null?(r.tag=15,r.type=S,Nd(a,r,S,d,v)):(a=kr(h.type,null,d,r,r.mode,v),a.ref=r.ref,a.return=r,r.child=a)}if(S=a.child,!kd(a,v)){var N=S.memoizedProps;if(h=h.compare,h=h!==null?h:oc,h(N,d)&&a.ref===r.ref)return ni(a,r,v)}return r.flags|=1,a=zs(S,d),a.ref=r.ref,a.return=r,r.child=a}function Nd(a,r,h,d,v){if(a!==null){var S=a.memoizedProps;if(oc(S,d)&&a.ref===r.ref)if(ci=!1,r.pendingProps=d=S,kd(a,v))(a.flags&131072)!==0&&(ci=!0);else return r.lanes=a.lanes,ni(a,r,v)}return Rc(a,r,h,d,v)}function ou(a,r,h,d){var v=d.children,S=a!==null?a.memoizedState:null;if(a===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),d.mode==="hidden"){if((r.flags&128)!==0){if(S=S!==null?S.baseLanes|h:h,a!==null){for(d=r.child=a.child,v=0;d!==null;)v=v|d.lanes|d.childLanes,d=d.sibling;d=v&~S}else d=0,r.child=null;return qs(a,r,S,h,d)}if((h&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},a!==null&&Zh(r,S!==null?S.cachePool:null),S!==null?s_(r,S):fp(),a_(r);else return d=r.lanes=536870912,qs(a,r,S!==null?S.baseLanes|h:h,h,d)}else S!==null?(Zh(r,S.cachePool),s_(r,S),Gs(),r.memoizedState=null):(a!==null&&Zh(r,null),fp(),Gs());return Ni(a,r,v,h),r.child}function qr(a,r){return a!==null&&a.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function qs(a,r,h,d,v){var S=fd();return S=S===null?null:{parent:ui._currentValue,pool:S},r.memoizedState={baseLanes:h,cachePool:S},a!==null&&Zh(r,null),fp(),a_(r),a!==null&&Hr(a,r,d,!0),r.childLanes=v,null}function Dd(a,r){return r=Ld({mode:r.mode,children:r.children},a.mode),r.ref=a.ref,a.child=r,r.return=a,r}function j_(a,r,h){return Al(r,a.child,null,h),a=Dd(r,r.pendingProps),a.flags|=2,ti(r),r.memoizedState=null,a}function Id(a,r,h){var d=r.pendingProps,v=(r.flags&128)!==0;if(r.flags&=-129,a===null){if(Ie){if(d.mode==="hidden")return a=Dd(r,d),r.lanes=536870912,qr(null,a);if(dp(r),(a=pn)?(a=d4(a,ua),a=a!==null&&a.data==="&"?a:null,a!==null&&(r.memoizedState={dehydrated:a,treeContext:gl!==null?{id:Bn,overflow:or}:null,retryLane:536870912,hydrationErrors:null},h=dc(a),h.return=r,r.child=h,Xn=r,pn=null)):a=null,a===null)throw Ur(r);return r.lanes=536870912,null}return Dd(r,d)}var S=a.memoizedState;if(S!==null){var N=S.dehydrated;if(dp(r),v)if(r.flags&256)r.flags&=-257,r=j_(a,r,h);else if(r.memoizedState!==null)r.child=a.child,r.flags|=128,r=null;else throw Error(i(558));else if(ci||Hr(a,r,h,!1),v=(h&a.childLanes)!==0,ci||v){if(d=ue,d!==null&&(N=sl(d,h),N!==0&&N!==S.retryLane))throw S.retryLane=N,Ts(a,N),Ee(d,a,N),xd;Mc(),r=j_(a,r,h)}else a=S.treeContext,pn=$r(N.nextSibling),Xn=r,Ie=!0,_l=null,ua=!1,a!==null&&ld(r,a),r=Dd(r,d),r.flags|=4096;return r}return a=zs(a.child,{mode:d.mode,children:d.children}),a.ref=r.ref,r.child=a,a.return=r,a}function uu(a,r){var h=r.ref;if(h===null)a!==null&&a.ref!==null&&(r.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(i(284));(a===null||a.ref!==h)&&(r.flags|=4194816)}}function Rc(a,r,h,d,v){return lo(r),h=vd(a,r,h,d,void 0,v),d=gp(),a!==null&&!ci?(_p(a,r,v),ni(a,r,v)):(Ie&&d&&Vr(r),r.flags|=1,Ni(a,r,h,v),r.child)}function uf(a,r,h,d,v,S){return lo(r),r.updateQueue=null,h=au(r,d,h,v),r_(a),d=gp(),a!==null&&!ci?(_p(a,r,S),ni(a,r,S)):(Ie&&d&&Vr(r),r.flags|=1,Ni(a,r,h,S),r.child)}function Od(a,r,h,d,v){if(lo(r),r.stateNode===null){var S=eo,N=h.contextType;typeof N=="object"&&N!==null&&(S=ae(N)),S=new h(d,S),r.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=of,r.stateNode=S,S._reactInternals=r,S=r.stateNode,S.props=d,S.state=r.memoizedState,S.refs={},ef(r),N=h.contextType,S.context=typeof N=="object"&&N!==null?ae(N):eo,S.state=r.memoizedState,N=h.getDerivedStateFromProps,typeof N=="function"&&(wd(r,h,N,d),S.state=r.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(N=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),N!==S.state&&of.enqueueReplaceState(S,S.state,null),Ec(r,d,S,v),nf(),S.state=r.memoizedState),typeof S.componentDidMount=="function"&&(r.flags|=4194308),d=!0}else if(a===null){S=r.stateNode;var U=r.memoizedProps,J=mo(h,U);S.props=J;var ot=S.context,_t=h.contextType;N=eo,typeof _t=="object"&&_t!==null&&(N=ae(_t));var Tt=h.getDerivedStateFromProps;_t=typeof Tt=="function"||typeof S.getSnapshotBeforeUpdate=="function",U=r.pendingProps!==U,_t||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(U||ot!==N)&&Vp(r,S,d,N),bs=!1;var ct=r.memoizedState;S.state=ct,Ec(r,d,S,v),nf(),ot=r.memoizedState,U||ct!==ot||bs?(typeof Tt=="function"&&(wd(r,h,Tt,d),ot=r.memoizedState),(J=bs||Pp(r,h,J,d,ct,ot,N))?(_t||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=ot),S.props=d,S.state=ot,S.context=N,d=J):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{S=r.stateNode,cp(a,r),N=r.memoizedProps,_t=mo(h,N),S.props=_t,Tt=r.pendingProps,ct=S.context,ot=h.contextType,J=eo,typeof ot=="object"&&ot!==null&&(J=ae(ot)),U=h.getDerivedStateFromProps,(ot=typeof U=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(N!==Tt||ct!==J)&&Vp(r,S,d,J),bs=!1,ct=r.memoizedState,S.state=ct,Ec(r,d,S,v),nf();var gt=r.memoizedState;N!==Tt||ct!==gt||bs||a!==null&&a.dependencies!==null&&Jh(a.dependencies)?(typeof U=="function"&&(wd(r,h,U,d),gt=r.memoizedState),(_t=bs||Pp(r,h,_t,d,ct,gt,J)||a!==null&&a.dependencies!==null&&Jh(a.dependencies))?(ot||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(d,gt,J),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(d,gt,J)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||N===a.memoizedProps&&ct===a.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||N===a.memoizedProps&&ct===a.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=gt),S.props=d,S.state=gt,S.context=J,d=_t):(typeof S.componentDidUpdate!="function"||N===a.memoizedProps&&ct===a.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||N===a.memoizedProps&&ct===a.memoizedState||(r.flags|=1024),d=!1)}return S=d,uu(a,r),d=(r.flags&128)!==0,S||d?(S=r.stateNode,h=d&&typeof h.getDerivedStateFromError!="function"?null:S.render(),r.flags|=1,a!==null&&d?(r.child=Al(r,a.child,null,v),r.child=Al(r,null,h,v)):Ni(a,r,h,v),r.memoizedState=S.state,a=r.child):a=ni(a,r,v),a}function H_(a,r,h,d){return ao(),r.flags|=256,Ni(a,r,h,d),r.child}var Gp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ss(a){return{baseLanes:a,cachePool:up()}}function Md(a,r,h){return a=a!==null?a.childLanes&~h:0,r&&(a|=Ns),a}function G_(a,r,h){var d=r.pendingProps,v=!1,S=(r.flags&128)!==0,N;if((N=S)||(N=a!==null&&a.memoizedState===null?!1:(Oe.current&2)!==0),N&&(v=!0,r.flags&=-129),N=(r.flags&32)!==0,r.flags&=-33,a===null){if(Ie){if(v?Sl(r):Gs(),(a=pn)?(a=d4(a,ua),a=a!==null&&a.data!=="&"?a:null,a!==null&&(r.memoizedState={dehydrated:a,treeContext:gl!==null?{id:Bn,overflow:or}:null,retryLane:536870912,hydrationErrors:null},h=dc(a),h.return=r,r.child=h,Xn=r,pn=null)):a=null,a===null)throw Ur(r);return jv(a)?r.lanes=32:r.lanes=536870912,null}var U=d.children;return d=d.fallback,v?(Gs(),v=r.mode,U=Ld({mode:"hidden",children:U},v),d=no(d,v,h,null),U.return=r,d.return=r,U.sibling=d,r.child=U,d=r.child,d.memoizedState=ss(h),d.childLanes=Md(a,N,h),r.memoizedState=Gp,qr(null,d)):(Sl(r),cf(r,U))}var J=a.memoizedState;if(J!==null&&(U=J.dehydrated,U!==null)){if(S)r.flags&256?(Sl(r),r.flags&=-257,r=qp(a,r,h)):r.memoizedState!==null?(Gs(),r.child=a.child,r.flags|=128,r=null):(Gs(),U=d.fallback,v=r.mode,d=Ld({mode:"visible",children:d.children},v),U=no(U,v,h,null),U.flags|=2,d.return=r,U.return=r,d.sibling=U,r.child=d,Al(r,a.child,null,h),d=r.child,d.memoizedState=ss(h),d.childLanes=Md(a,N,h),r.memoizedState=Gp,r=qr(null,d));else if(Sl(r),jv(U)){if(N=U.nextSibling&&U.nextSibling.dataset,N)var ot=N.dgst;N=ot,d=Error(i(419)),d.stack="",d.digest=N,zr({value:d,source:null,stack:null}),r=qp(a,r,h)}else if(ci||Hr(a,r,h,!1),N=(h&a.childLanes)!==0,ci||N){if(N=ue,N!==null&&(d=sl(N,h),d!==0&&d!==J.retryLane))throw J.retryLane=d,Ts(a,d),Ee(N,a,d),xd;Bv(U)||Mc(),r=qp(a,r,h)}else Bv(U)?(r.flags|=192,r.child=a.child,r=null):(a=J.treeContext,pn=$r(U.nextSibling),Xn=r,Ie=!0,_l=null,ua=!1,a!==null&&ld(r,a),r=cf(r,d.children),r.flags|=4096);return r}return v?(Gs(),U=d.fallback,v=r.mode,J=a.child,ot=J.sibling,d=zs(J,{mode:"hidden",children:d.children}),d.subtreeFlags=J.subtreeFlags&65011712,ot!==null?U=zs(ot,U):(U=no(U,v,h,null),U.flags|=2),U.return=r,d.return=r,d.sibling=U,r.child=d,qr(null,d),d=r.child,U=a.child.memoizedState,U===null?U=ss(h):(v=U.cachePool,v!==null?(J=ui._currentValue,v=v.parent!==J?{parent:J,pool:J}:v):v=up(),U={baseLanes:U.baseLanes|h,cachePool:v}),d.memoizedState=U,d.childLanes=Md(a,N,h),r.memoizedState=Gp,qr(a.child,d)):(Sl(r),h=a.child,a=h.sibling,h=zs(h,{mode:"visible",children:d.children}),h.return=r,h.sibling=null,a!==null&&(N=r.deletions,N===null?(r.deletions=[a],r.flags|=16):N.push(a)),r.child=h,r.memoizedState=null,h)}function cf(a,r){return r=Ld({mode:"visible",children:r},a.mode),r.return=a,a.child=r}function Ld(a,r){return a=zn(22,a,null,r),a.lanes=0,a}function qp(a,r,h){return Al(r,a.child,null,h),a=cf(r,r.pendingProps.children),a.flags|=2,r.memoizedState=null,a}function q_(a,r,h){a.lanes|=r;var d=a.alternate;d!==null&&(d.lanes|=r),ud(a.return,r,h)}function cu(a,r,h,d,v,S){var N=a.memoizedState;N===null?a.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:h,tailMode:v,treeForkCount:S}:(N.isBackwards=r,N.rendering=null,N.renderingStartTime=0,N.last=d,N.tail=h,N.tailMode=v,N.treeForkCount=S)}function Fs(a,r,h){var d=r.pendingProps,v=d.revealOrder,S=d.tail;d=d.children;var N=Oe.current,U=(N&2)!==0;if(U?(N=N&1|2,r.flags|=128):N&=1,bt(Oe,N),Ni(a,r,d,h),d=Ie?pc:0,!U&&a!==null&&(a.flags&128)!==0)t:for(a=r.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&q_(a,h,r);else if(a.tag===19)q_(a,h,r);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break t;for(;a.sibling===null;){if(a.return===null||a.return===r)break t;a=a.return}a.sibling.return=a.return,a=a.sibling}switch(v){case"forwards":for(h=r.child,v=null;h!==null;)a=h.alternate,a!==null&&ha(a)===null&&(v=h),h=h.sibling;h=v,h===null?(v=r.child,r.child=null):(v=h.sibling,h.sibling=null),cu(r,!1,v,h,S,d);break;case"backwards":case"unstable_legacy-backwards":for(h=null,v=r.child,r.child=null;v!==null;){if(a=v.alternate,a!==null&&ha(a)===null){r.child=v;break}a=v.sibling,v.sibling=h,h=v,v=a}cu(r,!0,h,null,S,d);break;case"together":cu(r,!1,null,null,void 0,d);break;default:r.memoizedState=null}return r.child}function ni(a,r,h){if(a!==null&&(r.dependencies=a.dependencies),Wr|=r.lanes,(h&r.childLanes)===0)if(a!==null){if(Hr(a,r,h,!1),(h&r.childLanes)===0)return null}else return null;if(a!==null&&r.child!==a.child)throw Error(i(153));if(r.child!==null){for(a=r.child,h=zs(a,a.pendingProps),r.child=h,h.return=r;a.sibling!==null;)a=a.sibling,h=h.sibling=zs(a,a.pendingProps),h.return=r;h.sibling=null}return r.child}function kd(a,r){return(a.lanes&r)!==0?!0:(a=a.dependencies,!!(a!==null&&Jh(a)))}function xv(a,r,h){switch(r.tag){case 3:qe(r,r.stateNode.containerInfo),yl(r,ui,a.memoizedState.cache),ao();break;case 27:case 5:bi(r);break;case 4:qe(r,r.stateNode.containerInfo);break;case 10:yl(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,dp(r),null;break;case 13:var d=r.memoizedState;if(d!==null)return d.dehydrated!==null?(Sl(r),r.flags|=128,null):(h&r.child.childLanes)!==0?G_(a,r,h):(Sl(r),a=ni(a,r,h),a!==null?a.sibling:null);Sl(r);break;case 19:var v=(a.flags&128)!==0;if(d=(h&r.childLanes)!==0,d||(Hr(a,r,h,!1),d=(h&r.childLanes)!==0),v){if(d)return Fs(a,r,h);r.flags|=128}if(v=r.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),bt(Oe,Oe.current),d)break;return null;case 22:return r.lanes=0,ou(a,r,h,r.pendingProps);case 24:yl(r,ui,a.memoizedState.cache)}return ni(a,r,h)}function Pd(a,r,h){if(a!==null)if(a.memoizedProps!==r.pendingProps)ci=!0;else{if(!kd(a,h)&&(r.flags&128)===0)return ci=!1,xv(a,r,h);ci=(a.flags&131072)!==0}else ci=!1,Ie&&(r.flags&1048576)!==0&&J0(r,pc,r.index);switch(r.lanes=0,r.tag){case 16:t:{var d=r.pendingProps;if(a=$o(r.elementType),r.type=a,typeof a=="function")id(a)?(d=mo(a,d),r.tag=1,r=Od(null,r,a,d,h)):(r.tag=0,r=Rc(null,r,a,d,h));else{if(a!=null){var v=a.$$typeof;if(v===$){r.tag=11,r=Hp(null,r,a,d,h);break t}else if(v===L){r.tag=14,r=lu(null,r,a,d,h);break t}}throw r=Ot(a)||a,Error(i(306,r,""))}}return r;case 0:return Rc(a,r,r.type,r.pendingProps,h);case 1:return d=r.type,v=mo(d,r.pendingProps),Od(a,r,d,v,h);case 3:t:{if(qe(r,r.stateNode.containerInfo),a===null)throw Error(i(387));d=r.pendingProps;var S=r.memoizedState;v=S.element,cp(a,r),Ec(r,d,null,h);var N=r.memoizedState;if(d=N.cache,yl(r,ui,d),d!==S.cache&&cd(r,[ui],h,!0),nf(),d=N.element,S.isDehydrated)if(S={element:d,isDehydrated:!1,cache:N.cache},r.updateQueue.baseState=S,r.memoizedState=S,r.flags&256){r=H_(a,r,d,h);break t}else if(d!==v){v=oa(Error(i(424)),r),zr(v),r=H_(a,r,d,h);break t}else for(a=r.stateNode.containerInfo,a.nodeType===9?a=a.body:a=a.nodeName==="HTML"?a.ownerDocument.body:a,pn=$r(a.firstChild),Xn=r,Ie=!0,_l=null,ua=!0,h=gd(r,null,d,h),r.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ao(),d===v){r=ni(a,r,h);break t}Ni(a,r,d,h)}r=r.child}return r;case 26:return uu(a,r),a===null?(h=v4(r.type,null,r.pendingProps,null))?r.memoizedState=h:Ie||(h=r.type,a=r.pendingProps,d=X_(re.current).createElement(h),d[vn]=r,d[mi]=a,Is(d,h,a),Un(d),r.stateNode=d):r.memoizedState=v4(r.type,a.memoizedProps,r.pendingProps,a.memoizedState),null;case 27:return bi(r),a===null&&Ie&&(d=r.stateNode=g4(r.type,r.pendingProps,re.current),Xn=r,ua=!0,v=pn,Vc(r.type)?(Hv=v,pn=$r(d.firstChild)):pn=v),Ni(a,r,r.pendingProps.children,h),uu(a,r),a===null&&(r.flags|=4194304),r.child;case 5:return a===null&&Ie&&((v=d=pn)&&(d=xw(d,r.type,r.pendingProps,ua),d!==null?(r.stateNode=d,Xn=r,pn=$r(d.firstChild),ua=!1,v=!0):v=!1),v||Ur(r)),bi(r),v=r.type,S=r.pendingProps,N=a!==null?a.memoizedProps:null,d=S.children,Vv(v,S)?d=null:N!==null&&Vv(v,N)&&(r.flags|=32),r.memoizedState!==null&&(v=vd(a,r,ru,null,null,h),eg._currentValue=v),uu(a,r),Ni(a,r,d,h),r.child;case 6:return a===null&&Ie&&((a=h=pn)&&(h=Nw(h,r.pendingProps,ua),h!==null?(r.stateNode=h,Xn=r,pn=null,a=!0):a=!1),a||Ur(r)),null;case 13:return G_(a,r,h);case 4:return qe(r,r.stateNode.containerInfo),d=r.pendingProps,a===null?r.child=Al(r,null,d,h):Ni(a,r,d,h),r.child;case 11:return Hp(a,r,r.type,r.pendingProps,h);case 7:return Ni(a,r,r.pendingProps,h),r.child;case 8:return Ni(a,r,r.pendingProps.children,h),r.child;case 12:return Ni(a,r,r.pendingProps.children,h),r.child;case 10:return d=r.pendingProps,yl(r,r.type,d.value),Ni(a,r,d.children,h),r.child;case 9:return v=r.type._context,d=r.pendingProps.children,lo(r),v=ae(v),d=d(v),r.flags|=1,Ni(a,r,d,h),r.child;case 14:return lu(a,r,r.type,r.pendingProps,h);case 15:return Nd(a,r,r.type,r.pendingProps,h);case 19:return Fs(a,r,h);case 31:return Id(a,r,h);case 22:return ou(a,r,h,r.pendingProps);case 24:return lo(r),d=ae(ui),a===null?(v=fd(),v===null&&(v=ue,S=ap(),v.pooledCache=S,S.refCount++,S!==null&&(v.pooledCacheLanes|=h),v=S),r.memoizedState={parent:d,cache:v},ef(r),yl(r,ui,v)):((a.lanes&h)!==0&&(cp(a,r),Ec(r,null,null,h),nf()),v=a.memoizedState,S=r.memoizedState,v.parent!==d?(v={parent:d,cache:d},r.memoizedState=v,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=v),yl(r,ui,d)):(d=S.cache,yl(r,ui,d),d!==v.cache&&cd(r,[ui],h,!0))),Ni(a,r,r.pendingProps.children,h),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function Fr(a){a.flags|=4}function hf(a,r,h,d,v){if((r=(a.mode&32)!==0)&&(r=!1),r){if(a.flags|=16777216,(v&335544128)===v)if(a.stateNode.complete)a.flags|=8192;else if(qn())a.flags|=8192;else throw Gr=dd,$h}else a.flags&=-16777217}function Fp(a,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!b4(r))if(qn())a.flags|=8192;else throw Gr=dd,$h}function bl(a,r){r!==null&&(a.flags|=4),a.flags&16384&&(r=a.tag!==22?Xe():536870912,a.lanes|=r,En|=r)}function Yr(a,r){if(!Ie)switch(a.tailMode){case"hidden":r=a.tail;for(var h=null;r!==null;)r.alternate!==null&&(h=r),r=r.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var d=null;h!==null;)h.alternate!==null&&(d=h),h=h.sibling;d===null?r||a.tail===null?a.tail=null:a.tail.sibling=null:d.sibling=null}}function ln(a){var r=a.alternate!==null&&a.alternate.child===a.child,h=0,d=0;if(r)for(var v=a.child;v!==null;)h|=v.lanes|v.childLanes,d|=v.subtreeFlags&65011712,d|=v.flags&65011712,v.return=a,v=v.sibling;else for(v=a.child;v!==null;)h|=v.lanes|v.childLanes,d|=v.subtreeFlags,d|=v.flags,v.return=a,v=v.sibling;return a.subtreeFlags|=d,a.childLanes=h,r}function ff(a,r,h){var d=r.pendingProps;switch(rd(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ln(r),null;case 1:return ln(r),null;case 3:return h=r.stateNode,d=null,a!==null&&(d=a.memoizedState.cache),r.memoizedState.cache!==d&&(r.flags|=2048),jr(ui),De(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(_c(r)?Fr(r):a===null||a.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,od())),ln(r),null;case 26:var v=r.type,S=r.memoizedState;return a===null?(Fr(r),S!==null?(ln(r),Fp(r,S)):(ln(r),hf(r,v,null,d,h))):S?S!==a.memoizedState?(Fr(r),ln(r),Fp(r,S)):(ln(r),r.flags&=-16777217):(a=a.memoizedProps,a!==d&&Fr(r),ln(r),hf(r,v,a,d,h)),null;case 27:if(ea(r),h=re.current,v=r.type,a!==null&&r.stateNode!=null)a.memoizedProps!==d&&Fr(r);else{if(!d){if(r.stateNode===null)throw Error(i(166));return ln(r),null}a=Ft.current,_c(r)?Z0(r):(a=g4(v,d,h),r.stateNode=a,Fr(r))}return ln(r),null;case 5:if(ea(r),v=r.type,a!==null&&r.stateNode!=null)a.memoizedProps!==d&&Fr(r);else{if(!d){if(r.stateNode===null)throw Error(i(166));return ln(r),null}if(S=Ft.current,_c(r))Z0(r);else{var N=X_(re.current);switch(S){case 1:S=N.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:S=N.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":S=N.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":S=N.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":S=N.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof d.is=="string"?N.createElement("select",{is:d.is}):N.createElement("select"),d.multiple?S.multiple=!0:d.size&&(S.size=d.size);break;default:S=typeof d.is=="string"?N.createElement(v,{is:d.is}):N.createElement(v)}}S[vn]=r,S[mi]=d;t:for(N=r.child;N!==null;){if(N.tag===5||N.tag===6)S.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===r)break t;for(;N.sibling===null;){if(N.return===null||N.return===r)break t;N=N.return}N.sibling.return=N.return,N=N.sibling}r.stateNode=S;t:switch(Is(S,v,d),v){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break t;case"img":d=!0;break t;default:d=!1}d&&Fr(r)}}return ln(r),hf(r,r.type,a===null?null:a.memoizedProps,r.pendingProps,h),null;case 6:if(a&&r.stateNode!=null)a.memoizedProps!==d&&Fr(r);else{if(typeof d!="string"&&r.stateNode===null)throw Error(i(166));if(a=re.current,_c(r)){if(a=r.stateNode,h=r.memoizedProps,d=null,v=Xn,v!==null)switch(v.tag){case 27:case 5:d=v.memoizedProps}a[vn]=r,a=!!(a.nodeValue===h||d!==null&&d.suppressHydrationWarning===!0||a4(a.nodeValue,h)),a||Ur(r,!0)}else a=X_(a).createTextNode(d),a[vn]=r,r.stateNode=a}return ln(r),null;case 31:if(h=r.memoizedState,a===null||a.memoizedState!==null){if(d=_c(r),h!==null){if(a===null){if(!d)throw Error(i(318));if(a=r.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(i(557));a[vn]=r}else ao(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ln(r),a=!1}else h=od(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=h),a=!0;if(!a)return r.flags&256?(ti(r),r):(ti(r),null);if((r.flags&128)!==0)throw Error(i(558))}return ln(r),null;case 13:if(d=r.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(v=_c(r),d!==null&&d.dehydrated!==null){if(a===null){if(!v)throw Error(i(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[vn]=r}else ao(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;ln(r),v=!1}else v=od(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=v),v=!0;if(!v)return r.flags&256?(ti(r),r):(ti(r),null)}return ti(r),(r.flags&128)!==0?(r.lanes=h,r):(h=d!==null,a=a!==null&&a.memoizedState!==null,h&&(d=r.child,v=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(v=d.alternate.memoizedState.cachePool.pool),S=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(S=d.memoizedState.cachePool.pool),S!==v&&(d.flags|=2048)),h!==a&&h&&(r.child.flags|=8192),bl(r,r.updateQueue),ln(r),null);case 4:return De(),a===null&&Ov(r.stateNode.containerInfo),ln(r),null;case 10:return jr(r.type),ln(r),null;case 19:if(ft(Oe),d=r.memoizedState,d===null)return ln(r),null;if(v=(r.flags&128)!==0,S=d.rendering,S===null)if(v)Yr(d,!1);else{if(Hn!==0||a!==null&&(a.flags&128)!==0)for(a=r.child;a!==null;){if(S=ha(a),S!==null){for(r.flags|=128,Yr(d,!1),a=S.updateQueue,r.updateQueue=a,bl(r,a),r.subtreeFlags=0,a=h,h=r.child;h!==null;)fc(h,a),h=h.sibling;return bt(Oe,Oe.current&1|2),Ie&&Pr(r,d.treeForkCount),r.child}a=a.sibling}d.tail!==null&&Qn()>ii&&(r.flags|=128,v=!0,Yr(d,!1),r.lanes=4194304)}else{if(!v)if(a=ha(S),a!==null){if(r.flags|=128,v=!0,a=a.updateQueue,r.updateQueue=a,bl(r,a),Yr(d,!0),d.tail===null&&d.tailMode==="hidden"&&!S.alternate&&!Ie)return ln(r),null}else 2*Qn()-d.renderingStartTime>ii&&h!==536870912&&(r.flags|=128,v=!0,Yr(d,!1),r.lanes=4194304);d.isBackwards?(S.sibling=r.child,r.child=S):(a=d.last,a!==null?a.sibling=S:r.child=S,d.last=S)}return d.tail!==null?(a=d.tail,d.rendering=a,d.tail=a.sibling,d.renderingStartTime=Qn(),a.sibling=null,h=Oe.current,bt(Oe,v?h&1|2:h&1),Ie&&Pr(r,d.treeForkCount),a):(ln(r),null);case 22:case 23:return ti(r),sf(),d=r.memoizedState!==null,a!==null?a.memoizedState!==null!==d&&(r.flags|=8192):d&&(r.flags|=8192),d?(h&536870912)!==0&&(r.flags&128)===0&&(ln(r),r.subtreeFlags&6&&(r.flags|=8192)):ln(r),h=r.updateQueue,h!==null&&bl(r,h.retryQueue),h=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),d=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(d=r.memoizedState.cachePool.pool),d!==h&&(r.flags|=2048),a!==null&&ft(oo),null;case 24:return h=null,a!==null&&(h=a.memoizedState.cache),r.memoizedState.cache!==h&&(r.flags|=2048),jr(ui),ln(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function Ma(a,r){switch(rd(r),r.tag){case 1:return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 3:return jr(ui),De(),a=r.flags,(a&65536)!==0&&(a&128)===0?(r.flags=a&-65537|128,r):null;case 26:case 27:case 5:return ea(r),null;case 31:if(r.memoizedState!==null){if(ti(r),r.alternate===null)throw Error(i(340));ao()}return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 13:if(ti(r),a=r.memoizedState,a!==null&&a.dehydrated!==null){if(r.alternate===null)throw Error(i(340));ao()}return a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 19:return ft(Oe),null;case 4:return De(),null;case 10:return jr(r.type),null;case 22:case 23:return ti(r),sf(),a!==null&&ft(oo),a=r.flags,a&65536?(r.flags=a&-65537|128,r):null;case 24:return jr(ui),null;case 25:return null;default:return null}}function fa(a,r){switch(rd(r),r.tag){case 3:jr(ui),De();break;case 26:case 27:case 5:ea(r);break;case 4:De();break;case 31:r.memoizedState!==null&&ti(r);break;case 13:ti(r);break;case 19:ft(Oe);break;case 10:jr(r.type);break;case 22:case 23:ti(r),sf(),a!==null&&ft(oo);break;case 24:jr(ui)}}function La(a,r){try{var h=r.updateQueue,d=h!==null?h.lastEffect:null;if(d!==null){var v=d.next;h=v;do{if((h.tag&a)===a){d=void 0;var S=h.create,N=h.inst;d=S(),N.destroy=d}h=h.next}while(h!==v)}}catch(U){Ge(r,r.return,U)}}function Fi(a,r,h){try{var d=r.updateQueue,v=d!==null?d.lastEffect:null;if(v!==null){var S=v.next;d=S;do{if((d.tag&a)===a){var N=d.inst,U=N.destroy;if(U!==void 0){N.destroy=void 0,v=r;var J=h,ot=U;try{ot()}catch(_t){Ge(v,J,_t)}}}d=d.next}while(d!==S)}}catch(_t){Ge(r,r.return,_t)}}function ur(a){var r=a.updateQueue;if(r!==null){var h=a.stateNode;try{i_(r,h)}catch(d){Ge(a,a.return,d)}}}function Di(a,r,h){h.props=mo(a.type,a.memoizedProps),h.state=a.memoizedState;try{h.componentWillUnmount()}catch(d){Ge(a,r,d)}}function Cl(a,r){try{var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var d=a.stateNode;break;case 30:d=a.stateNode;break;default:d=a.stateNode}typeof h=="function"?a.refCleanup=h(d):h.current=d}}catch(v){Ge(a,r,v)}}function Yi(a,r){var h=a.ref,d=a.refCleanup;if(h!==null)if(typeof d=="function")try{d()}catch(v){Ge(a,r,v)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(v){Ge(a,r,v)}else h.current=null}function df(a){var r=a.type,h=a.memoizedProps,d=a.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":h.autoFocus&&d.focus();break t;case"img":h.src?d.src=h.src:h.srcSet&&(d.srcset=h.srcSet)}}catch(v){Ge(a,a.return,v)}}function vi(a,r,h){try{var d=a.stateNode;Sw(d,a.type,h,r),d[mi]=r}catch(v){Ge(a,a.return,v)}}function xn(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Vc(a.type)||a.tag===4}function we(a){t:for(;;){for(;a.sibling===null;){if(a.return===null||xn(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Vc(a.type)||a.flags&2||a.child===null||a.tag===4)continue t;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Qr(a,r,h){var d=a.tag;if(d===5||d===6)a=a.stateNode,r?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(a,r):(r=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,r.appendChild(a),h=h._reactRootContainer,h!=null||r.onclick!==null||(r.onclick=Ci));else if(d!==4&&(d===27&&Vc(a.type)&&(h=a.stateNode,r=null),a=a.child,a!==null))for(Qr(a,r,h),a=a.sibling;a!==null;)Qr(a,r,h),a=a.sibling}function ws(a,r,h){var d=a.tag;if(d===5||d===6)a=a.stateNode,r?h.insertBefore(a,r):h.appendChild(a);else if(d!==4&&(d===27&&Vc(a.type)&&(h=a.stateNode),a=a.child,a!==null))for(ws(a,r,h),a=a.sibling;a!==null;)ws(a,r,h),a=a.sibling}function Vd(a){var r=a.stateNode,h=a.memoizedProps;try{for(var d=a.type,v=r.attributes;v.length;)r.removeAttributeNode(v[0]);Is(r,d,h),r[vn]=a,r[mi]=h}catch(S){Ge(a,a.return,S)}}var ka=!1,gn=!1,cr=!1,F_=typeof WeakSet=="function"?WeakSet:Set,Ii=null;function Nv(a,r){if(a=a.containerInfo,kv=ey,a=Q0(a),tp(a)){if("selectionStart"in a)var h={start:a.selectionStart,end:a.selectionEnd};else t:{h=(h=a.ownerDocument)&&h.defaultView||window;var d=h.getSelection&&h.getSelection();if(d&&d.rangeCount!==0){h=d.anchorNode;var v=d.anchorOffset,S=d.focusNode;d=d.focusOffset;try{h.nodeType,S.nodeType}catch{h=null;break t}var N=0,U=-1,J=-1,ot=0,_t=0,Tt=a,ct=null;e:for(;;){for(var gt;Tt!==h||v!==0&&Tt.nodeType!==3||(U=N+v),Tt!==S||d!==0&&Tt.nodeType!==3||(J=N+d),Tt.nodeType===3&&(N+=Tt.nodeValue.length),(gt=Tt.firstChild)!==null;)ct=Tt,Tt=gt;for(;;){if(Tt===a)break e;if(ct===h&&++ot===v&&(U=N),ct===S&&++_t===d&&(J=N),(gt=Tt.nextSibling)!==null)break;Tt=ct,ct=Tt.parentNode}Tt=gt}h=U===-1||J===-1?null:{start:U,end:J}}else h=null}h=h||{start:0,end:0}}else h=null;for(Pv={focusedElem:a,selectionRange:h},ey=!1,Ii=r;Ii!==null;)if(r=Ii,a=r.child,(r.subtreeFlags&1028)!==0&&a!==null)a.return=r,Ii=a;else for(;Ii!==null;){switch(r=Ii,S=r.alternate,a=r.flags,r.tag){case 0:if((a&4)!==0&&(a=r.updateQueue,a=a!==null?a.events:null,a!==null))for(h=0;h<a.length;h++)v=a[h],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((a&1024)!==0&&S!==null){a=void 0,h=r,v=S.memoizedProps,S=S.memoizedState,d=h.stateNode;try{var Xt=mo(h.type,v);a=d.getSnapshotBeforeUpdate(Xt,S),d.__reactInternalSnapshotBeforeUpdate=a}catch(se){Ge(h,h.return,se)}}break;case 3:if((a&1024)!==0){if(a=r.stateNode.containerInfo,h=a.nodeType,h===9)zv(a);else if(h===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":zv(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(i(163))}if(a=r.sibling,a!==null){a.return=r.return,Ii=a;break}Ii=r.return}}function Nn(a,r,h){var d=h.flags;switch(h.tag){case 0:case 11:case 15:Ua(a,h),d&4&&La(5,h);break;case 1:if(Ua(a,h),d&4)if(a=h.stateNode,r===null)try{a.componentDidMount()}catch(N){Ge(h,h.return,N)}else{var v=mo(h.type,r.memoizedProps);r=r.memoizedState;try{a.componentDidUpdate(v,r,a.__reactInternalSnapshotBeforeUpdate)}catch(N){Ge(h,h.return,N)}}d&64&&ur(h),d&512&&Cl(h,h.return);break;case 3:if(Ua(a,h),d&64&&(a=h.updateQueue,a!==null)){if(r=null,h.child!==null)switch(h.child.tag){case 27:case 5:r=h.child.stateNode;break;case 1:r=h.child.stateNode}try{i_(a,r)}catch(N){Ge(h,h.return,N)}}break;case 27:r===null&&d&4&&Vd(h);case 26:case 5:Ua(a,h),r===null&&d&4&&df(h),d&512&&Cl(h,h.return);break;case 12:Ua(a,h);break;case 31:Ua(a,h),d&4&&po(a,h);break;case 13:Ua(a,h),d&4&&xc(a,h),d&64&&(a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(h=p.bind(null,h),Dw(a,h))));break;case 22:if(d=h.memoizedState!==null||ka,!d){r=r!==null&&r.memoizedState!==null||gn,v=ka;var S=gn;ka=d,(gn=r)&&!S?Rs(a,h,(h.subtreeFlags&8772)!==0):Ua(a,h),ka=v,gn=S}break;case 30:break;default:Ua(a,h)}}function mf(a){var r=a.alternate;r!==null&&(a.alternate=null,mf(r)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(r=a.stateNode,r!==null&&nr(r)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var $e=null,as=!1;function Pa(a,r,h){for(h=h.child;h!==null;)Ud(a,r,h),h=h.sibling}function Ud(a,r,h){if(di&&typeof di.onCommitFiberUnmount=="function")try{di.onCommitFiberUnmount(Ja,h)}catch{}switch(h.tag){case 26:gn||Yi(h,r),Pa(a,r,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:gn||Yi(h,r);var d=$e,v=as;Vc(h.type)&&($e=h.stateNode,as=!1),Pa(a,r,h),Zp(h.stateNode),$e=d,as=v;break;case 5:gn||Yi(h,r);case 6:if(d=$e,v=as,$e=null,Pa(a,r,h),$e=d,as=v,$e!==null)if(as)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(h.stateNode)}catch(S){Ge(h,r,S)}else try{$e.removeChild(h.stateNode)}catch(S){Ge(h,r,S)}break;case 18:$e!==null&&(as?(a=$e,h4(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,h.stateNode),Yd(a)):h4($e,h.stateNode));break;case 4:d=$e,v=as,$e=h.stateNode.containerInfo,as=!0,Pa(a,r,h),$e=d,as=v;break;case 0:case 11:case 14:case 15:Fi(2,h,r),gn||Fi(4,h,r),Pa(a,r,h);break;case 1:gn||(Yi(h,r),d=h.stateNode,typeof d.componentWillUnmount=="function"&&Di(h,r,d)),Pa(a,r,h);break;case 21:Pa(a,r,h);break;case 22:gn=(d=gn)||h.memoizedState!==null,Pa(a,r,h),gn=d;break;default:Pa(a,r,h)}}function po(a,r){if(r.memoizedState===null&&(a=r.alternate,a!==null&&(a=a.memoizedState,a!==null))){a=a.dehydrated;try{Yd(a)}catch(h){Ge(r,r.return,h)}}}function xc(a,r){if(r.memoizedState===null&&(a=r.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Yd(a)}catch(h){Ge(r,r.return,h)}}function Yp(a){switch(a.tag){case 31:case 13:case 19:var r=a.stateNode;return r===null&&(r=a.stateNode=new F_),r;case 22:return a=a.stateNode,r=a._retryCache,r===null&&(r=a._retryCache=new F_),r;default:throw Error(i(435,a.tag))}}function wl(a,r){var h=Yp(a);r.forEach(function(d){if(!h.has(d)){h.add(d);var v=y.bind(null,a,d);d.then(v,v)}})}function Ai(a,r){var h=r.deletions;if(h!==null)for(var d=0;d<h.length;d++){var v=h[d],S=a,N=r,U=N;t:for(;U!==null;){switch(U.tag){case 27:if(Vc(U.type)){$e=U.stateNode,as=!1;break t}break;case 5:$e=U.stateNode,as=!1;break t;case 3:case 4:$e=U.stateNode.containerInfo,as=!0;break t}U=U.return}if($e===null)throw Error(i(160));Ud(S,N,v),$e=null,as=!1,S=v.alternate,S!==null&&(S.return=null),v.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)go(r,a),r=r.sibling}var Va=null;function go(a,r){var h=a.alternate,d=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Ai(r,a),Ei(a),d&4&&(Fi(3,a,a.return),La(3,a),Fi(5,a,a.return));break;case 1:Ai(r,a),Ei(a),d&512&&(gn||h===null||Yi(h,h.return)),d&64&&ka&&(a=a.updateQueue,a!==null&&(d=a.callbacks,d!==null&&(h=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=h===null?d:h.concat(d))));break;case 26:var v=Va;if(Ai(r,a),Ei(a),d&512&&(gn||h===null||Yi(h,h.return)),d&4){var S=h!==null?h.memoizedState:null;if(d=a.memoizedState,h===null)if(d===null)if(a.stateNode===null){t:{d=a.type,h=a.memoizedProps,v=v.ownerDocument||v;e:switch(d){case"title":S=v.getElementsByTagName("title")[0],(!S||S[na]||S[vn]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=v.createElement(d),v.head.insertBefore(S,v.querySelector("head > title"))),Is(S,d,h),S[vn]=a,Un(S),d=S;break t;case"link":var N=S4("link","href",v).get(d+(h.href||""));if(N){for(var U=0;U<N.length;U++)if(S=N[U],S.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&S.getAttribute("rel")===(h.rel==null?null:h.rel)&&S.getAttribute("title")===(h.title==null?null:h.title)&&S.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){N.splice(U,1);break e}}S=v.createElement(d),Is(S,d,h),v.head.appendChild(S);break;case"meta":if(N=S4("meta","content",v).get(d+(h.content||""))){for(U=0;U<N.length;U++)if(S=N[U],S.getAttribute("content")===(h.content==null?null:""+h.content)&&S.getAttribute("name")===(h.name==null?null:h.name)&&S.getAttribute("property")===(h.property==null?null:h.property)&&S.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&S.getAttribute("charset")===(h.charSet==null?null:h.charSet)){N.splice(U,1);break e}}S=v.createElement(d),Is(S,d,h),v.head.appendChild(S);break;default:throw Error(i(468,d))}S[vn]=a,Un(S),d=S}a.stateNode=d}else T4(v,a.type,a.stateNode);else a.stateNode=E4(v,d,a.memoizedProps);else S!==d?(S===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):S.count--,d===null?T4(v,a.type,a.stateNode):E4(v,d,a.memoizedProps)):d===null&&a.stateNode!==null&&vi(a,a.memoizedProps,h.memoizedProps)}break;case 27:Ai(r,a),Ei(a),d&512&&(gn||h===null||Yi(h,h.return)),h!==null&&d&4&&vi(a,a.memoizedProps,h.memoizedProps);break;case 5:if(Ai(r,a),Ei(a),d&512&&(gn||h===null||Yi(h,h.return)),a.flags&32){v=a.stateNode;try{ra(v,"")}catch(Xt){Ge(a,a.return,Xt)}}d&4&&a.stateNode!=null&&(v=a.memoizedProps,vi(a,v,h!==null?h.memoizedProps:v)),d&1024&&(cr=!0);break;case 6:if(Ai(r,a),Ei(a),d&4){if(a.stateNode===null)throw Error(i(162));d=a.memoizedProps,h=a.stateNode;try{h.nodeValue=d}catch(Xt){Ge(a,a.return,Xt)}}break;case 3:if(J_=null,v=Va,Va=K_(r.containerInfo),Ai(r,a),Va=v,Ei(a),d&4&&h!==null&&h.memoizedState.isDehydrated)try{Yd(r.containerInfo)}catch(Xt){Ge(a,a.return,Xt)}cr&&(cr=!1,zd(a));break;case 4:d=Va,Va=K_(a.stateNode.containerInfo),Ai(r,a),Ei(a),Va=d;break;case 12:Ai(r,a),Ei(a);break;case 31:Ai(r,a),Ei(a),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,wl(a,d)));break;case 13:Ai(r,a),Ei(a),a.child.flags&8192&&a.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Nc=Qn()),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,wl(a,d)));break;case 22:v=a.memoizedState!==null;var J=h!==null&&h.memoizedState!==null,ot=ka,_t=gn;if(ka=ot||v,gn=_t||J,Ai(r,a),gn=_t,ka=ot,Ei(a),d&8192)t:for(r=a.stateNode,r._visibility=v?r._visibility&-2:r._visibility|1,v&&(h===null||J||ka||gn||Xr(a)),h=null,r=a;;){if(r.tag===5||r.tag===26){if(h===null){J=h=r;try{if(S=J.stateNode,v)N=S.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{U=J.stateNode;var Tt=J.memoizedProps.style,ct=Tt!=null&&Tt.hasOwnProperty("display")?Tt.display:null;U.style.display=ct==null||typeof ct=="boolean"?"":(""+ct).trim()}}catch(Xt){Ge(J,J.return,Xt)}}}else if(r.tag===6){if(h===null){J=r;try{J.stateNode.nodeValue=v?"":J.memoizedProps}catch(Xt){Ge(J,J.return,Xt)}}}else if(r.tag===18){if(h===null){J=r;try{var gt=J.stateNode;v?f4(gt,!0):f4(J.stateNode,!1)}catch(Xt){Ge(J,J.return,Xt)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===a)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break t;for(;r.sibling===null;){if(r.return===null||r.return===a)break t;h===r&&(h=null),r=r.return}h===r&&(h=null),r.sibling.return=r.return,r=r.sibling}d&4&&(d=a.updateQueue,d!==null&&(h=d.retryQueue,h!==null&&(d.retryQueue=null,wl(a,h))));break;case 19:Ai(r,a),Ei(a),d&4&&(d=a.updateQueue,d!==null&&(a.updateQueue=null,wl(a,d)));break;case 30:break;case 21:break;default:Ai(r,a),Ei(a)}}function Ei(a){var r=a.flags;if(r&2){try{for(var h,d=a.return;d!==null;){if(xn(d)){h=d;break}d=d.return}if(h==null)throw Error(i(160));switch(h.tag){case 27:var v=h.stateNode,S=we(a);ws(a,S,v);break;case 5:var N=h.stateNode;h.flags&32&&(ra(N,""),h.flags&=-33);var U=we(a);ws(a,U,N);break;case 3:case 4:var J=h.stateNode.containerInfo,ot=we(a);Qr(a,ot,J);break;default:throw Error(i(161))}}catch(_t){Ge(a,a.return,_t)}a.flags&=-3}r&4096&&(a.flags&=-4097)}function zd(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var r=a;zd(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),a=a.sibling}}function Ua(a,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)Nn(a,r.alternate,r),r=r.sibling}function Xr(a){for(a=a.child;a!==null;){var r=a;switch(r.tag){case 0:case 11:case 14:case 15:Fi(4,r,r.return),Xr(r);break;case 1:Yi(r,r.return);var h=r.stateNode;typeof h.componentWillUnmount=="function"&&Di(r,r.return,h),Xr(r);break;case 27:Zp(r.stateNode);case 26:case 5:Yi(r,r.return),Xr(r);break;case 22:r.memoizedState===null&&Xr(r);break;case 30:Xr(r);break;default:Xr(r)}a=a.sibling}}function Rs(a,r,h){for(h=h&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var d=r.alternate,v=a,S=r,N=S.flags;switch(S.tag){case 0:case 11:case 15:Rs(v,S,h),La(4,S);break;case 1:if(Rs(v,S,h),d=S,v=d.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(ot){Ge(d,d.return,ot)}if(d=S,v=d.updateQueue,v!==null){var U=d.stateNode;try{var J=v.shared.hiddenCallbacks;if(J!==null)for(v.shared.hiddenCallbacks=null,v=0;v<J.length;v++)Sc(J[v],U)}catch(ot){Ge(d,d.return,ot)}}h&&N&64&&ur(S),Cl(S,S.return);break;case 27:Vd(S);case 26:case 5:Rs(v,S,h),h&&d===null&&N&4&&df(S),Cl(S,S.return);break;case 12:Rs(v,S,h);break;case 31:Rs(v,S,h),h&&N&4&&po(v,S);break;case 13:Rs(v,S,h),h&&N&4&&xc(v,S);break;case 22:S.memoizedState===null&&Rs(v,S,h),Cl(S,S.return);break;case 30:break;default:Rs(v,S,h)}r=r.sibling}}function _o(a,r){var h=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),a=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(a=r.memoizedState.cachePool.pool),a!==h&&(a!=null&&a.refCount++,h!=null&&Jo(h))}function hu(a,r){a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&Jo(a))}function Qi(a,r,h,d){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Qp(a,r,h,d),r=r.sibling}function Qp(a,r,h,d){var v=r.flags;switch(r.tag){case 0:case 11:case 15:Qi(a,r,h,d),v&2048&&La(9,r);break;case 1:Qi(a,r,h,d);break;case 3:Qi(a,r,h,d),v&2048&&(a=null,r.alternate!==null&&(a=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==a&&(r.refCount++,a!=null&&Jo(a)));break;case 12:if(v&2048){Qi(a,r,h,d),a=r.stateNode;try{var S=r.memoizedProps,N=S.id,U=S.onPostCommit;typeof U=="function"&&U(N,r.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(J){Ge(r,r.return,J)}}else Qi(a,r,h,d);break;case 31:Qi(a,r,h,d);break;case 13:Qi(a,r,h,d);break;case 23:break;case 22:S=r.stateNode,N=r.alternate,r.memoizedState!==null?S._visibility&2?Qi(a,r,h,d):Kr(a,r):S._visibility&2?Qi(a,r,h,d):(S._visibility|=2,Xi(a,r,h,d,(r.subtreeFlags&10256)!==0||!1)),v&2048&&_o(N,r);break;case 24:Qi(a,r,h,d),v&2048&&hu(r.alternate,r);break;default:Qi(a,r,h,d)}}function Xi(a,r,h,d,v){for(v=v&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var S=a,N=r,U=h,J=d,ot=N.flags;switch(N.tag){case 0:case 11:case 15:Xi(S,N,U,J,v),La(8,N);break;case 23:break;case 22:var _t=N.stateNode;N.memoizedState!==null?_t._visibility&2?Xi(S,N,U,J,v):Kr(S,N):(_t._visibility|=2,Xi(S,N,U,J,v)),v&&ot&2048&&_o(N.alternate,N);break;case 24:Xi(S,N,U,J,v),v&&ot&2048&&hu(N.alternate,N);break;default:Xi(S,N,U,J,v)}r=r.sibling}}function Kr(a,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var h=a,d=r,v=d.flags;switch(d.tag){case 22:Kr(h,d),v&2048&&_o(d.alternate,d);break;case 24:Kr(h,d),v&2048&&hu(d.alternate,d);break;default:Kr(h,d)}r=r.sibling}}var fu=8192;function da(a,r,h){if(a.subtreeFlags&fu)for(a=a.child;a!==null;)Bd(a,r,h),a=a.sibling}function Bd(a,r,h){switch(a.tag){case 26:da(a,r,h),a.flags&fu&&a.memoizedState!==null&&Hw(h,Va,a.memoizedState,a.memoizedProps);break;case 5:da(a,r,h);break;case 3:case 4:var d=Va;Va=K_(a.stateNode.containerInfo),da(a,r,h),Va=d;break;case 22:a.memoizedState===null&&(d=a.alternate,d!==null&&d.memoizedState!==null?(d=fu,fu=16777216,da(a,r,h),fu=d):da(a,r,h));break;default:da(a,r,h)}}function du(a){var r=a.alternate;if(r!==null&&(a=r.child,a!==null)){r.child=null;do r=a.sibling,a.sibling=null,a=r;while(a!==null)}}function yo(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var h=0;h<r.length;h++){var d=r[h];Ii=d,Kn(d,a)}du(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Ys(a),a=a.sibling}function Ys(a){switch(a.tag){case 0:case 11:case 15:yo(a),a.flags&2048&&Fi(9,a,a.return);break;case 3:yo(a);break;case 12:yo(a);break;case 22:var r=a.stateNode;a.memoizedState!==null&&r._visibility&2&&(a.return===null||a.return.tag!==13)?(r._visibility&=-3,xs(a)):yo(a);break;default:yo(a)}}function xs(a){var r=a.deletions;if((a.flags&16)!==0){if(r!==null)for(var h=0;h<r.length;h++){var d=r[h];Ii=d,Kn(d,a)}du(a)}for(a=a.child;a!==null;){switch(r=a,r.tag){case 0:case 11:case 15:Fi(8,r,r.return),xs(r);break;case 22:h=r.stateNode,h._visibility&2&&(h._visibility&=-3,xs(r));break;default:xs(r)}a=a.sibling}}function Kn(a,r){for(;Ii!==null;){var h=Ii;switch(h.tag){case 0:case 11:case 15:Fi(8,h,r);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var d=h.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Jo(h.memoizedState.cache)}if(d=h.child,d!==null)d.return=h,Ii=d;else t:for(h=a;Ii!==null;){d=Ii;var v=d.sibling,S=d.return;if(mf(d),d===h){Ii=null;break t}if(v!==null){v.return=S,Ii=v;break t}Ii=S}}}var Rl={getCacheForType:function(a){var r=ae(ui),h=r.data.get(a);return h===void 0&&(h=a(),r.data.set(a,h)),h},cacheSignal:function(){return ae(ui).controller.signal}},me=typeof WeakMap=="function"?WeakMap:Map,Wt=0,ue=null,Ae=null,_e=0,Pe=0,rs=null,za=!1,hr=!1,Xp=!1,ma=0,Hn=0,Wr=0,vo=0,pf=0,Ns=0,En=0,mu=null,Wn=null,Jn=!1,Nc=0,Kp=0,ii=1/0,Gn=null,si=null,tn=0,pa=null,Dc=null,Ba=0,Ic=0,Oc=null,gf=null,Ao=0,pu=null;function ga(){return(Wt&2)!==0&&_e!==0?_e&-_e:tt.T!==null?dt():tr()}function Te(){if(Ns===0)if((_e&536870912)===0||Ie){var a=Vs;Vs<<=1,(Vs&3932160)===0&&(Vs=262144),Ns=a}else Ns=536870912;return a=Hs.current,a!==null&&(a.flags|=32),Ns}function Ee(a,r,h){(a===ue&&(Pe===2||Pe===9)||a.cancelPendingCommit!==null)&&(So(a,0),hi(a,_e,Ns,!1)),ts(a,h),((Wt&2)===0||a!==ue)&&(a===ue&&((Wt&2)===0&&(vo|=h),Hn===4&&hi(a,_e,Ns,!1)),Rt(a))}function be(a,r,h){if((Wt&6)!==0)throw Error(i(327));var d=!h&&(r&127)===0&&(r&a.expiredLanes)===0||Bt(a,r),v=d?_f(a,r):Ds(a,r,!0),S=d;do{if(v===0){hr&&!d&&hi(a,r,0,!1);break}else{if(h=a.current.alternate,S&&!en(h)){v=Ds(a,r,!1),S=!1;continue}if(v===2){if(S=r,a.errorRecoveryDisabledLanes&S)var N=0;else N=a.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){r=N;t:{var U=a;v=mu;var J=U.current.memoizedState.isDehydrated;if(J&&(So(U,N).flags|=256),N=Ds(U,N,!1),N!==2){if(Xp&&!J){U.errorRecoveryDisabledLanes|=S,vo|=S,v=4;break t}S=Wn,Wn=v,S!==null&&(Wn===null?Wn=S:Wn.push.apply(Wn,S))}v=N}if(S=!1,v!==2)continue}}if(v===1){So(a,0),hi(a,r,0,!0);break}t:{switch(d=a,S=v,S){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:hi(d,r,Ns,!za);break t;case 2:Wn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(v=Nc+300-Qn(),10<v)){if(hi(d,r,Ns,!za),jt(d,0,!0)!==0)break t;Ba=r,d.timeoutHandle=u4(Re.bind(null,d,h,Wn,Gn,Jn,r,Ns,vo,En,za,S,"Throttled",-0,0),v);break t}Re(d,h,Wn,Gn,Jn,r,Ns,vo,En,za,S,null,-0,0)}}break}while(!0);Rt(a)}function Re(a,r,h,d,v,S,N,U,J,ot,_t,Tt,ct,gt){if(a.timeoutHandle=-1,Tt=r.subtreeFlags,Tt&8192||(Tt&16785408)===16785408){Tt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ci},Bd(r,S,Tt);var Xt=(S&62914560)===S?Nc-Qn():(S&4194048)===S?Kp-Qn():0;if(Xt=Gw(Tt,Xt),Xt!==null){Ba=S,a.cancelPendingCommit=Xt(Nl.bind(null,a,r,S,h,d,v,N,U,J,_t,Tt,null,ct,gt)),hi(a,S,N,!ot);return}}Nl(a,r,S,h,d,v,N,U,J)}function en(a){for(var r=a;;){var h=r.tag;if((h===0||h===11||h===15)&&r.flags&16384&&(h=r.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var d=0;d<h.length;d++){var v=h[d],S=v.getSnapshot;v=v.value;try{if(!Ss(S(),v))return!1}catch{return!1}}if(h=r.child,r.subtreeFlags&16384&&h!==null)h.return=r,r=h;else{if(r===a)break;for(;r.sibling===null;){if(r.return===null||r.return===a)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function hi(a,r,h,d){r&=~pf,r&=~vo,a.suspendedLanes|=r,a.pingedLanes&=~r,d&&(a.warmLanes|=r),d=a.expirationTimes;for(var v=r;0<v;){var S=31-ji(v),N=1<<S;d[S]=-1,v&=~N}h!==0&&ya(a,h,r)}function fr(){return(Wt&6)===0?(Ht(0),!1):!0}function Eo(){if(Ae!==null){if(Pe===0)var a=Ae.return;else a=Ae,Br=ro=null,yp(a),nu=null,iu=0,a=Ae;for(;a!==null;)fa(a.alternate,a),a=a.return;Ae=null}}function So(a,r){var h=a.timeoutHandle;h!==-1&&(a.timeoutHandle=-1,Cw(h)),h=a.cancelPendingCommit,h!==null&&(a.cancelPendingCommit=null,h()),Ba=0,Eo(),ue=a,Ae=h=zs(a.current,null),_e=r,Pe=0,rs=null,za=!1,hr=Bt(a,r),Xp=!1,En=Ns=pf=vo=Wr=Hn=0,Wn=mu=null,Jn=!1,(r&8)!==0&&(r|=r&32);var d=a.entangledLanes;if(d!==0)for(a=a.entanglements,d&=r;0<d;){var v=31-ji(d),S=1<<v;r|=a[v],d&=~S}return ma=r,Kh(),h}function Jr(a,r){de=null,tt.H=wc,r===Zo||r===ve?(r=tu(),Pe=3):r===$h?(r=tu(),Pe=4):Pe=r===xd?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,rs=r,Ae===null&&(Hn=1,Rd(a,oa(r,a.current)))}function qn(){var a=Hs.current;return a===null?!0:(_e&4194048)===_e?Cs===null:(_e&62914560)===_e||(_e&536870912)!==0?a===Cs:!1}function xl(){var a=tt.H;return tt.H=wc,a===null?wc:a}function To(){var a=tt.A;return tt.A=Rl,a}function Mc(){Hn=4,za||(_e&4194048)!==_e&&Hs.current!==null||(hr=!0),(Wr&134217727)===0&&(vo&134217727)===0||ue===null||hi(ue,_e,Ns,!1)}function Ds(a,r,h){var d=Wt;Wt|=2;var v=xl(),S=To();(ue!==a||_e!==r)&&(Gn=null,So(a,r)),r=!1;var N=Hn;t:do try{if(Pe!==0&&Ae!==null){var U=Ae,J=rs;switch(Pe){case 8:Eo(),N=6;break t;case 3:case 2:case 9:case 6:Hs.current===null&&(r=!0);var ot=Pe;if(Pe=0,rs=null,gu(a,U,J,ot),h&&hr){N=0;break t}break;default:ot=Pe,Pe=0,rs=null,gu(a,U,J,ot)}}Lc(),N=Hn;break}catch(_t){Jr(a,_t)}while(!0);return r&&a.shellSuspendCounter++,Br=ro=null,Wt=d,tt.H=v,tt.A=S,Ae===null&&(ue=null,_e=0,Kh()),N}function Lc(){for(;Ae!==null;)jd(Ae)}function _f(a,r){var h=Wt;Wt|=2;var d=xl(),v=To();ue!==a||_e!==r?(Gn=null,ii=Qn()+500,So(a,r)):hr=Bt(a,r);t:do try{if(Pe!==0&&Ae!==null){r=Ae;var S=rs;e:switch(Pe){case 1:Pe=0,rs=null,gu(a,r,S,1);break;case 2:case 9:if(js(S)){Pe=0,rs=null,yf(r);break}r=function(){Pe!==2&&Pe!==9||ue!==a||(Pe=7),Rt(a)},S.then(r,r);break t;case 3:Pe=7;break t;case 4:Pe=5;break t;case 7:js(S)?(Pe=0,rs=null,yf(r)):(Pe=0,rs=null,gu(a,r,S,7));break;case 5:var N=null;switch(Ae.tag){case 26:N=Ae.memoizedState;case 5:case 27:var U=Ae;if(N?b4(N):U.stateNode.complete){Pe=0,rs=null;var J=U.sibling;if(J!==null)Ae=J;else{var ot=U.return;ot!==null?(Ae=ot,bo(ot)):Ae=null}break e}}Pe=0,rs=null,gu(a,r,S,5);break;case 6:Pe=0,rs=null,gu(a,r,S,6);break;case 8:Eo(),Hn=6;break t;default:throw Error(i(462))}}Qs();break}catch(_t){Jr(a,_t)}while(!0);return Br=ro=null,tt.H=d,tt.A=v,Wt=h,Ae!==null?0:(ue=null,_e=0,Kh(),Hn)}function Qs(){for(;Ae!==null&&!ks();)jd(Ae)}function jd(a){var r=Pd(a.alternate,a,ma);a.memoizedProps=a.pendingProps,r===null?bo(a):Ae=r}function yf(a){var r=a,h=r.alternate;switch(r.tag){case 15:case 0:r=uf(h,r,r.pendingProps,r.type,void 0,_e);break;case 11:r=uf(h,r,r.pendingProps,r.type.render,r.ref,_e);break;case 5:yp(r);default:fa(h,r),r=Ae=fc(r,ma),r=Pd(h,r,ma)}a.memoizedProps=a.pendingProps,r===null?bo(a):Ae=r}function gu(a,r,h,d){Br=ro=null,yp(r),nu=null,iu=0;var v=r.return;try{if(yi(a,v,r,h,_e)){Hn=1,Rd(a,oa(h,a.current)),Ae=null;return}}catch(S){if(v!==null)throw Ae=v,S;Hn=1,Rd(a,oa(h,a.current)),Ae=null;return}r.flags&32768?(Ie||d===1?a=!0:hr||(_e&536870912)!==0?a=!1:(za=a=!0,(d===2||d===9||d===3||d===6)&&(d=Hs.current,d!==null&&d.tag===13&&(d.flags|=16384))),vf(r,a)):bo(r)}function bo(a){var r=a;do{if((r.flags&32768)!==0){vf(r,za);return}a=r.return;var h=ff(r.alternate,r,ma);if(h!==null){Ae=h;return}if(r=r.sibling,r!==null){Ae=r;return}Ae=r=a}while(r!==null);Hn===0&&(Hn=5)}function vf(a,r){do{var h=Ma(a.alternate,a);if(h!==null){h.flags&=32767,Ae=h;return}if(h=a.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!r&&(a=a.sibling,a!==null)){Ae=a;return}Ae=a=h}while(a!==null);Hn=6,Ae=null}function Nl(a,r,h,d,v,S,N,U,J){a.cancelPendingCommit=null;do kc();while(tn!==0);if((Wt&6)!==0)throw Error(i(327));if(r!==null){if(r===a.current)throw Error(i(177));if(S=r.lanes|r.childLanes,S|=Ri,Vn(a,h,S,N,U,J),a===ue&&(Ae=ue=null,_e=0),Dc=r,pa=a,Ba=h,Ic=S,Oc=v,gf=d,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,b(Ps,function(){return Hd(),null})):(a.callbackNode=null,a.callbackPriority=0),d=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||d){d=tt.T,tt.T=null,v=At.p,At.p=2,N=Wt,Wt|=4;try{Nv(a,r,h)}finally{Wt=N,At.p=v,tt.T=d}}tn=1,fi(),Dl(),_u()}}function fi(){if(tn===1){tn=0;var a=pa,r=Dc,h=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||h){h=tt.T,tt.T=null;var d=At.p;At.p=2;var v=Wt;Wt|=4;try{go(r,a);var S=Pv,N=Q0(a.containerInfo),U=S.focusedElem,J=S.selectionRange;if(N!==U&&U&&U.ownerDocument&&mn(U.ownerDocument.documentElement,U)){if(J!==null&&tp(U)){var ot=J.start,_t=J.end;if(_t===void 0&&(_t=ot),"selectionStart"in U)U.selectionStart=ot,U.selectionEnd=Math.min(_t,U.value.length);else{var Tt=U.ownerDocument||document,ct=Tt&&Tt.defaultView||window;if(ct.getSelection){var gt=ct.getSelection(),Xt=U.textContent.length,se=Math.min(J.start,Xt),yn=J.end===void 0?se:Math.min(J.end,Xt);!gt.extend&&se>yn&&(N=yn,yn=se,se=N);var it=uc(U,se),et=uc(U,yn);if(it&&et&&(gt.rangeCount!==1||gt.anchorNode!==it.node||gt.anchorOffset!==it.offset||gt.focusNode!==et.node||gt.focusOffset!==et.offset)){var lt=Tt.createRange();lt.setStart(it.node,it.offset),gt.removeAllRanges(),se>yn?(gt.addRange(lt),gt.extend(et.node,et.offset)):(lt.setEnd(et.node,et.offset),gt.addRange(lt))}}}}for(Tt=[],gt=U;gt=gt.parentNode;)gt.nodeType===1&&Tt.push({element:gt,left:gt.scrollLeft,top:gt.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Tt.length;U++){var vt=Tt[U];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}ey=!!kv,Pv=kv=null}finally{Wt=v,At.p=d,tt.T=h}}a.current=r,tn=2}}function Dl(){if(tn===2){tn=0;var a=pa,r=Dc,h=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||h){h=tt.T,tt.T=null;var d=At.p;At.p=2;var v=Wt;Wt|=4;try{Nn(a,r.alternate,r)}finally{Wt=v,At.p=d,tt.T=h}}tn=3}}function _u(){if(tn===4||tn===3){tn=0,Ln();var a=pa,r=Dc,h=Ba,d=gf;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?tn=5:(tn=0,Dc=pa=null,Zr(a,a.pendingLanes));var v=a.pendingLanes;if(v===0&&(si=null),Yl(h),r=r.stateNode,di&&typeof di.onCommitFiberRoot=="function")try{di.onCommitFiberRoot(Ja,r,void 0,(r.current.flags&128)===128)}catch{}if(d!==null){r=tt.T,v=At.p,At.p=2,tt.T=null;try{for(var S=a.onRecoverableError,N=0;N<d.length;N++){var U=d[N];S(U.value,{componentStack:U.stack})}}finally{tt.T=r,At.p=v}}(Ba&3)!==0&&kc(),Rt(a),v=a.pendingLanes,(h&261930)!==0&&(v&42)!==0?a===pu?Ao++:(Ao=0,pu=a):Ao=0,Ht(0)}}function Zr(a,r){(a.pooledCacheLanes&=r)===0&&(r=a.pooledCache,r!=null&&(a.pooledCache=null,Jo(r)))}function kc(){return fi(),Dl(),_u(),Hd()}function Hd(){if(tn!==5)return!1;var a=pa,r=Ic;Ic=0;var h=Yl(Ba),d=tt.T,v=At.p;try{At.p=32>h?32:h,tt.T=null,h=Oc,Oc=null;var S=pa,N=Ba;if(tn=0,Dc=pa=null,Ba=0,(Wt&6)!==0)throw Error(i(331));var U=Wt;if(Wt|=4,Ys(S.current),Qp(S,S.current,N,h),Wt=U,Ht(0,!1),di&&typeof di.onPostCommitFiberRoot=="function")try{di.onPostCommitFiberRoot(Ja,S)}catch{}return!0}finally{At.p=v,tt.T=d,Zr(a,r)}}function Wp(a,r,h){r=oa(h,r),r=Bp(a.stateNode,r,2),a=uo(a,r,2),a!==null&&(ts(a,2),Rt(a))}function Ge(a,r,h){if(a.tag===3)Wp(a,a,h);else for(;r!==null;){if(r.tag===3){Wp(r,a,h);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(si===null||!si.has(d))){a=oa(h,a),h=jp(2),d=uo(r,h,2),d!==null&&(B_(h,d,r,a),ts(d,2),Rt(d));break}}r=r.return}}function Af(a,r,h){var d=a.pingCache;if(d===null){d=a.pingCache=new me;var v=new Set;d.set(r,v)}else v=d.get(r),v===void 0&&(v=new Set,d.set(r,v));v.has(h)||(Xp=!0,v.add(h),a=o.bind(null,a,r,h),r.then(a,a))}function o(a,r,h){var d=a.pingCache;d!==null&&d.delete(r),a.pingedLanes|=a.suspendedLanes&h,a.warmLanes&=~h,ue===a&&(_e&h)===h&&(Hn===4||Hn===3&&(_e&62914560)===_e&&300>Qn()-Nc?(Wt&2)===0&&So(a,0):pf|=h,En===_e&&(En=0)),Rt(a)}function u(a,r){r===0&&(r=Xe()),a=Ts(a,r),a!==null&&(ts(a,r),Rt(a))}function p(a){var r=a.memoizedState,h=0;r!==null&&(h=r.retryLane),u(a,h)}function y(a,r){var h=0;switch(a.tag){case 31:case 13:var d=a.stateNode,v=a.memoizedState;v!==null&&(h=v.retryLane);break;case 19:d=a.stateNode;break;case 22:d=a.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(r),u(a,h)}function b(a,r){return Ls(a,r)}var C=null,P=null,Z=!1,mt=!1,wt=!1,Pt=0;function Rt(a){a!==P&&a.next===null&&(P===null?C=P=a:P=P.next=a),mt=!0,Z||(Z=!0,at())}function Ht(a,r){if(!wt&&mt){wt=!0;do for(var h=!1,d=C;d!==null;){if(a!==0){var v=d.pendingLanes;if(v===0)var S=0;else{var N=d.suspendedLanes,U=d.pingedLanes;S=(1<<31-ji(42|a)+1)-1,S&=v&~(N&~U),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(h=!0,ut(d,S))}else S=_e,S=jt(d,d===ue?S:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(S&3)===0||Bt(d,S)||(h=!0,ut(d,S));d=d.next}while(h);wt=!1}}function he(){Oi()}function Oi(){mt=Z=!1;var a=0;Pt!==0&&bw()&&(a=Pt);for(var r=Qn(),h=null,d=C;d!==null;){var v=d.next,S=Pc(d,r);S===0?(d.next=null,h===null?C=v:h.next=v,v===null&&(P=h)):(h=d,(a!==0||(S&3)!==0)&&(mt=!0)),d=v}tn!==0&&tn!==5||Ht(a),Pt!==0&&(Pt=0)}function Pc(a,r){for(var h=a.suspendedLanes,d=a.pingedLanes,v=a.expirationTimes,S=a.pendingLanes&-62914561;0<S;){var N=31-ji(S),U=1<<N,J=v[N];J===-1?((U&h)===0||(U&d)!==0)&&(v[N]=Jt(U,r)):J<=r&&(a.expiredLanes|=U),S&=~U}if(r=ue,h=_e,h=jt(a,a===r?h:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d=a.callbackNode,h===0||a===r&&(Pe===2||Pe===9)||a.cancelPendingCommit!==null)return d!==null&&d!==null&&Wa(d),a.callbackNode=null,a.callbackPriority=0;if((h&3)===0||Bt(a,h)){if(r=h&-h,r===a.callbackPriority)return r;switch(d!==null&&Wa(d),Yl(h)){case 2:case 8:h=Cn;break;case 32:h=Ps;break;case 268435456:h=_a;break;default:h=Ps}return d=Co.bind(null,a),h=Ls(h,d),a.callbackPriority=r,a.callbackNode=h,r}return d!==null&&d!==null&&Wa(d),a.callbackPriority=2,a.callbackNode=null,2}function Co(a,r){if(tn!==0&&tn!==5)return a.callbackNode=null,a.callbackPriority=0,null;var h=a.callbackNode;if(kc()&&a.callbackNode!==h)return null;var d=_e;return d=jt(a,a===ue?d:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),d===0?null:(be(a,d,r),Pc(a,Qn()),a.callbackNode!=null&&a.callbackNode===h?Co.bind(null,a):null)}function ut(a,r){if(kc())return null;be(a,r,!0)}function at(){ww(function(){(Wt&6)!==0?Ls(kn,he):Oi()})}function dt(){if(Pt===0){var a=vl;a===0&&(a=Za,Za<<=1,(Za&261888)===0&&(Za=256)),Pt=a}return Pt}function Dt(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:sr(""+a)}function ee(a,r){var h=r.ownerDocument.createElement("input");return h.name=r.name,h.value=r.value,a.id&&h.setAttribute("form",a.id),r.parentNode.insertBefore(h,r),a=new FormData(a),h.parentNode.removeChild(h),a}function Fn(a,r,h,d,v){if(r==="submit"&&h&&h.stateNode===v){var S=Dt((v[mi]||null).action),N=d.submitter;N&&(r=(r=N[mi]||null)?Dt(r.formAction):N.getAttribute("formAction"),r!==null&&(S=r,N=null));var U=new Zl("action","action",null,d,v);a.push({event:U,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Pt!==0){var J=N?ee(v,N):new FormData(v);Op(h,{pending:!0,data:J,method:v.method,action:S},null,J)}}else typeof S=="function"&&(U.preventDefault(),J=N?ee(v,N):new FormData(v),Op(h,{pending:!0,data:J,method:v.method,action:S},S,J))},currentTarget:v}]})}}for(var ie=0;ie<Qh.length;ie++){var ze=Qh[ie],Mi=ze.toLowerCase(),Ye=ze[0].toUpperCase()+ze.slice(1);wa(Mi,"on"+Ye)}wa(ed,"onAnimationEnd"),wa(Yh,"onAnimationIteration"),wa(np,"onAnimationStart"),wa("dblclick","onDoubleClick"),wa("focusin","onFocus"),wa("focusout","onBlur"),wa(K0,"onTransitionRun"),wa(Ev,"onTransitionStart"),wa(W0,"onTransitionCancel"),wa(ip,"onTransitionEnd"),Gi("onMouseEnter",["mouseout","mouseover"]),Gi("onMouseLeave",["mouseout","mouseover"]),Gi("onPointerEnter",["pointerout","pointerover"]),Gi("onPointerLeave",["pointerout","pointerover"]),es("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),es("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),es("onBeforeInput",["compositionend","keypress","textInput","paste"]),es("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),es("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),es("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ja="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dv=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ja));function e4(a,r){r=(r&4)!==0;for(var h=0;h<a.length;h++){var d=a[h],v=d.event;d=d.listeners;t:{var S=void 0;if(r)for(var N=d.length-1;0<=N;N--){var U=d[N],J=U.instance,ot=U.currentTarget;if(U=U.listener,J!==S&&v.isPropagationStopped())break t;S=U,v.currentTarget=ot;try{S(v)}catch(_t){Xh(_t)}v.currentTarget=null,S=J}else for(N=0;N<d.length;N++){if(U=d[N],J=U.instance,ot=U.currentTarget,U=U.listener,J!==S&&v.isPropagationStopped())break t;S=U,v.currentTarget=ot;try{S(v)}catch(_t){Xh(_t)}v.currentTarget=null,S=J}}}}function Ve(a,r){var h=r[gs];h===void 0&&(h=r[gs]=new Set);var d=a+"__bubble";h.has(d)||(n4(r,a,2,!1),h.add(d))}function Iv(a,r,h){var d=0;r&&(d|=4),n4(h,a,d,r)}var Y_="_reactListening"+Math.random().toString(36).slice(2);function Ov(a){if(!a[Y_]){a[Y_]=!0,sa.forEach(function(h){h!=="selectionchange"&&(Dv.has(h)||Iv(h,!1,a),Iv(h,!0,a))});var r=a.nodeType===9?a:a.ownerDocument;r===null||r[Y_]||(r[Y_]=!0,Iv("selectionchange",!1,r))}}function n4(a,r,h,d){switch(I4(r)){case 2:var v=Yw;break;case 8:v=Qw;break;default:v=Qv}h=v.bind(null,r,h,a),v=void 0,!Ih||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(v=!0),d?v!==void 0?a.addEventListener(r,h,{capture:!0,passive:v}):a.addEventListener(r,h,!0):v!==void 0?a.addEventListener(r,h,{passive:v}):a.addEventListener(r,h,!1)}function Mv(a,r,h,d,v){var S=d;if((r&1)===0&&(r&2)===0&&d!==null)t:for(;;){if(d===null)return;var N=d.tag;if(N===3||N===4){var U=d.stateNode.containerInfo;if(U===v)break;if(N===4)for(N=d.return;N!==null;){var J=N.tag;if((J===3||J===4)&&N.stateNode.containerInfo===v)return;N=N.return}for(;U!==null;){if(N=Er(U),N===null)return;if(J=N.tag,J===5||J===6||J===26||J===27){d=S=N;continue t}U=U.parentNode}}d=d.return}Dh(function(){var ot=S,_t=Go(h),Tt=[];t:{var ct=Ca.get(a);if(ct!==void 0){var gt=Zl,Xt=a;switch(a){case"keypress":if(Jl(h)===0)break t;case"keydown":case"keyup":gt=Dr;break;case"focusin":Xt="focus",gt=cl;break;case"focusout":Xt="blur",gt=cl;break;case"beforeblur":case"afterblur":gt=cl;break;case"click":if(h.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":gt=Mh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":gt=Lh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":gt=Uh;break;case ed:case Yh:case np:gt=tc;break;case ip:gt=rc;break;case"scroll":case"scrollend":gt=Oh;break;case"wheel":gt=Bh;break;case"copy":case"cut":case"paste":gt=Ph;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":gt=sc;break;case"toggle":case"beforetoggle":gt=fl}var se=(r&4)!==0,yn=!se&&(a==="scroll"||a==="scrollend"),it=se?ct!==null?ct+"Capture":null:ct;se=[];for(var et=ot,lt;et!==null;){var vt=et;if(lt=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||lt===null||it===null||(vt=As(et,it),vt!=null&&se.push(Jp(et,vt,lt))),yn)break;et=et.return}0<se.length&&(ct=new gt(ct,Xt,null,h,_t),Tt.push({event:ct,listeners:se}))}}if((r&7)===0){t:{if(ct=a==="mouseover"||a==="pointerover",gt=a==="mouseout"||a==="pointerout",ct&&h!==Ho&&(Xt=h.relatedTarget||h.fromElement)&&(Er(Xt)||Xt[va]))break t;if((gt||ct)&&(ct=_t.window===_t?_t:(ct=_t.ownerDocument)?ct.defaultView||ct.parentWindow:window,gt?(Xt=h.relatedTarget||h.toElement,gt=ot,Xt=Xt?Er(Xt):null,Xt!==null&&(yn=l(Xt),se=Xt.tag,Xt!==yn||se!==5&&se!==27&&se!==6)&&(Xt=null)):(gt=null,Xt=ot),gt!==Xt)){if(se=Mh,vt="onMouseLeave",it="onMouseEnter",et="mouse",(a==="pointerout"||a==="pointerover")&&(se=sc,vt="onPointerLeave",it="onPointerEnter",et="pointer"),yn=gt==null?ct:Xl(gt),lt=Xt==null?ct:Xl(Xt),ct=new se(vt,et+"leave",gt,h,_t),ct.target=yn,ct.relatedTarget=lt,vt=null,Er(_t)===ot&&(se=new se(it,et+"enter",Xt,h,_t),se.target=lt,se.relatedTarget=yn,vt=se),yn=vt,gt&&Xt)e:{for(se=vw,it=gt,et=Xt,lt=0,vt=it;vt;vt=se(vt))lt++;vt=0;for(var te=et;te;te=se(te))vt++;for(;0<lt-vt;)it=se(it),lt--;for(;0<vt-lt;)et=se(et),vt--;for(;lt--;){if(it===et||et!==null&&it===et.alternate){se=it;break e}it=se(it),et=se(et)}se=null}else se=null;gt!==null&&i4(Tt,ct,gt,se,!1),Xt!==null&&yn!==null&&i4(Tt,yn,Xt,se,!0)}}t:{if(ct=ot?Xl(ot):window,gt=ct.nodeName&&ct.nodeName.toLowerCase(),gt==="select"||gt==="input"&&ct.type==="file")var We=Km;else if(Es(ct))if(Or)We=Y0;else{We=Zm;var Kt=q0}else gt=ct.nodeName,!gt||gt.toLowerCase()!=="input"||ct.type!=="checkbox"&&ct.type!=="radio"?ot&&Zu(ot.elementType)&&(We=Km):We=F0;if(We&&(We=We(a,ot))){dl(Tt,We,h,_t);break t}Kt&&Kt(a,ct,ot),a==="focusout"&&ot&&ct.type==="number"&&ot.memoizedProps.value!=null&&Us(ct,"number",ct.value)}switch(Kt=ot?Xl(ot):window,a){case"focusin":(Es(Kt)||Kt.contentEditable==="true")&&(Mr=Kt,Lr=ot,cc=null);break;case"focusout":cc=Lr=Mr=null;break;case"mousedown":td=!0;break;case"contextmenu":case"mouseup":case"dragend":td=!1,hc(Tt,h,_t);break;case"selectionchange":if(X0)break;case"keydown":case"keyup":hc(Tt,h,_t)}var Se;if(w)t:{switch(a){case"compositionstart":var Be="onCompositionStart";break t;case"compositionend":Be="onCompositionEnd";break t;case"compositionupdate":Be="onCompositionUpdate";break t}Be=void 0}else ye?Fe(a,h)&&(Be="onCompositionEnd"):a==="keydown"&&h.keyCode===229&&(Be="onCompositionStart");Be&&(rt&&h.locale!=="ko"&&(ye||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&ye&&(Se=rr()):(wi=_t,qo="value"in wi?wi.value:wi.textContent,ye=!0)),Kt=Q_(ot,Be),0<Kt.length&&(Be=new Qo(Be,a,null,h,_t),Tt.push({event:Be,listeners:Kt}),Se?Be.data=Se:(Se=$n(h),Se!==null&&(Be.data=Se)))),(Se=z?gi(a,h):oi(a,h))&&(Be=Q_(ot,"onBeforeInput"),0<Be.length&&(Kt=new Qo("onBeforeInput","beforeinput",null,h,_t),Tt.push({event:Kt,listeners:Be}),Kt.data=Se)),Fn(Tt,a,ot,h,_t)}e4(Tt,r)})}function Jp(a,r,h){return{instance:a,listener:r,currentTarget:h}}function Q_(a,r){for(var h=r+"Capture",d=[];a!==null;){var v=a,S=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||S===null||(v=As(a,h),v!=null&&d.unshift(Jp(a,v,S)),v=As(a,r),v!=null&&d.push(Jp(a,v,S))),a.tag===3)return d;a=a.return}return[]}function vw(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function i4(a,r,h,d,v){for(var S=r._reactName,N=[];h!==null&&h!==d;){var U=h,J=U.alternate,ot=U.stateNode;if(U=U.tag,J!==null&&J===d)break;U!==5&&U!==26&&U!==27||ot===null||(J=ot,v?(ot=As(h,S),ot!=null&&N.unshift(Jp(h,ot,J))):v||(ot=As(h,S),ot!=null&&N.push(Jp(h,ot,J)))),h=h.return}N.length!==0&&a.push({event:r,listeners:N})}var Aw=/\r\n?/g,Ew=/\u0000|\uFFFD/g;function s4(a){return(typeof a=="string"?a:""+a).replace(Aw,`
`).replace(Ew,"")}function a4(a,r){return r=s4(r),s4(a)===r}function _n(a,r,h,d,v,S){switch(h){case"children":typeof d=="string"?r==="body"||r==="textarea"&&d===""||ra(a,d):(typeof d=="number"||typeof d=="bigint")&&r!=="body"&&ra(a,""+d);break;case"className":al(a,"class",d);break;case"tabIndex":al(a,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":al(a,h,d);break;case"style":Rh(a,d,S);break;case"data":if(r!=="object"){al(a,"data",d);break}case"src":case"href":if(d===""&&(r!=="a"||h!=="href")){a.removeAttribute(h);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(h);break}d=sr(""+d),a.setAttribute(h,d);break;case"action":case"formAction":if(typeof d=="function"){a.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(h==="formAction"?(r!=="input"&&_n(a,r,"name",v.name,v,null),_n(a,r,"formEncType",v.formEncType,v,null),_n(a,r,"formMethod",v.formMethod,v,null),_n(a,r,"formTarget",v.formTarget,v,null)):(_n(a,r,"encType",v.encType,v,null),_n(a,r,"method",v.method,v,null),_n(a,r,"target",v.target,v,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){a.removeAttribute(h);break}d=sr(""+d),a.setAttribute(h,d);break;case"onClick":d!=null&&(a.onclick=Ci);break;case"onScroll":d!=null&&Ve("scroll",a);break;case"onScrollEnd":d!=null&&Ve("scrollend",a);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(h=d.__html,h!=null){if(v.children!=null)throw Error(i(60));a.innerHTML=h}}break;case"multiple":a.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":a.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){a.removeAttribute("xlink:href");break}h=sr(""+d),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(h,""+d):a.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(h,""):a.removeAttribute(h);break;case"capture":case"download":d===!0?a.setAttribute(h,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?a.setAttribute(h,d):a.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?a.setAttribute(h,d):a.removeAttribute(h);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?a.removeAttribute(h):a.setAttribute(h,d);break;case"popover":Ve("beforetoggle",a),Ve("toggle",a),br(a,"popover",d);break;case"xlinkActuate":aa(a,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":aa(a,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":aa(a,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":aa(a,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":aa(a,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":aa(a,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":aa(a,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":aa(a,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":aa(a,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":br(a,"is",d);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=$f.get(h)||h,br(a,h,d))}}function Lv(a,r,h,d,v,S){switch(h){case"style":Rh(a,d,S);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(h=d.__html,h!=null){if(v.children!=null)throw Error(i(60));a.innerHTML=h}}break;case"children":typeof d=="string"?ra(a,d):(typeof d=="number"||typeof d=="bigint")&&ra(a,""+d);break;case"onScroll":d!=null&&Ve("scroll",a);break;case"onScrollEnd":d!=null&&Ve("scrollend",a);break;case"onClick":d!=null&&(a.onclick=Ci);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Tr.hasOwnProperty(h))t:{if(h[0]==="o"&&h[1]==="n"&&(v=h.endsWith("Capture"),r=h.slice(2,v?h.length-7:void 0),S=a[mi]||null,S=S!=null?S[h]:null,typeof S=="function"&&a.removeEventListener(r,S,v),typeof d=="function")){typeof S!="function"&&S!==null&&(h in a?a[h]=null:a.hasAttribute(h)&&a.removeAttribute(h)),a.addEventListener(r,d,v);break t}h in a?a[h]=d:d===!0?a.setAttribute(h,""):br(a,h,d)}}}function Is(a,r,h){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ve("error",a),Ve("load",a);var d=!1,v=!1,S;for(S in h)if(h.hasOwnProperty(S)){var N=h[S];if(N!=null)switch(S){case"src":d=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:_n(a,r,S,N,h,null)}}v&&_n(a,r,"srcSet",h.srcSet,h,null),d&&_n(a,r,"src",h.src,h,null);return;case"input":Ve("invalid",a);var U=S=N=v=null,J=null,ot=null;for(d in h)if(h.hasOwnProperty(d)){var _t=h[d];if(_t!=null)switch(d){case"name":v=_t;break;case"type":N=_t;break;case"checked":J=_t;break;case"defaultChecked":ot=_t;break;case"value":S=_t;break;case"defaultValue":U=_t;break;case"children":case"dangerouslySetInnerHTML":if(_t!=null)throw Error(i(137,r));break;default:_n(a,r,d,_t,h,null)}}rl(a,S,U,J,ot,N,v,!1);return;case"select":Ve("invalid",a),d=N=S=null;for(v in h)if(h.hasOwnProperty(v)&&(U=h[v],U!=null))switch(v){case"value":S=U;break;case"defaultValue":N=U;break;case"multiple":d=U;default:_n(a,r,v,U,h,null)}r=S,h=N,a.multiple=!!d,r!=null?ke(a,!!d,r,!1):h!=null&&ke(a,!!d,h,!0);return;case"textarea":Ve("invalid",a),S=v=d=null;for(N in h)if(h.hasOwnProperty(N)&&(U=h[N],U!=null))switch(N){case"value":d=U;break;case"defaultValue":v=U;break;case"children":S=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(i(91));break;default:_n(a,r,N,U,h,null)}Cr(a,d,v,S);return;case"option":for(J in h)h.hasOwnProperty(J)&&(d=h[J],d!=null)&&(J==="selected"?a.selected=d&&typeof d!="function"&&typeof d!="symbol":_n(a,r,J,d,h,null));return;case"dialog":Ve("beforetoggle",a),Ve("toggle",a),Ve("cancel",a),Ve("close",a);break;case"iframe":case"object":Ve("load",a);break;case"video":case"audio":for(d=0;d<ja.length;d++)Ve(ja[d],a);break;case"image":Ve("error",a),Ve("load",a);break;case"details":Ve("toggle",a);break;case"embed":case"source":case"link":Ve("error",a),Ve("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ot in h)if(h.hasOwnProperty(ot)&&(d=h[ot],d!=null))switch(ot){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:_n(a,r,ot,d,h,null)}return;default:if(Zu(r)){for(_t in h)h.hasOwnProperty(_t)&&(d=h[_t],d!==void 0&&Lv(a,r,_t,d,h,void 0));return}}for(U in h)h.hasOwnProperty(U)&&(d=h[U],d!=null&&_n(a,r,U,d,h,null))}function Sw(a,r,h,d){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,S=null,N=null,U=null,J=null,ot=null,_t=null;for(gt in h){var Tt=h[gt];if(h.hasOwnProperty(gt)&&Tt!=null)switch(gt){case"checked":break;case"value":break;case"defaultValue":J=Tt;default:d.hasOwnProperty(gt)||_n(a,r,gt,null,d,Tt)}}for(var ct in d){var gt=d[ct];if(Tt=h[ct],d.hasOwnProperty(ct)&&(gt!=null||Tt!=null))switch(ct){case"type":S=gt;break;case"name":v=gt;break;case"checked":ot=gt;break;case"defaultChecked":_t=gt;break;case"value":N=gt;break;case"defaultValue":U=gt;break;case"children":case"dangerouslySetInnerHTML":if(gt!=null)throw Error(i(137,r));break;default:gt!==Tt&&_n(a,r,ct,gt,d,Tt)}}ir(a,N,U,J,ot,_t,S,v);return;case"select":gt=N=U=ct=null;for(S in h)if(J=h[S],h.hasOwnProperty(S)&&J!=null)switch(S){case"value":break;case"multiple":gt=J;default:d.hasOwnProperty(S)||_n(a,r,S,null,d,J)}for(v in d)if(S=d[v],J=h[v],d.hasOwnProperty(v)&&(S!=null||J!=null))switch(v){case"value":ct=S;break;case"defaultValue":U=S;break;case"multiple":N=S;default:S!==J&&_n(a,r,v,S,d,J)}r=U,h=N,d=gt,ct!=null?ke(a,!!h,ct,!1):!!d!=!!h&&(r!=null?ke(a,!!h,r,!0):ke(a,!!h,h?[]:"",!1));return;case"textarea":gt=ct=null;for(U in h)if(v=h[U],h.hasOwnProperty(U)&&v!=null&&!d.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:_n(a,r,U,null,d,v)}for(N in d)if(v=d[N],S=h[N],d.hasOwnProperty(N)&&(v!=null||S!=null))switch(N){case"value":ct=v;break;case"defaultValue":gt=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==S&&_n(a,r,N,v,d,S)}ll(a,ct,gt);return;case"option":for(var Xt in h)ct=h[Xt],h.hasOwnProperty(Xt)&&ct!=null&&!d.hasOwnProperty(Xt)&&(Xt==="selected"?a.selected=!1:_n(a,r,Xt,null,d,ct));for(J in d)ct=d[J],gt=h[J],d.hasOwnProperty(J)&&ct!==gt&&(ct!=null||gt!=null)&&(J==="selected"?a.selected=ct&&typeof ct!="function"&&typeof ct!="symbol":_n(a,r,J,ct,d,gt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var se in h)ct=h[se],h.hasOwnProperty(se)&&ct!=null&&!d.hasOwnProperty(se)&&_n(a,r,se,null,d,ct);for(ot in d)if(ct=d[ot],gt=h[ot],d.hasOwnProperty(ot)&&ct!==gt&&(ct!=null||gt!=null))switch(ot){case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(i(137,r));break;default:_n(a,r,ot,ct,d,gt)}return;default:if(Zu(r)){for(var yn in h)ct=h[yn],h.hasOwnProperty(yn)&&ct!==void 0&&!d.hasOwnProperty(yn)&&Lv(a,r,yn,void 0,d,ct);for(_t in d)ct=d[_t],gt=h[_t],!d.hasOwnProperty(_t)||ct===gt||ct===void 0&&gt===void 0||Lv(a,r,_t,ct,d,gt);return}}for(var it in h)ct=h[it],h.hasOwnProperty(it)&&ct!=null&&!d.hasOwnProperty(it)&&_n(a,r,it,null,d,ct);for(Tt in d)ct=d[Tt],gt=h[Tt],!d.hasOwnProperty(Tt)||ct===gt||ct==null&&gt==null||_n(a,r,Tt,ct,d,gt)}function r4(a){switch(a){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Tw(){if(typeof performance.getEntriesByType=="function"){for(var a=0,r=0,h=performance.getEntriesByType("resource"),d=0;d<h.length;d++){var v=h[d],S=v.transferSize,N=v.initiatorType,U=v.duration;if(S&&U&&r4(N)){for(N=0,U=v.responseEnd,d+=1;d<h.length;d++){var J=h[d],ot=J.startTime;if(ot>U)break;var _t=J.transferSize,Tt=J.initiatorType;_t&&r4(Tt)&&(J=J.responseEnd,N+=_t*(J<U?1:(U-ot)/(J-ot)))}if(--d,r+=8*(S+N)/(v.duration/1e3),a++,10<a)break}}if(0<a)return r/a/1e6}return navigator.connection&&(a=navigator.connection.downlink,typeof a=="number")?a:5}var kv=null,Pv=null;function X_(a){return a.nodeType===9?a:a.ownerDocument}function l4(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function o4(a,r){if(a===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&r==="foreignObject"?0:a}function Vv(a,r){return a==="textarea"||a==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Uv=null;function bw(){var a=window.event;return a&&a.type==="popstate"?a===Uv?!1:(Uv=a,!0):(Uv=null,!1)}var u4=typeof setTimeout=="function"?setTimeout:void 0,Cw=typeof clearTimeout=="function"?clearTimeout:void 0,c4=typeof Promise=="function"?Promise:void 0,ww=typeof queueMicrotask=="function"?queueMicrotask:typeof c4<"u"?function(a){return c4.resolve(null).then(a).catch(Rw)}:u4;function Rw(a){setTimeout(function(){throw a})}function Vc(a){return a==="head"}function h4(a,r){var h=r,d=0;do{var v=h.nextSibling;if(a.removeChild(h),v&&v.nodeType===8)if(h=v.data,h==="/$"||h==="/&"){if(d===0){a.removeChild(v),Yd(r);return}d--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")d++;else if(h==="html")Zp(a.ownerDocument.documentElement);else if(h==="head"){h=a.ownerDocument.head,Zp(h);for(var S=h.firstChild;S;){var N=S.nextSibling,U=S.nodeName;S[na]||U==="SCRIPT"||U==="STYLE"||U==="LINK"&&S.rel.toLowerCase()==="stylesheet"||h.removeChild(S),S=N}}else h==="body"&&Zp(a.ownerDocument.body);h=v}while(h);Yd(r)}function f4(a,r){var h=a;a=0;do{var d=h.nextSibling;if(h.nodeType===1?r?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(r?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),d&&d.nodeType===8)if(h=d.data,h==="/$"){if(a===0)break;a--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||a++;h=d}while(h)}function zv(a){var r=a.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var h=r;switch(r=r.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":zv(h),nr(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}a.removeChild(h)}}function xw(a,r,h,d){for(;a.nodeType===1;){var v=h;if(a.nodeName.toLowerCase()!==r.toLowerCase()){if(!d&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(d){if(!a[na])switch(r){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(S=a.getAttribute("rel"),S==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(S!==v.rel||a.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||a.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||a.getAttribute("title")!==(v.title==null?null:v.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(S=a.getAttribute("src"),(S!==(v.src==null?null:v.src)||a.getAttribute("type")!==(v.type==null?null:v.type)||a.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&S&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(r==="input"&&a.type==="hidden"){var S=v.name==null?null:""+v.name;if(v.type==="hidden"&&a.getAttribute("name")===S)return a}else return a;if(a=$r(a.nextSibling),a===null)break}return null}function Nw(a,r,h){if(r==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!h||(a=$r(a.nextSibling),a===null))return null;return a}function d4(a,r){for(;a.nodeType!==8;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!r||(a=$r(a.nextSibling),a===null))return null;return a}function Bv(a){return a.data==="$?"||a.data==="$~"}function jv(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState!=="loading"}function Dw(a,r){var h=a.ownerDocument;if(a.data==="$~")a._reactRetry=r;else if(a.data!=="$?"||h.readyState!=="loading")r();else{var d=function(){r(),h.removeEventListener("DOMContentLoaded",d)};h.addEventListener("DOMContentLoaded",d),a._reactRetry=d}}function $r(a){for(;a!=null;a=a.nextSibling){var r=a.nodeType;if(r===1||r===3)break;if(r===8){if(r=a.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return a}var Hv=null;function m4(a){a=a.nextSibling;for(var r=0;a;){if(a.nodeType===8){var h=a.data;if(h==="/$"||h==="/&"){if(r===0)return $r(a.nextSibling);r--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||r++}a=a.nextSibling}return null}function p4(a){a=a.previousSibling;for(var r=0;a;){if(a.nodeType===8){var h=a.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(r===0)return a;r--}else h!=="/$"&&h!=="/&"||r++}a=a.previousSibling}return null}function g4(a,r,h){switch(r=X_(h),a){case"html":if(a=r.documentElement,!a)throw Error(i(452));return a;case"head":if(a=r.head,!a)throw Error(i(453));return a;case"body":if(a=r.body,!a)throw Error(i(454));return a;default:throw Error(i(451))}}function Zp(a){for(var r=a.attributes;r.length;)a.removeAttributeNode(r[0]);nr(a)}var tl=new Map,_4=new Set;function K_(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var yu=At.d;At.d={f:Iw,r:Ow,D:Mw,C:Lw,L:kw,m:Pw,X:Uw,S:Vw,M:zw};function Iw(){var a=yu.f(),r=fr();return a||r}function Ow(a){var r=Sr(a);r!==null&&r.tag===5&&r.type==="form"?I_(r):yu.r(a)}var Gd=typeof document>"u"?null:document;function y4(a,r,h){var d=Gd;if(d&&typeof r=="string"&&r){var v=dn(r);v='link[rel="'+a+'"][href="'+v+'"]',typeof h=="string"&&(v+='[crossorigin="'+h+'"]'),_4.has(v)||(_4.add(v),a={rel:a,crossOrigin:h,href:r},d.querySelector(v)===null&&(r=d.createElement("link"),Is(r,"link",a),Un(r),d.head.appendChild(r)))}}function Mw(a){yu.D(a),y4("dns-prefetch",a,null)}function Lw(a,r){yu.C(a,r),y4("preconnect",a,r)}function kw(a,r,h){yu.L(a,r,h);var d=Gd;if(d&&a&&r){var v='link[rel="preload"][as="'+dn(r)+'"]';r==="image"&&h&&h.imageSrcSet?(v+='[imagesrcset="'+dn(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(v+='[imagesizes="'+dn(h.imageSizes)+'"]')):v+='[href="'+dn(a)+'"]';var S=v;switch(r){case"style":S=qd(a);break;case"script":S=Fd(a)}tl.has(S)||(a=E({rel:"preload",href:r==="image"&&h&&h.imageSrcSet?void 0:a,as:r},h),tl.set(S,a),d.querySelector(v)!==null||r==="style"&&d.querySelector($p(S))||r==="script"&&d.querySelector(tg(S))||(r=d.createElement("link"),Is(r,"link",a),Un(r),d.head.appendChild(r)))}}function Pw(a,r){yu.m(a,r);var h=Gd;if(h&&a){var d=r&&typeof r.as=="string"?r.as:"script",v='link[rel="modulepreload"][as="'+dn(d)+'"][href="'+dn(a)+'"]',S=v;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=Fd(a)}if(!tl.has(S)&&(a=E({rel:"modulepreload",href:a},r),tl.set(S,a),h.querySelector(v)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(tg(S)))return}d=h.createElement("link"),Is(d,"link",a),Un(d),h.head.appendChild(d)}}}function Vw(a,r,h){yu.S(a,r,h);var d=Gd;if(d&&a){var v=ia(d).hoistableStyles,S=qd(a);r=r||"default";var N=v.get(S);if(!N){var U={loading:0,preload:null};if(N=d.querySelector($p(S)))U.loading=5;else{a=E({rel:"stylesheet",href:a,"data-precedence":r},h),(h=tl.get(S))&&Gv(a,h);var J=N=d.createElement("link");Un(J),Is(J,"link",a),J._p=new Promise(function(ot,_t){J.onload=ot,J.onerror=_t}),J.addEventListener("load",function(){U.loading|=1}),J.addEventListener("error",function(){U.loading|=2}),U.loading|=4,W_(N,r,d)}N={type:"stylesheet",instance:N,count:1,state:U},v.set(S,N)}}}function Uw(a,r){yu.X(a,r);var h=Gd;if(h&&a){var d=ia(h).hoistableScripts,v=Fd(a),S=d.get(v);S||(S=h.querySelector(tg(v)),S||(a=E({src:a,async:!0},r),(r=tl.get(v))&&qv(a,r),S=h.createElement("script"),Un(S),Is(S,"link",a),h.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},d.set(v,S))}}function zw(a,r){yu.M(a,r);var h=Gd;if(h&&a){var d=ia(h).hoistableScripts,v=Fd(a),S=d.get(v);S||(S=h.querySelector(tg(v)),S||(a=E({src:a,async:!0,type:"module"},r),(r=tl.get(v))&&qv(a,r),S=h.createElement("script"),Un(S),Is(S,"link",a),h.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},d.set(v,S))}}function v4(a,r,h,d){var v=(v=re.current)?K_(v):null;if(!v)throw Error(i(446));switch(a){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(r=qd(h.href),h=ia(v).hoistableStyles,d=h.get(r),d||(d={type:"style",instance:null,count:0,state:null},h.set(r,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){a=qd(h.href);var S=ia(v).hoistableStyles,N=S.get(a);if(N||(v=v.ownerDocument||v,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(a,N),(S=v.querySelector($p(a)))&&!S._p&&(N.instance=S,N.state.loading=5),tl.has(a)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},tl.set(a,h),S||Bw(v,a,h,N.state))),r&&d===null)throw Error(i(528,""));return N}if(r&&d!==null)throw Error(i(529,""));return null;case"script":return r=h.async,h=h.src,typeof h=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=Fd(h),h=ia(v).hoistableScripts,d=h.get(r),d||(d={type:"script",instance:null,count:0,state:null},h.set(r,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,a))}}function qd(a){return'href="'+dn(a)+'"'}function $p(a){return'link[rel="stylesheet"]['+a+"]"}function A4(a){return E({},a,{"data-precedence":a.precedence,precedence:null})}function Bw(a,r,h,d){a.querySelector('link[rel="preload"][as="style"]['+r+"]")?d.loading=1:(r=a.createElement("link"),d.preload=r,r.addEventListener("load",function(){return d.loading|=1}),r.addEventListener("error",function(){return d.loading|=2}),Is(r,"link",h),Un(r),a.head.appendChild(r))}function Fd(a){return'[src="'+dn(a)+'"]'}function tg(a){return"script[async]"+a}function E4(a,r,h){if(r.count++,r.instance===null)switch(r.type){case"style":var d=a.querySelector('style[data-href~="'+dn(h.href)+'"]');if(d)return r.instance=d,Un(d),d;var v=E({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return d=(a.ownerDocument||a).createElement("style"),Un(d),Is(d,"style",v),W_(d,h.precedence,a),r.instance=d;case"stylesheet":v=qd(h.href);var S=a.querySelector($p(v));if(S)return r.state.loading|=4,r.instance=S,Un(S),S;d=A4(h),(v=tl.get(v))&&Gv(d,v),S=(a.ownerDocument||a).createElement("link"),Un(S);var N=S;return N._p=new Promise(function(U,J){N.onload=U,N.onerror=J}),Is(S,"link",d),r.state.loading|=4,W_(S,h.precedence,a),r.instance=S;case"script":return S=Fd(h.src),(v=a.querySelector(tg(S)))?(r.instance=v,Un(v),v):(d=h,(v=tl.get(S))&&(d=E({},h),qv(d,v)),a=a.ownerDocument||a,v=a.createElement("script"),Un(v),Is(v,"link",d),a.head.appendChild(v),r.instance=v);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(d=r.instance,r.state.loading|=4,W_(d,h.precedence,a));return r.instance}function W_(a,r,h){for(var d=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=d.length?d[d.length-1]:null,S=v,N=0;N<d.length;N++){var U=d[N];if(U.dataset.precedence===r)S=U;else if(S!==v)break}S?S.parentNode.insertBefore(a,S.nextSibling):(r=h.nodeType===9?h.head:h,r.insertBefore(a,r.firstChild))}function Gv(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.title==null&&(a.title=r.title)}function qv(a,r){a.crossOrigin==null&&(a.crossOrigin=r.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=r.referrerPolicy),a.integrity==null&&(a.integrity=r.integrity)}var J_=null;function S4(a,r,h){if(J_===null){var d=new Map,v=J_=new Map;v.set(h,d)}else v=J_,d=v.get(h),d||(d=new Map,v.set(h,d));if(d.has(a))return d;for(d.set(a,null),h=h.getElementsByTagName(a),v=0;v<h.length;v++){var S=h[v];if(!(S[na]||S[vn]||a==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var N=S.getAttribute(r)||"";N=a+N;var U=d.get(N);U?U.push(S):d.set(N,[S])}}return d}function T4(a,r,h){a=a.ownerDocument||a,a.head.insertBefore(h,r==="title"?a.querySelector("head > title"):null)}function jw(a,r,h){if(h===1||r.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(a=r.disabled,typeof r.precedence=="string"&&a==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function b4(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}function Hw(a,r,h,d){if(h.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var v=qd(d.href),S=r.querySelector($p(v));if(S){r=S._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(a.count++,a=Z_.bind(a),r.then(a,a)),h.state.loading|=4,h.instance=S,Un(S);return}S=r.ownerDocument||r,d=A4(d),(v=tl.get(v))&&Gv(d,v),S=S.createElement("link"),Un(S);var N=S;N._p=new Promise(function(U,J){N.onload=U,N.onerror=J}),Is(S,"link",d),h.instance=S}a.stylesheets===null&&(a.stylesheets=new Map),a.stylesheets.set(h,r),(r=h.state.preload)&&(h.state.loading&3)===0&&(a.count++,h=Z_.bind(a),r.addEventListener("load",h),r.addEventListener("error",h))}}var Fv=0;function Gw(a,r){return a.stylesheets&&a.count===0&&ty(a,a.stylesheets),0<a.count||0<a.imgCount?function(h){var d=setTimeout(function(){if(a.stylesheets&&ty(a,a.stylesheets),a.unsuspend){var S=a.unsuspend;a.unsuspend=null,S()}},6e4+r);0<a.imgBytes&&Fv===0&&(Fv=62500*Tw());var v=setTimeout(function(){if(a.waitingForImages=!1,a.count===0&&(a.stylesheets&&ty(a,a.stylesheets),a.unsuspend)){var S=a.unsuspend;a.unsuspend=null,S()}},(a.imgBytes>Fv?50:800)+r);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(d),clearTimeout(v)}}:null}function Z_(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ty(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var $_=null;function ty(a,r){a.stylesheets=null,a.unsuspend!==null&&(a.count++,$_=new Map,r.forEach(qw,a),$_=null,Z_.call(a))}function qw(a,r){if(!(r.state.loading&4)){var h=$_.get(a);if(h)var d=h.get(null);else{h=new Map,$_.set(a,h);for(var v=a.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<v.length;S++){var N=v[S];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(h.set(N.dataset.precedence,N),d=N)}d&&h.set(null,d)}v=r.instance,N=v.getAttribute("data-precedence"),S=h.get(N)||d,S===d&&h.set(null,v),h.set(N,v),this.count++,d=Z_.bind(this),v.addEventListener("load",d),v.addEventListener("error",d),S?S.parentNode.insertBefore(v,S.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(v,a.firstChild)),r.state.loading|=4}}var eg={$$typeof:Y,Provider:null,Consumer:null,_currentValue:yt,_currentValue2:yt,_threadCount:0};function Fw(a,r,h,d,v,S,N,U,J){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Pn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pn(0),this.hiddenUpdates=Pn(null),this.identifierPrefix=d,this.onUncaughtError=v,this.onCaughtError=S,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function C4(a,r,h,d,v,S,N,U,J,ot,_t,Tt){return a=new Fw(a,r,h,N,J,ot,_t,Tt,U),r=1,S===!0&&(r|=24),S=zn(3,null,null,r),a.current=S,S.stateNode=a,r=ap(),r.refCount++,a.pooledCache=r,r.refCount++,S.memoizedState={element:d,isDehydrated:h,cache:r},ef(S),a}function w4(a){return a?(a=eo,a):eo}function R4(a,r,h,d,v,S){v=w4(v),d.context===null?d.context=v:d.pendingContext=v,d=El(r),d.payload={element:h},S=S===void 0?null:S,S!==null&&(d.callback=S),h=uo(a,d,r),h!==null&&(Ee(h,a,r),co(h,a,r))}function x4(a,r){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<r?h:r}}function Yv(a,r){x4(a,r),(a=a.alternate)&&x4(a,r)}function N4(a){if(a.tag===13||a.tag===31){var r=Ts(a,67108864);r!==null&&Ee(r,a,67108864),Yv(a,67108864)}}function D4(a){if(a.tag===13||a.tag===31){var r=ga();r=Fl(r);var h=Ts(a,r);h!==null&&Ee(h,a,r),Yv(a,r)}}var ey=!0;function Yw(a,r,h,d){var v=tt.T;tt.T=null;var S=At.p;try{At.p=2,Qv(a,r,h,d)}finally{At.p=S,tt.T=v}}function Qw(a,r,h,d){var v=tt.T;tt.T=null;var S=At.p;try{At.p=8,Qv(a,r,h,d)}finally{At.p=S,tt.T=v}}function Qv(a,r,h,d){if(ey){var v=Xv(d);if(v===null)Mv(a,r,d,ny,h),O4(a,d);else if(Kw(v,a,r,h,d))d.stopPropagation();else if(O4(a,d),r&4&&-1<Xw.indexOf(a)){for(;v!==null;){var S=Sr(v);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var N=St(S.pendingLanes);if(N!==0){var U=S;for(U.pendingLanes|=2,U.entangledLanes|=2;N;){var J=1<<31-ji(N);U.entanglements[1]|=J,N&=~J}Rt(S),(Wt&6)===0&&(ii=Qn()+500,Ht(0))}}break;case 31:case 13:U=Ts(S,2),U!==null&&Ee(U,S,2),fr(),Yv(S,2)}if(S=Xv(d),S===null&&Mv(a,r,d,ny,h),S===v)break;v=S}v!==null&&d.stopPropagation()}else Mv(a,r,d,null,h)}}function Xv(a){return a=Go(a),Kv(a)}var ny=null;function Kv(a){if(ny=null,a=Er(a),a!==null){var r=l(a);if(r===null)a=null;else{var h=r.tag;if(h===13){if(a=c(r),a!==null)return a;a=null}else if(h===31){if(a=f(r),a!==null)return a;a=null}else if(h===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;a=null}else r!==a&&(a=null)}}return ny=a,null}function I4(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Vo()){case kn:return 2;case Cn:return 8;case Ps:case ms:return 32;case _a:return 268435456;default:return 32}default:return 32}}var Wv=!1,Uc=null,zc=null,Bc=null,ng=new Map,ig=new Map,jc=[],Xw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function O4(a,r){switch(a){case"focusin":case"focusout":Uc=null;break;case"dragenter":case"dragleave":zc=null;break;case"mouseover":case"mouseout":Bc=null;break;case"pointerover":case"pointerout":ng.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":ig.delete(r.pointerId)}}function sg(a,r,h,d,v,S){return a===null||a.nativeEvent!==S?(a={blockedOn:r,domEventName:h,eventSystemFlags:d,nativeEvent:S,targetContainers:[v]},r!==null&&(r=Sr(r),r!==null&&N4(r)),a):(a.eventSystemFlags|=d,r=a.targetContainers,v!==null&&r.indexOf(v)===-1&&r.push(v),a)}function Kw(a,r,h,d,v){switch(r){case"focusin":return Uc=sg(Uc,a,r,h,d,v),!0;case"dragenter":return zc=sg(zc,a,r,h,d,v),!0;case"mouseover":return Bc=sg(Bc,a,r,h,d,v),!0;case"pointerover":var S=v.pointerId;return ng.set(S,sg(ng.get(S)||null,a,r,h,d,v)),!0;case"gotpointercapture":return S=v.pointerId,ig.set(S,sg(ig.get(S)||null,a,r,h,d,v)),!0}return!1}function M4(a){var r=Er(a.target);if(r!==null){var h=l(r);if(h!==null){if(r=h.tag,r===13){if(r=c(h),r!==null){a.blockedOn=r,Ar(a.priority,function(){D4(h)});return}}else if(r===31){if(r=f(h),r!==null){a.blockedOn=r,Ar(a.priority,function(){D4(h)});return}}else if(r===3&&h.stateNode.current.memoizedState.isDehydrated){a.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}a.blockedOn=null}function iy(a){if(a.blockedOn!==null)return!1;for(var r=a.targetContainers;0<r.length;){var h=Xv(a.nativeEvent);if(h===null){h=a.nativeEvent;var d=new h.constructor(h.type,h);Ho=d,h.target.dispatchEvent(d),Ho=null}else return r=Sr(h),r!==null&&N4(r),a.blockedOn=h,!1;r.shift()}return!0}function L4(a,r,h){iy(a)&&h.delete(r)}function Ww(){Wv=!1,Uc!==null&&iy(Uc)&&(Uc=null),zc!==null&&iy(zc)&&(zc=null),Bc!==null&&iy(Bc)&&(Bc=null),ng.forEach(L4),ig.forEach(L4)}function sy(a,r){a.blockedOn===r&&(a.blockedOn=null,Wv||(Wv=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Ww)))}var ay=null;function k4(a){ay!==a&&(ay=a,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){ay===a&&(ay=null);for(var r=0;r<a.length;r+=3){var h=a[r],d=a[r+1],v=a[r+2];if(typeof d!="function"){if(Kv(d||h)===null)continue;break}var S=Sr(h);S!==null&&(a.splice(r,3),r-=3,Op(S,{pending:!0,data:v,method:h.method,action:d},d,v))}}))}function Yd(a){function r(J){return sy(J,a)}Uc!==null&&sy(Uc,a),zc!==null&&sy(zc,a),Bc!==null&&sy(Bc,a),ng.forEach(r),ig.forEach(r);for(var h=0;h<jc.length;h++){var d=jc[h];d.blockedOn===a&&(d.blockedOn=null)}for(;0<jc.length&&(h=jc[0],h.blockedOn===null);)M4(h),h.blockedOn===null&&jc.shift();if(h=(a.ownerDocument||a).$$reactFormReplay,h!=null)for(d=0;d<h.length;d+=3){var v=h[d],S=h[d+1],N=v[mi]||null;if(typeof S=="function")N||k4(h);else if(N){var U=null;if(S&&S.hasAttribute("formAction")){if(v=S,N=S[mi]||null)U=N.formAction;else if(Kv(v)!==null)continue}else U=N.action;typeof U=="function"?h[d+1]=U:(h.splice(d,3),d-=3),k4(h)}}}function P4(){function a(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(N){return v=N})},focusReset:"manual",scroll:"manual"})}function r(){v!==null&&(v(),v=null),d||setTimeout(h,20)}function h(){if(!d&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var d=!1,v=null;return navigation.addEventListener("navigate",a),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(h,100),function(){d=!0,navigation.removeEventListener("navigate",a),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),v!==null&&(v(),v=null)}}}function Jv(a){this._internalRoot=a}ry.prototype.render=Jv.prototype.render=function(a){var r=this._internalRoot;if(r===null)throw Error(i(409));var h=r.current,d=ga();R4(h,d,a,r,null,null)},ry.prototype.unmount=Jv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var r=a.containerInfo;R4(a.current,2,null,a,null,null),fr(),r[va]=null}};function ry(a){this._internalRoot=a}ry.prototype.unstable_scheduleHydration=function(a){if(a){var r=tr();a={blockedOn:null,target:a,priority:r};for(var h=0;h<jc.length&&r!==0&&r<jc[h].priority;h++);jc.splice(h,0,a),h===0&&M4(a)}};var V4=t.version;if(V4!=="19.2.4")throw Error(i(527,V4,"19.2.4"));At.findDOMNode=function(a){var r=a._reactInternals;if(r===void 0)throw typeof a.render=="function"?Error(i(188)):(a=Object.keys(a).join(","),Error(i(268,a)));return a=g(r),a=a!==null?A(a):null,a=a===null?null:a.stateNode,a};var Jw={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:tt,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ly=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ly.isDisabled&&ly.supportsFiber)try{Ja=ly.inject(Jw),di=ly}catch{}}return rg.createRoot=function(a,r){if(!s(a))throw Error(i(299));var h=!1,d="",v=U_,S=Up,N=zp;return r!=null&&(r.unstable_strictMode===!0&&(h=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onUncaughtError!==void 0&&(v=r.onUncaughtError),r.onCaughtError!==void 0&&(S=r.onCaughtError),r.onRecoverableError!==void 0&&(N=r.onRecoverableError)),r=C4(a,1,!1,null,null,h,d,null,v,S,N,P4),a[va]=r.current,Ov(a),new Jv(r)},rg.hydrateRoot=function(a,r,h){if(!s(a))throw Error(i(299));var d=!1,v="",S=U_,N=Up,U=zp,J=null;return h!=null&&(h.unstable_strictMode===!0&&(d=!0),h.identifierPrefix!==void 0&&(v=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(N=h.onCaughtError),h.onRecoverableError!==void 0&&(U=h.onRecoverableError),h.formState!==void 0&&(J=h.formState)),r=C4(a,1,!0,r,h??null,d,v,J,S,N,U,P4),r.context=w4(null),h=r.current,d=ga(),d=Fl(d),v=El(d),v.callback=null,uo(h,v,d),h=d,r.current.lanes=h,ts(r,h),Rt(r),a[va]=r.current,Ov(a),new ry(r)},rg.version="19.2.4",rg}var Q4;function rR(){if(Q4)return t2.exports;Q4=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),t2.exports=aR(),t2.exports}var lR=rR();var X4="popstate";function oR(n={}){function t(i,s){let{pathname:l,search:c,hash:f}=i.location;return F2("",{pathname:l,search:c,hash:f},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function e(i,s){return typeof s=="string"?s:Qg(s)}return cR(t,e,null,n)}function Zn(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function Vl(n,t){if(!n){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function uR(){return Math.random().toString(36).substring(2,10)}function K4(n,t){return{usr:n.state,key:n.key,idx:t}}function F2(n,t,e=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof t=="string"?Im(t):t,state:e,key:t&&t.key||i||uR()}}function Qg({pathname:n="/",search:t="",hash:e=""}){return t&&t!=="?"&&(n+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(n+=e.charAt(0)==="#"?e:"#"+e),n}function Im(n){let t={};if(n){let e=n.indexOf("#");e>=0&&(t.hash=n.substring(e),n=n.substring(0,e));let i=n.indexOf("?");i>=0&&(t.search=n.substring(i),n=n.substring(0,i)),n&&(t.pathname=n)}return t}function cR(n,t,e,i={}){let{window:s=document.defaultView,v5Compat:l=!1}=i,c=s.history,f="POP",m=null,g=A();g==null&&(g=0,c.replaceState({...c.state,idx:g},""));function A(){return(c.state||{idx:null}).idx}function E(){f="POP";let M=A(),H=M==null?null:M-g;g=M,m&&m({action:f,location:O.location,delta:H})}function T(M,H){f="PUSH";let B=F2(O.location,M,H);g=A()+1;let Y=K4(B,g),$=O.createHref(B);try{c.pushState(Y,"",$)}catch(nt){if(nt instanceof DOMException&&nt.name==="DataCloneError")throw nt;s.location.assign($)}l&&m&&m({action:f,location:O.location,delta:1})}function x(M,H){f="REPLACE";let B=F2(O.location,M,H);g=A();let Y=K4(B,g),$=O.createHref(B);c.replaceState(Y,"",$),l&&m&&m({action:f,location:O.location,delta:0})}function R(M){return hR(M)}let O={get action(){return f},get location(){return n(s,c)},listen(M){if(m)throw new Error("A history only accepts one active listener");return s.addEventListener(X4,E),m=M,()=>{s.removeEventListener(X4,E),m=null}},createHref(M){return t(s,M)},createURL:R,encodeLocation(M){let H=R(M);return{pathname:H.pathname,search:H.search,hash:H.hash}},push:T,replace:x,go(M){return c.go(M)}};return O}function hR(n,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Zn(e,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:Qg(n);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function uC(n,t,e="/"){return fR(n,t,e,!1)}function fR(n,t,e,i){let s=typeof t=="string"?Im(t):t,l=Iu(s.pathname||"/",e);if(l==null)return null;let c=cC(n);dR(c);let f=null;for(let m=0;f==null&&m<c.length;++m){let g=bR(l);f=SR(c[m],g,i)}return f}function cC(n,t=[],e=[],i="",s=!1){let l=(c,f,m=s,g)=>{let A={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:f,route:c};if(A.relativePath.startsWith("/")){if(!A.relativePath.startsWith(i)&&m)return;Zn(A.relativePath.startsWith(i),`Absolute route path "${A.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),A.relativePath=A.relativePath.slice(i.length)}let E=wu([i,A.relativePath]),T=e.concat(A);c.children&&c.children.length>0&&(Zn(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${E}".`),cC(c.children,t,T,E,m)),!(c.path==null&&!c.index)&&t.push({path:E,score:AR(E,c.index),routesMeta:T})};return n.forEach((c,f)=>{if(c.path===""||!c.path?.includes("?"))l(c,f);else for(let m of hC(c.path))l(c,f,!0,m)}),t}function hC(n){let t=n.split("/");if(t.length===0)return[];let[e,...i]=t,s=e.endsWith("?"),l=e.replace(/\?$/,"");if(i.length===0)return s?[l,""]:[l];let c=hC(i.join("/")),f=[];return f.push(...c.map(m=>m===""?l:[l,m].join("/"))),s&&f.push(...c),f.map(m=>n.startsWith("/")&&m===""?"/":m)}function dR(n){n.sort((t,e)=>t.score!==e.score?e.score-t.score:ER(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var mR=/^:[\w-]+$/,pR=3,gR=2,_R=1,yR=10,vR=-2,W4=n=>n==="*";function AR(n,t){let e=n.split("/"),i=e.length;return e.some(W4)&&(i+=vR),t&&(i+=gR),e.filter(s=>!W4(s)).reduce((s,l)=>s+(mR.test(l)?pR:l===""?_R:yR),i)}function ER(n,t){return n.length===t.length&&n.slice(0,-1).every((i,s)=>i===t[s])?n[n.length-1]-t[t.length-1]:0}function SR(n,t,e=!1){let{routesMeta:i}=n,s={},l="/",c=[];for(let f=0;f<i.length;++f){let m=i[f],g=f===i.length-1,A=l==="/"?t:t.slice(l.length)||"/",E=Gy({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},A),T=m.route;if(!E&&g&&e&&!i[i.length-1].route.index&&(E=Gy({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},A)),!E)return null;Object.assign(s,E.params),c.push({params:s,pathname:wu([l,E.pathname]),pathnameBase:xR(wu([l,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(l=wu([l,E.pathnameBase]))}return c}function Gy(n,t){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[e,i]=TR(n.path,n.caseSensitive,n.end),s=t.match(e);if(!s)return null;let l=s[0],c=l.replace(/(.)\/+$/,"$1"),f=s.slice(1);return{params:i.reduce((g,{paramName:A,isOptional:E},T)=>{if(A==="*"){let R=f[T]||"";c=l.slice(0,l.length-R.length).replace(/(.)\/+$/,"$1")}const x=f[T];return E&&!x?g[A]=void 0:g[A]=(x||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:c,pattern:n}}function TR(n,t=!1,e=!0){Vl(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,f,m)=>(i.push({paramName:f,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),i]}function bR(n){try{return n.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Vl(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),n}}function Iu(n,t){if(t==="/")return n;if(!n.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=n.charAt(e);return i&&i!=="/"?null:n.slice(e)||"/"}var CR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function wR(n,t="/"){let{pathname:e,search:i="",hash:s=""}=typeof n=="string"?Im(n):n,l;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?l=J4(e.substring(1),"/"):l=J4(e,t)):l=t,{pathname:l,search:NR(i),hash:DR(s)}}function J4(n,t){let e=t.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?e.length>1&&e.pop():s!=="."&&e.push(s)}),e.length>1?e.join("/"):"/"}function s2(n,t,e,i){return`Cannot include a '${n}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function RR(n){return n.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function $A(n){let t=RR(n);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function tE(n,t,e,i=!1){let s;typeof n=="string"?s=Im(n):(s={...n},Zn(!s.pathname||!s.pathname.includes("?"),s2("?","pathname","search",s)),Zn(!s.pathname||!s.pathname.includes("#"),s2("#","pathname","hash",s)),Zn(!s.search||!s.search.includes("#"),s2("#","search","hash",s)));let l=n===""||s.pathname==="",c=l?"/":s.pathname,f;if(c==null)f=e;else{let E=t.length-1;if(!i&&c.startsWith("..")){let T=c.split("/");for(;T[0]==="..";)T.shift(),E-=1;s.pathname=T.join("/")}f=E>=0?t[E]:"/"}let m=wR(s,f),g=c&&c!=="/"&&c.endsWith("/"),A=(l||c===".")&&e.endsWith("/");return!m.pathname.endsWith("/")&&(g||A)&&(m.pathname+="/"),m}var wu=n=>n.join("/").replace(/\/\/+/g,"/"),xR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),NR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,DR=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n,IR=class{constructor(n,t,e,i=!1){this.status=n,this.statusText=t||"",this.internal=i,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function OR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function MR(n){return n.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var fC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function dC(n,t){let e=n;if(typeof e!="string"||!CR.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let i=e,s=!1;if(fC)try{let l=new URL(window.location.href),c=e.startsWith("//")?new URL(l.protocol+e):new URL(e),f=Iu(c.pathname,t);c.origin===l.origin&&f!=null?e=f+c.search+c.hash:s=!0}catch{Vl(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:s,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var mC=["POST","PUT","PATCH","DELETE"];new Set(mC);var LR=["GET",...mC];new Set(LR);var Om=j.createContext(null);Om.displayName="DataRouter";var I1=j.createContext(null);I1.displayName="DataRouterState";var kR=j.createContext(!1),pC=j.createContext({isTransitioning:!1});pC.displayName="ViewTransition";var PR=j.createContext(new Map);PR.displayName="Fetchers";var VR=j.createContext(null);VR.displayName="Await";var yr=j.createContext(null);yr.displayName="Navigation";var m0=j.createContext(null);m0.displayName="Location";var Bl=j.createContext({outlet:null,matches:[],isDataRoute:!1});Bl.displayName="Route";var eE=j.createContext(null);eE.displayName="RouteError";var gC="REACT_ROUTER_ERROR",UR="REDIRECT",zR="ROUTE_ERROR_RESPONSE";function BR(n){if(n.startsWith(`${gC}:${UR}:{`))try{let t=JSON.parse(n.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function jR(n){if(n.startsWith(`${gC}:${zR}:{`))try{let t=JSON.parse(n.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new IR(t.status,t.statusText,t.data)}catch{}}function HR(n,{relative:t}={}){Zn(Mm(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=j.useContext(yr),{hash:s,pathname:l,search:c}=p0(n,{relative:t}),f=l;return e!=="/"&&(f=l==="/"?e:wu([e,l])),i.createHref({pathname:f,search:c,hash:s})}function Mm(){return j.useContext(m0)!=null}function Lo(){return Zn(Mm(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(m0).location}var _C="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yC(n){j.useContext(yr).static||j.useLayoutEffect(n)}function zf(){let{isDataRoute:n}=j.useContext(Bl);return n?n7():GR()}function GR(){Zn(Mm(),"useNavigate() may be used only in the context of a <Router> component.");let n=j.useContext(Om),{basename:t,navigator:e}=j.useContext(yr),{matches:i}=j.useContext(Bl),{pathname:s}=Lo(),l=JSON.stringify($A(i)),c=j.useRef(!1);return yC(()=>{c.current=!0}),j.useCallback((m,g={})=>{if(Vl(c.current,_C),!c.current)return;if(typeof m=="number"){e.go(m);return}let A=tE(m,JSON.parse(l),s,g.relative==="path");n==null&&t!=="/"&&(A.pathname=A.pathname==="/"?t:wu([t,A.pathname])),(g.replace?e.replace:e.push)(A,g.state,g)},[t,e,l,s,n])}j.createContext(null);function qR(){let{matches:n}=j.useContext(Bl),t=n[n.length-1];return t?t.params:{}}function p0(n,{relative:t}={}){let{matches:e}=j.useContext(Bl),{pathname:i}=Lo(),s=JSON.stringify($A(e));return j.useMemo(()=>tE(n,JSON.parse(s),i,t==="path"),[n,s,i,t])}function FR(n,t){return vC(n,t)}function vC(n,t,e,i,s){Zn(Mm(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=j.useContext(yr),{matches:c}=j.useContext(Bl),f=c[c.length-1],m=f?f.params:{},g=f?f.pathname:"/",A=f?f.pathnameBase:"/",E=f&&f.route;{let B=E&&E.path||"";EC(g,!E||B.endsWith("*")||B.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${B}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${B}"> to <Route path="${B==="/"?"*":`${B}/*`}">.`)}let T=Lo(),x;if(t){let B=typeof t=="string"?Im(t):t;Zn(A==="/"||B.pathname?.startsWith(A),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${A}" but pathname "${B.pathname}" was given in the \`location\` prop.`),x=B}else x=T;let R=x.pathname||"/",O=R;if(A!=="/"){let B=A.replace(/^\//,"").split("/");O="/"+R.replace(/^\//,"").split("/").slice(B.length).join("/")}let M=uC(n,{pathname:O});Vl(E||M!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Vl(M==null||M[M.length-1].route.element!==void 0||M[M.length-1].route.Component!==void 0||M[M.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let H=WR(M&&M.map(B=>Object.assign({},B,{params:Object.assign({},m,B.params),pathname:wu([A,l.encodeLocation?l.encodeLocation(B.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?A:wu([A,l.encodeLocation?l.encodeLocation(B.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:B.pathnameBase])})),c,e,i,s);return t&&H?j.createElement(m0.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},H):H}function YR(){let n=e7(),t=OR(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),e=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",n),c=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:l},"ErrorBoundary")," or"," ",j.createElement("code",{style:l},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},t),e?j.createElement("pre",{style:s},e):null,c)}var QR=j.createElement(YR,null),AC=class extends j.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,t){return t.location!==n.location||t.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:t.error,location:t.location,revalidation:n.revalidation||t.revalidation}}componentDidCatch(n,t){this.props.onError?this.props.onError(n,t):console.error("React Router caught the following error during render",n)}render(){let n=this.state.error;if(this.context&&typeof n=="object"&&n&&"digest"in n&&typeof n.digest=="string"){const e=jR(n.digest);e&&(n=e)}let t=n!==void 0?j.createElement(Bl.Provider,{value:this.props.routeContext},j.createElement(eE.Provider,{value:n,children:this.props.component})):this.props.children;return this.context?j.createElement(XR,{error:n},t):t}};AC.contextType=kR;var a2=new WeakMap;function XR({children:n,error:t}){let{basename:e}=j.useContext(yr);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=BR(t.digest);if(i){let s=a2.get(t);if(s)throw s;let l=dC(i.location,e);if(fC&&!a2.get(t))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw a2.set(t,c),c}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return n}function KR({routeContext:n,match:t,children:e}){let i=j.useContext(Om);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),j.createElement(Bl.Provider,{value:n},e)}function WR(n,t=[],e=null,i=null,s=null){if(n==null){if(!e)return null;if(e.errors)n=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)n=e.matches;else return null}let l=n,c=e?.errors;if(c!=null){let A=l.findIndex(E=>E.route.id&&c?.[E.route.id]!==void 0);Zn(A>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,A+1))}let f=!1,m=-1;if(e)for(let A=0;A<l.length;A++){let E=l[A];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(m=A),E.route.id){let{loaderData:T,errors:x}=e,R=E.route.loader&&!T.hasOwnProperty(E.route.id)&&(!x||x[E.route.id]===void 0);if(E.route.lazy||R){f=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}let g=e&&i?(A,E)=>{i(A,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:MR(e.matches),errorInfo:E})}:void 0;return l.reduceRight((A,E,T)=>{let x,R=!1,O=null,M=null;e&&(x=c&&E.route.id?c[E.route.id]:void 0,O=E.route.errorElement||QR,f&&(m<0&&T===0?(EC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,M=null):m===T&&(R=!0,M=E.route.hydrateFallbackElement||null)));let H=t.concat(l.slice(0,T+1)),B=()=>{let Y;return x?Y=O:R?Y=M:E.route.Component?Y=j.createElement(E.route.Component,null):E.route.element?Y=E.route.element:Y=A,j.createElement(KR,{match:E,routeContext:{outlet:A,matches:H,isDataRoute:e!=null},children:Y})};return e&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?j.createElement(AC,{location:e.location,revalidation:e.revalidation,component:O,error:x,children:B(),routeContext:{outlet:null,matches:H,isDataRoute:!0},onError:g}):B()},null)}function nE(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function JR(n){let t=j.useContext(Om);return Zn(t,nE(n)),t}function ZR(n){let t=j.useContext(I1);return Zn(t,nE(n)),t}function $R(n){let t=j.useContext(Bl);return Zn(t,nE(n)),t}function iE(n){let t=$R(n),e=t.matches[t.matches.length-1];return Zn(e.route.id,`${n} can only be used on routes that contain a unique "id"`),e.route.id}function t7(){return iE("useRouteId")}function e7(){let n=j.useContext(eE),t=ZR("useRouteError"),e=iE("useRouteError");return n!==void 0?n:t.errors?.[e]}function n7(){let{router:n}=JR("useNavigate"),t=iE("useNavigate"),e=j.useRef(!1);return yC(()=>{e.current=!0}),j.useCallback(async(s,l={})=>{Vl(e.current,_C),e.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:t,...l}))},[n,t])}var Z4={};function EC(n,t,e){!t&&!Z4[n]&&(Z4[n]=!0,Vl(!1,e))}j.memo(i7);function i7({routes:n,future:t,state:e,onError:i}){return vC(n,void 0,e,i,t)}function SC({to:n,replace:t,state:e,relative:i}){Zn(Mm(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=j.useContext(yr);Vl(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=j.useContext(Bl),{pathname:c}=Lo(),f=zf(),m=tE(n,$A(l),c,i==="path"),g=JSON.stringify(m);return j.useEffect(()=>{f(JSON.parse(g),{replace:t,state:e,relative:i})},[f,g,i,t,e]),null}function Jd(n){Zn(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function s7({basename:n="/",children:t=null,location:e,navigationType:i="POP",navigator:s,static:l=!1,unstable_useTransitions:c}){Zn(!Mm(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let f=n.replace(/^\/*/,"/"),m=j.useMemo(()=>({basename:f,navigator:s,static:l,unstable_useTransitions:c,future:{}}),[f,s,l,c]);typeof e=="string"&&(e=Im(e));let{pathname:g="/",search:A="",hash:E="",state:T=null,key:x="default"}=e,R=j.useMemo(()=>{let O=Iu(g,f);return O==null?null:{location:{pathname:O,search:A,hash:E,state:T,key:x},navigationType:i}},[f,g,A,E,T,x,i]);return Vl(R!=null,`<Router basename="${f}"> is not able to match the URL "${g}${A}${E}" because it does not start with the basename, so the <Router> won't render anything.`),R==null?null:j.createElement(yr.Provider,{value:m},j.createElement(m0.Provider,{children:t,value:R}))}function a7({children:n,location:t}){return FR(Y2(n),t)}function Y2(n,t=[]){let e=[];return j.Children.forEach(n,(i,s)=>{if(!j.isValidElement(i))return;let l=[...t,s];if(i.type===j.Fragment){e.push.apply(e,Y2(i.props.children,l));return}Zn(i.type===Jd,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Zn(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Y2(i.props.children,l)),e.push(c)}),e}var Ny="get",Dy="application/x-www-form-urlencoded";function O1(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function r7(n){return O1(n)&&n.tagName.toLowerCase()==="button"}function l7(n){return O1(n)&&n.tagName.toLowerCase()==="form"}function o7(n){return O1(n)&&n.tagName.toLowerCase()==="input"}function u7(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function c7(n,t){return n.button===0&&(!t||t==="_self")&&!u7(n)}var oy=null;function h7(){if(oy===null)try{new FormData(document.createElement("form"),0),oy=!1}catch{oy=!0}return oy}var f7=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function r2(n){return n!=null&&!f7.has(n)?(Vl(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Dy}"`),null):n}function d7(n,t){let e,i,s,l,c;if(l7(n)){let f=n.getAttribute("action");i=f?Iu(f,t):null,e=n.getAttribute("method")||Ny,s=r2(n.getAttribute("enctype"))||Dy,l=new FormData(n)}else if(r7(n)||o7(n)&&(n.type==="submit"||n.type==="image")){let f=n.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=n.getAttribute("formaction")||f.getAttribute("action");if(i=m?Iu(m,t):null,e=n.getAttribute("formmethod")||f.getAttribute("method")||Ny,s=r2(n.getAttribute("formenctype"))||r2(f.getAttribute("enctype"))||Dy,l=new FormData(f,n),!h7()){let{name:g,type:A,value:E}=n;if(A==="image"){let T=g?`${g}.`:"";l.append(`${T}x`,"0"),l.append(`${T}y`,"0")}else g&&l.append(g,E)}}else{if(O1(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Ny,i=null,s=Dy,c=n}return l&&s==="text/plain"&&(c=l,l=void 0),{action:i,method:e.toLowerCase(),encType:s,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function sE(n,t){if(n===!1||n===null||typeof n>"u")throw new Error(t)}function m7(n,t,e,i){let s=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e?s.pathname.endsWith("/")?s.pathname=`${s.pathname}_.${i}`:s.pathname=`${s.pathname}.${i}`:s.pathname==="/"?s.pathname=`_root.${i}`:t&&Iu(s.pathname,t)==="/"?s.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${i}`,s}async function p7(n,t){if(n.id in t)return t[n.id];try{let e=await import(n.module);return t[n.id]=e,e}catch(e){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function g7(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function _7(n,t,e){let i=await Promise.all(n.map(async s=>{let l=t.routes[s.route.id];if(l){let c=await p7(l,e);return c.links?c.links():[]}return[]}));return E7(i.flat(1).filter(g7).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function $4(n,t,e,i,s,l){let c=(m,g)=>e[g]?m.route.id!==e[g].route.id:!0,f=(m,g)=>e[g].pathname!==m.pathname||e[g].route.path?.endsWith("*")&&e[g].params["*"]!==m.params["*"];return l==="assets"?t.filter((m,g)=>c(m,g)||f(m,g)):l==="data"?t.filter((m,g)=>{let A=i.routes[m.route.id];if(!A||!A.hasLoader)return!1;if(c(m,g)||f(m,g))return!0;if(m.route.shouldRevalidate){let E=m.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof E=="boolean")return E}return!0}):[]}function y7(n,t,{includeHydrateFallback:e}={}){return v7(n.map(i=>{let s=t.routes[i.route.id];if(!s)return[];let l=[s.module];return s.clientActionModule&&(l=l.concat(s.clientActionModule)),s.clientLoaderModule&&(l=l.concat(s.clientLoaderModule)),e&&s.hydrateFallbackModule&&(l=l.concat(s.hydrateFallbackModule)),s.imports&&(l=l.concat(s.imports)),l}).flat(1))}function v7(n){return[...new Set(n)]}function A7(n){let t={},e=Object.keys(n).sort();for(let i of e)t[i]=n[i];return t}function E7(n,t){let e=new Set;return new Set(t),n.reduce((i,s)=>{let l=JSON.stringify(A7(s));return e.has(l)||(e.add(l),i.push({key:l,link:s})),i},[])}function TC(){let n=j.useContext(Om);return sE(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function S7(){let n=j.useContext(I1);return sE(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var aE=j.createContext(void 0);aE.displayName="FrameworkContext";function bC(){let n=j.useContext(aE);return sE(n,"You must render this element inside a <HydratedRouter> element"),n}function T7(n,t){let e=j.useContext(aE),[i,s]=j.useState(!1),[l,c]=j.useState(!1),{onFocus:f,onBlur:m,onMouseEnter:g,onMouseLeave:A,onTouchStart:E}=t,T=j.useRef(null);j.useEffect(()=>{if(n==="render"&&c(!0),n==="viewport"){let O=H=>{H.forEach(B=>{c(B.isIntersecting)})},M=new IntersectionObserver(O,{threshold:.5});return T.current&&M.observe(T.current),()=>{M.disconnect()}}},[n]),j.useEffect(()=>{if(i){let O=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(O)}}},[i]);let x=()=>{s(!0)},R=()=>{s(!1),c(!1)};return e?n!=="intent"?[l,T,{}]:[l,T,{onFocus:lg(f,x),onBlur:lg(m,R),onMouseEnter:lg(g,x),onMouseLeave:lg(A,R),onTouchStart:lg(E,x)}]:[!1,T,{}]}function lg(n,t){return e=>{n&&n(e),e.defaultPrevented||t(e)}}function b7({page:n,...t}){let{router:e}=TC(),i=j.useMemo(()=>uC(e.routes,n,e.basename),[e.routes,n,e.basename]);return i?j.createElement(w7,{page:n,matches:i,...t}):null}function C7(n){let{manifest:t,routeModules:e}=bC(),[i,s]=j.useState([]);return j.useEffect(()=>{let l=!1;return _7(n,t,e).then(c=>{l||s(c)}),()=>{l=!0}},[n,t,e]),i}function w7({page:n,matches:t,...e}){let i=Lo(),{future:s,manifest:l,routeModules:c}=bC(),{basename:f}=TC(),{loaderData:m,matches:g}=S7(),A=j.useMemo(()=>$4(n,t,g,l,i,"data"),[n,t,g,l,i]),E=j.useMemo(()=>$4(n,t,g,l,i,"assets"),[n,t,g,l,i]),T=j.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let O=new Set,M=!1;if(t.forEach(B=>{let Y=l.routes[B.route.id];!Y||!Y.hasLoader||(!A.some($=>$.route.id===B.route.id)&&B.route.id in m&&c[B.route.id]?.shouldRevalidate||Y.hasClientLoader?M=!0:O.add(B.route.id))}),O.size===0)return[];let H=m7(n,f,s.unstable_trailingSlashAwareDataRequests,"data");return M&&O.size>0&&H.searchParams.set("_routes",t.filter(B=>O.has(B.route.id)).map(B=>B.route.id).join(",")),[H.pathname+H.search]},[f,s.unstable_trailingSlashAwareDataRequests,m,i,l,A,t,n,c]),x=j.useMemo(()=>y7(E,l),[E,l]),R=C7(E);return j.createElement(j.Fragment,null,T.map(O=>j.createElement("link",{key:O,rel:"prefetch",as:"fetch",href:O,...e})),x.map(O=>j.createElement("link",{key:O,rel:"modulepreload",href:O,...e})),R.map(({key:O,link:M})=>j.createElement("link",{key:O,nonce:e.nonce,...M,crossOrigin:M.crossOrigin??e.crossOrigin})))}function R7(...n){return t=>{n.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var x7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{x7&&(window.__reactRouterVersion="7.13.0")}catch{}function N7({basename:n,children:t,unstable_useTransitions:e,window:i}){let s=j.useRef();s.current==null&&(s.current=oR({window:i,v5Compat:!0}));let l=s.current,[c,f]=j.useState({action:l.action,location:l.location}),m=j.useCallback(g=>{e===!1?f(g):j.startTransition(()=>f(g))},[e]);return j.useLayoutEffect(()=>l.listen(m),[l,m]),j.createElement(s7,{basename:n,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:e})}var CC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rE=j.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:s,reloadDocument:l,replace:c,state:f,target:m,to:g,preventScrollReset:A,viewTransition:E,unstable_defaultShouldRevalidate:T,...x},R){let{basename:O,unstable_useTransitions:M}=j.useContext(yr),H=typeof g=="string"&&CC.test(g),B=dC(g,O);g=B.to;let Y=HR(g,{relative:s}),[$,nt,X]=T7(i,x),L=M7(g,{replace:c,state:f,target:m,preventScrollReset:A,relative:s,viewTransition:E,unstable_defaultShouldRevalidate:T,unstable_useTransitions:M});function k(q){t&&t(q),q.defaultPrevented||L(q)}let V=j.createElement("a",{...x,...X,href:B.absoluteURL||Y,onClick:B.isExternal||l?t:k,ref:R7(R,nt),target:m,"data-discover":!H&&e==="render"?"true":void 0});return $&&!H?j.createElement(j.Fragment,null,V,j.createElement(b7,{page:Y})):V});rE.displayName="Link";var D7=j.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:s=!1,style:l,to:c,viewTransition:f,children:m,...g},A){let E=p0(c,{relative:g.relative}),T=Lo(),x=j.useContext(I1),{navigator:R,basename:O}=j.useContext(yr),M=x!=null&&U7(E)&&f===!0,H=R.encodeLocation?R.encodeLocation(E).pathname:E.pathname,B=T.pathname,Y=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;e||(B=B.toLowerCase(),Y=Y?Y.toLowerCase():null,H=H.toLowerCase()),Y&&O&&(Y=Iu(Y,O)||Y);const $=H!=="/"&&H.endsWith("/")?H.length-1:H.length;let nt=B===H||!s&&B.startsWith(H)&&B.charAt($)==="/",X=Y!=null&&(Y===H||!s&&Y.startsWith(H)&&Y.charAt(H.length)==="/"),L={isActive:nt,isPending:X,isTransitioning:M},k=nt?t:void 0,V;typeof i=="function"?V=i(L):V=[i,nt?"active":null,X?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let q=typeof l=="function"?l(L):l;return j.createElement(rE,{...g,"aria-current":k,className:V,ref:A,style:q,to:c,viewTransition:f},typeof m=="function"?m(L):m)});D7.displayName="NavLink";var I7=j.forwardRef(({discover:n="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:s,state:l,method:c=Ny,action:f,onSubmit:m,relative:g,preventScrollReset:A,viewTransition:E,unstable_defaultShouldRevalidate:T,...x},R)=>{let{unstable_useTransitions:O}=j.useContext(yr),M=P7(),H=V7(f,{relative:g}),B=c.toLowerCase()==="get"?"get":"post",Y=typeof f=="string"&&CC.test(f),$=nt=>{if(m&&m(nt),nt.defaultPrevented)return;nt.preventDefault();let X=nt.nativeEvent.submitter,L=X?.getAttribute("formmethod")||c,k=()=>M(X||nt.currentTarget,{fetcherKey:t,method:L,navigate:e,replace:s,state:l,relative:g,preventScrollReset:A,viewTransition:E,unstable_defaultShouldRevalidate:T});O&&e!==!1?j.startTransition(()=>k()):k()};return j.createElement("form",{ref:R,method:B,action:H,onSubmit:i?m:$,...x,"data-discover":!Y&&n==="render"?"true":void 0})});I7.displayName="Form";function O7(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wC(n){let t=j.useContext(Om);return Zn(t,O7(n)),t}function M7(n,{target:t,replace:e,state:i,preventScrollReset:s,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:f,unstable_useTransitions:m}={}){let g=zf(),A=Lo(),E=p0(n,{relative:l});return j.useCallback(T=>{if(c7(T,t)){T.preventDefault();let x=e!==void 0?e:Qg(A)===Qg(E),R=()=>g(n,{replace:x,state:i,preventScrollReset:s,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:f});m?j.startTransition(()=>R()):R()}},[A,g,E,e,i,t,n,s,l,c,f,m])}var L7=0,k7=()=>`__${String(++L7)}__`;function P7(){let{router:n}=wC("useSubmit"),{basename:t}=j.useContext(yr),e=t7(),i=n.fetch,s=n.navigate;return j.useCallback(async(l,c={})=>{let{action:f,method:m,encType:g,formData:A,body:E}=d7(l,t);if(c.navigate===!1){let T=c.fetcherKey||k7();await i(T,e,c.action||f,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:A,body:E,formMethod:c.method||m,formEncType:c.encType||g,flushSync:c.flushSync})}else await s(c.action||f,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:A,body:E,formMethod:c.method||m,formEncType:c.encType||g,replace:c.replace,state:c.state,fromRouteId:e,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,s,t,e])}function V7(n,{relative:t}={}){let{basename:e}=j.useContext(yr),i=j.useContext(Bl);Zn(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),l={...p0(n||".",{relative:t})},c=Lo();if(n==null){l.search=c.search;let f=new URLSearchParams(l.search),m=f.getAll("index");if(m.some(A=>A==="")){f.delete("index"),m.filter(E=>E).forEach(E=>f.append("index",E));let A=f.toString();l.search=A?`?${A}`:""}}return(!n||n===".")&&s.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(l.pathname=l.pathname==="/"?e:wu([e,l.pathname])),Qg(l)}function U7(n,{relative:t}={}){let e=j.useContext(pC);Zn(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=wC("useViewTransitionState"),s=p0(n,{relative:t});if(!e.isTransitioning)return!1;let l=Iu(e.currentLocation.pathname,i)||e.currentLocation.pathname,c=Iu(e.nextLocation.pathname,i)||e.nextLocation.pathname;return Gy(s.pathname,c)!=null||Gy(s.pathname,l)!=null}const z7=()=>{};var tT={};const RC={NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};const zt=function(n,t){if(!n)throw Lm(t)},Lm=function(n){return new Error("Firebase Database ("+RC.SDK_VERSION+") INTERNAL ASSERT FAILED: "+n)};const xC=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},B7=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const l=n[e++];t[i++]=String.fromCharCode((s&31)<<6|l&63)}else if(s>239&&s<365){const l=n[e++],c=n[e++],f=n[e++],m=((s&7)<<18|(l&63)<<12|(c&63)<<6|f&63)-65536;t[i++]=String.fromCharCode(55296+(m>>10)),t[i++]=String.fromCharCode(56320+(m&1023))}else{const l=n[e++],c=n[e++];t[i++]=String.fromCharCode((s&15)<<12|(l&63)<<6|c&63)}}return t.join("")},lE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const l=n[s],c=s+1<n.length,f=c?n[s+1]:0,m=s+2<n.length,g=m?n[s+2]:0,A=l>>2,E=(l&3)<<4|f>>4;let T=(f&15)<<2|g>>6,x=g&63;m||(x=64,c||(T=64)),i.push(e[A],e[E],e[T],e[x])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(xC(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):B7(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const l=e[n.charAt(s++)],f=s<n.length?e[n.charAt(s)]:0;++s;const g=s<n.length?e[n.charAt(s)]:64;++s;const E=s<n.length?e[n.charAt(s)]:64;if(++s,l==null||f==null||g==null||E==null)throw new j7;const T=l<<2|f>>4;if(i.push(T),g!==64){const x=f<<4&240|g>>2;if(i.push(x),E!==64){const R=g<<6&192|E;i.push(R)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class j7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const NC=function(n){const t=xC(n);return lE.encodeByteArray(t,!0)},qy=function(n){return NC(n).replace(/\./g,"")},Fy=function(n){try{return lE.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function H7(n){return DC(void 0,n)}function DC(n,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:const e=t;return new Date(e.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return t}for(const e in t)!t.hasOwnProperty(e)||!G7(e)||(n[e]=DC(n[e],t[e]));return n}function G7(n){return n!=="__proto__"}function q7(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const F7=()=>q7().__FIREBASE_DEFAULTS__,Y7=()=>{if(typeof process>"u"||typeof tT>"u")return;const n=tT.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Q7=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Fy(n[1]);return t&&JSON.parse(t)},M1=()=>{try{return z7()||F7()||Y7()||Q7()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},IC=n=>{var t,e;return(e=(t=M1())===null||t===void 0?void 0:t.emulatorHosts)===null||e===void 0?void 0:e[n]},OC=n=>{const t=IC(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},MC=()=>{var n;return(n=M1())===null||n===void 0?void 0:n.config},LC=n=>{var t;return(t=M1())===null||t===void 0?void 0:t[`_${n}`]};class Su{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function ph(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function oE(n){return(await fetch(n,{credentials:"include"})).ok}function kC(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",s=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}}},n);return[qy(JSON.stringify(e)),qy(JSON.stringify(c)),""].join(".")}const Ig={};function X7(){const n={prod:[],emulator:[]};for(const t of Object.keys(Ig))Ig[t]?n.emulator.push(t):n.prod.push(t);return n}function K7(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let eT=!1;function uE(n,t){if(typeof window>"u"||typeof document>"u"||!ph(window.location.host)||Ig[n]===t||Ig[n]||eT)return;Ig[n]=t;function e(T){return`__firebase__banner__${T}`}const i="__firebase__banner",l=X7().prod.length>0;function c(){const T=document.getElementById(i);T&&T.remove()}function f(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function m(T,x){T.setAttribute("width","24"),T.setAttribute("id",x),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function g(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{eT=!0,c()},T}function A(T,x){T.setAttribute("id",x),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function E(){const T=K7(i),x=e("text"),R=document.getElementById(x)||document.createElement("span"),O=e("learnmore"),M=document.getElementById(O)||document.createElement("a"),H=e("preprendIcon"),B=document.getElementById(H)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const Y=T.element;f(Y),A(M,O);const $=g();m(B,H),Y.append(B,R,M,$),document.body.appendChild(Y)}l?(R.innerText="Preview backend disconnected.",B.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(B.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,R.innerText="Preview backend running in this workspace."),R.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",E):E()}function $s(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cE(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($s())}function W7(){var n;const t=(n=M1())===null||n===void 0?void 0:n.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function J7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Z7(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function PC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $7(){const n=$s();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function tx(){return RC.NODE_ADMIN===!0}function ex(){return!W7()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function nx(){try{return typeof indexedDB=="object"}catch{return!1}}function ix(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{var l;t(((l=s.error)===null||l===void 0?void 0:l.message)||"")}}catch(e){t(e)}})}const sx="FirebaseError";class ju extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=sx,Object.setPrototypeOf(this,ju.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,g0.prototype.create)}}class g0{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,l=this.errors[t],c=l?ax(l,i):"Error",f=`${this.serviceName}: ${c} (${s}).`;return new ju(s,f,i)}}function ax(n,t){return n.replace(rx,(e,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const rx=/\{\$([^}]+)}/g;function Xg(n){return JSON.parse(n)}function cs(n){return JSON.stringify(n)}const VC=function(n){let t={},e={},i={},s="";try{const l=n.split(".");t=Xg(Fy(l[0])||""),e=Xg(Fy(l[1])||""),s=l[2],i=e.d||{},delete e.d}catch{}return{header:t,claims:e,data:i,signature:s}},lx=function(n){const t=VC(n),e=t.claims;return!!e&&typeof e=="object"&&e.hasOwnProperty("iat")},ox=function(n){const t=VC(n).claims;return typeof t=="object"&&t.admin===!0};function ko(n,t){return Object.prototype.hasOwnProperty.call(n,t)}function dm(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]}function Yy(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function Qy(n,t,e){const i={};for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(i[s]=t.call(e,n[s],s,n));return i}function ah(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const l=n[s],c=t[s];if(nT(l)&&nT(c)){if(!ah(l,c))return!1}else if(l!==c)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function nT(n){return n!==null&&typeof n=="object"}function km(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function vg(n){const t={};return n.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[s,l]=i.split("=");t[decodeURIComponent(s)]=decodeURIComponent(l)}}),t}function Ag(n){const t=n.indexOf("?");if(!t)return"";const e=n.indexOf("#",t);return n.substring(t,e>0?e:void 0)}class ux{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const i=this.W_;if(typeof t=="string")for(let E=0;E<16;E++)i[E]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let E=0;E<16;E++)i[E]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let E=16;E<80;E++){const T=i[E-3]^i[E-8]^i[E-14]^i[E-16];i[E]=(T<<1|T>>>31)&4294967295}let s=this.chain_[0],l=this.chain_[1],c=this.chain_[2],f=this.chain_[3],m=this.chain_[4],g,A;for(let E=0;E<80;E++){E<40?E<20?(g=f^l&(c^f),A=1518500249):(g=l^c^f,A=1859775393):E<60?(g=l&c|f&(l|c),A=2400959708):(g=l^c^f,A=3395469782);const T=(s<<5|s>>>27)+g+m+A+i[E]&4294967295;m=f,f=c,c=(l<<30|l>>>2)&4294967295,l=s,s=T}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+m&4294967295}update(t,e){if(t==null)return;e===void 0&&(e=t.length);const i=e-this.blockSize;let s=0;const l=this.buf_;let c=this.inbuf_;for(;s<e;){if(c===0)for(;s<=i;)this.compress_(t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(l[c]=t.charCodeAt(s),++c,++s,c===this.blockSize){this.compress_(l),c=0;break}}else for(;s<e;)if(l[c]=t[s],++c,++s,c===this.blockSize){this.compress_(l),c=0;break}}this.inbuf_=c,this.total_+=e}digest(){const t=[];let e=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let s=this.blockSize-1;s>=56;s--)this.buf_[s]=e&255,e/=256;this.compress_(this.buf_);let i=0;for(let s=0;s<5;s++)for(let l=24;l>=0;l-=8)t[i]=this.chain_[s]>>l&255,++i;return t}}function cx(n,t){const e=new hx(n,t);return e.subscribe.bind(e)}class hx{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let s;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");fx(t,["next","error","complete"])?s=t:s={next:t,error:e,complete:i},s.next===void 0&&(s.next=l2),s.error===void 0&&(s.error=l2),s.complete===void 0&&(s.complete=l2);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),l}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fx(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function l2(){}function mm(n,t){return`${n} failed: ${t} argument `}const dx=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);if(s>=55296&&s<=56319){const l=s-55296;i++,zt(i<n.length,"Surrogate pair missing trail surrogate.");const c=n.charCodeAt(i)-56320;s=65536+(l<<10)+c}s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):s<65536?(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},L1=function(n){let t=0;for(let e=0;e<n.length;e++){const i=n.charCodeAt(e);i<128?t++:i<2048?t+=2:i>=55296&&i<=56319?(t+=4,e++):t+=3}return t};function On(n){return n&&n._delegate?n._delegate:n}class rh{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const bf="[DEFAULT]";class mx{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new Su;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const i=this.normalizeInstanceIdentifier(t?.identifier),s=(e=t?.optional)!==null&&e!==void 0?e:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(l){if(s)return null;throw l}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(gx(t))try{this.getOrInitializeService({instanceIdentifier:bf})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const l=this.getOrInitializeService({instanceIdentifier:s});i.resolve(l)}catch{}}}}clearInstance(t=bf){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=bf){return this.instances.has(t)}getOptions(t=bf){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[l,c]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(l);i===f&&c.resolve(s)}return s}onInit(t,e){var i;const s=this.normalizeInstanceIdentifier(e),l=(i=this.onInitCallbacks.get(s))!==null&&i!==void 0?i:new Set;l.add(t),this.onInitCallbacks.set(s,l);const c=this.instances.get(s);return c&&t(c,s),()=>{l.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:px(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=bf){return this.component?this.component.multipleInstances?t:bf:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function px(n){return n===bf?void 0:n}function gx(n){return n.instantiationMode==="EAGER"}class _x{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new mx(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var Ue;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ue||(Ue={}));const yx={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},vx=Ue.INFO,Ax={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},Ex=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=Ax[t];if(s)console[s](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class k1{constructor(t){this.name=t,this._logLevel=vx,this._logHandler=Ex,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in Ue))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?yx[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...t),this._logHandler(this,Ue.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...t),this._logHandler(this,Ue.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...t),this._logHandler(this,Ue.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...t),this._logHandler(this,Ue.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...t),this._logHandler(this,Ue.ERROR,...t)}}const Sx=(n,t)=>t.some(e=>n instanceof e);let iT,sT;function Tx(){return iT||(iT=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bx(){return sT||(sT=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const UC=new WeakMap,Q2=new WeakMap,zC=new WeakMap,o2=new WeakMap,hE=new WeakMap;function Cx(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{e(Zc(n.result)),s()},c=()=>{i(n.error),s()};n.addEventListener("success",l),n.addEventListener("error",c)});return t.then(e=>{e instanceof IDBCursor&&UC.set(e,n)}).catch(()=>{}),hE.set(t,n),t}function wx(n){if(Q2.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{e(),s()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Q2.set(n,t)}let X2={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Q2.get(n);if(t==="objectStoreNames")return n.objectStoreNames||zC.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return Zc(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function Rx(n){X2=n(X2)}function xx(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(u2(this),t,...e);return zC.set(i,t.sort?t.sort():[t]),Zc(i)}:bx().includes(n)?function(...t){return n.apply(u2(this),t),Zc(UC.get(this))}:function(...t){return Zc(n.apply(u2(this),t))}}function Nx(n){return typeof n=="function"?xx(n):(n instanceof IDBTransaction&&wx(n),Sx(n,Tx())?new Proxy(n,X2):n)}function Zc(n){if(n instanceof IDBRequest)return Cx(n);if(o2.has(n))return o2.get(n);const t=Nx(n);return t!==n&&(o2.set(n,t),hE.set(t,n)),t}const u2=n=>hE.get(n);function Dx(n,t,{blocked:e,upgrade:i,blocking:s,terminated:l}={}){const c=indexedDB.open(n,t),f=Zc(c);return i&&c.addEventListener("upgradeneeded",m=>{i(Zc(c.result),m.oldVersion,m.newVersion,Zc(c.transaction),m)}),e&&c.addEventListener("blocked",m=>e(m.oldVersion,m.newVersion,m)),f.then(m=>{l&&m.addEventListener("close",()=>l()),s&&m.addEventListener("versionchange",g=>s(g.oldVersion,g.newVersion,g))}).catch(()=>{}),f}const Ix=["get","getKey","getAll","getAllKeys","count"],Ox=["put","add","delete","clear"],c2=new Map;function aT(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(c2.get(t))return c2.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=Ox.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Ix.includes(e)))return;const l=async function(c,...f){const m=this.transaction(c,s?"readwrite":"readonly");let g=m.store;return i&&(g=g.index(f.shift())),(await Promise.all([g[e](...f),s&&m.done]))[0]};return c2.set(t,l),l}Rx(n=>({...n,get:(t,e,i)=>aT(t,e)||n.get(t,e,i),has:(t,e)=>!!aT(t,e)||n.has(t,e)}));class Mx{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Lx(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function Lx(n){const t=n.getComponent();return t?.type==="VERSION"}const K2="@firebase/app",rT="0.13.2";const Ou=new k1("@firebase/app"),kx="@firebase/app-compat",Px="@firebase/analytics-compat",Vx="@firebase/analytics",Ux="@firebase/app-check-compat",zx="@firebase/app-check",Bx="@firebase/auth",jx="@firebase/auth-compat",Hx="@firebase/database",Gx="@firebase/data-connect",qx="@firebase/database-compat",Fx="@firebase/functions",Yx="@firebase/functions-compat",Qx="@firebase/installations",Xx="@firebase/installations-compat",Kx="@firebase/messaging",Wx="@firebase/messaging-compat",Jx="@firebase/performance",Zx="@firebase/performance-compat",$x="@firebase/remote-config",tN="@firebase/remote-config-compat",eN="@firebase/storage",nN="@firebase/storage-compat",iN="@firebase/firestore",sN="@firebase/ai",aN="@firebase/firestore-compat",rN="firebase",lN="11.10.0";const W2="[DEFAULT]",oN={[K2]:"fire-core",[kx]:"fire-core-compat",[Vx]:"fire-analytics",[Px]:"fire-analytics-compat",[zx]:"fire-app-check",[Ux]:"fire-app-check-compat",[Bx]:"fire-auth",[jx]:"fire-auth-compat",[Hx]:"fire-rtdb",[Gx]:"fire-data-connect",[qx]:"fire-rtdb-compat",[Fx]:"fire-fn",[Yx]:"fire-fn-compat",[Qx]:"fire-iid",[Xx]:"fire-iid-compat",[Kx]:"fire-fcm",[Wx]:"fire-fcm-compat",[Jx]:"fire-perf",[Zx]:"fire-perf-compat",[$x]:"fire-rc",[tN]:"fire-rc-compat",[eN]:"fire-gcs",[nN]:"fire-gcs-compat",[iN]:"fire-fst",[aN]:"fire-fst-compat",[sN]:"fire-vertex","fire-js":"fire-js",[rN]:"fire-js-all"};const Xy=new Map,uN=new Map,J2=new Map;function lT(n,t){try{n.container.addComponent(t)}catch(e){Ou.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function Df(n){const t=n.name;if(J2.has(t))return Ou.debug(`There were multiple attempts to register component ${t}.`),!1;J2.set(t,n);for(const e of Xy.values())lT(e,n);for(const e of uN.values())lT(e,n);return!0}function P1(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function dr(n){return n==null?!1:n.settings!==void 0}const cN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$c=new g0("app","Firebase",cN);class hN{constructor(t,e,i){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new rh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw $c.create("app-deleted",{appName:this._name})}}const Bf=lN;function BC(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i=Object.assign({name:W2,automaticDataCollectionEnabled:!0},t),s=i.name;if(typeof s!="string"||!s)throw $c.create("bad-app-name",{appName:String(s)});if(e||(e=MC()),!e)throw $c.create("no-options");const l=Xy.get(s);if(l){if(ah(e,l.options)&&ah(i,l.config))return l;throw $c.create("duplicate-app",{appName:s})}const c=new _x(s);for(const m of J2.values())c.addComponent(m);const f=new hN(e,i,c);return Xy.set(s,f),f}function fE(n=W2){const t=Xy.get(n);if(!t&&n===W2&&MC())return BC();if(!t)throw $c.create("no-app",{appName:n});return t}function Ro(n,t,e){var i;let s=(i=oN[n])!==null&&i!==void 0?i:n;e&&(s+=`-${e}`);const l=s.match(/\s|\//),c=t.match(/\s|\//);if(l||c){const f=[`Unable to register library "${s}" with version "${t}":`];l&&f.push(`library name "${s}" contains illegal characters (whitespace or "/")`),l&&c&&f.push("and"),c&&f.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Ou.warn(f.join(" "));return}Df(new rh(`${s}-version`,()=>({library:s,version:t}),"VERSION"))}const fN="firebase-heartbeat-database",dN=1,Kg="firebase-heartbeat-store";let h2=null;function jC(){return h2||(h2=Dx(fN,dN,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Kg)}catch(e){console.warn(e)}}}}).catch(n=>{throw $c.create("idb-open",{originalErrorMessage:n.message})})),h2}async function mN(n){try{const e=(await jC()).transaction(Kg),i=await e.objectStore(Kg).get(HC(n));return await e.done,i}catch(t){if(t instanceof ju)Ou.warn(t.message);else{const e=$c.create("idb-get",{originalErrorMessage:t?.message});Ou.warn(e.message)}}}async function oT(n,t){try{const i=(await jC()).transaction(Kg,"readwrite");await i.objectStore(Kg).put(t,HC(n)),await i.done}catch(e){if(e instanceof ju)Ou.warn(e.message);else{const i=$c.create("idb-set",{originalErrorMessage:e?.message});Ou.warn(i.message)}}}function HC(n){return`${n.name}!${n.options.appId}`}const pN=1024,gN=30;class _N{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new vN(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var t,e;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=uT();if(((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:s}),this._heartbeatsCache.heartbeats.length>gN){const c=AN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){Ou.warn(i)}}async getHeartbeatsHeader(){var t;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=uT(),{heartbeatsToSend:i,unsentEntries:s}=yN(this._heartbeatsCache.heartbeats),l=qy(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(e){return Ou.warn(e),""}}}function uT(){return new Date().toISOString().substring(0,10)}function yN(n,t=pN){const e=[];let i=n.slice();for(const s of n){const l=e.find(c=>c.agent===s.agent);if(l){if(l.dates.push(s.date),cT(e)>t){l.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),cT(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class vN{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return nx()?ix().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await mN(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return oT(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){var e;if(await this._canUseIndexedDBPromise){const s=await this.read();return oT(this.app,{lastSentHeartbeatDate:(e=t.lastSentHeartbeatDate)!==null&&e!==void 0?e:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...t.heartbeats]})}else return}}function cT(n){return qy(JSON.stringify({version:2,heartbeats:n})).length}function AN(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let i=1;i<n.length;i++)n[i].date<e&&(e=n[i].date,t=i);return t}function EN(n){Df(new rh("platform-logger",t=>new Mx(t),"PRIVATE")),Df(new rh("heartbeat",t=>new _N(t),"PRIVATE")),Ro(K2,rT,n),Ro(K2,rT,"esm2017"),Ro("fire-js","")}EN("");var SN="firebase",TN="11.10.0";Ro(SN,TN,"app");function dE(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(e[i[s]]=n[i[s]]);return e}function GC(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const bN=GC,qC=new g0("auth","Firebase",GC());const Ky=new k1("@firebase/auth");function CN(n,...t){Ky.logLevel<=Ue.WARN&&Ky.warn(`Auth (${Bf}): ${n}`,...t)}function Iy(n,...t){Ky.logLevel<=Ue.ERROR&&Ky.error(`Auth (${Bf}): ${n}`,...t)}function Ul(n,...t){throw mE(n,...t)}function xo(n,...t){return mE(n,...t)}function FC(n,t,e){const i=Object.assign(Object.assign({},bN()),{[t]:e});return new g0("auth","Firebase",i).create(t,{appName:n.name})}function Ru(n){return FC(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function mE(n,...t){if(typeof n!="string"){const e=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(e,...i)}return qC.create(n,...t)}function le(n,t,...e){if(!n)throw mE(t,...e)}function Tu(n){const t="INTERNAL ASSERTION FAILED: "+n;throw Iy(t),new Error(t)}function Mu(n,t){n||Tu(t)}function Z2(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function wN(){return hT()==="http:"||hT()==="https:"}function hT(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function RN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(wN()||Z7()||"connection"in navigator)?navigator.onLine:!0}function xN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class _0{constructor(t,e){this.shortDelay=t,this.longDelay=e,Mu(e>t,"Short delay should be less than long delay!"),this.isMobile=cE()||PC()}get(){return RN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function pE(n,t){Mu(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class YC{static initialize(t,e,i){this.fetchImpl=t,e&&(this.headersImpl=e),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const NN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const DN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],IN=new _0(3e4,6e4);function gh(n,t){return n.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:n.tenantId}):t}async function Hu(n,t,e,i,s={}){return QC(n,s,async()=>{let l={},c={};i&&(t==="GET"?c=i:l={body:JSON.stringify(i)});const f=km(Object.assign({key:n.config.apiKey},c)).slice(1),m=await n._getAdditionalHeaders();m["Content-Type"]="application/json",n.languageCode&&(m["X-Firebase-Locale"]=n.languageCode);const g=Object.assign({method:t,headers:m},l);return J7()||(g.referrerPolicy="no-referrer"),n.emulatorConfig&&ph(n.emulatorConfig.host)&&(g.credentials="include"),YC.fetch()(await XC(n,n.config.apiHost,e,f),g)})}async function QC(n,t,e){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},NN),t);try{const s=new MN(n),l=await Promise.race([e(),s.promise]);s.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw uy(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const f=l.ok?c.errorMessage:c.error.message,[m,g]=f.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw uy(n,"credential-already-in-use",c);if(m==="EMAIL_EXISTS")throw uy(n,"email-already-in-use",c);if(m==="USER_DISABLED")throw uy(n,"user-disabled",c);const A=i[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw FC(n,A,g);Ul(n,A)}}catch(s){if(s instanceof ju)throw s;Ul(n,"network-request-failed",{message:String(s)})}}async function y0(n,t,e,i,s={}){const l=await Hu(n,t,e,i,s);return"mfaPendingCredential"in l&&Ul(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function XC(n,t,e,i){const s=`${t}${e}?${i}`,l=n,c=l.config.emulator?pE(n.config,s):`${n.config.apiScheme}://${s}`;return DN.includes(e)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}function ON(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class MN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,i)=>{this.timer=setTimeout(()=>i(xo(this.auth,"network-request-failed")),IN.get())})}}function uy(n,t,e){const i={appName:n.name};e.email&&(i.email=e.email),e.phoneNumber&&(i.phoneNumber=e.phoneNumber);const s=xo(n,t,i);return s.customData._tokenResponse=e,s}function fT(n){return n!==void 0&&n.enterprise!==void 0}class LN{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],t.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return ON(e.enforcementState);return null}isProviderEnabled(t){return this.getProviderEnforcementState(t)==="ENFORCE"||this.getProviderEnforcementState(t)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function kN(n,t){return Hu(n,"GET","/v2/recaptchaConfig",gh(n,t))}async function PN(n,t){return Hu(n,"POST","/v1/accounts:delete",t)}async function Wy(n,t){return Hu(n,"POST","/v1/accounts:lookup",t)}function Og(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function VN(n,t=!1){const e=On(n),i=await e.getIdToken(t),s=gE(i);le(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const l=typeof s.firebase=="object"?s.firebase:void 0,c=l?.sign_in_provider;return{claims:s,token:i,authTime:Og(f2(s.auth_time)),issuedAtTime:Og(f2(s.iat)),expirationTime:Og(f2(s.exp)),signInProvider:c||null,signInSecondFactor:l?.sign_in_second_factor||null}}function f2(n){return Number(n)*1e3}function gE(n){const[t,e,i]=n.split(".");if(t===void 0||e===void 0||i===void 0)return Iy("JWT malformed, contained fewer than 3 sections"),null;try{const s=Fy(e);return s?JSON.parse(s):(Iy("Failed to decode base64 JWT payload"),null)}catch(s){return Iy("Caught error parsing JWT payload as JSON",s?.toString()),null}}function dT(n){const t=gE(n);return le(t,"internal-error"),le(typeof t.exp<"u","internal-error"),le(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function pm(n,t,e=!1){if(e)return t;try{return await t}catch(i){throw i instanceof ju&&UN(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function UN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class zN{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const s=((e=this.user.stsTokenManager.expirationTime)!==null&&e!==void 0?e:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class $2{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Og(this.lastLoginAt),this.creationTime=Og(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Jy(n){var t;const e=n.auth,i=await n.getIdToken(),s=await pm(n,Wy(e,{idToken:i}));le(s?.users.length,e,"internal-error");const l=s.users[0];n._notifyReloadListener(l);const c=!((t=l.providerUserInfo)===null||t===void 0)&&t.length?KC(l.providerUserInfo):[],f=jN(n.providerData,c),m=n.isAnonymous,g=!(n.email&&l.passwordHash)&&!f?.length,A=m?g:!1,E={uid:l.localId,displayName:l.displayName||null,photoURL:l.photoUrl||null,email:l.email||null,emailVerified:l.emailVerified||!1,phoneNumber:l.phoneNumber||null,tenantId:l.tenantId||null,providerData:f,metadata:new $2(l.createdAt,l.lastLoginAt),isAnonymous:A};Object.assign(n,E)}async function BN(n){const t=On(n);await Jy(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function jN(n,t){return[...n.filter(i=>!t.some(s=>s.providerId===i.providerId)),...t]}function KC(n){return n.map(t=>{var{providerId:e}=t,i=dE(t,["providerId"]);return{providerId:e,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}async function HN(n,t){const e=await QC(n,{},async()=>{const i=km({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:l}=n.config,c=await XC(n,s,"/v1/token",`key=${l}`),f=await n._getAdditionalHeaders();f["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:f,body:i};return n.emulatorConfig&&ph(n.emulatorConfig.host)&&(m.credentials="include"),YC.fetch()(c,m)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function GN(n,t){return Hu(n,"POST","/v2/accounts:revokeToken",gh(n,t))}class rm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){le(t.idToken,"internal-error"),le(typeof t.idToken<"u","internal-error"),le(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):dT(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){le(t.length!==0,"internal-error");const e=dT(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(le(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:i,refreshToken:s,expiresIn:l}=await HN(t,e);this.updateTokensAndExpiration(i,s,Number(l))}updateTokensAndExpiration(t,e,i){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,e){const{refreshToken:i,accessToken:s,expirationTime:l}=e,c=new rm;return i&&(le(typeof i=="string","internal-error",{appName:t}),c.refreshToken=i),s&&(le(typeof s=="string","internal-error",{appName:t}),c.accessToken=s),l&&(le(typeof l=="number","internal-error",{appName:t}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new rm,this.toJSON())}_performRefresh(){return Tu("not implemented")}}function Gc(n,t){le(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class Ol{constructor(t){var{uid:e,auth:i,stsTokenManager:s}=t,l=dE(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new zN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=i,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=l.displayName||null,this.email=l.email||null,this.emailVerified=l.emailVerified||!1,this.phoneNumber=l.phoneNumber||null,this.photoURL=l.photoURL||null,this.isAnonymous=l.isAnonymous||!1,this.tenantId=l.tenantId||null,this.providerData=l.providerData?[...l.providerData]:[],this.metadata=new $2(l.createdAt||void 0,l.lastLoginAt||void 0)}async getIdToken(t){const e=await pm(this,this.stsTokenManager.getToken(this.auth,t));return le(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return VN(this,t)}reload(){return BN(this)}_assign(t){this!==t&&(le(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>Object.assign({},e)),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Ol(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){le(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),e&&await Jy(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(dr(this.auth.app))return Promise.reject(Ru(this.auth));const t=await this.getIdToken();return await pm(this,PN(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>Object.assign({},t)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var i,s,l,c,f,m,g,A;const E=(i=e.displayName)!==null&&i!==void 0?i:void 0,T=(s=e.email)!==null&&s!==void 0?s:void 0,x=(l=e.phoneNumber)!==null&&l!==void 0?l:void 0,R=(c=e.photoURL)!==null&&c!==void 0?c:void 0,O=(f=e.tenantId)!==null&&f!==void 0?f:void 0,M=(m=e._redirectEventId)!==null&&m!==void 0?m:void 0,H=(g=e.createdAt)!==null&&g!==void 0?g:void 0,B=(A=e.lastLoginAt)!==null&&A!==void 0?A:void 0,{uid:Y,emailVerified:$,isAnonymous:nt,providerData:X,stsTokenManager:L}=e;le(Y&&L,t,"internal-error");const k=rm.fromJSON(this.name,L);le(typeof Y=="string",t,"internal-error"),Gc(E,t.name),Gc(T,t.name),le(typeof $=="boolean",t,"internal-error"),le(typeof nt=="boolean",t,"internal-error"),Gc(x,t.name),Gc(R,t.name),Gc(O,t.name),Gc(M,t.name),Gc(H,t.name),Gc(B,t.name);const V=new Ol({uid:Y,auth:t,email:T,emailVerified:$,displayName:E,isAnonymous:nt,photoURL:R,phoneNumber:x,tenantId:O,stsTokenManager:k,createdAt:H,lastLoginAt:B});return X&&Array.isArray(X)&&(V.providerData=X.map(q=>Object.assign({},q))),M&&(V._redirectEventId=M),V}static async _fromIdTokenResponse(t,e,i=!1){const s=new rm;s.updateFromServerResponse(e);const l=new Ol({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:i});return await Jy(l),l}static async _fromGetAccountInfoResponse(t,e,i){const s=e.users[0];le(s.localId!==void 0,"internal-error");const l=s.providerUserInfo!==void 0?KC(s.providerUserInfo):[],c=!(s.email&&s.passwordHash)&&!l?.length,f=new rm;f.updateFromIdToken(i);const m=new Ol({uid:s.localId,auth:t,stsTokenManager:f,isAnonymous:c}),g={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new $2(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!l?.length};return Object.assign(m,g),m}}const mT=new Map;function bu(n){Mu(n instanceof Function,"Expected a class definition");let t=mT.get(n);return t?(Mu(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,mT.set(n,t),t)}class WC{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}WC.type="NONE";const pT=WC;function Oy(n,t,e){return`firebase:${n}:${t}:${e}`}class lm{constructor(t,e,i){this.persistence=t,this.auth=e,this.userKey=i;const{config:s,name:l}=this.auth;this.fullUserKey=Oy(this.userKey,s.apiKey,l),this.fullPersistenceKey=Oy("persistence",s.apiKey,l),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await Wy(this.auth,{idToken:t}).catch(()=>{});return e?Ol._fromGetAccountInfoResponse(this.auth,e,t):null}return Ol._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,i="authUser"){if(!e.length)return new lm(bu(pT),t,i);const s=(await Promise.all(e.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=s[0]||bu(pT);const c=Oy(i,t.config.apiKey,t.name);let f=null;for(const g of e)try{const A=await g._get(c);if(A){let E;if(typeof A=="string"){const T=await Wy(t,{idToken:A}).catch(()=>{});if(!T)break;E=await Ol._fromGetAccountInfoResponse(t,T,A)}else E=Ol._fromJSON(t,A);g!==l&&(f=E),l=g;break}}catch{}const m=s.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new lm(l,t,i):(l=m[0],f&&await l._set(c,f.toJSON()),await Promise.all(e.map(async g=>{if(g!==l)try{await g._remove(c)}catch{}})),new lm(l,t,i))}}function gT(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(t5(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(JC(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(n5(t))return"Blackberry";if(i5(t))return"Webos";if(ZC(t))return"Safari";if((t.includes("chrome/")||$C(t))&&!t.includes("edge/"))return"Chrome";if(e5(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(e);if(i?.length===2)return i[1]}return"Other"}function JC(n=$s()){return/firefox\//i.test(n)}function ZC(n=$s()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function $C(n=$s()){return/crios\//i.test(n)}function t5(n=$s()){return/iemobile/i.test(n)}function e5(n=$s()){return/android/i.test(n)}function n5(n=$s()){return/blackberry/i.test(n)}function i5(n=$s()){return/webos/i.test(n)}function _E(n=$s()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function qN(n=$s()){var t;return _E(n)&&!!(!((t=window.navigator)===null||t===void 0)&&t.standalone)}function FN(){return $7()&&document.documentMode===10}function s5(n=$s()){return _E(n)||e5(n)||i5(n)||n5(n)||/windows phone/i.test(n)||t5(n)}function a5(n,t=[]){let e;switch(n){case"Browser":e=gT($s());break;case"Worker":e=`${gT($s())}-${n}`;break;default:e=n}const i=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Bf}/${i}`}class YN{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const i=l=>new Promise((c,f)=>{try{const m=t(l);c(m)}catch(m){f(m)}});i.onAbort=e,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const i of this.queue)await i(t),i.onAbort&&e.push(i.onAbort)}catch(i){e.reverse();for(const s of e)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function QN(n,t={}){return Hu(n,"GET","/v2/passwordPolicy",gh(n,t))}const XN=6;class KN{constructor(t){var e,i,s,l;const c=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(e=c.minPasswordLength)!==null&&e!==void 0?e:XN,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(i=t.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(l=t.forceUpgradeOnSignin)!==null&&l!==void 0?l:!1,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,i,s,l,c,f;const m={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,m),this.validatePasswordCharacterOptions(t,m),m.isValid&&(m.isValid=(e=m.meetsMinPasswordLength)!==null&&e!==void 0?e:!0),m.isValid&&(m.isValid=(i=m.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),m.isValid&&(m.isValid=(s=m.containsLowercaseLetter)!==null&&s!==void 0?s:!0),m.isValid&&(m.isValid=(l=m.containsUppercaseLetter)!==null&&l!==void 0?l:!0),m.isValid&&(m.isValid=(c=m.containsNumericCharacter)!==null&&c!==void 0?c:!0),m.isValid&&(m.isValid=(f=m.containsNonAlphanumericCharacter)!==null&&f!==void 0?f:!0),m}validatePasswordLengthOptions(t,e){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(e.meetsMinPasswordLength=t.length>=i),s&&(e.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let i;for(let s=0;s<t.length;s++)i=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(e,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,e,i,s,l){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=l))}}class WN{constructor(t,e,i,s){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _T(this),this.idTokenSubscription=new _T(this),this.beforeStateQueue=new YN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qC,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=bu(e)),this._initializationPromise=this.queue(async()=>{var i,s,l;if(!this._deleted&&(this.persistenceManager=await lm.create(this,t),(i=this._resolvePersistenceManagerAvailable)===null||i===void 0||i.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=((l=this.currentUser)===null||l===void 0?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await Wy(this,{idToken:t}),i=await Ol._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(dr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(f=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(f,f))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let s=i,l=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(e=this.redirectUser)===null||e===void 0?void 0:e._redirectEventId,f=s?._redirectEventId,m=await this.tryRedirectSignIn(t);(!c||c===f)&&m?.user&&(s=m.user,l=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(l)try{await this.beforeStateQueue.runMiddleware(s)}catch(c){s=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return le(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Jy(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=xN()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(dr(this.app))return Promise.reject(Ru(this));const e=t?On(t):null;return e&&le(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&le(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return dr(this.app)?Promise.reject(Ru(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return dr(this.app)?Promise.reject(Ru(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bu(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await QN(this),e=new KN(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new g0("auth","Firebase",t())}onAuthStateChanged(t,e,i){return this.registerStateListener(this.authStateSubscription,t,e,i)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,i){return this.registerStateListener(this.idTokenSubscription,t,e,i)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(i.tenantId=this.tenantId),await GN(this,i)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(t=this._currentUser)===null||t===void 0?void 0:t.toJSON()}}async _setRedirectUser(t,e){const i=await this.getOrInitRedirectPersistenceManager(e);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&bu(t)||this._popupRedirectResolver;le(e,this,"argument-error"),this.redirectPersistenceManager=await lm.create(this,[bu(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,i;return this._isInitialized&&await this.queue(async()=>{}),((e=this._currentUser)===null||e===void 0?void 0:e._redirectEventId)===t?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(e=(t=this.currentUser)===null||t===void 0?void 0:t.uid)!==null&&e!==void 0?e:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,i,s){if(this._deleted)return()=>{};const l=typeof e=="function"?e:e.next.bind(e);let c=!1;const f=this._isInitialized?Promise.resolve():this._initializationPromise;if(le(f,this,"internal-error"),f.then(()=>{c||l(this.currentUser)}),typeof e=="function"){const m=t.addObserver(e,i,s);return()=>{c=!0,m()}}else{const m=t.addObserver(e);return()=>{c=!0,m()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return le(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=a5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const i=await((t=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getHeartbeatsHeader());i&&(e["X-Firebase-Client"]=i);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var t;if(dr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||t===void 0?void 0:t.getToken());return e?.error&&CN(`Error while retrieving App Check token: ${e.error}`),e?.token}}function jf(n){return On(n)}class _T{constructor(t){this.auth=t,this.observer=null,this.addObserver=cx(e=>this.observer=e)}get next(){return le(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let V1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JN(n){V1=n}function r5(n){return V1.loadJS(n)}function ZN(){return V1.recaptchaEnterpriseScript}function $N(){return V1.gapiScript}function tD(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class eD{constructor(){this.enterprise=new nD}ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}class nD{ready(t){t()}execute(t,e){return Promise.resolve("token")}render(t,e){return""}}const iD="recaptcha-enterprise",l5="NO_RECAPTCHA";class sD{constructor(t){this.type=iD,this.auth=jf(t)}async verify(t="verify",e=!1){async function i(l){if(!e){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(c,f)=>{kN(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)f(new Error("recaptcha Enterprise site key undefined"));else{const g=new LN(m);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,c(g.siteKey)}}).catch(m=>{f(m)})})}function s(l,c,f){const m=window.grecaptcha;fT(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:t}).then(g=>{c(g)}).catch(()=>{c(l5)})}):f(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new eD().execute("siteKey",{action:"verify"}):new Promise((l,c)=>{i(this.auth).then(f=>{if(!e&&fT(window.grecaptcha))s(f,l,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let m=ZN();m.length!==0&&(m+=f),r5(m).then(()=>{s(f,l,c)}).catch(g=>{c(g)})}}).catch(f=>{c(f)})})}}async function yT(n,t,e,i=!1,s=!1){const l=new sD(n);let c;if(s)c=l5;else try{c=await l.verify(e)}catch{c=await l.verify(e,!0)}const f=Object.assign({},t);if(e==="mfaSmsEnrollment"||e==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in f){const m=f.phoneEnrollmentInfo.phoneNumber,g=f.phoneEnrollmentInfo.recaptchaToken;Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in f){const m=f.phoneSignInInfo.recaptchaToken;Object.assign(f,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return f}return i?Object.assign(f,{captchaResp:c}):Object.assign(f,{captchaResponse:c}),Object.assign(f,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(f,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),f}async function tA(n,t,e,i,s){var l;if(!((l=n._getRecaptchaConfig())===null||l===void 0)&&l.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await yT(n,t,e,e==="getOobCode");return i(n,c)}else return i(n,t).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${e} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const f=await yT(n,t,e,e==="getOobCode");return i(n,f)}else return Promise.reject(c)})}function aD(n,t){const e=P1(n,"auth");if(e.isInitialized()){const s=e.getImmediate(),l=e.getOptions();if(ah(l,t??{}))return s;Ul(s,"already-initialized")}return e.initialize({options:t})}function rD(n,t){const e=t?.persistence||[],i=(Array.isArray(e)?e:[e]).map(bu);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(i,t?.popupRedirectResolver)}function lD(n,t,e){const i=jf(n);le(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!1,l=o5(t),{host:c,port:f}=oD(t),m=f===null?"":`:${f}`,g={url:`${l}//${c}${m}/`},A=Object.freeze({host:c,port:f,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){le(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),le(ah(g,i.config.emulator)&&ah(A,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=A,i.settings.appVerificationDisabledForTesting=!0,ph(c)?(oE(`${l}//${c}${m}`),uE("Auth",!0)):uD()}function o5(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function oD(n){const t=o5(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const i=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const l=s[1];return{host:l,port:vT(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:vT(c)}}}function vT(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function uD(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class yE{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Tu("not implemented")}_getIdTokenResponse(t){return Tu("not implemented")}_linkToIdToken(t,e){return Tu("not implemented")}_getReauthenticationResolver(t){return Tu("not implemented")}}async function cD(n,t){return Hu(n,"POST","/v1/accounts:signUp",t)}async function hD(n,t){return y0(n,"POST","/v1/accounts:signInWithPassword",gh(n,t))}async function fD(n,t){return y0(n,"POST","/v1/accounts:signInWithEmailLink",gh(n,t))}async function dD(n,t){return y0(n,"POST","/v1/accounts:signInWithEmailLink",gh(n,t))}class Wg extends yE{constructor(t,e,i,s=null){super("password",i),this._email=t,this._password=e,this._tenantId=s}static _fromEmailAndPassword(t,e){return new Wg(t,e,"password")}static _fromEmailAndCode(t,e,i=null){return new Wg(t,e,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t;if(e?.email&&e?.password){if(e.signInMethod==="password")return this._fromEmailAndPassword(e.email,e.password);if(e.signInMethod==="emailLink")return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":const e={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tA(t,e,"signInWithPassword",hD);case"emailLink":return fD(t,{email:this._email,oobCode:this._password});default:Ul(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":const i={idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return tA(t,i,"signUpPassword",cD);case"emailLink":return dD(t,{idToken:e,email:this._email,oobCode:this._password});default:Ul(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function om(n,t){return y0(n,"POST","/v1/accounts:signInWithIdp",gh(n,t))}const mD="http://localhost";class If extends yE{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new If(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Ul("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:s}=e,l=dE(e,["providerId","signInMethod"]);if(!i||!s)return null;const c=new If(i,s);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(t){const e=this.buildRequest();return om(t,e)}_linkToIdToken(t,e){const i=this.buildRequest();return i.idToken=e,om(t,i)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,om(t,e)}buildRequest(){const t={requestUri:mD,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=km(e)}return t}}function pD(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function gD(n){const t=vg(Ag(n)).link,e=t?vg(Ag(t)).deep_link_id:null,i=vg(Ag(n)).deep_link_id;return(i?vg(Ag(i)).link:null)||i||e||t||n}class vE{constructor(t){var e,i,s,l,c,f;const m=vg(Ag(t)),g=(e=m.apiKey)!==null&&e!==void 0?e:null,A=(i=m.oobCode)!==null&&i!==void 0?i:null,E=pD((s=m.mode)!==null&&s!==void 0?s:null);le(g&&A&&E,"argument-error"),this.apiKey=g,this.operation=E,this.code=A,this.continueUrl=(l=m.continueUrl)!==null&&l!==void 0?l:null,this.languageCode=(c=m.lang)!==null&&c!==void 0?c:null,this.tenantId=(f=m.tenantId)!==null&&f!==void 0?f:null}static parseLink(t){const e=gD(t);try{return new vE(e)}catch{return null}}}class Pm{constructor(){this.providerId=Pm.PROVIDER_ID}static credential(t,e){return Wg._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const i=vE.parseLink(e);return le(i,"argument-error"),Wg._fromEmailAndCode(t,i.code,i.tenantId)}}Pm.PROVIDER_ID="password";Pm.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Pm.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class u5{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class v0 extends u5{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Yc extends v0{constructor(){super("facebook.com")}static credential(t){return If._fromParams({providerId:Yc.PROVIDER_ID,signInMethod:Yc.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Yc.credentialFromTaggedObject(t)}static credentialFromError(t){return Yc.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Yc.credential(t.oauthAccessToken)}catch{return null}}}Yc.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yc.PROVIDER_ID="facebook.com";class Qc extends v0{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return If._fromParams({providerId:Qc.PROVIDER_ID,signInMethod:Qc.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Qc.credentialFromTaggedObject(t)}static credentialFromError(t){return Qc.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i}=t;if(!e&&!i)return null;try{return Qc.credential(e,i)}catch{return null}}}Qc.GOOGLE_SIGN_IN_METHOD="google.com";Qc.PROVIDER_ID="google.com";class Xc extends v0{constructor(){super("github.com")}static credential(t){return If._fromParams({providerId:Xc.PROVIDER_ID,signInMethod:Xc.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Xc.credentialFromTaggedObject(t)}static credentialFromError(t){return Xc.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Xc.credential(t.oauthAccessToken)}catch{return null}}}Xc.GITHUB_SIGN_IN_METHOD="github.com";Xc.PROVIDER_ID="github.com";class Kc extends v0{constructor(){super("twitter.com")}static credential(t,e){return If._fromParams({providerId:Kc.PROVIDER_ID,signInMethod:Kc.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return Kc.credentialFromTaggedObject(t)}static credentialFromError(t){return Kc.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:i}=t;if(!e||!i)return null;try{return Kc.credential(e,i)}catch{return null}}}Kc.TWITTER_SIGN_IN_METHOD="twitter.com";Kc.PROVIDER_ID="twitter.com";async function _D(n,t){return y0(n,"POST","/v1/accounts:signUp",gh(n,t))}class Of{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,i,s=!1){const l=await Ol._fromIdTokenResponse(t,i,s),c=AT(i);return new Of({user:l,providerId:c,_tokenResponse:i,operationType:e})}static async _forOperation(t,e,i){await t._updateTokensIfNecessary(i,!0);const s=AT(i);return new Of({user:t,providerId:s,_tokenResponse:i,operationType:e})}}function AT(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Zy extends ju{constructor(t,e,i,s){var l;super(e.code,e.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,Zy.prototype),this.customData={appName:t.name,tenantId:(l=t.tenantId)!==null&&l!==void 0?l:void 0,_serverResponse:e.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,e,i,s){return new Zy(t,e,i,s)}}function c5(n,t,e,i){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Zy._fromErrorAndOperation(n,l,t,i):l})}async function yD(n,t,e=!1){const i=await pm(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Of._forOperation(n,"link",i)}async function vD(n,t,e=!1){const{auth:i}=n;if(dr(i.app))return Promise.reject(Ru(i));const s="reauthenticate";try{const l=await pm(n,c5(i,s,t,n),e);le(l.idToken,i,"internal-error");const c=gE(l.idToken);le(c,i,"internal-error");const{sub:f}=c;return le(n.uid===f,i,"user-mismatch"),Of._forOperation(n,s,l)}catch(l){throw l?.code==="auth/user-not-found"&&Ul(i,"user-mismatch"),l}}async function h5(n,t,e=!1){if(dr(n.app))return Promise.reject(Ru(n));const i="signIn",s=await c5(n,i,t),l=await Of._fromIdTokenResponse(n,i,s);return e||await n._updateCurrentUser(l.user),l}async function AD(n,t){return h5(jf(n),t)}async function f5(n){const t=jf(n);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function ED(n,t,e){if(dr(n.app))return Promise.reject(Ru(n));const i=jf(n),c=await tA(i,{returnSecureToken:!0,email:t,password:e,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",_D).catch(m=>{throw m.code==="auth/password-does-not-meet-requirements"&&f5(n),m}),f=await Of._fromIdTokenResponse(i,"signIn",c);return await i._updateCurrentUser(f.user),f}function SD(n,t,e){return dr(n.app)?Promise.reject(Ru(n)):AD(On(n),Pm.credential(t,e)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&f5(n),i})}async function TD(n,t){return Hu(n,"POST","/v1/accounts:update",t)}async function bD(n,{displayName:t,photoURL:e}){if(t===void 0&&e===void 0)return;const i=On(n),l={idToken:await i.getIdToken(),displayName:t,photoUrl:e,returnSecureToken:!0},c=await pm(i,TD(i.auth,l));i.displayName=c.displayName||null,i.photoURL=c.photoUrl||null;const f=i.providerData.find(({providerId:m})=>m==="password");f&&(f.displayName=i.displayName,f.photoURL=i.photoURL),await i._updateTokensIfNecessary(c)}function CD(n,t,e,i){return On(n).onIdTokenChanged(t,e,i)}function wD(n,t,e){return On(n).beforeAuthStateChanged(t,e)}function RD(n,t,e,i){return On(n).onAuthStateChanged(t,e,i)}function xD(n){return On(n).signOut()}const $y="__sak";class d5{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem($y,"1"),this.storage.removeItem($y),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const ND=1e3,DD=10;class m5 extends d5{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=s5(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const i=this.storage.getItem(e),s=this.localCache[e];i!==s&&t(e,s,i)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((c,f,m)=>{this.notifyListeners(c,m)});return}const i=t.key;e?this.detachListener():this.stopPolling();const s=()=>{const c=this.storage.getItem(i);!e&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);FN()&&l!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,DD):s()}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:i}),!0)})},ND)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}m5.type="LOCAL";const ID=m5;class p5 extends d5{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}p5.type="SESSION";const g5=p5;function OD(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class U1{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(s=>s.isListeningto(t));if(e)return e;const i=new U1(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:i,eventType:s,data:l}=e.data,c=this.handlersMap[s];if(!c?.size)return;e.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const f=Array.from(c).map(async g=>g(e.origin,l)),m=await OD(f);e.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:m})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}U1.receivers=[];function AE(n="",t=10){let e="";for(let i=0;i<t;i++)e+=Math.floor(Math.random()*10);return n+e}class MD{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let l,c;return new Promise((f,m)=>{const g=AE("",20);s.port1.start();const A=setTimeout(()=>{m(new Error("unsupported_event"))},i);c={messageChannel:s,onMessage(E){const T=E;if(T.data.eventId===g)switch(T.data.status){case"ack":clearTimeout(A),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),f(T.data.response);break;default:clearTimeout(A),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(c),s.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:t,eventId:g,data:e},[s.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function No(){return window}function LD(n){No().location.href=n}function _5(){return typeof No().WorkerGlobalScope<"u"&&typeof No().importScripts=="function"}async function kD(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function PD(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function VD(){return _5()?self:null}const y5="firebaseLocalStorageDb",UD=1,t1="firebaseLocalStorage",v5="fbase_key";class A0{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function z1(n,t){return n.transaction([t1],t?"readwrite":"readonly").objectStore(t1)}function zD(){const n=indexedDB.deleteDatabase(y5);return new A0(n).toPromise()}function eA(){const n=indexedDB.open(y5,UD);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(t1,{keyPath:v5})}catch(s){e(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(t1)?t(i):(i.close(),await zD(),t(await eA()))})})}async function ET(n,t,e){const i=z1(n,!0).put({[v5]:t,value:e});return new A0(i).toPromise()}async function BD(n,t){const e=z1(n,!1).get(t),i=await new A0(e).toPromise();return i===void 0?null:i.value}function ST(n,t){const e=z1(n,!0).delete(t);return new A0(e).toPromise()}const jD=800,HD=3;class A5{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await eA(),this.db)}async _withRetries(t){let e=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(e++>HD)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _5()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=U1._getInstance(VD()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){var t,e;if(this.activeServiceWorker=await kD(),!this.activeServiceWorker)return;this.sender=new MD(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((e=i[0])===null||e===void 0)&&e.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||PD()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await eA();return await ET(t,$y,"1"),await ST(t,$y),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(i=>ET(i,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(i=>BD(i,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>ST(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const l=z1(s,!1).getAll();return new A0(l).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],i=new Set;if(t.length!==0)for(const{fbase_key:s,value:l}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(l)&&(this.notifyListeners(s,l),e.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),e.push(s));return e}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),jD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}A5.type="LOCAL";const GD=A5;new _0(3e4,6e4);function qD(n,t){return t?bu(t):(le(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class EE extends yE{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return om(t,this._buildIdpRequest())}_linkToIdToken(t,e){return om(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return om(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function FD(n){return h5(n.auth,new EE(n),n.bypassAuthState)}function YD(n){const{auth:t,user:e}=n;return le(e,t,"internal-error"),vD(e,new EE(n),n.bypassAuthState)}async function QD(n){const{auth:t,user:e}=n;return le(e,t,"internal-error"),yD(e,new EE(n),n.bypassAuthState)}class E5{constructor(t,e,i,s,l=!1){this.auth=t,this.resolver=i,this.user=s,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:i,postBody:s,tenantId:l,error:c,type:f}=t;if(c){this.reject(c);return}const m={auth:this.auth,requestUri:e,sessionId:i,tenantId:l||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(f)(m))}catch(g){this.reject(g)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return FD;case"linkViaPopup":case"linkViaRedirect":return QD;case"reauthViaPopup":case"reauthViaRedirect":return YD;default:Ul(this.auth,"internal-error")}}resolve(t){Mu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Mu(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const XD=new _0(2e3,1e4);class nm extends E5{constructor(t,e,i,s,l){super(t,e,s,l),this.provider=i,this.authWindow=null,this.pollId=null,nm.currentPopupAction&&nm.currentPopupAction.cancel(),nm.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return le(t,this.auth,"internal-error"),t}async onExecution(){Mu(this.filter.length===1,"Popup operations only handle one event");const t=AE();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(xo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(xo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nm.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,i;if(!((i=(e=this.authWindow)===null||e===void 0?void 0:e.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(xo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,XD.get())};t()}}nm.currentPopupAction=null;const KD="pendingRedirect",My=new Map;class WD extends E5{constructor(t,e,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,i),this.eventId=null}async execute(){let t=My.get(this.auth._key());if(!t){try{const i=await JD(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(e){t=()=>Promise.reject(e)}My.set(this.auth._key(),t)}return this.bypassAuthState||My.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function JD(n,t){const e=tI(t),i=$D(n);if(!await i._isAvailable())return!1;const s=await i._get(e)==="true";return await i._remove(e),s}function ZD(n,t){My.set(n._key(),t)}function $D(n){return bu(n._redirectPersistence)}function tI(n){return Oy(KD,n.config.apiKey,n.name)}async function eI(n,t,e=!1){if(dr(n.app))return Promise.reject(Ru(n));const i=jf(n),s=qD(i,t),c=await new WD(i,s,e).execute();return c&&!e&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,t)),c}const nI=600*1e3;class iI{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(e=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!sI(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var i;if(t.error&&!S5(t)){const s=((i=t.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";e.onError(xo(this.auth,s))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const i=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=nI&&this.cachedEventUids.clear(),this.cachedEventUids.has(TT(t))}saveEventToCache(t){this.cachedEventUids.add(TT(t)),this.lastProcessedEventTime=Date.now()}}function TT(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function S5({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function sI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return S5(n);default:return!1}}async function aI(n,t={}){return Hu(n,"GET","/v1/projects",t)}const rI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,lI=/^https?/;async function oI(n){if(n.config.emulator)return;const{authorizedDomains:t}=await aI(n);for(const e of t)try{if(uI(e))return}catch{}Ul(n,"unauthorized-domain")}function uI(n){const t=Z2(),{protocol:e,hostname:i}=new URL(t);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&c.hostname===i}if(!lI.test(e))return!1;if(rI.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const cI=new _0(3e4,6e4);function bT(){const n=No().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function hI(n){return new Promise((t,e)=>{var i,s,l;function c(){bT(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{bT(),e(xo(n,"network-request-failed"))},timeout:cI.get()})}if(!((s=(i=No().gapi)===null||i===void 0?void 0:i.iframes)===null||s===void 0)&&s.Iframe)t(gapi.iframes.getContext());else if(!((l=No().gapi)===null||l===void 0)&&l.load)c();else{const f=tD("iframefcb");return No()[f]=()=>{gapi.load?c():e(xo(n,"network-request-failed"))},r5(`${$N()}?onload=${f}`).catch(m=>e(m))}}).catch(t=>{throw Ly=null,t})}let Ly=null;function fI(n){return Ly=Ly||hI(n),Ly}const dI=new _0(5e3,15e3),mI="__/auth/iframe",pI="emulator/auth/iframe",gI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_I=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yI(n){const t=n.config;le(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?pE(t,pI):`https://${n.config.authDomain}/${mI}`,i={apiKey:t.apiKey,appName:n.name,v:Bf},s=_I.get(n.config.apiHost);s&&(i.eid=s);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${e}?${km(i).slice(1)}`}async function vI(n){const t=await fI(n),e=No().gapi;return le(e,n,"internal-error"),t.open({where:document.body,url:yI(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gI,dontclear:!0},i=>new Promise(async(s,l)=>{await i.restyle({setHideOnLeave:!1});const c=xo(n,"network-request-failed"),f=No().setTimeout(()=>{l(c)},dI.get());function m(){No().clearTimeout(f),s(i)}i.ping(m).then(m,()=>{l(c)})}))}const AI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},EI=500,SI=600,TI="_blank",bI="http://localhost";class CT{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CI(n,t,e,i=EI,s=SI){const l=Math.max((window.screen.availHeight-s)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let f="";const m=Object.assign(Object.assign({},AI),{width:i.toString(),height:s.toString(),top:l,left:c}),g=$s().toLowerCase();e&&(f=$C(g)?TI:e),JC(g)&&(t=t||bI,m.scrollbars="yes");const A=Object.entries(m).reduce((T,[x,R])=>`${T}${x}=${R},`,"");if(qN(g)&&f!=="_self")return wI(t||"",f),new CT(null);const E=window.open(t||"",f,A);le(E,n,"popup-blocked");try{E.focus()}catch{}return new CT(E)}function wI(n,t){const e=document.createElement("a");e.href=n,e.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(i)}const RI="__/auth/handler",xI="emulator/auth/handler",NI=encodeURIComponent("fac");async function wT(n,t,e,i,s,l){le(n.config.authDomain,n,"auth-domain-config-required"),le(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:i,v:Bf,eventId:s};if(t instanceof u5){t.setDefaultLanguage(n.languageCode),c.providerId=t.providerId||"",Yy(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[A,E]of Object.entries({}))c[A]=E}if(t instanceof v0){const A=t.getScopes().filter(E=>E!=="");A.length>0&&(c.scopes=A.join(","))}n.tenantId&&(c.tid=n.tenantId);const f=c;for(const A of Object.keys(f))f[A]===void 0&&delete f[A];const m=await n._getAppCheckToken(),g=m?`#${NI}=${encodeURIComponent(m)}`:"";return`${DI(n)}?${km(f).slice(1)}${g}`}function DI({config:n}){return n.emulator?pE(n,xI):`https://${n.authDomain}/${RI}`}const d2="webStorageSupport";class II{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=g5,this._completeRedirectFn=eI,this._overrideRedirectResult=ZD}async _openPopup(t,e,i,s){var l;Mu((l=this.eventManagers[t._key()])===null||l===void 0?void 0:l.manager,"_initialize() not called before _openPopup()");const c=await wT(t,e,i,Z2(),s);return CI(t,c,AE())}async _openRedirect(t,e,i,s){await this._originValidation(t);const l=await wT(t,e,i,Z2(),s);return LD(l),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:l}=this.eventManagers[e];return s?Promise.resolve(s):(Mu(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(t);return this.eventManagers[e]={promise:i},i.catch(()=>{delete this.eventManagers[e]}),i}async initAndGetManager(t){const e=await vI(t),i=new iI(t);return e.register("authEvent",s=>(le(s?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=e,i}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(d2,{type:d2},s=>{var l;const c=(l=s?.[0])===null||l===void 0?void 0:l[d2];c!==void 0&&e(!!c),Ul(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=oI(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return s5()||ZC()||_E()}}const OI=II;var RT="@firebase/auth",xT="1.10.8";class MI{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),((t=this.auth.currentUser)===null||t===void 0?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){le(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function LI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kI(n){Df(new rh("auth",(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),l=t.getProvider("app-check-internal"),{apiKey:c,authDomain:f}=i.options;le(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const m={apiKey:c,authDomain:f,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:a5(n)},g=new WN(i,s,l,m);return rD(g,e),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider("auth-internal").initialize()})),Df(new rh("auth-internal",t=>{const e=jf(t.getProvider("auth").getImmediate());return(i=>new MI(i))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ro(RT,xT,LI(n)),Ro(RT,xT,"esm2017")}const PI=300,VI=LC("authIdTokenMaxAge")||PI;let NT=null;const UI=n=>async t=>{const e=t&&await t.getIdTokenResult(),i=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(i&&i>VI)return;const s=e?.token;NT!==s&&(NT=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function zI(n=fE()){const t=P1(n,"auth");if(t.isInitialized())return t.getImmediate();const e=aD(n,{popupRedirectResolver:OI,persistence:[GD,ID,g5]}),i=LC("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=UI(l.toString());wD(e,c,()=>c(e.currentUser)),CD(e,f=>c(f))}}const s=IC("auth");return s&&lD(e,`http://${s}`),e}function BI(){var n,t;return(t=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&t!==void 0?t:document}JN({loadJS(n){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=t,i.onerror=s=>{const l=xo("internal-error");l.customData=s,e(l)},i.type="text/javascript",i.charset="UTF-8",BI().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kI("Browser");var DT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var th,T5;(function(){var n;function t(L,k){function V(){}V.prototype=k.prototype,L.D=k.prototype,L.prototype=new V,L.prototype.constructor=L,L.C=function(q,Q,F){for(var G=Array(arguments.length-2),Ot=2;Ot<arguments.length;Ot++)G[Ot-2]=arguments[Ot];return k.prototype[Q].apply(q,G)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,e),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(L,k,V){V||(V=0);var q=Array(16);if(typeof k=="string")for(var Q=0;16>Q;++Q)q[Q]=k.charCodeAt(V++)|k.charCodeAt(V++)<<8|k.charCodeAt(V++)<<16|k.charCodeAt(V++)<<24;else for(Q=0;16>Q;++Q)q[Q]=k[V++]|k[V++]<<8|k[V++]<<16|k[V++]<<24;k=L.g[0],V=L.g[1],Q=L.g[2];var F=L.g[3],G=k+(F^V&(Q^F))+q[0]+3614090360&4294967295;k=V+(G<<7&4294967295|G>>>25),G=F+(Q^k&(V^Q))+q[1]+3905402710&4294967295,F=k+(G<<12&4294967295|G>>>20),G=Q+(V^F&(k^V))+q[2]+606105819&4294967295,Q=F+(G<<17&4294967295|G>>>15),G=V+(k^Q&(F^k))+q[3]+3250441966&4294967295,V=Q+(G<<22&4294967295|G>>>10),G=k+(F^V&(Q^F))+q[4]+4118548399&4294967295,k=V+(G<<7&4294967295|G>>>25),G=F+(Q^k&(V^Q))+q[5]+1200080426&4294967295,F=k+(G<<12&4294967295|G>>>20),G=Q+(V^F&(k^V))+q[6]+2821735955&4294967295,Q=F+(G<<17&4294967295|G>>>15),G=V+(k^Q&(F^k))+q[7]+4249261313&4294967295,V=Q+(G<<22&4294967295|G>>>10),G=k+(F^V&(Q^F))+q[8]+1770035416&4294967295,k=V+(G<<7&4294967295|G>>>25),G=F+(Q^k&(V^Q))+q[9]+2336552879&4294967295,F=k+(G<<12&4294967295|G>>>20),G=Q+(V^F&(k^V))+q[10]+4294925233&4294967295,Q=F+(G<<17&4294967295|G>>>15),G=V+(k^Q&(F^k))+q[11]+2304563134&4294967295,V=Q+(G<<22&4294967295|G>>>10),G=k+(F^V&(Q^F))+q[12]+1804603682&4294967295,k=V+(G<<7&4294967295|G>>>25),G=F+(Q^k&(V^Q))+q[13]+4254626195&4294967295,F=k+(G<<12&4294967295|G>>>20),G=Q+(V^F&(k^V))+q[14]+2792965006&4294967295,Q=F+(G<<17&4294967295|G>>>15),G=V+(k^Q&(F^k))+q[15]+1236535329&4294967295,V=Q+(G<<22&4294967295|G>>>10),G=k+(Q^F&(V^Q))+q[1]+4129170786&4294967295,k=V+(G<<5&4294967295|G>>>27),G=F+(V^Q&(k^V))+q[6]+3225465664&4294967295,F=k+(G<<9&4294967295|G>>>23),G=Q+(k^V&(F^k))+q[11]+643717713&4294967295,Q=F+(G<<14&4294967295|G>>>18),G=V+(F^k&(Q^F))+q[0]+3921069994&4294967295,V=Q+(G<<20&4294967295|G>>>12),G=k+(Q^F&(V^Q))+q[5]+3593408605&4294967295,k=V+(G<<5&4294967295|G>>>27),G=F+(V^Q&(k^V))+q[10]+38016083&4294967295,F=k+(G<<9&4294967295|G>>>23),G=Q+(k^V&(F^k))+q[15]+3634488961&4294967295,Q=F+(G<<14&4294967295|G>>>18),G=V+(F^k&(Q^F))+q[4]+3889429448&4294967295,V=Q+(G<<20&4294967295|G>>>12),G=k+(Q^F&(V^Q))+q[9]+568446438&4294967295,k=V+(G<<5&4294967295|G>>>27),G=F+(V^Q&(k^V))+q[14]+3275163606&4294967295,F=k+(G<<9&4294967295|G>>>23),G=Q+(k^V&(F^k))+q[3]+4107603335&4294967295,Q=F+(G<<14&4294967295|G>>>18),G=V+(F^k&(Q^F))+q[8]+1163531501&4294967295,V=Q+(G<<20&4294967295|G>>>12),G=k+(Q^F&(V^Q))+q[13]+2850285829&4294967295,k=V+(G<<5&4294967295|G>>>27),G=F+(V^Q&(k^V))+q[2]+4243563512&4294967295,F=k+(G<<9&4294967295|G>>>23),G=Q+(k^V&(F^k))+q[7]+1735328473&4294967295,Q=F+(G<<14&4294967295|G>>>18),G=V+(F^k&(Q^F))+q[12]+2368359562&4294967295,V=Q+(G<<20&4294967295|G>>>12),G=k+(V^Q^F)+q[5]+4294588738&4294967295,k=V+(G<<4&4294967295|G>>>28),G=F+(k^V^Q)+q[8]+2272392833&4294967295,F=k+(G<<11&4294967295|G>>>21),G=Q+(F^k^V)+q[11]+1839030562&4294967295,Q=F+(G<<16&4294967295|G>>>16),G=V+(Q^F^k)+q[14]+4259657740&4294967295,V=Q+(G<<23&4294967295|G>>>9),G=k+(V^Q^F)+q[1]+2763975236&4294967295,k=V+(G<<4&4294967295|G>>>28),G=F+(k^V^Q)+q[4]+1272893353&4294967295,F=k+(G<<11&4294967295|G>>>21),G=Q+(F^k^V)+q[7]+4139469664&4294967295,Q=F+(G<<16&4294967295|G>>>16),G=V+(Q^F^k)+q[10]+3200236656&4294967295,V=Q+(G<<23&4294967295|G>>>9),G=k+(V^Q^F)+q[13]+681279174&4294967295,k=V+(G<<4&4294967295|G>>>28),G=F+(k^V^Q)+q[0]+3936430074&4294967295,F=k+(G<<11&4294967295|G>>>21),G=Q+(F^k^V)+q[3]+3572445317&4294967295,Q=F+(G<<16&4294967295|G>>>16),G=V+(Q^F^k)+q[6]+76029189&4294967295,V=Q+(G<<23&4294967295|G>>>9),G=k+(V^Q^F)+q[9]+3654602809&4294967295,k=V+(G<<4&4294967295|G>>>28),G=F+(k^V^Q)+q[12]+3873151461&4294967295,F=k+(G<<11&4294967295|G>>>21),G=Q+(F^k^V)+q[15]+530742520&4294967295,Q=F+(G<<16&4294967295|G>>>16),G=V+(Q^F^k)+q[2]+3299628645&4294967295,V=Q+(G<<23&4294967295|G>>>9),G=k+(Q^(V|~F))+q[0]+4096336452&4294967295,k=V+(G<<6&4294967295|G>>>26),G=F+(V^(k|~Q))+q[7]+1126891415&4294967295,F=k+(G<<10&4294967295|G>>>22),G=Q+(k^(F|~V))+q[14]+2878612391&4294967295,Q=F+(G<<15&4294967295|G>>>17),G=V+(F^(Q|~k))+q[5]+4237533241&4294967295,V=Q+(G<<21&4294967295|G>>>11),G=k+(Q^(V|~F))+q[12]+1700485571&4294967295,k=V+(G<<6&4294967295|G>>>26),G=F+(V^(k|~Q))+q[3]+2399980690&4294967295,F=k+(G<<10&4294967295|G>>>22),G=Q+(k^(F|~V))+q[10]+4293915773&4294967295,Q=F+(G<<15&4294967295|G>>>17),G=V+(F^(Q|~k))+q[1]+2240044497&4294967295,V=Q+(G<<21&4294967295|G>>>11),G=k+(Q^(V|~F))+q[8]+1873313359&4294967295,k=V+(G<<6&4294967295|G>>>26),G=F+(V^(k|~Q))+q[15]+4264355552&4294967295,F=k+(G<<10&4294967295|G>>>22),G=Q+(k^(F|~V))+q[6]+2734768916&4294967295,Q=F+(G<<15&4294967295|G>>>17),G=V+(F^(Q|~k))+q[13]+1309151649&4294967295,V=Q+(G<<21&4294967295|G>>>11),G=k+(Q^(V|~F))+q[4]+4149444226&4294967295,k=V+(G<<6&4294967295|G>>>26),G=F+(V^(k|~Q))+q[11]+3174756917&4294967295,F=k+(G<<10&4294967295|G>>>22),G=Q+(k^(F|~V))+q[2]+718787259&4294967295,Q=F+(G<<15&4294967295|G>>>17),G=V+(F^(Q|~k))+q[9]+3951481745&4294967295,L.g[0]=L.g[0]+k&4294967295,L.g[1]=L.g[1]+(Q+(G<<21&4294967295|G>>>11))&4294967295,L.g[2]=L.g[2]+Q&4294967295,L.g[3]=L.g[3]+F&4294967295}i.prototype.u=function(L,k){k===void 0&&(k=L.length);for(var V=k-this.blockSize,q=this.B,Q=this.h,F=0;F<k;){if(Q==0)for(;F<=V;)s(this,L,F),F+=this.blockSize;if(typeof L=="string"){for(;F<k;)if(q[Q++]=L.charCodeAt(F++),Q==this.blockSize){s(this,q),Q=0;break}}else for(;F<k;)if(q[Q++]=L[F++],Q==this.blockSize){s(this,q),Q=0;break}}this.h=Q,this.o+=k},i.prototype.v=function(){var L=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);L[0]=128;for(var k=1;k<L.length-8;++k)L[k]=0;var V=8*this.o;for(k=L.length-8;k<L.length;++k)L[k]=V&255,V/=256;for(this.u(L),L=Array(16),k=V=0;4>k;++k)for(var q=0;32>q;q+=8)L[V++]=this.g[k]>>>q&255;return L};function l(L,k){var V=f;return Object.prototype.hasOwnProperty.call(V,L)?V[L]:V[L]=k(L)}function c(L,k){this.h=k;for(var V=[],q=!0,Q=L.length-1;0<=Q;Q--){var F=L[Q]|0;q&&F==k||(V[Q]=F,q=!1)}this.g=V}var f={};function m(L){return-128<=L&&128>L?l(L,function(k){return new c([k|0],0>k?-1:0)}):new c([L|0],0>L?-1:0)}function g(L){if(isNaN(L)||!isFinite(L))return E;if(0>L)return M(g(-L));for(var k=[],V=1,q=0;L>=V;q++)k[q]=L/V|0,V*=4294967296;return new c(k,0)}function A(L,k){if(L.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(L.charAt(0)=="-")return M(A(L.substring(1),k));if(0<=L.indexOf("-"))throw Error('number format error: interior "-" character');for(var V=g(Math.pow(k,8)),q=E,Q=0;Q<L.length;Q+=8){var F=Math.min(8,L.length-Q),G=parseInt(L.substring(Q,Q+F),k);8>F?(F=g(Math.pow(k,F)),q=q.j(F).add(g(G))):(q=q.j(V),q=q.add(g(G)))}return q}var E=m(0),T=m(1),x=m(16777216);n=c.prototype,n.m=function(){if(O(this))return-M(this).m();for(var L=0,k=1,V=0;V<this.g.length;V++){var q=this.i(V);L+=(0<=q?q:4294967296+q)*k,k*=4294967296}return L},n.toString=function(L){if(L=L||10,2>L||36<L)throw Error("radix out of range: "+L);if(R(this))return"0";if(O(this))return"-"+M(this).toString(L);for(var k=g(Math.pow(L,6)),V=this,q="";;){var Q=$(V,k).g;V=H(V,Q.j(k));var F=((0<V.g.length?V.g[0]:V.h)>>>0).toString(L);if(V=Q,R(V))return F+q;for(;6>F.length;)F="0"+F;q=F+q}},n.i=function(L){return 0>L?0:L<this.g.length?this.g[L]:this.h};function R(L){if(L.h!=0)return!1;for(var k=0;k<L.g.length;k++)if(L.g[k]!=0)return!1;return!0}function O(L){return L.h==-1}n.l=function(L){return L=H(this,L),O(L)?-1:R(L)?0:1};function M(L){for(var k=L.g.length,V=[],q=0;q<k;q++)V[q]=~L.g[q];return new c(V,~L.h).add(T)}n.abs=function(){return O(this)?M(this):this},n.add=function(L){for(var k=Math.max(this.g.length,L.g.length),V=[],q=0,Q=0;Q<=k;Q++){var F=q+(this.i(Q)&65535)+(L.i(Q)&65535),G=(F>>>16)+(this.i(Q)>>>16)+(L.i(Q)>>>16);q=G>>>16,F&=65535,G&=65535,V[Q]=G<<16|F}return new c(V,V[V.length-1]&-2147483648?-1:0)};function H(L,k){return L.add(M(k))}n.j=function(L){if(R(this)||R(L))return E;if(O(this))return O(L)?M(this).j(M(L)):M(M(this).j(L));if(O(L))return M(this.j(M(L)));if(0>this.l(x)&&0>L.l(x))return g(this.m()*L.m());for(var k=this.g.length+L.g.length,V=[],q=0;q<2*k;q++)V[q]=0;for(q=0;q<this.g.length;q++)for(var Q=0;Q<L.g.length;Q++){var F=this.i(q)>>>16,G=this.i(q)&65535,Ot=L.i(Q)>>>16,Vt=L.i(Q)&65535;V[2*q+2*Q]+=G*Vt,B(V,2*q+2*Q),V[2*q+2*Q+1]+=F*Vt,B(V,2*q+2*Q+1),V[2*q+2*Q+1]+=G*Ot,B(V,2*q+2*Q+1),V[2*q+2*Q+2]+=F*Ot,B(V,2*q+2*Q+2)}for(q=0;q<k;q++)V[q]=V[2*q+1]<<16|V[2*q];for(q=k;q<2*k;q++)V[q]=0;return new c(V,0)};function B(L,k){for(;(L[k]&65535)!=L[k];)L[k+1]+=L[k]>>>16,L[k]&=65535,k++}function Y(L,k){this.g=L,this.h=k}function $(L,k){if(R(k))throw Error("division by zero");if(R(L))return new Y(E,E);if(O(L))return k=$(M(L),k),new Y(M(k.g),M(k.h));if(O(k))return k=$(L,M(k)),new Y(M(k.g),k.h);if(30<L.g.length){if(O(L)||O(k))throw Error("slowDivide_ only works with positive integers.");for(var V=T,q=k;0>=q.l(L);)V=nt(V),q=nt(q);var Q=X(V,1),F=X(q,1);for(q=X(q,2),V=X(V,2);!R(q);){var G=F.add(q);0>=G.l(L)&&(Q=Q.add(V),F=G),q=X(q,1),V=X(V,1)}return k=H(L,Q.j(k)),new Y(Q,k)}for(Q=E;0<=L.l(k);){for(V=Math.max(1,Math.floor(L.m()/k.m())),q=Math.ceil(Math.log(V)/Math.LN2),q=48>=q?1:Math.pow(2,q-48),F=g(V),G=F.j(k);O(G)||0<G.l(L);)V-=q,F=g(V),G=F.j(k);R(F)&&(F=T),Q=Q.add(F),L=H(L,G)}return new Y(Q,L)}n.A=function(L){return $(this,L).h},n.and=function(L){for(var k=Math.max(this.g.length,L.g.length),V=[],q=0;q<k;q++)V[q]=this.i(q)&L.i(q);return new c(V,this.h&L.h)},n.or=function(L){for(var k=Math.max(this.g.length,L.g.length),V=[],q=0;q<k;q++)V[q]=this.i(q)|L.i(q);return new c(V,this.h|L.h)},n.xor=function(L){for(var k=Math.max(this.g.length,L.g.length),V=[],q=0;q<k;q++)V[q]=this.i(q)^L.i(q);return new c(V,this.h^L.h)};function nt(L){for(var k=L.g.length+1,V=[],q=0;q<k;q++)V[q]=L.i(q)<<1|L.i(q-1)>>>31;return new c(V,L.h)}function X(L,k){var V=k>>5;k%=32;for(var q=L.g.length-V,Q=[],F=0;F<q;F++)Q[F]=0<k?L.i(F+V)>>>k|L.i(F+V+1)<<32-k:L.i(F+V);return new c(Q,L.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,T5=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=g,c.fromString=A,th=c}).apply(typeof DT<"u"?DT:typeof self<"u"?self:typeof window<"u"?window:{});var cy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var b5,Eg,C5,ky,nA,w5,R5,x5;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(_,w,D){return _==Array.prototype||_==Object.prototype||(_[w]=D.value),_};function e(_){_=[typeof globalThis=="object"&&globalThis,_,typeof window=="object"&&window,typeof self=="object"&&self,typeof cy=="object"&&cy];for(var w=0;w<_.length;++w){var D=_[w];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var i=e(this);function s(_,w){if(w)t:{var D=i;_=_.split(".");for(var z=0;z<_.length-1;z++){var rt=_[z];if(!(rt in D))break t;D=D[rt]}_=_[_.length-1],z=D[_],w=w(z),w!=z&&w!=null&&t(D,_,{configurable:!0,writable:!0,value:w})}}function l(_,w){_ instanceof String&&(_+="");var D=0,z=!1,rt={next:function(){if(!z&&D<_.length){var pt=D++;return{value:w(pt,_[pt]),done:!1}}return z=!0,{done:!0,value:void 0}}};return rt[Symbol.iterator]=function(){return rt},rt}s("Array.prototype.values",function(_){return _||function(){return l(this,function(w,D){return D})}});var c=c||{},f=this||self;function m(_){var w=typeof _;return w=w!="object"?w:_?Array.isArray(_)?"array":w:"null",w=="array"||w=="object"&&typeof _.length=="number"}function g(_){var w=typeof _;return w=="object"&&_!=null||w=="function"}function A(_,w,D){return _.call.apply(_.bind,arguments)}function E(_,w,D){if(!_)throw Error();if(2<arguments.length){var z=Array.prototype.slice.call(arguments,2);return function(){var rt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(rt,z),_.apply(w,rt)}}return function(){return _.apply(w,arguments)}}function T(_,w,D){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?A:E,T.apply(null,arguments)}function x(_,w){var D=Array.prototype.slice.call(arguments,1);return function(){var z=D.slice();return z.push.apply(z,arguments),_.apply(this,z)}}function R(_,w){function D(){}D.prototype=w.prototype,_.aa=w.prototype,_.prototype=new D,_.prototype.constructor=_,_.Qb=function(z,rt,pt){for(var Lt=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)Lt[Fe-2]=arguments[Fe];return w.prototype[rt].apply(z,Lt)}}function O(_){const w=_.length;if(0<w){const D=Array(w);for(let z=0;z<w;z++)D[z]=_[z];return D}return[]}function M(_,w){for(let D=1;D<arguments.length;D++){const z=arguments[D];if(m(z)){const rt=_.length||0,pt=z.length||0;_.length=rt+pt;for(let Lt=0;Lt<pt;Lt++)_[rt+Lt]=z[Lt]}else _.push(z)}}class H{constructor(w,D){this.i=w,this.j=D,this.h=0,this.g=null}get(){let w;return 0<this.h?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function B(_){return/^[\s\xa0]*$/.test(_)}function Y(){var _=f.navigator;return _&&(_=_.userAgent)?_:""}function $(_){return $[" "](_),_}$[" "]=function(){};var nt=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function X(_,w,D){for(const z in _)w.call(D,_[z],z,_)}function L(_,w){for(const D in _)w.call(void 0,_[D],D,_)}function k(_){const w={};for(const D in _)w[D]=_[D];return w}const V="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q(_,w){let D,z;for(let rt=1;rt<arguments.length;rt++){z=arguments[rt];for(D in z)_[D]=z[D];for(let pt=0;pt<V.length;pt++)D=V[pt],Object.prototype.hasOwnProperty.call(z,D)&&(_[D]=z[D])}}function Q(_){var w=1;_=_.split(":");const D=[];for(;0<w&&_.length;)D.push(_.shift()),w--;return _.length&&D.push(_.join(":")),D}function F(_){f.setTimeout(()=>{throw _},0)}function G(){var _=Mt;let w=null;return _.g&&(w=_.g,_.g=_.g.next,_.g||(_.h=null),w.next=null),w}class Ot{constructor(){this.h=this.g=null}add(w,D){const z=Vt.get();z.set(w,D),this.h?this.h.next=z:this.g=z,this.h=z}}var Vt=new H(()=>new tt,_=>_.reset());class tt{constructor(){this.next=this.g=this.h=null}set(w,D){this.h=w,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let At,yt=!1,Mt=new Ot,Qt=()=>{const _=f.Promise.resolve(void 0);At=()=>{_.then(W)}};var W=()=>{for(var _;_=G();){try{_.h.call(_.g)}catch(D){F(D)}var w=Vt;w.j(_),100>w.h&&(w.h++,_.next=w.g,w.g=_)}yt=!1};function ft(){this.s=this.s,this.C=this.C}ft.prototype.s=!1,ft.prototype.ma=function(){this.s||(this.s=!0,this.N())},ft.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function bt(_,w){this.type=_,this.g=this.target=w,this.defaultPrevented=!1}bt.prototype.h=function(){this.defaultPrevented=!0};var Ft=(function(){if(!f.addEventListener||!Object.defineProperty)return!1;var _=!1,w=Object.defineProperty({},"passive",{get:function(){_=!0}});try{const D=()=>{};f.addEventListener("test",D,w),f.removeEventListener("test",D,w)}catch{}return _})();function qt(_,w){if(bt.call(this,_?_.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,_){var D=this.type=_.type,z=_.changedTouches&&_.changedTouches.length?_.changedTouches[0]:null;if(this.target=_.target||_.srcElement,this.g=w,w=_.relatedTarget){if(nt){t:{try{$(w.nodeName);var rt=!0;break t}catch{}rt=!1}rt||(w=null)}}else D=="mouseover"?w=_.fromElement:D=="mouseout"&&(w=_.toElement);this.relatedTarget=w,z?(this.clientX=z.clientX!==void 0?z.clientX:z.pageX,this.clientY=z.clientY!==void 0?z.clientY:z.pageY,this.screenX=z.screenX||0,this.screenY=z.screenY||0):(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0),this.button=_.button,this.key=_.key||"",this.ctrlKey=_.ctrlKey,this.altKey=_.altKey,this.shiftKey=_.shiftKey,this.metaKey=_.metaKey,this.pointerId=_.pointerId||0,this.pointerType=typeof _.pointerType=="string"?_.pointerType:re[_.pointerType]||"",this.state=_.state,this.i=_,_.defaultPrevented&&qt.aa.h.call(this)}}R(qt,bt);var re={2:"touch",3:"pen",4:"mouse"};qt.prototype.h=function(){qt.aa.h.call(this);var _=this.i;_.preventDefault?_.preventDefault():_.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),qe=0;function De(_,w,D,z,rt){this.listener=_,this.proxy=null,this.src=w,this.type=D,this.capture=!!z,this.ha=rt,this.key=++qe,this.da=this.fa=!1}function bi(_){_.da=!0,_.listener=null,_.proxy=null,_.src=null,_.ha=null}function ea(_){this.src=_,this.g={},this.h=0}ea.prototype.add=function(_,w,D,z,rt){var pt=_.toString();_=this.g[pt],_||(_=this.g[pt]=[],this.h++);var Lt=Zi(_,w,z,rt);return-1<Lt?(w=_[Lt],D||(w.fa=!1)):(w=new De(w,this.src,pt,!!z,rt),w.fa=D,_.push(w)),w};function Nt(_,w){var D=w.type;if(D in _.g){var z=_.g[D],rt=Array.prototype.indexOf.call(z,w,void 0),pt;(pt=0<=rt)&&Array.prototype.splice.call(z,rt,1),pt&&(bi(w),_.g[D].length==0&&(delete _.g[D],_.h--))}}function Zi(_,w,D,z){for(var rt=0;rt<_.length;++rt){var pt=_[rt];if(!pt.da&&pt.listener==w&&pt.capture==!!D&&pt.ha==z)return rt}return-1}var $i="closure_lm_"+(1e6*Math.random()|0),Ze={};function Bi(_,w,D,z,rt){if(Array.isArray(w)){for(var pt=0;pt<w.length;pt++)Bi(_,w[pt],D,z,rt);return null}return D=Vo(D),_&&_[ne]?_.K(w,D,g(z)?!!z.capture:!1,rt):ds(_,w,D,!1,z,rt)}function ds(_,w,D,z,rt,pt){if(!w)throw Error("Invalid event type");var Lt=g(rt)?!!rt.capture:!!rt,Fe=Ln(_);if(Fe||(_[$i]=Fe=new ea(_)),D=Fe.add(w,D,z,Lt,pt),D.proxy)return D;if(z=ql(),D.proxy=z,z.src=_,z.listener=D,_.addEventListener)Ft||(rt=Lt),rt===void 0&&(rt=!1),_.addEventListener(w.toString(),z,rt);else if(_.attachEvent)_.attachEvent(Wa(w.toString()),z);else if(_.addListener&&_.removeListener)_.addListener(z);else throw Error("addEventListener and attachEvent are unavailable.");return D}function ql(){function _(D){return w.call(_.src,_.listener,D)}const w=ks;return _}function Ka(_,w,D,z,rt){if(Array.isArray(w))for(var pt=0;pt<w.length;pt++)Ka(_,w[pt],D,z,rt);else z=g(z)?!!z.capture:!!z,D=Vo(D),_&&_[ne]?(_=_.i,w=String(w).toString(),w in _.g&&(pt=_.g[w],D=Zi(pt,D,z,rt),-1<D&&(bi(pt[D]),Array.prototype.splice.call(pt,D,1),pt.length==0&&(delete _.g[w],_.h--)))):_&&(_=Ln(_))&&(w=_.g[w.toString()],_=-1,w&&(_=Zi(w,D,z,rt)),(D=-1<_?w[_]:null)&&Ls(D))}function Ls(_){if(typeof _!="number"&&_&&!_.da){var w=_.src;if(w&&w[ne])Nt(w.i,_);else{var D=_.type,z=_.proxy;w.removeEventListener?w.removeEventListener(D,z,_.capture):w.detachEvent?w.detachEvent(Wa(D),z):w.addListener&&w.removeListener&&w.removeListener(z),(D=Ln(w))?(Nt(D,_),D.h==0&&(D.src=null,w[$i]=null)):bi(_)}}}function Wa(_){return _ in Ze?Ze[_]:Ze[_]="on"+_}function ks(_,w){if(_.da)_=!0;else{w=new qt(w,this);var D=_.listener,z=_.ha||_.src;_.fa&&Ls(_),_=D.call(z,w)}return _}function Ln(_){return _=_[$i],_ instanceof ea?_:null}var Qn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vo(_){return typeof _=="function"?_:(_[Qn]||(_[Qn]=function(w){return _.handleEvent(w)}),_[Qn])}function kn(){ft.call(this),this.i=new ea(this),this.M=this,this.F=null}R(kn,ft),kn.prototype[ne]=!0,kn.prototype.removeEventListener=function(_,w,D,z){Ka(this,_,w,D,z)};function Cn(_,w){var D,z=_.F;if(z)for(D=[];z;z=z.F)D.push(z);if(_=_.M,z=w.type||w,typeof w=="string")w=new bt(w,_);else if(w instanceof bt)w.target=w.target||_;else{var rt=w;w=new bt(z,_),q(w,rt)}if(rt=!0,D)for(var pt=D.length-1;0<=pt;pt--){var Lt=w.g=D[pt];rt=Ps(Lt,z,!0,w)&&rt}if(Lt=w.g=_,rt=Ps(Lt,z,!0,w)&&rt,rt=Ps(Lt,z,!1,w)&&rt,D)for(pt=0;pt<D.length;pt++)Lt=w.g=D[pt],rt=Ps(Lt,z,!1,w)&&rt}kn.prototype.N=function(){if(kn.aa.N.call(this),this.i){var _=this.i,w;for(w in _.g){for(var D=_.g[w],z=0;z<D.length;z++)bi(D[z]);delete _.g[w],_.h--}}this.F=null},kn.prototype.K=function(_,w,D,z){return this.i.add(String(_),w,!1,D,z)},kn.prototype.L=function(_,w,D,z){return this.i.add(String(_),w,!0,D,z)};function Ps(_,w,D,z){if(w=_.i.g[String(w)],!w)return!0;w=w.concat();for(var rt=!0,pt=0;pt<w.length;++pt){var Lt=w[pt];if(Lt&&!Lt.da&&Lt.capture==D){var Fe=Lt.listener,$n=Lt.ha||Lt.src;Lt.fa&&Nt(_.i,Lt),rt=Fe.call($n,z)!==!1&&rt}}return rt&&!z.defaultPrevented}function ms(_,w,D){if(typeof _=="function")D&&(_=T(_,D));else if(_&&typeof _.handleEvent=="function")_=T(_.handleEvent,_);else throw Error("Invalid listener argument");return 2147483647<Number(w)?-1:f.setTimeout(_,w||0)}function _a(_){_.g=ms(()=>{_.g=null,_.i&&(_.i=!1,_a(_))},_.l);const w=_.h;_.h=null,_.m.apply(null,w)}class Xu extends ft{constructor(w,D){super(),this.m=w,this.l=D,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:_a(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function vr(_){ft.call(this),this.h=_,this.g={}}R(vr,ft);var Ja=[];function di(_){X(_.g,function(w,D){this.g.hasOwnProperty(D)&&Ls(w)},_),_.g={}}vr.prototype.N=function(){vr.aa.N.call(this),di(this)},vr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ps=f.JSON.stringify,ji=f.JSON.parse,Uo=class{stringify(_){return f.JSON.stringify(_,void 0)}parse(_){return f.JSON.parse(_,void 0)}};function zo(){}zo.prototype.h=null;function Bo(_){return _.h||(_.h=_.i())}function Za(){}var Vs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ht(){bt.call(this,"d")}R(ht,bt);function St(){bt.call(this,"c")}R(St,bt);var jt={},Bt=null;function Jt(){return Bt=Bt||new kn}jt.La="serverreachability";function Xe(_){bt.call(this,jt.La,_)}R(Xe,bt);function Pn(_){const w=Jt();Cn(w,new Xe(w))}jt.STAT_EVENT="statevent";function ts(_,w){bt.call(this,jt.STAT_EVENT,_),this.stat=w}R(ts,bt);function Vn(_){const w=Jt();Cn(w,new ts(w,_))}jt.Ma="timingevent";function ya(_,w){bt.call(this,jt.Ma,_),this.size=w}R(ya,bt);function $a(_,w){if(typeof _!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){_()},w)}function sl(){this.g=!0}sl.prototype.xa=function(){this.g=!1};function Fl(_,w,D,z,rt,pt){_.info(function(){if(_.g)if(pt)for(var Lt="",Fe=pt.split("&"),$n=0;$n<Fe.length;$n++){var ye=Fe[$n].split("=");if(1<ye.length){var gi=ye[0];ye=ye[1];var oi=gi.split("_");Lt=2<=oi.length&&oi[1]=="type"?Lt+(gi+"="+ye+"&"):Lt+(gi+"=redacted&")}}else Lt=null;else Lt=pt;return"XMLHTTP REQ ("+z+") [attempt "+rt+"]: "+w+`
`+D+`
`+Lt})}function Yl(_,w,D,z,rt,pt,Lt){_.info(function(){return"XMLHTTP RESP ("+z+") [ attempt "+rt+"]: "+w+`
`+D+`
`+pt+" "+Lt})}function tr(_,w,D,z){_.info(function(){return"XMLHTTP TEXT ("+w+"): "+er(_,D)+(z?" "+z:"")})}function Ar(_,w){_.info(function(){return"TIMEOUT: "+w})}sl.prototype.info=function(){};function er(_,w){if(!_.g)return w;if(!w)return null;try{var D=JSON.parse(w);if(D){for(_=0;_<D.length;_++)if(Array.isArray(D[_])){var z=D[_];if(!(2>z.length)){var rt=z[1];if(Array.isArray(rt)&&!(1>rt.length)){var pt=rt[0];if(pt!="noop"&&pt!="stop"&&pt!="close")for(var Lt=1;Lt<rt.length;Lt++)rt[Lt]=""}}}}return ps(D)}catch{return w}}var vn={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},mi={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},va;function gs(){}R(gs,zo),gs.prototype.g=function(){return new XMLHttpRequest},gs.prototype.i=function(){return{}},va=new gs;function Hi(_,w,D,z){this.j=_,this.i=w,this.l=D,this.R=z||1,this.U=new vr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ql}function Ql(){this.i=null,this.g="",this.h=!1}var jo={},na={};function nr(_,w,D){_.L=1,_.v=ll(dn(w)),_.m=D,_.P=!0,Er(_,null)}function Er(_,w){_.F=Date.now(),ia(_),_.A=dn(_.v);var D=_.A,z=_.R;Array.isArray(z)||(z=[String(z)]),wr(D.i,"t",z),_.C=0,D=_.j.J,_.h=new Ql,_.g=Uh(_.j,D?w:null,!_.m),0<_.O&&(_.M=new Xu(T(_.Y,_,_.g),_.O)),w=_.U,D=_.g,z=_.ca;var rt="readystatechange";Array.isArray(rt)||(rt&&(Ja[0]=rt.toString()),rt=Ja);for(var pt=0;pt<rt.length;pt++){var Lt=Bi(D,rt[pt],z||w.handleEvent,!1,w.h||w);if(!Lt)break;w.g[Lt.key]=Lt}w=_.H?k(_.H):{},_.m?(_.u||(_.u="POST"),w["Content-Type"]="application/x-www-form-urlencoded",_.g.ea(_.A,_.u,_.m,w)):(_.u="GET",_.g.ea(_.A,_.u,null,w)),Pn(),Fl(_.i,_.u,_.A,_.l,_.R,_.m)}Hi.prototype.ca=function(_){_=_.target;const w=this.M;w&&ns(_)==3?w.j():this.Y(_)},Hi.prototype.Y=function(_){try{if(_==this.g)t:{const oi=ns(this.g);var w=this.g.Ba();const Ir=this.g.Z();if(!(3>oi)&&(oi!=3||this.g&&(this.h.h||this.g.oa()||ul(this.g)))){this.J||oi!=4||w==7||(w==8||0>=Ir?Pn(3):Pn(2)),sa(this);var D=this.g.Z();this.X=D;e:if(Sr(this)){var z=ul(this.g);_="";var rt=z.length,pt=ns(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){es(this),Tr(this);var Lt="";break e}this.h.i=new f.TextDecoder}for(w=0;w<rt;w++)this.h.h=!0,_+=this.h.i.decode(z[w],{stream:!(pt&&w==rt-1)});z.length=0,this.h.g+=_,this.C=0,Lt=this.h.g}else Lt=this.g.oa();if(this.o=D==200,Yl(this.i,this.u,this.A,this.l,this.R,oi,D),this.o){if(this.T&&!this.K){e:{if(this.g){var Fe,$n=this.g;if((Fe=$n.g?$n.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!B(Fe)){var ye=Fe;break e}}ye=null}if(D=ye)tr(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gi(this,D);else{this.o=!1,this.s=3,Vn(12),es(this),Tr(this);break t}}if(this.P){D=!0;let Es;for(;!this.J&&this.C<Lt.length;)if(Es=Xl(this,Lt),Es==na){oi==4&&(this.s=4,Vn(14),D=!1),tr(this.i,this.l,null,"[Incomplete Response]");break}else if(Es==jo){this.s=4,Vn(15),tr(this.i,this.l,Lt,"[Invalid Chunk]"),D=!1;break}else tr(this.i,this.l,Es,null),Gi(this,Es);if(Sr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),oi!=4||Lt.length!=0||this.h.h||(this.s=1,Vn(16),D=!1),this.o=this.o&&D,!D)tr(this.i,this.l,Lt,"[Invalid Chunked Response]"),es(this),Tr(this);else if(0<Lt.length&&!this.W){this.W=!0;var gi=this.j;gi.g==this&&gi.ba&&!gi.M&&(gi.j.info("Great, no buffering proxy detected. Bytes received: "+Lt.length),nc(gi),gi.M=!0,Vn(11))}}else tr(this.i,this.l,Lt,null),Gi(this,Lt);oi==4&&es(this),this.o&&!this.J&&(oi==4?Vh(this.j,this):(this.o=!1,ia(this)))}else Mh(this.g),D==400&&0<Lt.indexOf("Unknown SID")?(this.s=3,Vn(12)):(this.s=0,Vn(13)),es(this),Tr(this)}}}catch{}};function Sr(_){return _.g?_.u=="GET"&&_.L!=2&&_.j.Ca:!1}function Xl(_,w){var D=_.C,z=w.indexOf(`
`,D);return z==-1?na:(D=Number(w.substring(D,z)),isNaN(D)?jo:(z+=1,z+D>w.length?na:(w=w.slice(z,z+D),_.C=z+D,w)))}Hi.prototype.cancel=function(){this.J=!0,es(this)};function ia(_){_.S=Date.now()+_.I,Un(_,_.I)}function Un(_,w){if(_.B!=null)throw Error("WatchDog timer not null");_.B=$a(T(_.ba,_),w)}function sa(_){_.B&&(f.clearTimeout(_.B),_.B=null)}Hi.prototype.ba=function(){this.B=null;const _=Date.now();0<=_-this.S?(Ar(this.i,this.A),this.L!=2&&(Pn(),Vn(17)),es(this),this.s=2,Tr(this)):Un(this,this.S-_)};function Tr(_){_.j.G==0||_.J||Vh(_.j,_)}function es(_){sa(_);var w=_.M;w&&typeof w.ma=="function"&&w.ma(),_.M=null,di(_.U),_.g&&(w=_.g,_.g=null,w.abort(),w.ma())}function Gi(_,w){try{var D=_.j;if(D.G!=0&&(D.g==_||br(D.h,_))){if(!_.K&&br(D.h,_)&&D.G==3){try{var z=D.Da.g.parse(w)}catch{z=null}if(Array.isArray(z)&&z.length==3){var rt=z;if(rt[0]==0){t:if(!D.u){if(D.g)if(D.g.F+3e3<_.F)hl(D),cl(D);else break t;ec(D),Vn(18)}}else D.za=rt[1],0<D.za-D.T&&37500>rt[2]&&D.F&&D.v==0&&!D.C&&(D.C=$a(T(D.Za,D),6e3));if(1>=Ku(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else Sa(D,11)}else if((_.K||D.g==_)&&hl(D),!B(w))for(rt=D.Da.g.parse(w),w=0;w<rt.length;w++){let ye=rt[w];if(D.T=ye[0],ye=ye[1],D.G==2)if(ye[0]=="c"){D.K=ye[1],D.ia=ye[2];const gi=ye[3];gi!=null&&(D.la=gi,D.j.info("VER="+D.la));const oi=ye[4];oi!=null&&(D.Aa=oi,D.j.info("SVER="+D.Aa));const Ir=ye[5];Ir!=null&&typeof Ir=="number"&&0<Ir&&(z=1.5*Ir,D.L=z,D.j.info("backChannelRequestTimeoutMs_="+z)),z=D;const Es=_.g;if(Es){const dl=Es.g?Es.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(dl){var pt=z.h;pt.g||dl.indexOf("spdy")==-1&&dl.indexOf("quic")==-1&&dl.indexOf("h2")==-1||(pt.j=pt.l,pt.g=new Set,pt.h&&(al(pt,pt.h),pt.h=null))}if(z.D){const Ta=Es.g?Es.g.getResponseHeader("X-HTTP-Session-Id"):null;Ta&&(z.ya=Ta,ke(z.I,z.D,Ta))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-_.F,D.j.info("Handshake RTT: "+D.R+"ms")),z=D;var Lt=_;if(z.qa=ac(z,z.J?z.ia:null,z.W),Lt.K){aa(z.h,Lt);var Fe=Lt,$n=z.L;$n&&(Fe.I=$n),Fe.B&&(sa(Fe),ia(Fe)),z.g=Lt}else Xo(z);0<D.i.length&&tc(D)}else ye[0]!="stop"&&ye[0]!="close"||Sa(D,7);else D.G==3&&(ye[0]=="stop"||ye[0]=="close"?ye[0]=="stop"?Sa(D,7):Yo(D):ye[0]!="noop"&&D.l&&D.l.ta(ye),D.v=0)}}Pn(4)}catch{}}var _s=class{constructor(_,w){this.g=_,this.map=w}};function Kl(_){this.l=_||10,f.PerformanceNavigationTiming?(_=f.performance.getEntriesByType("navigation"),_=0<_.length&&(_[0].nextHopProtocol=="hq"||_[0].nextHopProtocol=="h2")):_=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=_?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function hn(_){return _.h?!0:_.g?_.g.size>=_.j:!1}function Ku(_){return _.h?1:_.g?_.g.size:0}function br(_,w){return _.h?_.h==w:_.g?_.g.has(w):!1}function al(_,w){_.g?_.g.add(w):_.h=w}function aa(_,w){_.h&&_.h==w?_.h=null:_.g&&_.g.has(w)&&_.g.delete(w)}Kl.prototype.cancel=function(){if(this.i=ys(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const _ of this.g.values())_.cancel();this.g.clear()}};function ys(_){if(_.h!=null)return _.i.concat(_.h.D);if(_.g!=null&&_.g.size!==0){let w=_.i;for(const D of _.g.values())w=w.concat(D.D);return w}return O(_.i)}function Wu(_){if(_.V&&typeof _.V=="function")return _.V();if(typeof Map<"u"&&_ instanceof Map||typeof Set<"u"&&_ instanceof Set)return Array.from(_.values());if(typeof _=="string")return _.split("");if(m(_)){for(var w=[],D=_.length,z=0;z<D;z++)w.push(_[z]);return w}w=[],D=0;for(z in _)w[D++]=_[z];return w}function wh(_){if(_.na&&typeof _.na=="function")return _.na();if(!_.V||typeof _.V!="function"){if(typeof Map<"u"&&_ instanceof Map)return Array.from(_.keys());if(!(typeof Set<"u"&&_ instanceof Set)){if(m(_)||typeof _=="string"){var w=[];_=_.length;for(var D=0;D<_;D++)w.push(D);return w}w=[],D=0;for(const z in _)w[D++]=z;return w}}}function Wl(_,w){if(_.forEach&&typeof _.forEach=="function")_.forEach(w,void 0);else if(m(_)||typeof _=="string")Array.prototype.forEach.call(_,w,void 0);else for(var D=wh(_),z=Wu(_),rt=z.length,pt=0;pt<rt;pt++)w.call(void 0,z[pt],D&&D[pt],_)}var pi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fn(_,w){if(_){_=_.split("&");for(var D=0;D<_.length;D++){var z=_[D].indexOf("="),rt=null;if(0<=z){var pt=_[D].substring(0,z);rt=_[D].substring(z+1)}else pt=_[D];w(pt,rt?decodeURIComponent(rt.replace(/\+/g," ")):"")}}}function Aa(_){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,_ instanceof Aa){this.h=_.h,ir(this,_.j),this.o=_.o,this.g=_.g,rl(this,_.s),this.l=_.l;var w=_.i,D=new sr;D.i=w.i,w.g&&(D.g=new Map(w.g),D.h=w.h),Us(this,D),this.m=_.m}else _&&(w=String(_).match(pi))?(this.h=!1,ir(this,w[1]||"",!0),this.o=Cr(w[2]||""),this.g=Cr(w[3]||"",!0),rl(this,w[4]),this.l=Cr(w[5]||"",!0),Us(this,w[6]||"",!0),this.m=Cr(w[7]||"")):(this.h=!1,this.i=new sr(null,this.h))}Aa.prototype.toString=function(){var _=[],w=this.j;w&&_.push(ra(w,Ju,!0),":");var D=this.g;return(D||w=="file")&&(_.push("//"),(w=this.o)&&_.push(ra(w,Ju,!0),"@"),_.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&_.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&_.push("/"),_.push(ra(D,D.charAt(0)=="/"?Zu:Rh,!0))),(D=this.i.toString())&&_.push("?",D),(D=this.m)&&_.push("#",ra(D,xh)),_.join("")};function dn(_){return new Aa(_)}function ir(_,w,D){_.j=D?Cr(w,!0):w,_.j&&(_.j=_.j.replace(/:$/,""))}function rl(_,w){if(w){if(w=Number(w),isNaN(w)||0>w)throw Error("Bad port number "+w);_.s=w}else _.s=null}function Us(_,w,D){w instanceof sr?(_.i=w,Nh(_.i,_.h)):(D||(w=ra(w,$f)),_.i=new sr(w,_.h))}function ke(_,w,D){_.i.set(w,D)}function ll(_){return ke(_,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),_}function Cr(_,w){return _?w?decodeURI(_.replace(/%25/g,"%2525")):decodeURIComponent(_):""}function ra(_,w,D){return typeof _=="string"?(_=encodeURI(_).replace(w,Zf),D&&(_=_.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_):null}function Zf(_){return _=_.charCodeAt(0),"%"+(_>>4&15).toString(16)+(_&15).toString(16)}var Ju=/[#\/\?@]/g,Rh=/[#\?:]/g,Zu=/[#\?]/g,$f=/[#\?@]/g,xh=/#/g;function sr(_,w){this.h=this.g=null,this.i=_||null,this.j=!!w}function Ci(_){_.g||(_.g=new Map,_.h=0,_.i&&fn(_.i,function(w,D){_.add(decodeURIComponent(w.replace(/\+/g," ")),D)}))}n=sr.prototype,n.add=function(_,w){Ci(this),this.i=null,_=vs(this,_);var D=this.g.get(_);return D||this.g.set(_,D=[]),D.push(w),this.h+=1,this};function Ho(_,w){Ci(_),w=vs(_,w),_.g.has(w)&&(_.i=null,_.h-=_.g.get(w).length,_.g.delete(w))}function Go(_,w){return Ci(_),w=vs(_,w),_.g.has(w)}n.forEach=function(_,w){Ci(this),this.g.forEach(function(D,z){D.forEach(function(rt){_.call(w,rt,z,this)},this)},this)},n.na=function(){Ci(this);const _=Array.from(this.g.values()),w=Array.from(this.g.keys()),D=[];for(let z=0;z<w.length;z++){const rt=_[z];for(let pt=0;pt<rt.length;pt++)D.push(w[z])}return D},n.V=function(_){Ci(this);let w=[];if(typeof _=="string")Go(this,_)&&(w=w.concat(this.g.get(vs(this,_))));else{_=Array.from(this.g.values());for(let D=0;D<_.length;D++)w=w.concat(_[D])}return w},n.set=function(_,w){return Ci(this),this.i=null,_=vs(this,_),Go(this,_)&&(this.h-=this.g.get(_).length),this.g.set(_,[w]),this.h+=1,this},n.get=function(_,w){return _?(_=this.V(_),0<_.length?String(_[0]):w):w};function wr(_,w,D){Ho(_,w),0<D.length&&(_.i=null,_.g.set(vs(_,w),O(D)),_.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const _=[],w=Array.from(this.g.keys());for(var D=0;D<w.length;D++){var z=w[D];const pt=encodeURIComponent(String(z)),Lt=this.V(z);for(z=0;z<Lt.length;z++){var rt=pt;Lt[z]!==""&&(rt+="="+encodeURIComponent(String(Lt[z]))),_.push(rt)}}return this.i=_.join("&")};function vs(_,w){return w=String(w),_.j&&(w=w.toLowerCase()),w}function Nh(_,w){w&&!_.j&&(Ci(_),_.i=null,_.g.forEach(function(D,z){var rt=z.toLowerCase();z!=rt&&(Ho(this,z),wr(this,rt,D))},_)),_.j=w}function $u(_,w){const D=new sl;if(f.Image){const z=new Image;z.onload=x(As,D,"TestLoadImage: loaded",!0,w,z),z.onerror=x(As,D,"TestLoadImage: error",!1,w,z),z.onabort=x(As,D,"TestLoadImage: abort",!1,w,z),z.ontimeout=x(As,D,"TestLoadImage: timeout",!1,w,z),f.setTimeout(function(){z.ontimeout&&z.ontimeout()},1e4),z.src=_}else w(!1)}function Dh(_,w){const D=new sl,z=new AbortController,rt=setTimeout(()=>{z.abort(),As(D,"TestPingServer: timeout",!1,w)},1e4);fetch(_,{signal:z.signal}).then(pt=>{clearTimeout(rt),pt.ok?As(D,"TestPingServer: ok",!0,w):As(D,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(rt),As(D,"TestPingServer: error",!1,w)})}function As(_,w,D,z,rt){try{rt&&(rt.onload=null,rt.onerror=null,rt.onabort=null,rt.ontimeout=null),z(D)}catch{}}function Ea(){this.g=new Uo}function Ih(_,w,D){const z=D||"";try{Wl(_,function(rt,pt){let Lt=rt;g(rt)&&(Lt=ps(rt)),w.push(z+pt+"="+encodeURIComponent(Lt))})}catch(rt){throw w.push(z+"type="+encodeURIComponent("_badmap")),rt}}function ar(_){this.l=_.Ub||null,this.j=_.eb||!1}R(ar,zo),ar.prototype.g=function(){return new wi(this.l,this.j)},ar.prototype.i=(function(_){return function(){return _}})({});function wi(_,w){kn.call(this),this.D=_,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(wi,kn),n=wi.prototype,n.open=function(_,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=_,this.A=w,this.readyState=1,rr(this)},n.send=function(_){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const w={headers:this.u,method:this.B,credentials:this.m,cache:void 0};_&&(w.body=_),(this.D||f).fetch(new Request(this.A,w)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,la(this)),this.readyState=0},n.Sa=function(_){if(this.g&&(this.l=_,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=_.headers,this.readyState=2,rr(this)),this.g&&(this.readyState=3,rr(this),this.g)))if(this.responseType==="arraybuffer")_.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in _){if(this.j=_.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qo(this)}else _.text().then(this.Ra.bind(this),this.ga.bind(this))};function qo(_){_.j.read().then(_.Pa.bind(_)).catch(_.ga.bind(_))}n.Pa=function(_){if(this.g){if(this.o&&_.value)this.response.push(_.value);else if(!this.o){var w=_.value?_.value:new Uint8Array(0);(w=this.v.decode(w,{stream:!_.done}))&&(this.response=this.responseText+=w)}_.done?la(this):rr(this),this.readyState==3&&qo(this)}},n.Ra=function(_){this.g&&(this.response=this.responseText=_,la(this))},n.Qa=function(_){this.g&&(this.response=_,la(this))},n.ga=function(){this.g&&la(this)};function la(_){_.readyState=4,_.l=null,_.j=null,_.v=null,rr(_)}n.setRequestHeader=function(_,w){this.u.append(_,w)},n.getResponseHeader=function(_){return this.h&&this.h.get(_.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const _=[],w=this.h.entries();for(var D=w.next();!D.done;)D=D.value,_.push(D[0]+": "+D[1]),D=w.next();return _.join(`\r
`)};function rr(_){_.onreadystatechange&&_.onreadystatechange.call(_)}Object.defineProperty(wi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(_){this.m=_?"include":"same-origin"}});function Jl(_){let w="";return X(_,function(D,z){w+=z,w+=":",w+=D,w+=`\r
`}),w}function Rr(_,w,D){t:{for(z in D){var z=!1;break t}z=!0}z||(D=Jl(D),typeof _=="string"?D!=null&&encodeURIComponent(String(D)):ke(_,w,D))}function An(_){kn.call(this),this.headers=new Map,this.o=_||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(An,kn);var qi=/^https?$/i,xr=["POST","PUT"];n=An.prototype,n.Ha=function(_){this.J=_},n.ea=function(_,w,D,z){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+_);w=w?w.toUpperCase():"GET",this.D=_,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():va.g(),this.v=this.o?Bo(this.o):Bo(va),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(w,String(_),!0),this.B=!1}catch(pt){Zl(this,pt);return}if(_=D||"",D=new Map(this.headers),z)if(Object.getPrototypeOf(z)===Object.prototype)for(var rt in z)D.set(rt,z[rt]);else if(typeof z.keys=="function"&&typeof z.get=="function")for(const pt of z.keys())D.set(pt,z.get(pt));else throw Error("Unknown input type for opt_headers: "+String(z));z=Array.from(D.keys()).find(pt=>pt.toLowerCase()=="content-type"),rt=f.FormData&&_ instanceof f.FormData,!(0<=Array.prototype.indexOf.call(xr,w,void 0))||z||rt||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pt,Lt]of D)this.g.setRequestHeader(pt,Lt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fo(this),this.u=!0,this.g.send(_),this.u=!1}catch(pt){Zl(this,pt)}};function Zl(_,w){_.h=!1,_.g&&(_.j=!0,_.g.abort(),_.j=!1),_.l=w,_.m=5,ol(_),Nr(_)}function ol(_){_.A||(_.A=!0,Cn(_,"complete"),Cn(_,"error"))}n.abort=function(_){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=_||7,Cn(this,"complete"),Cn(this,"abort"),Nr(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Nr(this,!0)),An.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Oh(this):this.bb())},n.bb=function(){Oh(this)};function Oh(_){if(_.h&&typeof c<"u"&&(!_.v[1]||ns(_)!=4||_.Z()!=2)){if(_.u&&ns(_)==4)ms(_.Ea,0,_);else if(Cn(_,"readystatechange"),ns(_)==4){_.h=!1;try{const Lt=_.Z();t:switch(Lt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break t;default:w=!1}var D;if(!(D=w)){var z;if(z=Lt===0){var rt=String(_.D).match(pi)[1]||null;!rt&&f.self&&f.self.location&&(rt=f.self.location.protocol.slice(0,-1)),z=!qi.test(rt?rt.toLowerCase():"")}D=z}if(D)Cn(_,"complete"),Cn(_,"success");else{_.m=6;try{var pt=2<ns(_)?_.g.statusText:""}catch{pt=""}_.l=pt+" ["+_.Z()+"]",ol(_)}}finally{Nr(_)}}}}function Nr(_,w){if(_.g){Fo(_);const D=_.g,z=_.v[0]?()=>{}:null;_.g=null,_.v=null,w||Cn(_,"ready");try{D.onreadystatechange=z}catch{}}}function Fo(_){_.I&&(f.clearTimeout(_.I),_.I=null)}n.isActive=function(){return!!this.g};function ns(_){return _.g?_.g.readyState:0}n.Z=function(){try{return 2<ns(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(_){if(this.g){var w=this.g.responseText;return _&&w.indexOf(_)==0&&(w=w.substring(_.length)),ji(w)}};function ul(_){try{if(!_.g)return null;if("response"in _.g)return _.g.response;switch(_.H){case"":case"text":return _.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in _.g)return _.g.mozResponseArrayBuffer}return null}catch{return null}}function Mh(_){const w={};_=(_.g&&2<=ns(_)&&_.g.getAllResponseHeaders()||"").split(`\r
`);for(let z=0;z<_.length;z++){if(B(_[z]))continue;var D=Q(_[z]);const rt=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const pt=w[rt]||[];w[rt]=pt,pt.push(D)}L(w,function(z){return z.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $l(_,w,D){return D&&D.internalChannelParams&&D.internalChannelParams[_]||w}function Lh(_){this.Aa=0,this.i=[],this.j=new sl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$l("failFast",!1,_),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$l("baseRetryDelayMs",5e3,_),this.cb=$l("retryDelaySeedMs",1e4,_),this.Wa=$l("forwardChannelMaxRetries",2,_),this.wa=$l("forwardChannelRequestTimeoutMs",2e4,_),this.pa=_&&_.xmlHttpFactory||void 0,this.Xa=_&&_.Tb||void 0,this.Ca=_&&_.useFetchStreams||!1,this.L=void 0,this.J=_&&_.supportsCrossDomainXhr||!1,this.K="",this.h=new Kl(_&&_.concurrentRequestLimit),this.Da=new Ea,this.P=_&&_.fastHandshake||!1,this.O=_&&_.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=_&&_.Rb||!1,_&&_.xa&&this.j.xa(),_&&_.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&_&&_.detectBufferingProxy||!1,this.ja=void 0,_&&_.longPollingTimeout&&0<_.longPollingTimeout&&(this.ja=_.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Lh.prototype,n.la=8,n.G=1,n.connect=function(_,w,D,z){Vn(0),this.W=_,this.H=w||{},D&&z!==void 0&&(this.H.OSID=D,this.H.OAID=z),this.F=this.X,this.I=ac(this,null,this.W),tc(this)};function Yo(_){if(kh(_),_.G==3){var w=_.U++,D=dn(_.I);if(ke(D,"SID",_.K),ke(D,"RID",w),ke(D,"TYPE","terminate"),lr(_,D),w=new Hi(_,_.j,w),w.L=2,w.v=ll(dn(D)),D=!1,f.navigator&&f.navigator.sendBeacon)try{D=f.navigator.sendBeacon(w.v.toString(),"")}catch{}!D&&f.Image&&(new Image().src=w.v,D=!0),D||(w.g=Uh(w.j,null),w.g.ea(w.v)),w.F=Date.now(),ia(w)}sc(_)}function cl(_){_.g&&(nc(_),_.g.cancel(),_.g=null)}function kh(_){cl(_),_.u&&(f.clearTimeout(_.u),_.u=null),hl(_),_.h.cancel(),_.s&&(typeof _.s=="number"&&f.clearTimeout(_.s),_.s=null)}function tc(_){if(!hn(_.h)&&!_.s){_.s=!0;var w=_.Ga;At||Qt(),yt||(At(),yt=!0),Mt.add(w,_),_.B=0}}function Xm(_,w){return Ku(_.h)>=_.h.j-(_.s?1:0)?!1:_.s?(_.i=w.D.concat(_.i),!0):_.G==1||_.G==2||_.B>=(_.Va?0:_.Wa)?!1:(_.s=$a(T(_.Ga,_,w),Dr(_,_.B)),_.B++,!0)}n.Ga=function(_){if(this.s)if(this.s=null,this.G==1){if(!_){this.U=Math.floor(1e5*Math.random()),_=this.U++;const rt=new Hi(this,this.j,_);let pt=this.o;if(this.S&&(pt?(pt=k(pt),q(pt,this.S)):pt=this.S),this.m!==null||this.O||(rt.H=pt,pt=null),this.P)t:{for(var w=0,D=0;D<this.i.length;D++){e:{var z=this.i[D];if("__data__"in z.map&&(z=z.map.__data__,typeof z=="string")){z=z.length;break e}z=void 0}if(z===void 0)break;if(w+=z,4096<w){w=D;break t}if(w===4096||D===this.i.length-1){w=D+1;break t}}w=1e3}else w=1e3;w=Qo(this,rt,w),D=dn(this.I),ke(D,"RID",_),ke(D,"CVER",22),this.D&&ke(D,"X-HTTP-Session-Id",this.D),lr(this,D),pt&&(this.O?w="headers="+encodeURIComponent(String(Jl(pt)))+"&"+w:this.m&&Rr(D,this.m,pt)),al(this.h,rt),this.Ua&&ke(D,"TYPE","init"),this.P?(ke(D,"$req",w),ke(D,"SID","null"),rt.T=!0,nr(rt,D,null)):nr(rt,D,w),this.G=2}}else this.G==3&&(_?Ph(this,_):this.i.length==0||hn(this.h)||Ph(this))};function Ph(_,w){var D;w?D=w.l:D=_.U++;const z=dn(_.I);ke(z,"SID",_.K),ke(z,"RID",D),ke(z,"AID",_.T),lr(_,z),_.m&&_.o&&Rr(z,_.m,_.o),D=new Hi(_,_.j,D,_.B+1),_.m===null&&(D.H=_.o),w&&(_.i=w.D.concat(_.i)),w=Qo(_,D,1e3),D.I=Math.round(.5*_.wa)+Math.round(.5*_.wa*Math.random()),al(_.h,D),nr(D,z,w)}function lr(_,w){_.H&&X(_.H,function(D,z){ke(w,z,D)}),_.l&&Wl({},function(D,z){ke(w,z,D)})}function Qo(_,w,D){D=Math.min(_.i.length,D);var z=_.l?T(_.l.Na,_.l,_):null;t:{var rt=_.i;let pt=-1;for(;;){const Lt=["count="+D];pt==-1?0<D?(pt=rt[0].g,Lt.push("ofs="+pt)):pt=0:Lt.push("ofs="+pt);let Fe=!0;for(let $n=0;$n<D;$n++){let ye=rt[$n].g;const gi=rt[$n].map;if(ye-=pt,0>ye)pt=Math.max(0,rt[$n].g-100),Fe=!1;else try{Ih(gi,Lt,"req"+ye+"_")}catch{z&&z(gi)}}if(Fe){z=Lt.join("&");break t}}}return _=_.i.splice(0,D),w.D=_,z}function Xo(_){if(!_.g&&!_.u){_.Y=1;var w=_.Fa;At||Qt(),yt||(At(),yt=!0),Mt.add(w,_),_.v=0}}function ec(_){return _.g||_.u||3<=_.v?!1:(_.Y++,_.u=$a(T(_.Fa,_),Dr(_,_.v)),_.v++,!0)}n.Fa=function(){if(this.u=null,ic(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var _=2*this.R;this.j.info("BP detection timer enabled: "+_),this.A=$a(T(this.ab,this),_)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Vn(10),cl(this),ic(this))};function nc(_){_.A!=null&&(f.clearTimeout(_.A),_.A=null)}function ic(_){_.g=new Hi(_,_.j,"rpc",_.Y),_.m===null&&(_.g.H=_.o),_.g.O=0;var w=dn(_.qa);ke(w,"RID","rpc"),ke(w,"SID",_.K),ke(w,"AID",_.T),ke(w,"CI",_.F?"0":"1"),!_.F&&_.ja&&ke(w,"TO",_.ja),ke(w,"TYPE","xmlhttp"),lr(_,w),_.m&&_.o&&Rr(w,_.m,_.o),_.L&&(_.g.I=_.L);var D=_.g;_=_.ia,D.L=1,D.v=ll(dn(w)),D.m=null,D.P=!0,Er(D,_)}n.Za=function(){this.C!=null&&(this.C=null,cl(this),ec(this),Vn(19))};function hl(_){_.C!=null&&(f.clearTimeout(_.C),_.C=null)}function Vh(_,w){var D=null;if(_.g==w){hl(_),nc(_),_.g=null;var z=2}else if(br(_.h,w))D=w.D,aa(_.h,w),z=1;else return;if(_.G!=0){if(w.o)if(z==1){D=w.m?w.m.length:0,w=Date.now()-w.F;var rt=_.B;z=Jt(),Cn(z,new ya(z,D)),tc(_)}else Xo(_);else if(rt=w.s,rt==3||rt==0&&0<w.X||!(z==1&&Xm(_,w)||z==2&&ec(_)))switch(D&&0<D.length&&(w=_.h,w.i=w.i.concat(D)),rt){case 1:Sa(_,5);break;case 4:Sa(_,10);break;case 3:Sa(_,6);break;default:Sa(_,2)}}}function Dr(_,w){let D=_.Ta+Math.floor(Math.random()*_.cb);return _.isActive()||(D*=2),D*w}function Sa(_,w){if(_.j.info("Error code "+w),w==2){var D=T(_.fb,_),z=_.Xa;const rt=!z;z=new Aa(z||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||ir(z,"https"),ll(z),rt?$u(z.toString(),D):Dh(z.toString(),D)}else Vn(2);_.G=0,_.l&&_.l.sa(w),sc(_),kh(_)}n.fb=function(_){_?(this.j.info("Successfully pinged google.com"),Vn(2)):(this.j.info("Failed to ping google.com"),Vn(1))};function sc(_){if(_.G=0,_.ka=[],_.l){const w=ys(_.h);(w.length!=0||_.i.length!=0)&&(M(_.ka,w),M(_.ka,_.i),_.h.i.length=0,O(_.i),_.i.length=0),_.l.ra()}}function ac(_,w,D){var z=D instanceof Aa?dn(D):new Aa(D);if(z.g!="")w&&(z.g=w+"."+z.g),rl(z,z.s);else{var rt=f.location;z=rt.protocol,w=w?w+"."+rt.hostname:rt.hostname,rt=+rt.port;var pt=new Aa(null);z&&ir(pt,z),w&&(pt.g=w),rt&&rl(pt,rt),D&&(pt.l=D),z=pt}return D=_.D,w=_.ya,D&&w&&ke(z,D,w),ke(z,"VER",_.la),lr(_,z),z}function Uh(_,w,D){if(w&&!_.J)throw Error("Can't create secondary domain capable XhrIo object.");return w=_.Ca&&!_.pa?new An(new ar({eb:D})):new An(_.pa),w.Ha(_.J),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function zh(){}n=zh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function rc(){}rc.prototype.g=function(_,w){return new Ke(_,w)};function Ke(_,w){kn.call(this),this.g=new Lh(w),this.l=_,this.h=w&&w.messageUrlParams||null,_=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(_?_["X-Client-Protocol"]="webchannel":_={"X-Client-Protocol":"webchannel"}),this.g.o=_,_=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(_?_["X-WebChannel-Content-Type"]=w.messageContentType:_={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.va&&(_?_["X-WebChannel-Client-Profile"]=w.va:_={"X-WebChannel-Client-Profile":w.va}),this.g.S=_,(_=w&&w.Sb)&&!B(_)&&(this.g.m=_),this.v=w&&w.supportsCrossDomainXhr||!1,this.u=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!B(w)&&(this.g.D=w,_=this.h,_!==null&&w in _&&(_=this.h,w in _&&delete _[w])),this.j=new fl(this)}R(Ke,kn),Ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ke.prototype.close=function(){Yo(this.g)},Ke.prototype.o=function(_){var w=this.g;if(typeof _=="string"){var D={};D.__data__=_,_=D}else this.u&&(D={},D.__data__=ps(_),_=D);w.i.push(new _s(w.Ya++,_)),w.G==3&&tc(w)},Ke.prototype.N=function(){this.g.l=null,delete this.j,Yo(this.g),delete this.g,Ke.aa.N.call(this)};function Bh(_){ht.call(this),_.__headers__&&(this.headers=_.__headers__,this.statusCode=_.__status__,delete _.__headers__,delete _.__status__);var w=_.__sm__;if(w){t:{for(const D in w){_=D;break t}_=void 0}(this.i=_)&&(_=this.i,w=w!==null&&_ in w?w[_]:void 0),this.data=w}else this.data=_}R(Bh,ht);function jh(){St.call(this),this.status=1}R(jh,St);function fl(_){this.g=_}R(fl,zh),fl.prototype.ua=function(){Cn(this.g,"a")},fl.prototype.ta=function(_){Cn(this.g,new Bh(_))},fl.prototype.sa=function(_){Cn(this.g,new jh)},fl.prototype.ra=function(){Cn(this.g,"b")},rc.prototype.createWebChannel=rc.prototype.g,Ke.prototype.send=Ke.prototype.o,Ke.prototype.open=Ke.prototype.m,Ke.prototype.close=Ke.prototype.close,x5=function(){return new rc},R5=function(){return Jt()},w5=jt,nA={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},vn.NO_ERROR=0,vn.TIMEOUT=8,vn.HTTP_ERROR=6,ky=vn,mi.COMPLETE="complete",C5=mi,Za.EventType=Vs,Vs.OPEN="a",Vs.CLOSE="b",Vs.ERROR="c",Vs.MESSAGE="d",kn.prototype.listen=kn.prototype.K,Eg=Za,An.prototype.listenOnce=An.prototype.L,An.prototype.getLastError=An.prototype.Ka,An.prototype.getLastErrorCode=An.prototype.Ba,An.prototype.getStatus=An.prototype.Z,An.prototype.getResponseJson=An.prototype.Oa,An.prototype.getResponseText=An.prototype.oa,An.prototype.send=An.prototype.ea,An.prototype.setWithCredentials=An.prototype.Ha,b5=An}).apply(typeof cy<"u"?cy:typeof self<"u"?self:typeof window<"u"?window:{});const IT="@firebase/firestore",OT="4.8.0";class Ws{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Ws.UNAUTHENTICATED=new Ws(null),Ws.GOOGLE_CREDENTIALS=new Ws("google-credentials-uid"),Ws.FIRST_PARTY=new Ws("first-party-uid"),Ws.MOCK_USER=new Ws("mock-user");let Vm="11.10.0";const Mf=new k1("@firebase/firestore");function Zd(){return Mf.logLevel}function Yt(n,...t){if(Mf.logLevel<=Ue.DEBUG){const e=t.map(SE);Mf.debug(`Firestore (${Vm}): ${n}`,...e)}}function Lu(n,...t){if(Mf.logLevel<=Ue.ERROR){const e=t.map(SE);Mf.error(`Firestore (${Vm}): ${n}`,...e)}}function ku(n,...t){if(Mf.logLevel<=Ue.WARN){const e=t.map(SE);Mf.warn(`Firestore (${Vm}): ${n}`,...e)}}function SE(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function oe(n,t,e){let i="Unexpected state";typeof t=="string"?i=t:e=t,N5(n,i,e)}function N5(n,t,e){let i=`FIRESTORE (${Vm}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{i+=" CONTEXT: "+JSON.stringify(e)}catch{i+=" CONTEXT: "+e}throw Lu(i),new Error(i)}function un(n,t,e,i){let s="Unexpected state";typeof e=="string"?s=e:i=e,n||N5(t,s,i)}function ge(n,t){return n}const Et={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Gt extends ju{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class xu{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class D5{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class I5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Ws.UNAUTHENTICATED)))}shutdown(){}}class jI{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class HI{constructor(t){this.t=t,this.currentUser=Ws.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){un(this.o===void 0,42304);let i=this.i;const s=m=>this.i!==i?(i=this.i,e(m)):Promise.resolve();let l=new xu;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new xu,t.enqueueRetryable((()=>s(this.currentUser)))};const c=()=>{const m=l;t.enqueueRetryable((async()=>{await m.promise,await s(this.currentUser)}))},f=m=>{Yt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((m=>f(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?f(m):(Yt("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new xu)}}),0),c()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((i=>this.i!==t?(Yt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(un(typeof i.accessToken=="string",31837,{l:i}),new D5(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return un(t===null||typeof t=="string",2055,{h:t}),new Ws(t)}}class GI{constructor(t,e,i){this.P=t,this.T=e,this.I=i,this.type="FirstParty",this.user=Ws.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class qI{constructor(t,e,i){this.P=t,this.T=e,this.I=i}getToken(){return Promise.resolve(new GI(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Ws.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class MT{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class FI{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,dr(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){un(this.o===void 0,3512);const i=l=>{l.error!=null&&Yt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Yt("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?e(l.token):Promise.resolve()};this.o=l=>{t.enqueueRetryable((()=>i(l)))};const s=l=>{Yt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>s(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?s(l):Yt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new MT(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(un(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new MT(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function YI(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}function O5(){return new TextEncoder}class B1{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=YI(40);for(let l=0;l<s.length;++l)i.length<20&&s[l]<e&&(i+=t.charAt(s[l]%62))}return i}}function xe(n,t){return n<t?-1:n>t?1:0}function iA(n,t){let e=0;for(;e<n.length&&e<t.length;){const i=n.codePointAt(e),s=t.codePointAt(e);if(i!==s){if(i<128&&s<128)return xe(i,s);{const l=O5(),c=QI(l.encode(LT(n,e)),l.encode(LT(t,e)));return c!==0?c:xe(i,s)}}e+=i>65535?2:1}return xe(n.length,t.length)}function LT(n,t){return n.codePointAt(t)>65535?n.substring(t,t+2):n.substring(t,t+1)}function QI(n,t){for(let e=0;e<n.length&&e<t.length;++e)if(n[e]!==t[e])return xe(n[e],t[e]);return xe(n.length,t.length)}function gm(n,t,e){return n.length===t.length&&n.every(((i,s)=>e(i,t[s])))}const kT="__name__";class wo{constructor(t,e,i){e===void 0?e=0:e>t.length&&oe(637,{offset:e,range:t.length}),i===void 0?i=t.length-e:i>t.length-e&&oe(1746,{length:i,range:t.length-e}),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return wo.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof wo?t.forEach((i=>{e.push(i)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let s=0;s<i;s++){const l=wo.compareSegments(t.get(s),e.get(s));if(l!==0)return l}return xe(t.length,e.length)}static compareSegments(t,e){const i=wo.isNumericId(t),s=wo.isNumericId(e);return i&&!s?-1:!i&&s?1:i&&s?wo.extractNumericId(t).compare(wo.extractNumericId(e)):iA(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return th.fromString(t.substring(4,t.length-2))}}class Tn extends wo{construct(t,e,i){return new Tn(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((s=>s.length>0)))}return new Tn(e)}static emptyPath(){return new Tn([])}}const XI=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class hs extends wo{construct(t,e,i){return new hs(t,e,i)}static isValidIdentifier(t){return XI.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),hs.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===kT}static keyField(){return new hs([kT])}static fromServerFormat(t){const e=[];let i="",s=0;const l=()=>{if(i.length===0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let c=!1;for(;s<t.length;){const f=t[s];if(f==="\\"){if(s+1===t.length)throw new Gt(Et.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const m=t[s+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Gt(Et.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=m,s+=2}else f==="`"?(c=!c,s++):f!=="."||c?(i+=f,s++):(l(),s++)}if(l(),c)throw new Gt(Et.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new hs(e)}static emptyPath(){return new hs([])}}class Zt{constructor(t){this.path=t}static fromPath(t){return new Zt(Tn.fromString(t))}static fromName(t){return new Zt(Tn.fromString(t).popFirst(5))}static empty(){return new Zt(Tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&Tn.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return Tn.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Zt(new Tn(t.slice()))}}function TE(n,t,e){if(!e)throw new Gt(Et.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function M5(n,t,e,i){if(t===!0&&i===!0)throw new Gt(Et.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function PT(n){if(!Zt.isDocumentKey(n))throw new Gt(Et.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function VT(n){if(Zt.isDocumentKey(n))throw new Gt(Et.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function L5(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function j1(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(i){return i.constructor?i.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":oe(12329,{type:typeof n})}function Zs(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new Gt(Et.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=j1(n);throw new Gt(Et.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function Vi(n,t){const e={typeString:n};return t&&(e.value=t),e}function E0(n,t){if(!L5(n))throw new Gt(Et.INVALID_ARGUMENT,"JSON must be an object");let e;for(const i in t)if(t[i]){const s=t[i].typeString,l="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){e=`JSON missing required field: '${i}'`;break}const c=n[i];if(s&&typeof c!==s){e=`JSON field '${i}' must be a ${s}.`;break}if(l!==void 0&&c!==l.value){e=`Expected '${i}' field to equal '${l.value}'`;break}}if(e)throw new Gt(Et.INVALID_ARGUMENT,e);return!0}const UT=-62135596800,zT=1e6;class sn{static now(){return sn.fromMillis(Date.now())}static fromDate(t){return sn.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor((t-1e3*e)*zT);return new sn(e,i)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<UT)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Gt(Et.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/zT}_compareTo(t){return this.seconds===t.seconds?xe(this.nanoseconds,t.nanoseconds):xe(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:sn._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(E0(t,sn._jsonSchema))return new sn(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-UT;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}sn._jsonSchemaVersion="firestore/timestamp/1.0",sn._jsonSchema={type:Vi("string",sn._jsonSchemaVersion),seconds:Vi("number"),nanoseconds:Vi("number")};class fe{static fromTimestamp(t){return new fe(t)}static min(){return new fe(new sn(0,0))}static max(){return new fe(new sn(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Jg=-1;function KI(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=fe.fromTimestamp(i===1e9?new sn(e+1,0):new sn(e,i));return new lh(s,Zt.empty(),t)}function WI(n){return new lh(n.readTime,n.key,Jg)}class lh{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new lh(fe.min(),Zt.empty(),Jg)}static max(){return new lh(fe.max(),Zt.empty(),Jg)}}function JI(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=Zt.comparator(n.documentKey,t.documentKey),e!==0?e:xe(n.largestBatchId,t.largestBatchId))}const ZI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $I{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Um(n){if(n.code!==Et.FAILED_PRECONDITION||n.message!==ZI)throw n;Yt("LocalStore","Unexpectedly lost primary lease")}class Ct{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&oe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new Ct(((i,s)=>{this.nextCallback=l=>{this.wrapSuccess(t,l).next(i,s)},this.catchCallback=l=>{this.wrapFailure(e,l).next(i,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof Ct?e:Ct.resolve(e)}catch(e){return Ct.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):Ct.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):Ct.reject(e)}static resolve(t){return new Ct(((e,i)=>{e(t)}))}static reject(t){return new Ct(((e,i)=>{i(t)}))}static waitFor(t){return new Ct(((e,i)=>{let s=0,l=0,c=!1;t.forEach((f=>{++s,f.next((()=>{++l,c&&l===s&&e()}),(m=>i(m)))})),c=!0,l===s&&e()}))}static or(t){let e=Ct.resolve(!1);for(const i of t)e=e.next((s=>s?Ct.resolve(s):i()));return e}static forEach(t,e){const i=[];return t.forEach(((s,l)=>{i.push(e.call(this,s,l))})),this.waitFor(i)}static mapArray(t,e){return new Ct(((i,s)=>{const l=t.length,c=new Array(l);let f=0;for(let m=0;m<l;m++){const g=m;e(t[g]).next((A=>{c[g]=A,++f,f===l&&i(c)}),(A=>s(A)))}}))}static doWhile(t,e){return new Ct(((i,s)=>{const l=()=>{t()===!0?e().next((()=>{l()}),s):i()};l()}))}}function tO(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function zm(n){return n.name==="IndexedDbTransactionError"}class H1{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this._e(i),this.ae=i=>e.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ae&&this.ae(t),t}}H1.ue=-1;const bE=-1;function G1(n){return n==null}function e1(n){return n===0&&1/n==-1/0}function eO(n){return typeof n=="number"&&Number.isInteger(n)&&!e1(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const k5="";function nO(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=BT(t)),t=iO(n.get(e),t);return BT(t)}function iO(n,t){let e=t;const i=n.length;for(let s=0;s<i;s++){const l=n.charAt(s);switch(l){case"\0":e+="";break;case k5:e+="";break;default:e+=l}}return e}function BT(n){return n+k5+""}function jT(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function _h(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function P5(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}let zi=class sA{constructor(t,e){this.comparator=t,this.root=e||eh.EMPTY}insert(t,e){return new sA(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,eh.BLACK,null,null))}remove(t){return new sA(this.comparator,this.root.remove(t,this.comparator).copy(null,null,eh.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return e+i.left.size;s<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,i)=>(t(e,i),!1)))}toString(){const t=[];return this.inorderTraversal(((e,i)=>(t.push(`${e}:${i}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new hy(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new hy(this.root,t,this.comparator,!1)}getReverseIterator(){return new hy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new hy(this.root,t,this.comparator,!0)}},hy=class{constructor(t,e,i,s){this.isReverse=s,this.nodeStack=[];let l=1;for(;!t.isEmpty();)if(l=e?i(t.key,e):1,e&&s&&(l*=-1),l<0)t=this.isReverse?t.left:t.right;else{if(l===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},eh=class Au{constructor(t,e,i,s,l){this.key=t,this.value=e,this.color=i??Au.RED,this.left=s??Au.EMPTY,this.right=l??Au.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,s,l){return new Au(t??this.key,e??this.value,i??this.color,s??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const l=i(t,s.key);return s=l<0?s.copy(null,null,null,s.left.insert(t,e,i),null):l===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Au.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return Au.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,Au.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,Au.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw oe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw oe(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw oe(27949);return t+(this.isRed()?0:1)}};eh.EMPTY=null,eh.RED=!0,eh.BLACK=!1;eh.EMPTY=new class{constructor(){this.size=0}get key(){throw oe(57766)}get value(){throw oe(16141)}get color(){throw oe(16727)}get left(){throw oe(29726)}get right(){throw oe(36894)}copy(t,e,i,s,l){return this}insert(t,e,i){return new eh(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Wi{constructor(t){this.comparator=t,this.data=new zi(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,i)=>(t(e),!1)))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new HT(this.data.getIterator())}getIteratorFrom(t){return new HT(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((i=>{e=e.add(i)})),e}isEqual(t){if(!(t instanceof Wi)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,l=i.getNext().key;if(this.comparator(s,l)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new Wi(this.comparator);return e.data=t,e}}class HT{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class gr{constructor(t){this.fields=t,t.sort(hs.comparator)}static empty(){return new gr([])}unionWith(t){let e=new Wi(hs.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new gr(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return gm(this.fields,t.fields,((e,i)=>e.isEqual(i)))}}class V5 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class fs{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new V5("Invalid base64 string: "+l):l}})(t);return new fs(e)}static fromUint8Array(t){const e=(function(s){let l="";for(let c=0;c<s.length;++c)l+=String.fromCharCode(s[c]);return l})(t);return new fs(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const i=new Uint8Array(e.length);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return xe(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}fs.EMPTY_BYTE_STRING=new fs("");const sO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oh(n){if(un(!!n,39018),typeof n=="string"){let t=0;const e=sO.exec(n);if(un(!!e,46558,{timestamp:n}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Si(n.seconds),nanos:Si(n.nanos)}}function Si(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function uh(n){return typeof n=="string"?fs.fromBase64String(n):fs.fromUint8Array(n)}const U5="server_timestamp",z5="__type__",B5="__previous_value__",j5="__local_write_time__";function CE(n){var t,e;return((e=(((t=n?.mapValue)===null||t===void 0?void 0:t.fields)||{})[z5])===null||e===void 0?void 0:e.stringValue)===U5}function q1(n){const t=n.mapValue.fields[B5];return CE(t)?q1(t):t}function Zg(n){const t=oh(n.mapValue.fields[j5].timestampValue);return new sn(t.seconds,t.nanos)}class aO{constructor(t,e,i,s,l,c,f,m,g,A){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=s,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=f,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=A}}const n1="(default)";class _m{constructor(t,e){this.projectId=t,this.database=e||n1}static empty(){return new _m("","")}get isDefaultDatabase(){return this.database===n1}isEqual(t){return t instanceof _m&&t.projectId===this.projectId&&t.database===this.database}}const H5="__type__",rO="__max__",fy={mapValue:{}},G5="__vector__",i1="value";function ch(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?CE(n)?4:oO(n)?9007199254740991:lO(n)?10:11:oe(28295,{value:n})}function Oo(n,t){if(n===t)return!0;const e=ch(n);if(e!==ch(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Zg(n).isEqual(Zg(t));case 3:return(function(s,l){if(typeof s.timestampValue=="string"&&typeof l.timestampValue=="string"&&s.timestampValue.length===l.timestampValue.length)return s.timestampValue===l.timestampValue;const c=oh(s.timestampValue),f=oh(l.timestampValue);return c.seconds===f.seconds&&c.nanos===f.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(s,l){return uh(s.bytesValue).isEqual(uh(l.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(s,l){return Si(s.geoPointValue.latitude)===Si(l.geoPointValue.latitude)&&Si(s.geoPointValue.longitude)===Si(l.geoPointValue.longitude)})(n,t);case 2:return(function(s,l){if("integerValue"in s&&"integerValue"in l)return Si(s.integerValue)===Si(l.integerValue);if("doubleValue"in s&&"doubleValue"in l){const c=Si(s.doubleValue),f=Si(l.doubleValue);return c===f?e1(c)===e1(f):isNaN(c)&&isNaN(f)}return!1})(n,t);case 9:return gm(n.arrayValue.values||[],t.arrayValue.values||[],Oo);case 10:case 11:return(function(s,l){const c=s.mapValue.fields||{},f=l.mapValue.fields||{};if(jT(c)!==jT(f))return!1;for(const m in c)if(c.hasOwnProperty(m)&&(f[m]===void 0||!Oo(c[m],f[m])))return!1;return!0})(n,t);default:return oe(52216,{left:n})}}function $g(n,t){return(n.values||[]).find((e=>Oo(e,t)))!==void 0}function ym(n,t){if(n===t)return 0;const e=ch(n),i=ch(t);if(e!==i)return xe(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,t.booleanValue);case 2:return(function(l,c){const f=Si(l.integerValue||l.doubleValue),m=Si(c.integerValue||c.doubleValue);return f<m?-1:f>m?1:f===m?0:isNaN(f)?isNaN(m)?0:-1:1})(n,t);case 3:return GT(n.timestampValue,t.timestampValue);case 4:return GT(Zg(n),Zg(t));case 5:return iA(n.stringValue,t.stringValue);case 6:return(function(l,c){const f=uh(l),m=uh(c);return f.compareTo(m)})(n.bytesValue,t.bytesValue);case 7:return(function(l,c){const f=l.split("/"),m=c.split("/");for(let g=0;g<f.length&&g<m.length;g++){const A=xe(f[g],m[g]);if(A!==0)return A}return xe(f.length,m.length)})(n.referenceValue,t.referenceValue);case 8:return(function(l,c){const f=xe(Si(l.latitude),Si(c.latitude));return f!==0?f:xe(Si(l.longitude),Si(c.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return qT(n.arrayValue,t.arrayValue);case 10:return(function(l,c){var f,m,g,A;const E=l.fields||{},T=c.fields||{},x=(f=E[i1])===null||f===void 0?void 0:f.arrayValue,R=(m=T[i1])===null||m===void 0?void 0:m.arrayValue,O=xe(((g=x?.values)===null||g===void 0?void 0:g.length)||0,((A=R?.values)===null||A===void 0?void 0:A.length)||0);return O!==0?O:qT(x,R)})(n.mapValue,t.mapValue);case 11:return(function(l,c){if(l===fy.mapValue&&c===fy.mapValue)return 0;if(l===fy.mapValue)return 1;if(c===fy.mapValue)return-1;const f=l.fields||{},m=Object.keys(f),g=c.fields||{},A=Object.keys(g);m.sort(),A.sort();for(let E=0;E<m.length&&E<A.length;++E){const T=iA(m[E],A[E]);if(T!==0)return T;const x=ym(f[m[E]],g[A[E]]);if(x!==0)return x}return xe(m.length,A.length)})(n.mapValue,t.mapValue);default:throw oe(23264,{le:e})}}function GT(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return xe(n,t);const e=oh(n),i=oh(t),s=xe(e.seconds,i.seconds);return s!==0?s:xe(e.nanos,i.nanos)}function qT(n,t){const e=n.values||[],i=t.values||[];for(let s=0;s<e.length&&s<i.length;++s){const l=ym(e[s],i[s]);if(l)return l}return xe(e.length,i.length)}function vm(n){return aA(n)}function aA(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const i=oh(e);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return uh(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return Zt.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let i="[",s=!0;for(const l of e.values||[])s?s=!1:i+=",",i+=aA(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(e){const i=Object.keys(e.fields||{}).sort();let s="{",l=!0;for(const c of i)l?l=!1:s+=",",s+=`${c}:${aA(e.fields[c])}`;return s+"}"})(n.mapValue):oe(61005,{value:n})}function Py(n){switch(ch(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=q1(n);return t?16+Py(t):16;case 5:return 2*n.stringValue.length;case 6:return uh(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,l)=>s+Py(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return _h(i.fields,((l,c)=>{s+=l.length+Py(c)})),s})(n.mapValue);default:throw oe(13486,{value:n})}}function FT(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function rA(n){return!!n&&"integerValue"in n}function wE(n){return!!n&&"arrayValue"in n}function YT(n){return!!n&&"nullValue"in n}function QT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Vy(n){return!!n&&"mapValue"in n}function lO(n){var t,e;return((e=(((t=n?.mapValue)===null||t===void 0?void 0:t.fields)||{})[H5])===null||e===void 0?void 0:e.stringValue)===G5}function Mg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const t={mapValue:{fields:{}}};return _h(n.mapValue.fields,((e,i)=>t.mapValue.fields[e]=Mg(i))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=Mg(n.arrayValue.values[e]);return t}return Object.assign({},n)}function oO(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===rO}class qa{constructor(t){this.value=t}static empty(){return new qa({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!Vy(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Mg(e)}setAll(t){let e=hs.emptyPath(),i={},s=[];t.forEach(((c,f)=>{if(!e.isImmediateParentOf(f)){const m=this.getFieldsMap(e);this.applyChanges(m,i,s),i={},s=[],e=f.popLast()}c?i[f.lastSegment()]=Mg(c):s.push(f.lastSegment())}));const l=this.getFieldsMap(e);this.applyChanges(l,i,s)}delete(t){const e=this.field(t.popLast());Vy(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Oo(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=e.mapValue.fields[t.get(i)];Vy(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,i){_h(e,((s,l)=>t[s]=l));for(const s of i)delete t[s]}clone(){return new qa(Mg(this.value))}}function q5(n){const t=[];return _h(n.fields,((e,i)=>{const s=new hs([e]);if(Vy(i)){const l=q5(i.mapValue).fields;if(l.length===0)t.push(s);else for(const c of l)t.push(s.child(c))}else t.push(s)})),new gr(t)}class Js{constructor(t,e,i,s,l,c,f){this.key=t,this.documentType=e,this.version=i,this.readTime=s,this.createTime=l,this.data=c,this.documentState=f}static newInvalidDocument(t){return new Js(t,0,fe.min(),fe.min(),fe.min(),qa.empty(),0)}static newFoundDocument(t,e,i,s){return new Js(t,1,e,fe.min(),i,s,0)}static newNoDocument(t,e){return new Js(t,2,e,fe.min(),fe.min(),qa.empty(),0)}static newUnknownDocument(t,e){return new Js(t,3,e,fe.min(),fe.min(),qa.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(fe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=qa.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=qa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=fe.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof Js&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Js(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class s1{constructor(t,e){this.position=t,this.inclusive=e}}function XT(n,t,e){let i=0;for(let s=0;s<n.position.length;s++){const l=t[s],c=n.position[s];if(l.field.isKeyField()?i=Zt.comparator(Zt.fromName(c.referenceValue),e.key):i=ym(c,e.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function KT(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Oo(n.position[e],t.position[e]))return!1;return!0}class a1{constructor(t,e="asc"){this.field=t,this.dir=e}}function uO(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class F5{}class Pi extends F5{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new hO(t,e,i):e==="array-contains"?new mO(t,i):e==="in"?new pO(t,i):e==="not-in"?new gO(t,i):e==="array-contains-any"?new _O(t,i):new Pi(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new fO(t,i):new dO(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(ym(e,this.value)):e!==null&&ch(this.value)===ch(e)&&this.matchesComparison(ym(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return oe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class zl extends F5{constructor(t,e){super(),this.filters=t,this.op=e,this.he=null}static create(t,e){return new zl(t,e)}matches(t){return Y5(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function Y5(n){return n.op==="and"}function Q5(n){return cO(n)&&Y5(n)}function cO(n){for(const t of n.filters)if(t instanceof zl)return!1;return!0}function lA(n){if(n instanceof Pi)return n.field.canonicalString()+n.op.toString()+vm(n.value);if(Q5(n))return n.filters.map((t=>lA(t))).join(",");{const t=n.filters.map((e=>lA(e))).join(",");return`${n.op}(${t})`}}function X5(n,t){return n instanceof Pi?(function(i,s){return s instanceof Pi&&i.op===s.op&&i.field.isEqual(s.field)&&Oo(i.value,s.value)})(n,t):n instanceof zl?(function(i,s){return s instanceof zl&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((l,c,f)=>l&&X5(c,s.filters[f])),!0):!1})(n,t):void oe(19439)}function K5(n){return n instanceof Pi?(function(e){return`${e.field.canonicalString()} ${e.op} ${vm(e.value)}`})(n):n instanceof zl?(function(e){return e.op.toString()+" {"+e.getFilters().map(K5).join(" ,")+"}"})(n):"Filter"}class hO extends Pi{constructor(t,e,i){super(t,e,i),this.key=Zt.fromName(i.referenceValue)}matches(t){const e=Zt.comparator(t.key,this.key);return this.matchesComparison(e)}}class fO extends Pi{constructor(t,e){super(t,"in",e),this.keys=W5("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class dO extends Pi{constructor(t,e){super(t,"not-in",e),this.keys=W5("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function W5(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map((i=>Zt.fromName(i.referenceValue)))}class mO extends Pi{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return wE(e)&&$g(e.arrayValue,this.value)}}class pO extends Pi{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&$g(this.value.arrayValue,e)}}class gO extends Pi{constructor(t,e){super(t,"not-in",e)}matches(t){if($g(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!$g(this.value.arrayValue,e)}}class _O extends Pi{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!wE(e)||!e.arrayValue.values)&&e.arrayValue.values.some((i=>$g(this.value.arrayValue,i)))}}class yO{constructor(t,e=null,i=[],s=[],l=null,c=null,f=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=s,this.limit=l,this.startAt=c,this.endAt=f,this.Pe=null}}function WT(n,t=null,e=[],i=[],s=null,l=null,c=null){return new yO(n,t,e,i,s,l,c)}function RE(n){const t=ge(n);if(t.Pe===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((i=>lA(i))).join(","),e+="|ob:",e+=t.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),G1(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((i=>vm(i))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((i=>vm(i))).join(",")),t.Pe=e}return t.Pe}function xE(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!uO(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!X5(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!KT(n.startAt,t.startAt)&&KT(n.endAt,t.endAt)}function oA(n){return Zt.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Bm{constructor(t,e=null,i=[],s=[],l=null,c="F",f=null,m=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=s,this.limit=l,this.limitType=c,this.startAt=f,this.endAt=m,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function vO(n,t,e,i,s,l,c,f){return new Bm(n,t,e,i,s,l,c,f)}function F1(n){return new Bm(n)}function JT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function J5(n){return n.collectionGroup!==null}function Lg(n){const t=ge(n);if(t.Te===null){t.Te=[];const e=new Set;for(const l of t.explicitOrderBy)t.Te.push(l),e.add(l.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(c){let f=new Wi(hs.comparator);return c.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(f=f.add(g.field))}))})),f})(t).forEach((l=>{e.has(l.canonicalString())||l.isKeyField()||t.Te.push(new a1(l,i))})),e.has(hs.keyField().canonicalString())||t.Te.push(new a1(hs.keyField(),i))}return t.Te}function Do(n){const t=ge(n);return t.Ie||(t.Ie=AO(t,Lg(n))),t.Ie}function AO(n,t){if(n.limitType==="F")return WT(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((s=>{const l=s.dir==="desc"?"asc":"desc";return new a1(s.field,l)}));const e=n.endAt?new s1(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new s1(n.startAt.position,n.startAt.inclusive):null;return WT(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function uA(n,t){const e=n.filters.concat([t]);return new Bm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function cA(n,t,e){return new Bm(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Y1(n,t){return xE(Do(n),Do(t))&&n.limitType===t.limitType}function Z5(n){return`${RE(Do(n))}|lt:${n.limitType}`}function $d(n){return`Query(target=${(function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map((s=>K5(s))).join(", ")}]`),G1(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map((s=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(s))).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map((s=>vm(s))).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map((s=>vm(s))).join(",")),`Target(${i})`})(Do(n))}; limitType=${n.limitType})`}function Q1(n,t){return t.isFoundDocument()&&(function(i,s){const l=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Zt.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,t)&&(function(i,s){for(const l of Lg(i))if(!l.field.isKeyField()&&s.data.field(l.field)===null)return!1;return!0})(n,t)&&(function(i,s){for(const l of i.filters)if(!l.matches(s))return!1;return!0})(n,t)&&(function(i,s){return!(i.startAt&&!(function(c,f,m){const g=XT(c,f,m);return c.inclusive?g<=0:g<0})(i.startAt,Lg(i),s)||i.endAt&&!(function(c,f,m){const g=XT(c,f,m);return c.inclusive?g>=0:g>0})(i.endAt,Lg(i),s))})(n,t)}function EO(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function $5(n){return(t,e)=>{let i=!1;for(const s of Lg(n)){const l=SO(s,t,e);if(l!==0)return l;i=i||s.field.isKeyField()}return 0}}function SO(n,t,e){const i=n.field.isKeyField()?Zt.comparator(t.key,e.key):(function(l,c,f){const m=c.data.field(l),g=f.data.field(l);return m!==null&&g!==null?ym(m,g):oe(42886)})(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return oe(19790,{direction:n.dir})}}class Hf{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[s,l]of i)if(this.equalsFn(s,t))return l}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let l=0;l<s.length;l++)if(this.equalsFn(s[l][0],t))return void(s[l]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[e]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){_h(this.inner,((e,i)=>{for(const[s,l]of i)t(s,l)}))}isEmpty(){return P5(this.inner)}size(){return this.innerSize}}const TO=new zi(Zt.comparator);function Pu(){return TO}const t6=new zi(Zt.comparator);function Sg(...n){let t=t6;for(const e of n)t=t.insert(e.key,e);return t}function e6(n){let t=t6;return n.forEach(((e,i)=>t=t.insert(e,i.overlayedDocument))),t}function wf(){return kg()}function n6(){return kg()}function kg(){return new Hf((n=>n.toString()),((n,t)=>n.isEqual(t)))}const bO=new zi(Zt.comparator),CO=new Wi(Zt.comparator);function je(...n){let t=CO;for(const e of n)t=t.add(e);return t}const wO=new Wi(xe);function RO(){return wO}function NE(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:e1(t)?"-0":t}}function i6(n){return{integerValue:""+n}}function xO(n,t){return eO(t)?i6(t):NE(n,t)}class X1{constructor(){this._=void 0}}function NO(n,t,e){return n instanceof t0?(function(s,l){const c={fields:{[z5]:{stringValue:U5},[j5]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return l&&CE(l)&&(l=q1(l)),l&&(c.fields[B5]=l),{mapValue:c}})(e,t):n instanceof e0?a6(n,t):n instanceof n0?r6(n,t):(function(s,l){const c=s6(s,l),f=ZT(c)+ZT(s.Ee);return rA(c)&&rA(s.Ee)?i6(f):NE(s.serializer,f)})(n,t)}function DO(n,t,e){return n instanceof e0?a6(n,t):n instanceof n0?r6(n,t):e}function s6(n,t){return n instanceof r1?(function(i){return rA(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(t)?t:{integerValue:0}:null}class t0 extends X1{}class e0 extends X1{constructor(t){super(),this.elements=t}}function a6(n,t){const e=l6(t);for(const i of n.elements)e.some((s=>Oo(s,i)))||e.push(i);return{arrayValue:{values:e}}}class n0 extends X1{constructor(t){super(),this.elements=t}}function r6(n,t){let e=l6(t);for(const i of n.elements)e=e.filter((s=>!Oo(s,i)));return{arrayValue:{values:e}}}class r1 extends X1{constructor(t,e){super(),this.serializer=t,this.Ee=e}}function ZT(n){return Si(n.integerValue||n.doubleValue)}function l6(n){return wE(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class IO{constructor(t,e){this.field=t,this.transform=e}}function OO(n,t){return n.field.isEqual(t.field)&&(function(i,s){return i instanceof e0&&s instanceof e0||i instanceof n0&&s instanceof n0?gm(i.elements,s.elements,Oo):i instanceof r1&&s instanceof r1?Oo(i.Ee,s.Ee):i instanceof t0&&s instanceof t0})(n.transform,t.transform)}class MO{constructor(t,e){this.version=t,this.transformResults=e}}class il{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new il}static exists(t){return new il(void 0,t)}static updateTime(t){return new il(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Uy(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class K1{}function o6(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new DE(n.key,il.none()):new S0(n.key,n.data,il.none());{const e=n.data,i=qa.empty();let s=new Wi(hs.comparator);for(let l of t.fields)if(!s.has(l)){let c=e.field(l);c===null&&l.length>1&&(l=l.popLast(),c=e.field(l)),c===null?i.delete(l):i.set(l,c),s=s.add(l)}return new yh(n.key,i,new gr(s.toArray()),il.none())}}function LO(n,t,e){n instanceof S0?(function(s,l,c){const f=s.value.clone(),m=tb(s.fieldTransforms,l,c.transformResults);f.setAll(m),l.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(n,t,e):n instanceof yh?(function(s,l,c){if(!Uy(s.precondition,l))return void l.convertToUnknownDocument(c.version);const f=tb(s.fieldTransforms,l,c.transformResults),m=l.data;m.setAll(u6(s)),m.setAll(f),l.convertToFoundDocument(c.version,m).setHasCommittedMutations()})(n,t,e):(function(s,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,t,e)}function Pg(n,t,e,i){return n instanceof S0?(function(l,c,f,m){if(!Uy(l.precondition,c))return f;const g=l.value.clone(),A=eb(l.fieldTransforms,m,c);return g.setAll(A),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),null})(n,t,e,i):n instanceof yh?(function(l,c,f,m){if(!Uy(l.precondition,c))return f;const g=eb(l.fieldTransforms,m,c),A=c.data;return A.setAll(u6(l)),A.setAll(g),c.convertToFoundDocument(c.version,A).setHasLocalMutations(),f===null?null:f.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((E=>E.field)))})(n,t,e,i):(function(l,c,f){return Uy(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):f})(n,t,e)}function kO(n,t){let e=null;for(const i of n.fieldTransforms){const s=t.data.field(i.field),l=s6(i.transform,s||null);l!=null&&(e===null&&(e=qa.empty()),e.set(i.field,l))}return e||null}function $T(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&gm(i,s,((l,c)=>OO(l,c)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class S0 extends K1{constructor(t,e,i,s=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yh extends K1{constructor(t,e,i,s,l=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=s,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function u6(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}})),t}function tb(n,t,e){const i=new Map;un(n.length===e.length,32656,{Ae:e.length,Re:n.length});for(let s=0;s<e.length;s++){const l=n[s],c=l.transform,f=t.data.field(l.field);i.set(l.field,DO(c,f,e[s]))}return i}function eb(n,t,e){const i=new Map;for(const s of n){const l=s.transform,c=e.data.field(s.field);i.set(s.field,NO(l,c,t))}return i}class DE extends K1{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PO extends K1{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class VO{constructor(t,e,i,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const l=this.mutations[s];l.key.isEqual(t.key)&&LO(l,t,i[s])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=Pg(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=Pg(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=n6();return this.mutations.forEach((s=>{const l=t.get(s.key),c=l.overlayedDocument;let f=this.applyToLocalView(c,l.mutatedFields);f=e.has(s.key)?null:f;const m=o6(c,f);m!==null&&i.set(s.key,m),c.isValidDocument()||c.convertToNoDocument(fe.min())})),i}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),je())}isEqual(t){return this.batchId===t.batchId&&gm(this.mutations,t.mutations,((e,i)=>$T(e,i)))&&gm(this.baseMutations,t.baseMutations,((e,i)=>$T(e,i)))}}class IE{constructor(t,e,i,s){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=s}static from(t,e,i){un(t.mutations.length===i.length,58842,{Ve:t.mutations.length,me:i.length});let s=(function(){return bO})();const l=t.mutations;for(let c=0;c<l.length;c++)s=s.insert(l[c].key,i[c].version);return new IE(t,e,i,s)}}class UO{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class zO{constructor(t,e){this.count=t,this.unchangedNames=e}}var Li,Qe;function BO(n){switch(n){case Et.OK:return oe(64938);case Et.CANCELLED:case Et.UNKNOWN:case Et.DEADLINE_EXCEEDED:case Et.RESOURCE_EXHAUSTED:case Et.INTERNAL:case Et.UNAVAILABLE:case Et.UNAUTHENTICATED:return!1;case Et.INVALID_ARGUMENT:case Et.NOT_FOUND:case Et.ALREADY_EXISTS:case Et.PERMISSION_DENIED:case Et.FAILED_PRECONDITION:case Et.ABORTED:case Et.OUT_OF_RANGE:case Et.UNIMPLEMENTED:case Et.DATA_LOSS:return!0;default:return oe(15467,{code:n})}}function c6(n){if(n===void 0)return Lu("GRPC error has no .code"),Et.UNKNOWN;switch(n){case Li.OK:return Et.OK;case Li.CANCELLED:return Et.CANCELLED;case Li.UNKNOWN:return Et.UNKNOWN;case Li.DEADLINE_EXCEEDED:return Et.DEADLINE_EXCEEDED;case Li.RESOURCE_EXHAUSTED:return Et.RESOURCE_EXHAUSTED;case Li.INTERNAL:return Et.INTERNAL;case Li.UNAVAILABLE:return Et.UNAVAILABLE;case Li.UNAUTHENTICATED:return Et.UNAUTHENTICATED;case Li.INVALID_ARGUMENT:return Et.INVALID_ARGUMENT;case Li.NOT_FOUND:return Et.NOT_FOUND;case Li.ALREADY_EXISTS:return Et.ALREADY_EXISTS;case Li.PERMISSION_DENIED:return Et.PERMISSION_DENIED;case Li.FAILED_PRECONDITION:return Et.FAILED_PRECONDITION;case Li.ABORTED:return Et.ABORTED;case Li.OUT_OF_RANGE:return Et.OUT_OF_RANGE;case Li.UNIMPLEMENTED:return Et.UNIMPLEMENTED;case Li.DATA_LOSS:return Et.DATA_LOSS;default:return oe(39323,{code:n})}}(Qe=Li||(Li={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";const jO=new th([4294967295,4294967295],0);function nb(n){const t=O5().encode(n),e=new T5;return e.update(t),new Uint8Array(e.digest())}function ib(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),l=t.getUint32(12,!0);return[new th([e,i],0),new th([s,l],0)]}class OE{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new Tg(`Invalid padding: ${e}`);if(i<0)throw new Tg(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Tg(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new Tg(`Invalid padding when bitmap length is 0: ${e}`);this.fe=8*t.length-e,this.ge=th.fromNumber(this.fe)}pe(t,e,i){let s=t.add(e.multiply(th.fromNumber(i)));return s.compare(jO)===1&&(s=new th([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.fe===0)return!1;const e=nb(t),[i,s]=ib(e);for(let l=0;l<this.hashCount;l++){const c=this.pe(i,s,l);if(!this.ye(c))return!1}return!0}static create(t,e,i){const s=t%8==0?0:8-t%8,l=new Uint8Array(Math.ceil(t/8)),c=new OE(l,s,e);return i.forEach((f=>c.insert(f))),c}insert(t){if(this.fe===0)return;const e=nb(t),[i,s]=ib(e);for(let l=0;l<this.hashCount;l++){const c=this.pe(i,s,l);this.we(c)}}we(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class Tg extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class W1{constructor(t,e,i,s,l){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const s=new Map;return s.set(t,T0.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new W1(fe.min(),s,new zi(xe),Pu(),je())}}class T0{constructor(t,e,i,s,l){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new T0(i,e,je(),je(),je())}}class zy{constructor(t,e,i,s){this.Se=t,this.removedTargetIds=e,this.key=i,this.be=s}}class h6{constructor(t,e){this.targetId=t,this.De=e}}class f6{constructor(t,e,i=fs.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=s}}class sb{constructor(){this.ve=0,this.Ce=ab(),this.Fe=fs.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(t){t.approximateByteSize()>0&&(this.xe=!0,this.Fe=t)}Le(){let t=je(),e=je(),i=je();return this.Ce.forEach(((s,l)=>{switch(l){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:i=i.add(s);break;default:oe(38017,{changeType:l})}})),new T0(this.Fe,this.Me,t,e,i)}ke(){this.xe=!1,this.Ce=ab()}qe(t,e){this.xe=!0,this.Ce=this.Ce.insert(t,e)}Qe(t){this.xe=!0,this.Ce=this.Ce.remove(t)}$e(){this.ve+=1}Ue(){this.ve-=1,un(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class HO{constructor(t){this.We=t,this.Ge=new Map,this.ze=Pu(),this.je=dy(),this.Je=dy(),this.He=new zi(xe)}Ye(t){for(const e of t.Se)t.be&&t.be.isFoundDocument()?this.Ze(e,t.be):this.Xe(e,t.key,t.be);for(const e of t.removedTargetIds)this.Xe(e,t.key,t.be)}et(t){this.forEachTarget(t,(e=>{const i=this.tt(e);switch(t.state){case 0:this.nt(e)&&i.Be(t.resumeToken);break;case 1:i.Ue(),i.Oe||i.ke(),i.Be(t.resumeToken);break;case 2:i.Ue(),i.Oe||this.removeTarget(e);break;case 3:this.nt(e)&&(i.Ke(),i.Be(t.resumeToken));break;case 4:this.nt(e)&&(this.rt(e),i.Be(t.resumeToken));break;default:oe(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Ge.forEach(((i,s)=>{this.nt(s)&&e(s)}))}it(t){const e=t.targetId,i=t.De.count,s=this.st(e);if(s){const l=s.target;if(oA(l))if(i===0){const c=new Zt(l.path);this.Xe(e,c,Js.newNoDocument(c,fe.min()))}else un(i===1,20013,{expectedCount:i});else{const c=this.ot(e);if(c!==i){const f=this._t(t),m=f?this.ut(f,t,c):1;if(m!==0){this.rt(e);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(e,g)}}}}}_t(t){const e=t.De.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:l=0}=e;let c,f;try{c=uh(i).toUint8Array()}catch(m){if(m instanceof V5)return ku("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{f=new OE(c,s,l)}catch(m){return ku(m instanceof Tg?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return f.fe===0?null:f}ut(t,e,i){return e.De.count===i-this.ht(t,e.targetId)?0:2}ht(t,e){const i=this.We.getRemoteKeysForTarget(e);let s=0;return i.forEach((l=>{const c=this.We.lt(),f=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;t.mightContain(f)||(this.Xe(e,l,null),s++)})),s}Pt(t){const e=new Map;this.Ge.forEach(((l,c)=>{const f=this.st(c);if(f){if(l.current&&oA(f.target)){const m=new Zt(f.target.path);this.Tt(m).has(c)||this.It(c,m)||this.Xe(c,m,Js.newNoDocument(m,t))}l.Ne&&(e.set(c,l.Le()),l.ke())}}));let i=je();this.Je.forEach(((l,c)=>{let f=!0;c.forEachWhile((m=>{const g=this.st(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)})),f&&(i=i.add(l))})),this.ze.forEach(((l,c)=>c.setReadTime(t)));const s=new W1(t,e,this.He,this.ze,i);return this.ze=Pu(),this.je=dy(),this.Je=dy(),this.He=new zi(xe),s}Ze(t,e){if(!this.nt(t))return;const i=this.It(t,e.key)?2:0;this.tt(t).qe(e.key,i),this.ze=this.ze.insert(e.key,e),this.je=this.je.insert(e.key,this.Tt(e.key).add(t)),this.Je=this.Je.insert(e.key,this.dt(e.key).add(t))}Xe(t,e,i){if(!this.nt(t))return;const s=this.tt(t);this.It(t,e)?s.qe(e,1):s.Qe(e),this.Je=this.Je.insert(e,this.dt(e).delete(t)),this.Je=this.Je.insert(e,this.dt(e).add(t)),i&&(this.ze=this.ze.insert(e,i))}removeTarget(t){this.Ge.delete(t)}ot(t){const e=this.tt(t).Le();return this.We.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}$e(t){this.tt(t).$e()}tt(t){let e=this.Ge.get(t);return e||(e=new sb,this.Ge.set(t,e)),e}dt(t){let e=this.Je.get(t);return e||(e=new Wi(xe),this.Je=this.Je.insert(t,e)),e}Tt(t){let e=this.je.get(t);return e||(e=new Wi(xe),this.je=this.je.insert(t,e)),e}nt(t){const e=this.st(t)!==null;return e||Yt("WatchChangeAggregator","Detected inactive target",t),e}st(t){const e=this.Ge.get(t);return e&&e.Oe?null:this.We.Et(t)}rt(t){this.Ge.set(t,new sb),this.We.getRemoteKeysForTarget(t).forEach((e=>{this.Xe(t,e,null)}))}It(t,e){return this.We.getRemoteKeysForTarget(t).has(e)}}function dy(){return new zi(Zt.comparator)}function ab(){return new zi(Zt.comparator)}const GO={asc:"ASCENDING",desc:"DESCENDING"},qO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FO={and:"AND",or:"OR"};class YO{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function hA(n,t){return n.useProto3Json||G1(t)?t:{value:t}}function l1(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function d6(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function QO(n,t){return l1(n,t.toTimestamp())}function Io(n){return un(!!n,49232),fe.fromTimestamp((function(e){const i=oh(e);return new sn(i.seconds,i.nanos)})(n))}function ME(n,t){return fA(n,t).canonicalString()}function fA(n,t){const e=(function(s){return new Tn(["projects",s.projectId,"databases",s.database])})(n).child("documents");return t===void 0?e:e.child(t)}function m6(n){const t=Tn.fromString(n);return un(v6(t),10190,{key:t.toString()}),t}function dA(n,t){return ME(n.databaseId,t.path)}function m2(n,t){const e=m6(t);if(e.get(1)!==n.databaseId.projectId)throw new Gt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new Gt(Et.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new Zt(g6(e))}function p6(n,t){return ME(n.databaseId,t)}function XO(n){const t=m6(n);return t.length===4?Tn.emptyPath():g6(t)}function mA(n){return new Tn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function g6(n){return un(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function rb(n,t,e){return{name:dA(n,t),fields:e.value.mapValue.fields}}function KO(n,t){let e;if("targetChange"in t){t.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:oe(39313,{state:g})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],l=(function(g,A){return g.useProto3Json?(un(A===void 0||typeof A=="string",58123),fs.fromBase64String(A||"")):(un(A===void 0||A instanceof Buffer||A instanceof Uint8Array,16193),fs.fromUint8Array(A||new Uint8Array))})(n,t.targetChange.resumeToken),c=t.targetChange.cause,f=c&&(function(g){const A=g.code===void 0?Et.UNKNOWN:c6(g.code);return new Gt(A,g.message||"")})(c);e=new f6(i,s,l,f||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=m2(n,i.document.name),l=Io(i.document.updateTime),c=i.document.createTime?Io(i.document.createTime):fe.min(),f=new qa({mapValue:{fields:i.document.fields}}),m=Js.newFoundDocument(s,l,c,f),g=i.targetIds||[],A=i.removedTargetIds||[];e=new zy(g,A,m.key,m)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=m2(n,i.document),l=i.readTime?Io(i.readTime):fe.min(),c=Js.newNoDocument(s,l),f=i.removedTargetIds||[];e=new zy([],f,c.key,c)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=m2(n,i.document),l=i.removedTargetIds||[];e=new zy([],l,s,null)}else{if(!("filter"in t))return oe(11601,{At:t});{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:l}=i,c=new zO(s,l),f=i.targetId;e=new h6(f,c)}}return e}function WO(n,t){let e;if(t instanceof S0)e={update:rb(n,t.key,t.value)};else if(t instanceof DE)e={delete:dA(n,t.key)};else if(t instanceof yh)e={update:rb(n,t.key,t.data),updateMask:aM(t.fieldMask)};else{if(!(t instanceof PO))return oe(16599,{Rt:t.type});e={verify:dA(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((i=>(function(l,c){const f=c.transform;if(f instanceof t0)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof e0)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof n0)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof r1)return{fieldPath:c.field.canonicalString(),increment:f.Ee};throw oe(20930,{transform:c.transform})})(0,i)))),t.precondition.isNone||(e.currentDocument=(function(s,l){return l.updateTime!==void 0?{updateTime:QO(s,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:oe(27497)})(n,t.precondition)),e}function JO(n,t){return n&&n.length>0?(un(t!==void 0,14353),n.map((e=>(function(s,l){let c=s.updateTime?Io(s.updateTime):Io(l);return c.isEqual(fe.min())&&(c=Io(l)),new MO(c,s.transformResults||[])})(e,t)))):[]}function ZO(n,t){return{documents:[p6(n,t.path)]}}function $O(n,t){const e={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=p6(n,s);const l=(function(g){if(g.length!==0)return y6(zl.create(g,"and"))})(t.filters);l&&(e.structuredQuery.where=l);const c=(function(g){if(g.length!==0)return g.map((A=>(function(T){return{field:tm(T.field),direction:nM(T.dir)}})(A)))})(t.orderBy);c&&(e.structuredQuery.orderBy=c);const f=hA(n,t.limit);return f!==null&&(e.structuredQuery.limit=f),t.startAt&&(e.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(t.endAt)),{Vt:e,parent:s}}function tM(n){let t=XO(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let s=null;if(i>0){un(i===1,65062);const A=e.from[0];A.allDescendants?s=A.collectionId:t=t.child(A.collectionId)}let l=[];e.where&&(l=(function(E){const T=_6(E);return T instanceof zl&&Q5(T)?T.getFilters():[T]})(e.where));let c=[];e.orderBy&&(c=(function(E){return E.map((T=>(function(R){return new a1(em(R.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(T)))})(e.orderBy));let f=null;e.limit&&(f=(function(E){let T;return T=typeof E=="object"?E.value:E,G1(T)?null:T})(e.limit));let m=null;e.startAt&&(m=(function(E){const T=!!E.before,x=E.values||[];return new s1(x,T)})(e.startAt));let g=null;return e.endAt&&(g=(function(E){const T=!E.before,x=E.values||[];return new s1(x,T)})(e.endAt)),vO(t,s,c,l,f,"F",m,g)}function eM(n,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return oe(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function _6(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=em(e.unaryFilter.field);return Pi.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=em(e.unaryFilter.field);return Pi.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=em(e.unaryFilter.field);return Pi.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=em(e.unaryFilter.field);return Pi.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return oe(61313);default:return oe(60726)}})(n):n.fieldFilter!==void 0?(function(e){return Pi.create(em(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return oe(58110);default:return oe(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return zl.create(e.compositeFilter.filters.map((i=>_6(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return oe(1026)}})(e.compositeFilter.op))})(n):oe(30097,{filter:n})}function nM(n){return GO[n]}function iM(n){return qO[n]}function sM(n){return FO[n]}function tm(n){return{fieldPath:n.canonicalString()}}function em(n){return hs.fromServerFormat(n.fieldPath)}function y6(n){return n instanceof Pi?(function(e){if(e.op==="=="){if(QT(e.value))return{unaryFilter:{field:tm(e.field),op:"IS_NAN"}};if(YT(e.value))return{unaryFilter:{field:tm(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(QT(e.value))return{unaryFilter:{field:tm(e.field),op:"IS_NOT_NAN"}};if(YT(e.value))return{unaryFilter:{field:tm(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tm(e.field),op:iM(e.op),value:e.value}}})(n):n instanceof zl?(function(e){const i=e.getFilters().map((s=>y6(s)));return i.length===1?i[0]:{compositeFilter:{op:sM(e.op),filters:i}}})(n):oe(54877,{filter:n})}function aM(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function v6(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class Jc{constructor(t,e,i,s,l=fe.min(),c=fe.min(),f=fs.EMPTY_BYTE_STRING,m=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=f,this.expectedCount=m}withSequenceNumber(t){return new Jc(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new Jc(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new Jc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new Jc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class rM{constructor(t){this.gt=t}}function lM(n){const t=tM({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?cA(t,t.limit,"L"):t}class oM{constructor(){this.Dn=new uM}addToCollectionParentIndex(t,e){return this.Dn.add(e),Ct.resolve()}getCollectionParents(t,e){return Ct.resolve(this.Dn.getEntries(e))}addFieldIndex(t,e){return Ct.resolve()}deleteFieldIndex(t,e){return Ct.resolve()}deleteAllFieldIndexes(t){return Ct.resolve()}createTargetIndexes(t,e){return Ct.resolve()}getDocumentsMatchingTarget(t,e){return Ct.resolve(null)}getIndexType(t,e){return Ct.resolve(0)}getFieldIndexes(t,e){return Ct.resolve([])}getNextCollectionGroupToUpdate(t){return Ct.resolve(null)}getMinOffset(t,e){return Ct.resolve(lh.min())}getMinOffsetFromCollectionGroup(t,e){return Ct.resolve(lh.min())}updateCollectionGroup(t,e,i){return Ct.resolve()}updateIndexEntries(t,e){return Ct.resolve()}}class uM{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e]||new Wi(Tn.comparator),l=!s.has(i);return this.index[e]=s.add(i),l}has(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e];return s&&s.has(i)}getEntries(t){return(this.index[t]||new Wi(Tn.comparator)).toArray()}}const lb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},A6=41943040;class Ga{static withCacheSize(t){return new Ga(t,Ga.DEFAULT_COLLECTION_PERCENTILE,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}}Ga.DEFAULT_COLLECTION_PERCENTILE=10,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ga.DEFAULT=new Ga(A6,Ga.DEFAULT_COLLECTION_PERCENTILE,Ga.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ga.DISABLED=new Ga(-1,0,0);class Am{constructor(t){this._r=t}next(){return this._r+=2,this._r}static ar(){return new Am(0)}static ur(){return new Am(-1)}}const ob="LruGarbageCollector",cM=1048576;function ub([n,t],[e,i]){const s=xe(n,e);return s===0?xe(t,i):s}class hM{constructor(t){this.Tr=t,this.buffer=new Wi(ub),this.Ir=0}dr(){return++this.Ir}Er(t){const e=[t,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();ub(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class fM{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(t){Yt(ob,`Garbage collection scheduled in ${t}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){zm(e)?Yt(ob,"Ignoring IndexedDB error during garbage collection: ",e):await Um(e)}await this.Rr(3e5)}))}}class dM{constructor(t,e){this.Vr=t,this.params=e}calculateTargetCount(t,e){return this.Vr.mr(t).next((i=>Math.floor(e/100*i)))}nthSequenceNumber(t,e){if(e===0)return Ct.resolve(H1.ue);const i=new hM(e);return this.Vr.forEachTarget(t,(s=>i.Er(s.sequenceNumber))).next((()=>this.Vr.gr(t,(s=>i.Er(s))))).next((()=>i.maxValue))}removeTargets(t,e,i){return this.Vr.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.Vr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(Yt("LruGarbageCollector","Garbage collection skipped; disabled"),Ct.resolve(lb)):this.getCacheSize(t).next((i=>i<this.params.cacheSizeCollectionThreshold?(Yt("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lb):this.pr(t,e)))}getCacheSize(t){return this.Vr.getCacheSize(t)}pr(t,e){let i,s,l,c,f,m,g;const A=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((E=>(E>this.params.maximumSequenceNumbersToCollect?(Yt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${E}`),s=this.params.maximumSequenceNumbersToCollect):s=E,c=Date.now(),this.nthSequenceNumber(t,s)))).next((E=>(i=E,f=Date.now(),this.removeTargets(t,i,e)))).next((E=>(l=E,m=Date.now(),this.removeOrphanedDocuments(t,i)))).next((E=>(g=Date.now(),Zd()<=Ue.DEBUG&&Yt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-A}ms
	Determined least recently used ${s} in `+(f-c)+`ms
	Removed ${l} targets in `+(m-f)+`ms
	Removed ${E} documents in `+(g-m)+`ms
Total Duration: ${g-A}ms`),Ct.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:l,documentsRemoved:E}))))}}function mM(n,t){return new dM(n,t)}class pM{constructor(){this.changes=new Hf((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Js.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?Ct.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class gM{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class _M{constructor(t,e,i,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(i=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(i!==null&&Pg(i.mutation,s,gr.empty(),sn.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.getLocalViewOfDocuments(t,i,je()).next((()=>i))))}getLocalViewOfDocuments(t,e,i=je()){const s=wf();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,i).next((l=>{let c=Sg();return l.forEach(((f,m)=>{c=c.insert(f,m.overlayedDocument)})),c}))))}getOverlayedDocuments(t,e){const i=wf();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,je())))}populateOverlays(t,e,i){const s=[];return i.forEach((l=>{e.has(l)||s.push(l)})),this.documentOverlayCache.getOverlays(t,s).next((l=>{l.forEach(((c,f)=>{e.set(c,f)}))}))}computeViews(t,e,i,s){let l=Pu();const c=kg(),f=(function(){return kg()})();return e.forEach(((m,g)=>{const A=i.get(g.key);s.has(g.key)&&(A===void 0||A.mutation instanceof yh)?l=l.insert(g.key,g):A!==void 0?(c.set(g.key,A.mutation.getFieldMask()),Pg(A.mutation,g,A.mutation.getFieldMask(),sn.now())):c.set(g.key,gr.empty())})),this.recalculateAndSaveOverlays(t,l).next((m=>(m.forEach(((g,A)=>c.set(g,A))),e.forEach(((g,A)=>{var E;return f.set(g,new gM(A,(E=c.get(g))!==null&&E!==void 0?E:null))})),f)))}recalculateAndSaveOverlays(t,e){const i=kg();let s=new zi(((c,f)=>c-f)),l=je();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((c=>{for(const f of c)f.keys().forEach((m=>{const g=e.get(m);if(g===null)return;let A=i.get(m)||gr.empty();A=f.applyToLocalView(g,A),i.set(m,A);const E=(s.get(f.batchId)||je()).add(m);s=s.insert(f.batchId,E)}))})).next((()=>{const c=[],f=s.getReverseIterator();for(;f.hasNext();){const m=f.getNext(),g=m.key,A=m.value,E=n6();A.forEach((T=>{if(!l.has(T)){const x=o6(e.get(T),i.get(T));x!==null&&E.set(T,x),l=l.add(T)}})),c.push(this.documentOverlayCache.saveOverlays(t,g,E))}return Ct.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.recalculateAndSaveOverlays(t,i)))}getDocumentsMatchingQuery(t,e,i,s){return(function(c){return Zt.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):J5(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,s):this.getDocumentsMatchingCollectionQuery(t,e,i,s)}getNextDocuments(t,e,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,s).next((l=>{const c=s-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,s-l.size):Ct.resolve(wf());let f=Jg,m=l;return c.next((g=>Ct.forEach(g,((A,E)=>(f<E.largestBatchId&&(f=E.largestBatchId),l.get(A)?Ct.resolve():this.remoteDocumentCache.getEntry(t,A).next((T=>{m=m.insert(A,T)}))))).next((()=>this.populateOverlays(t,g,l))).next((()=>this.computeViews(t,m,g,je()))).next((A=>({batchId:f,changes:e6(A)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Zt(e)).next((i=>{let s=Sg();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,i,s){const l=e.collectionGroup;let c=Sg();return this.indexManager.getCollectionParents(t,l).next((f=>Ct.forEach(f,(m=>{const g=(function(E,T){return new Bm(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)})(e,m.child(l));return this.getDocumentsMatchingCollectionQuery(t,g,i,s).next((A=>{A.forEach(((E,T)=>{c=c.insert(E,T)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(t,e,i,s){let l;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,l,s)))).next((c=>{l.forEach(((m,g)=>{const A=g.getKey();c.get(A)===null&&(c=c.insert(A,Js.newInvalidDocument(A)))}));let f=Sg();return c.forEach(((m,g)=>{const A=l.get(m);A!==void 0&&Pg(A.mutation,g,gr.empty(),sn.now()),Q1(e,g)&&(f=f.insert(m,g))})),f}))}}class yM{constructor(t){this.serializer=t,this.Br=new Map,this.Lr=new Map}getBundleMetadata(t,e){return Ct.resolve(this.Br.get(e))}saveBundleMetadata(t,e){return this.Br.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:Io(s.createTime)}})(e)),Ct.resolve()}getNamedQuery(t,e){return Ct.resolve(this.Lr.get(e))}saveNamedQuery(t,e){return this.Lr.set(e.name,(function(s){return{name:s.name,query:lM(s.bundledQuery),readTime:Io(s.readTime)}})(e)),Ct.resolve()}}class vM{constructor(){this.overlays=new zi(Zt.comparator),this.kr=new Map}getOverlay(t,e){return Ct.resolve(this.overlays.get(e))}getOverlays(t,e){const i=wf();return Ct.forEach(e,(s=>this.getOverlay(t,s).next((l=>{l!==null&&i.set(s,l)})))).next((()=>i))}saveOverlays(t,e,i){return i.forEach(((s,l)=>{this.wt(t,e,l)})),Ct.resolve()}removeOverlaysForBatchId(t,e,i){const s=this.kr.get(i);return s!==void 0&&(s.forEach((l=>this.overlays=this.overlays.remove(l))),this.kr.delete(i)),Ct.resolve()}getOverlaysForCollection(t,e,i){const s=wf(),l=e.length+1,c=new Zt(e.child("")),f=this.overlays.getIteratorFrom(c);for(;f.hasNext();){const m=f.getNext().value,g=m.getKey();if(!e.isPrefixOf(g.path))break;g.path.length===l&&m.largestBatchId>i&&s.set(m.getKey(),m)}return Ct.resolve(s)}getOverlaysForCollectionGroup(t,e,i,s){let l=new zi(((g,A)=>g-A));const c=this.overlays.getIterator();for(;c.hasNext();){const g=c.getNext().value;if(g.getKey().getCollectionGroup()===e&&g.largestBatchId>i){let A=l.get(g.largestBatchId);A===null&&(A=wf(),l=l.insert(g.largestBatchId,A)),A.set(g.getKey(),g)}}const f=wf(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,A)=>f.set(g,A))),!(f.size()>=s)););return Ct.resolve(f)}wt(t,e,i){const s=this.overlays.get(i.key);if(s!==null){const c=this.kr.get(s.largestBatchId).delete(i.key);this.kr.set(s.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new UO(e,i));let l=this.kr.get(e);l===void 0&&(l=je(),this.kr.set(e,l)),this.kr.set(e,l.add(i.key))}}class AM{constructor(){this.sessionToken=fs.EMPTY_BYTE_STRING}getSessionToken(t){return Ct.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,Ct.resolve()}}class LE{constructor(){this.qr=new Wi(os.Qr),this.$r=new Wi(os.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(t,e){const i=new os(t,e);this.qr=this.qr.add(i),this.$r=this.$r.add(i)}Kr(t,e){t.forEach((i=>this.addReference(i,e)))}removeReference(t,e){this.Wr(new os(t,e))}Gr(t,e){t.forEach((i=>this.removeReference(i,e)))}zr(t){const e=new Zt(new Tn([])),i=new os(e,t),s=new os(e,t+1),l=[];return this.$r.forEachInRange([i,s],(c=>{this.Wr(c),l.push(c.key)})),l}jr(){this.qr.forEach((t=>this.Wr(t)))}Wr(t){this.qr=this.qr.delete(t),this.$r=this.$r.delete(t)}Jr(t){const e=new Zt(new Tn([])),i=new os(e,t),s=new os(e,t+1);let l=je();return this.$r.forEachInRange([i,s],(c=>{l=l.add(c.key)})),l}containsKey(t){const e=new os(t,0),i=this.qr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class os{constructor(t,e){this.key=t,this.Hr=e}static Qr(t,e){return Zt.comparator(t.key,e.key)||xe(t.Hr,e.Hr)}static Ur(t,e){return xe(t.Hr,e.Hr)||Zt.comparator(t.key,e.key)}}class EM{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.er=1,this.Yr=new Wi(os.Qr)}checkEmpty(t){return Ct.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,s){const l=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new VO(l,e,i,s);this.mutationQueue.push(c);for(const f of s)this.Yr=this.Yr.add(new os(f.key,l)),this.indexManager.addToCollectionParentIndex(t,f.key.path.popLast());return Ct.resolve(c)}lookupMutationBatch(t,e){return Ct.resolve(this.Zr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,s=this.Xr(i),l=s<0?0:s;return Ct.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return Ct.resolve(this.mutationQueue.length===0?bE:this.er-1)}getAllMutationBatches(t){return Ct.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new os(e,0),s=new os(e,Number.POSITIVE_INFINITY),l=[];return this.Yr.forEachInRange([i,s],(c=>{const f=this.Zr(c.Hr);l.push(f)})),Ct.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new Wi(xe);return e.forEach((s=>{const l=new os(s,0),c=new os(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([l,c],(f=>{i=i.add(f.Hr)}))})),Ct.resolve(this.ei(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,s=i.length+1;let l=i;Zt.isDocumentKey(l)||(l=l.child(""));const c=new os(new Zt(l),0);let f=new Wi(xe);return this.Yr.forEachWhile((m=>{const g=m.key.path;return!!i.isPrefixOf(g)&&(g.length===s&&(f=f.add(m.Hr)),!0)}),c),Ct.resolve(this.ei(f))}ei(t){const e=[];return t.forEach((i=>{const s=this.Zr(i);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){un(this.ti(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Yr;return Ct.forEach(e.mutations,(s=>{const l=new os(s.key,e.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Yr=i}))}rr(t){}containsKey(t,e){const i=new os(e,0),s=this.Yr.firstAfterOrEqual(i);return Ct.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,Ct.resolve()}ti(t,e){return this.Xr(t)}Xr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Zr(t){const e=this.Xr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class SM{constructor(t){this.ni=t,this.docs=(function(){return new zi(Zt.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,s=this.docs.get(i),l=s?s.size:0,c=this.ni(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return Ct.resolve(i?i.document.mutableCopy():Js.newInvalidDocument(e))}getEntries(t,e){let i=Pu();return e.forEach((s=>{const l=this.docs.get(s);i=i.insert(s,l?l.document.mutableCopy():Js.newInvalidDocument(s))})),Ct.resolve(i)}getDocumentsMatchingQuery(t,e,i,s){let l=Pu();const c=e.path,f=new Zt(c.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(f);for(;m.hasNext();){const{key:g,value:{document:A}}=m.getNext();if(!c.isPrefixOf(g.path))break;g.path.length>c.length+1||JI(WI(A),i)<=0||(s.has(A.key)||Q1(e,A))&&(l=l.insert(A.key,A.mutableCopy()))}return Ct.resolve(l)}getAllFromCollectionGroup(t,e,i,s){oe(9500)}ri(t,e){return Ct.forEach(this.docs,(i=>e(i)))}newChangeBuffer(t){return new TM(this)}getSize(t){return Ct.resolve(this.size)}}class TM extends pM{constructor(t){super(),this.Or=t}applyChanges(t){const e=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?e.push(this.Or.addEntry(t,s)):this.Or.removeEntry(i)})),Ct.waitFor(e)}getFromCache(t,e){return this.Or.getEntry(t,e)}getAllFromCache(t,e){return this.Or.getEntries(t,e)}}class bM{constructor(t){this.persistence=t,this.ii=new Hf((e=>RE(e)),xE),this.lastRemoteSnapshotVersion=fe.min(),this.highestTargetId=0,this.si=0,this.oi=new LE,this.targetCount=0,this._i=Am.ar()}forEachTarget(t,e){return this.ii.forEach(((i,s)=>e(s))),Ct.resolve()}getLastRemoteSnapshotVersion(t){return Ct.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return Ct.resolve(this.si)}allocateTargetId(t){return this.highestTargetId=this._i.next(),Ct.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.si&&(this.si=e),Ct.resolve()}hr(t){this.ii.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this._i=new Am(e),this.highestTargetId=e),t.sequenceNumber>this.si&&(this.si=t.sequenceNumber)}addTargetData(t,e){return this.hr(e),this.targetCount+=1,Ct.resolve()}updateTargetData(t,e){return this.hr(e),Ct.resolve()}removeTargetData(t,e){return this.ii.delete(e.target),this.oi.zr(e.targetId),this.targetCount-=1,Ct.resolve()}removeTargets(t,e,i){let s=0;const l=[];return this.ii.forEach(((c,f)=>{f.sequenceNumber<=e&&i.get(f.targetId)===null&&(this.ii.delete(c),l.push(this.removeMatchingKeysForTargetId(t,f.targetId)),s++)})),Ct.waitFor(l).next((()=>s))}getTargetCount(t){return Ct.resolve(this.targetCount)}getTargetData(t,e){const i=this.ii.get(e)||null;return Ct.resolve(i)}addMatchingKeys(t,e,i){return this.oi.Kr(e,i),Ct.resolve()}removeMatchingKeys(t,e,i){this.oi.Gr(e,i);const s=this.persistence.referenceDelegate,l=[];return s&&e.forEach((c=>{l.push(s.markPotentiallyOrphaned(t,c))})),Ct.waitFor(l)}removeMatchingKeysForTargetId(t,e){return this.oi.zr(e),Ct.resolve()}getMatchingKeysForTargetId(t,e){const i=this.oi.Jr(e);return Ct.resolve(i)}containsKey(t,e){return Ct.resolve(this.oi.containsKey(e))}}class E6{constructor(t,e){this.ai={},this.overlays={},this.ui=new H1(0),this.ci=!1,this.ci=!0,this.li=new AM,this.referenceDelegate=t(this),this.hi=new bM(this),this.indexManager=new oM,this.remoteDocumentCache=(function(s){return new SM(s)})((i=>this.referenceDelegate.Pi(i))),this.serializer=new rM(e),this.Ti=new yM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new vM,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.ai[t.toKey()];return i||(i=new EM(e,this.referenceDelegate),this.ai[t.toKey()]=i),i}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(t,e,i){Yt("MemoryPersistence","Starting transaction:",t);const s=new CM(this.ui.next());return this.referenceDelegate.Ii(),i(s).next((l=>this.referenceDelegate.di(s).next((()=>l)))).toPromise().then((l=>(s.raiseOnCommittedEvent(),l)))}Ei(t,e){return Ct.or(Object.values(this.ai).map((i=>()=>i.containsKey(t,e))))}}class CM extends $I{constructor(t){super(),this.currentSequenceNumber=t}}class kE{constructor(t){this.persistence=t,this.Ai=new LE,this.Ri=null}static Vi(t){return new kE(t)}get mi(){if(this.Ri)return this.Ri;throw oe(60996)}addReference(t,e,i){return this.Ai.addReference(i,e),this.mi.delete(i.toString()),Ct.resolve()}removeReference(t,e,i){return this.Ai.removeReference(i,e),this.mi.add(i.toString()),Ct.resolve()}markPotentiallyOrphaned(t,e){return this.mi.add(e.toString()),Ct.resolve()}removeTarget(t,e){this.Ai.zr(e.targetId).forEach((s=>this.mi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((l=>this.mi.add(l.toString())))})).next((()=>i.removeTargetData(t,e)))}Ii(){this.Ri=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ct.forEach(this.mi,(i=>{const s=Zt.fromPath(i);return this.fi(t,s).next((l=>{l||e.removeEntry(s,fe.min())}))})).next((()=>(this.Ri=null,e.apply(t))))}updateLimboDocument(t,e){return this.fi(t,e).next((i=>{i?this.mi.delete(e.toString()):this.mi.add(e.toString())}))}Pi(t){return 0}fi(t,e){return Ct.or([()=>Ct.resolve(this.Ai.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ei(t,e)])}}class o1{constructor(t,e){this.persistence=t,this.gi=new Hf((i=>nO(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=mM(this,e)}static Vi(t,e){return new o1(t,e)}Ii(){}di(t){return Ct.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}mr(t){const e=this.yr(t);return this.persistence.getTargetCache().getTargetCount(t).next((i=>e.next((s=>i+s))))}yr(t){let e=0;return this.gr(t,(i=>{e++})).next((()=>e))}gr(t,e){return Ct.forEach(this.gi,((i,s)=>this.Sr(t,i,s).next((l=>l?Ct.resolve():e(s)))))}removeTargets(t,e,i){return this.persistence.getTargetCache().removeTargets(t,e,i)}removeOrphanedDocuments(t,e){let i=0;const s=this.persistence.getRemoteDocumentCache(),l=s.newChangeBuffer();return s.ri(t,(c=>this.Sr(t,c,e).next((f=>{f||(i++,l.removeEntry(c,fe.min()))})))).next((()=>l.apply(t))).next((()=>i))}markPotentiallyOrphaned(t,e){return this.gi.set(e,t.currentSequenceNumber),Ct.resolve()}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,e,i){return this.gi.set(i,t.currentSequenceNumber),Ct.resolve()}removeReference(t,e,i){return this.gi.set(i,t.currentSequenceNumber),Ct.resolve()}updateLimboDocument(t,e){return this.gi.set(e,t.currentSequenceNumber),Ct.resolve()}Pi(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Py(t.data.value)),e}Sr(t,e,i){return Ct.or([()=>this.persistence.Ei(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.gi.get(e);return Ct.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class PE{constructor(t,e,i,s){this.targetId=t,this.fromCache=e,this.Is=i,this.ds=s}static Es(t,e){let i=je(),s=je();for(const l of e.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:s=s.add(l.doc.key)}return new PE(t,e.fromCache,i,s)}}class wM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class RM{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return ex()?8:tO($s())>0?6:4})()}initialize(t,e){this.gs=t,this.indexManager=e,this.As=!0}getDocumentsMatchingQuery(t,e,i,s){const l={result:null};return this.ps(t,e).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ys(t,e,s,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new wM;return this.ws(t,e,c).next((f=>{if(l.result=f,this.Rs)return this.Ss(t,e,c,f.size)}))})).next((()=>l.result))}Ss(t,e,i,s){return i.documentReadCount<this.Vs?(Zd()<=Ue.DEBUG&&Yt("QueryEngine","SDK will not create cache indexes for query:",$d(e),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),Ct.resolve()):(Zd()<=Ue.DEBUG&&Yt("QueryEngine","Query:",$d(e),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.fs*s?(Zd()<=Ue.DEBUG&&Yt("QueryEngine","The SDK decides to create cache indexes for query:",$d(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,Do(e))):Ct.resolve())}ps(t,e){if(JT(e))return Ct.resolve(null);let i=Do(e);return this.indexManager.getIndexType(t,i).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=cA(e,null,"F"),i=Do(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next((l=>{const c=je(...l);return this.gs.getDocuments(t,c).next((f=>this.indexManager.getMinOffset(t,i).next((m=>{const g=this.bs(e,f);return this.Ds(e,g,c,m.readTime)?this.ps(t,cA(e,null,"F")):this.vs(t,g,e,m)}))))})))))}ys(t,e,i,s){return JT(e)||s.isEqual(fe.min())?Ct.resolve(null):this.gs.getDocuments(t,i).next((l=>{const c=this.bs(e,l);return this.Ds(e,c,i,s)?Ct.resolve(null):(Zd()<=Ue.DEBUG&&Yt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),$d(e)),this.vs(t,c,e,KI(s,Jg)).next((f=>f)))}))}bs(t,e){let i=new Wi($5(t));return e.forEach(((s,l)=>{Q1(t,l)&&(i=i.add(l))})),i}Ds(t,e,i,s){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const l=t.limitType==="F"?e.last():e.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(s)>0)}ws(t,e,i){return Zd()<=Ue.DEBUG&&Yt("QueryEngine","Using full collection scan to execute query:",$d(e)),this.gs.getDocumentsMatchingQuery(t,e,lh.min(),i)}vs(t,e,i,s){return this.gs.getDocumentsMatchingQuery(t,i,s).next((l=>(e.forEach((c=>{l=l.insert(c.key,c)})),l)))}}const VE="LocalStore",xM=3e8;class NM{constructor(t,e,i,s){this.persistence=t,this.Cs=e,this.serializer=s,this.Fs=new zi(xe),this.Ms=new Hf((l=>RE(l)),xE),this.xs=new Map,this.Os=t.getRemoteDocumentCache(),this.hi=t.getTargetCache(),this.Ti=t.getBundleCache(),this.Ns(i)}Ns(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new _M(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Fs)))}}function DM(n,t,e,i){return new NM(n,t,e,i)}async function S6(n,t){const e=ge(n);return await e.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return e.mutationQueue.getAllMutationBatches(i).next((l=>(s=l,e.Ns(t),e.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],f=[];let m=je();for(const g of s){c.push(g.batchId);for(const A of g.mutations)m=m.add(A.key)}for(const g of l){f.push(g.batchId);for(const A of g.mutations)m=m.add(A.key)}return e.localDocuments.getDocuments(i,m).next((g=>({Bs:g,removedBatchIds:c,addedBatchIds:f})))}))}))}function IM(n,t){const e=ge(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=t.batch.keys(),l=e.Os.newChangeBuffer({trackRemovals:!0});return(function(f,m,g,A){const E=g.batch,T=E.keys();let x=Ct.resolve();return T.forEach((R=>{x=x.next((()=>A.getEntry(m,R))).next((O=>{const M=g.docVersions.get(R);un(M!==null,48541),O.version.compareTo(M)<0&&(E.applyToRemoteDocument(O,g),O.isValidDocument()&&(O.setReadTime(g.commitVersion),A.addEntry(O)))}))})),x.next((()=>f.mutationQueue.removeMutationBatch(m,E)))})(e,i,t,l).next((()=>l.apply(i))).next((()=>e.mutationQueue.performConsistencyCheck(i))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(f){let m=je();for(let g=0;g<f.mutationResults.length;++g)f.mutationResults[g].transformResults.length>0&&(m=m.add(f.batch.mutations[g].key));return m})(t)))).next((()=>e.localDocuments.getDocuments(i,s)))}))}function T6(n){const t=ge(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.hi.getLastRemoteSnapshotVersion(e)))}function OM(n,t){const e=ge(n),i=t.snapshotVersion;let s=e.Fs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=e.Os.newChangeBuffer({trackRemovals:!0});s=e.Fs;const f=[];t.targetChanges.forEach(((A,E)=>{const T=s.get(E);if(!T)return;f.push(e.hi.removeMatchingKeys(l,A.removedDocuments,E).next((()=>e.hi.addMatchingKeys(l,A.addedDocuments,E))));let x=T.withSequenceNumber(l.currentSequenceNumber);t.targetMismatches.get(E)!==null?x=x.withResumeToken(fs.EMPTY_BYTE_STRING,fe.min()).withLastLimboFreeSnapshotVersion(fe.min()):A.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(A.resumeToken,i)),s=s.insert(E,x),(function(O,M,H){return O.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=xM?!0:H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0})(T,x,A)&&f.push(e.hi.updateTargetData(l,x))}));let m=Pu(),g=je();if(t.documentUpdates.forEach((A=>{t.resolvedLimboDocuments.has(A)&&f.push(e.persistence.referenceDelegate.updateLimboDocument(l,A))})),f.push(MM(l,c,t.documentUpdates).next((A=>{m=A.Ls,g=A.ks}))),!i.isEqual(fe.min())){const A=e.hi.getLastRemoteSnapshotVersion(l).next((E=>e.hi.setTargetsMetadata(l,l.currentSequenceNumber,i)));f.push(A)}return Ct.waitFor(f).next((()=>c.apply(l))).next((()=>e.localDocuments.getLocalViewOfDocuments(l,m,g))).next((()=>m))})).then((l=>(e.Fs=s,l)))}function MM(n,t,e){let i=je(),s=je();return e.forEach((l=>i=i.add(l))),t.getEntries(n,i).next((l=>{let c=Pu();return e.forEach(((f,m)=>{const g=l.get(f);m.isFoundDocument()!==g.isFoundDocument()&&(s=s.add(f)),m.isNoDocument()&&m.version.isEqual(fe.min())?(t.removeEntry(f,m.readTime),c=c.insert(f,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(t.addEntry(m),c=c.insert(f,m)):Yt(VE,"Ignoring outdated watch update for ",f,". Current version:",g.version," Watch version:",m.version)})),{Ls:c,ks:s}}))}function LM(n,t){const e=ge(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(i=>(t===void 0&&(t=bE),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t))))}function kM(n,t){const e=ge(n);return e.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return e.hi.getTargetData(i,t).next((l=>l?(s=l,Ct.resolve(s)):e.hi.allocateTargetId(i).next((c=>(s=new Jc(t,c,"TargetPurposeListen",i.currentSequenceNumber),e.hi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=e.Fs.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Fs=e.Fs.insert(i.targetId,i),e.Ms.set(t,i.targetId)),i}))}async function pA(n,t,e){const i=ge(n),s=i.Fs.get(t),l=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,s)))}catch(c){if(!zm(c))throw c;Yt(VE,`Failed to update sequence numbers for target ${t}: ${c}`)}i.Fs=i.Fs.remove(t),i.Ms.delete(s.target)}function cb(n,t,e){const i=ge(n);let s=fe.min(),l=je();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(m,g,A){const E=ge(m),T=E.Ms.get(A);return T!==void 0?Ct.resolve(E.Fs.get(T)):E.hi.getTargetData(g,A)})(i,c,Do(t)).next((f=>{if(f)return s=f.lastLimboFreeSnapshotVersion,i.hi.getMatchingKeysForTargetId(c,f.targetId).next((m=>{l=m}))})).next((()=>i.Cs.getDocumentsMatchingQuery(c,t,e?s:fe.min(),e?l:je()))).next((f=>(PM(i,EO(t),f),{documents:f,qs:l})))))}function PM(n,t,e){let i=n.xs.get(t)||fe.min();e.forEach(((s,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.xs.set(t,i)}class hb{constructor(){this.activeTargetIds=RO()}Gs(t){this.activeTargetIds=this.activeTargetIds.add(t)}zs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Ws(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class VM{constructor(){this.Fo=new hb,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.Fo.Gs(t),this.Mo[t]||"not-current"}updateQueryState(t,e,i){this.Mo[t]=e}removeLocalQueryTarget(t){this.Fo.zs(t)}isLocalQueryTarget(t){return this.Fo.activeTargetIds.has(t)}clearQueryState(t){delete this.Mo[t]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(t){return this.Fo.activeTargetIds.has(t)}start(){return this.Fo=new hb,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class UM{xo(t){}shutdown(){}}const fb="ConnectivityMonitor";class db{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(t){this.ko.push(t)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Yt(fb,"Network connectivity changed: AVAILABLE");for(const t of this.ko)t(0)}Lo(){Yt(fb,"Network connectivity changed: UNAVAILABLE");for(const t of this.ko)t(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let my=null;function gA(){return my===null?my=(function(){return 268435456+Math.round(2147483648*Math.random())})():my++,"0x"+my.toString(16)}const p2="RestConnection",zM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class BM{get Qo(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=e+"://"+t.host,this.Uo=`projects/${i}/databases/${s}`,this.Ko=this.databaseId.database===n1?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Wo(t,e,i,s,l){const c=gA(),f=this.Go(t,e.toUriEncodedString());Yt(p2,`Sending RPC '${t}' ${c}:`,f,i);const m={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(m,s,l);const{host:g}=new URL(f),A=ph(g);return this.jo(t,f,m,i,A).then((E=>(Yt(p2,`Received RPC '${t}' ${c}: `,E),E)),(E=>{throw ku(p2,`RPC '${t}' ${c} failed with error: `,E,"url: ",f,"request:",i),E}))}Jo(t,e,i,s,l,c){return this.Wo(t,e,i,s,l)}zo(t,e,i){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Vm})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,l)=>t[l]=s)),i&&i.headers.forEach(((s,l)=>t[l]=s))}Go(t,e){const i=zM[t];return`${this.$o}/v1/${e}:${i}`}terminate(){}}class jM{constructor(t){this.Ho=t.Ho,this.Yo=t.Yo}Zo(t){this.Xo=t}e_(t){this.t_=t}n_(t){this.r_=t}onMessage(t){this.i_=t}close(){this.Yo()}send(t){this.Ho(t)}s_(){this.Xo()}o_(){this.t_()}__(t){this.r_(t)}a_(t){this.i_(t)}}const Ks="WebChannelConnection";class HM extends BM{constructor(t){super(t),this.u_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}jo(t,e,i,s,l){const c=gA();return new Promise(((f,m)=>{const g=new b5;g.setWithCredentials(!0),g.listenOnce(C5.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case ky.NO_ERROR:const E=g.getResponseJson();Yt(Ks,`XHR for RPC '${t}' ${c} received:`,JSON.stringify(E)),f(E);break;case ky.TIMEOUT:Yt(Ks,`RPC '${t}' ${c} timed out`),m(new Gt(Et.DEADLINE_EXCEEDED,"Request time out"));break;case ky.HTTP_ERROR:const T=g.getStatus();if(Yt(Ks,`RPC '${t}' ${c} failed with status:`,T,"response text:",g.getResponseText()),T>0){let x=g.getResponseJson();Array.isArray(x)&&(x=x[0]);const R=x?.error;if(R&&R.status&&R.message){const O=(function(H){const B=H.toLowerCase().replace(/_/g,"-");return Object.values(Et).indexOf(B)>=0?B:Et.UNKNOWN})(R.status);m(new Gt(O,R.message))}else m(new Gt(Et.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new Gt(Et.UNAVAILABLE,"Connection failed."));break;default:oe(9055,{c_:t,streamId:c,l_:g.getLastErrorCode(),h_:g.getLastError()})}}finally{Yt(Ks,`RPC '${t}' ${c} completed.`)}}));const A=JSON.stringify(s);Yt(Ks,`RPC '${t}' ${c} sending request:`,s),g.send(e,"POST",A,i,15)}))}P_(t,e,i){const s=gA(),l=[this.$o,"/","google.firestore.v1.Firestore","/",t,"/channel"],c=x5(),f=R5(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(m.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(m.useFetchStreams=!0),this.zo(m.initMessageHeaders,e,i),m.encodeInitMessageHeaders=!0;const A=l.join("");Yt(Ks,`Creating RPC '${t}' stream ${s}: ${A}`,m);const E=c.createWebChannel(A,m);this.T_(E);let T=!1,x=!1;const R=new jM({Ho:M=>{x?Yt(Ks,`Not sending because RPC '${t}' stream ${s} is closed:`,M):(T||(Yt(Ks,`Opening RPC '${t}' stream ${s} transport.`),E.open(),T=!0),Yt(Ks,`RPC '${t}' stream ${s} sending:`,M),E.send(M))},Yo:()=>E.close()}),O=(M,H,B)=>{M.listen(H,(Y=>{try{B(Y)}catch($){setTimeout((()=>{throw $}),0)}}))};return O(E,Eg.EventType.OPEN,(()=>{x||(Yt(Ks,`RPC '${t}' stream ${s} transport opened.`),R.s_())})),O(E,Eg.EventType.CLOSE,(()=>{x||(x=!0,Yt(Ks,`RPC '${t}' stream ${s} transport closed`),R.__(),this.I_(E))})),O(E,Eg.EventType.ERROR,(M=>{x||(x=!0,ku(Ks,`RPC '${t}' stream ${s} transport errored. Name:`,M.name,"Message:",M.message),R.__(new Gt(Et.UNAVAILABLE,"The operation could not be completed")))})),O(E,Eg.EventType.MESSAGE,(M=>{var H;if(!x){const B=M.data[0];un(!!B,16349);const Y=B,$=Y?.error||((H=Y[0])===null||H===void 0?void 0:H.error);if($){Yt(Ks,`RPC '${t}' stream ${s} received error:`,$);const nt=$.status;let X=(function(V){const q=Li[V];if(q!==void 0)return c6(q)})(nt),L=$.message;X===void 0&&(X=Et.INTERNAL,L="Unknown error status: "+nt+" with message "+$.message),x=!0,R.__(new Gt(X,L)),E.close()}else Yt(Ks,`RPC '${t}' stream ${s} received:`,B),R.a_(B)}})),O(f,w5.STAT_EVENT,(M=>{M.stat===nA.PROXY?Yt(Ks,`RPC '${t}' stream ${s} detected buffering proxy`):M.stat===nA.NOPROXY&&Yt(Ks,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{R.o_()}),0),R}terminate(){this.u_.forEach((t=>t.close())),this.u_=[]}T_(t){this.u_.push(t)}I_(t){this.u_=this.u_.filter((e=>e===t))}}function g2(){return typeof document<"u"?document:null}function J1(n){return new YO(n,!0)}class b6{constructor(t,e,i=1e3,s=1.5,l=6e4){this.Fi=t,this.timerId=e,this.d_=i,this.E_=s,this.A_=l,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(t){this.cancel();const e=Math.floor(this.R_+this.p_()),i=Math.max(0,Date.now()-this.m_),s=Math.max(0,e-i);s>0&&Yt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,(()=>(this.m_=Date.now(),t()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}const mb="PersistentStream";class C6{constructor(t,e,i,s,l,c,f,m){this.Fi=t,this.w_=i,this.S_=s,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=f,this.listener=m,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new b6(t,e)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(t){this.q_(),this.stream.send(t)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,t!==4?this.F_.reset():e&&e.code===Et.RESOURCE_EXHAUSTED?(Lu(e.toString()),Lu("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):e&&e.code===Et.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.n_(e)}U_(){}auth(){this.state=1;const t=this.K_(this.b_),e=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.b_===e&&this.W_(i,s)}),(i=>{t((()=>{const s=new Gt(Et.UNKNOWN,"Fetching auth token failed: "+i.message);return this.G_(s)}))}))}W_(t,e){const i=this.K_(this.b_);this.stream=this.z_(t,e),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.e_((()=>{i((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((s=>{i((()=>this.G_(s)))})),this.stream.onMessage((s=>{i((()=>++this.C_==1?this.j_(s):this.onNext(s)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(t){return Yt(mb,`close with error: ${t}`),this.stream=null,this.close(4,t)}K_(t){return e=>{this.Fi.enqueueAndForget((()=>this.b_===t?e():(Yt(mb,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class GM extends C6{constructor(t,e,i,s,l,c){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,s,c),this.serializer=l}z_(t,e){return this.connection.P_("Listen",t,e)}j_(t){return this.onNext(t)}onNext(t){this.F_.reset();const e=KO(this.serializer,t),i=(function(l){if(!("targetChange"in l))return fe.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?fe.min():c.readTime?Io(c.readTime):fe.min()})(t);return this.listener.J_(e,i)}H_(t){const e={};e.database=mA(this.serializer),e.addTarget=(function(l,c){let f;const m=c.target;if(f=oA(m)?{documents:ZO(l,m)}:{query:$O(l,m).Vt},f.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){f.resumeToken=d6(l,c.resumeToken);const g=hA(l,c.expectedCount);g!==null&&(f.expectedCount=g)}else if(c.snapshotVersion.compareTo(fe.min())>0){f.readTime=l1(l,c.snapshotVersion.toTimestamp());const g=hA(l,c.expectedCount);g!==null&&(f.expectedCount=g)}return f})(this.serializer,t);const i=eM(this.serializer,t);i&&(e.labels=i),this.k_(e)}Y_(t){const e={};e.database=mA(this.serializer),e.removeTarget=t,this.k_(e)}}class qM extends C6{constructor(t,e,i,s,l,c){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,s,c),this.serializer=l}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(t,e){return this.connection.P_("Write",t,e)}j_(t){return un(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,un(!t.writeResults||t.writeResults.length===0,55816),this.listener.ea()}onNext(t){un(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.F_.reset();const e=JO(t.writeResults,t.commitTime),i=Io(t.commitTime);return this.listener.ta(i,e)}na(){const t={};t.database=mA(this.serializer),this.k_(t)}X_(t){const e={streamToken:this.lastStreamToken,writes:t.map((i=>WO(this.serializer,i)))};this.k_(e)}}class FM{}class YM extends FM{constructor(t,e,i,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new Gt(Et.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(t,e,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(t,fA(e,i),s,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Gt(Et.UNKNOWN,l.toString())}))}Jo(t,e,i,s,l){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,f])=>this.connection.Jo(t,fA(e,i),s,c,f,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Et.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Gt(Et.UNKNOWN,c.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class QM{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(t){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ua("Offline")))}set(t){this.ha(),this.sa=0,t==="Online"&&(this._a=!1),this.ua(t)}ua(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ca(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Lu(e),this._a=!1):Yt("OnlineStateTracker",e)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}const Lf="RemoteStore";class XM{constructor(t,e,i,s,l){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=l,this.Ea.xo((c=>{i.enqueueAndForget((async()=>{Gf(this)&&(Yt(Lf,"Restarting streams for network reachability change."),await(async function(m){const g=ge(m);g.Ia.add(4),await b0(g),g.Aa.set("Unknown"),g.Ia.delete(4),await Z1(g)})(this))}))})),this.Aa=new QM(i,s)}}async function Z1(n){if(Gf(n))for(const t of n.da)await t(!0)}async function b0(n){for(const t of n.da)await t(!1)}function w6(n,t){const e=ge(n);e.Ta.has(t.targetId)||(e.Ta.set(t.targetId,t),jE(e)?BE(e):jm(e).x_()&&zE(e,t))}function UE(n,t){const e=ge(n),i=jm(e);e.Ta.delete(t),i.x_()&&R6(e,t),e.Ta.size===0&&(i.x_()?i.B_():Gf(e)&&e.Aa.set("Unknown"))}function zE(n,t){if(n.Ra.$e(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(fe.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}jm(n).H_(t)}function R6(n,t){n.Ra.$e(t),jm(n).Y_(t)}function BE(n){n.Ra=new HO({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>n.Ta.get(t)||null,lt:()=>n.datastore.serializer.databaseId}),jm(n).start(),n.Aa.aa()}function jE(n){return Gf(n)&&!jm(n).M_()&&n.Ta.size>0}function Gf(n){return ge(n).Ia.size===0}function x6(n){n.Ra=void 0}async function KM(n){n.Aa.set("Online")}async function WM(n){n.Ta.forEach(((t,e)=>{zE(n,t)}))}async function JM(n,t){x6(n),jE(n)?(n.Aa.la(t),BE(n)):n.Aa.set("Unknown")}async function ZM(n,t,e){if(n.Aa.set("Online"),t instanceof f6&&t.state===2&&t.cause)try{await(async function(s,l){const c=l.cause;for(const f of l.targetIds)s.Ta.has(f)&&(await s.remoteSyncer.rejectListen(f,c),s.Ta.delete(f),s.Ra.removeTarget(f))})(n,t)}catch(i){Yt(Lf,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await u1(n,i)}else if(t instanceof zy?n.Ra.Ye(t):t instanceof h6?n.Ra.it(t):n.Ra.et(t),!e.isEqual(fe.min()))try{const i=await T6(n.localStore);e.compareTo(i)>=0&&await(function(l,c){const f=l.Ra.Pt(c);return f.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const A=l.Ta.get(g);A&&l.Ta.set(g,A.withResumeToken(m.resumeToken,c))}})),f.targetMismatches.forEach(((m,g)=>{const A=l.Ta.get(m);if(!A)return;l.Ta.set(m,A.withResumeToken(fs.EMPTY_BYTE_STRING,A.snapshotVersion)),R6(l,m);const E=new Jc(A.target,m,g,A.sequenceNumber);zE(l,E)})),l.remoteSyncer.applyRemoteEvent(f)})(n,e)}catch(i){Yt(Lf,"Failed to raise snapshot:",i),await u1(n,i)}}async function u1(n,t,e){if(!zm(t))throw t;n.Ia.add(1),await b0(n),n.Aa.set("Offline"),e||(e=()=>T6(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Yt(Lf,"Retrying IndexedDB access"),await e(),n.Ia.delete(1),await Z1(n)}))}function N6(n,t){return t().catch((e=>u1(n,e,t)))}async function $1(n){const t=ge(n),e=hh(t);let i=t.Pa.length>0?t.Pa[t.Pa.length-1].batchId:bE;for(;$M(t);)try{const s=await LM(t.localStore,i);if(s===null){t.Pa.length===0&&e.B_();break}i=s.batchId,tL(t,s)}catch(s){await u1(t,s)}D6(t)&&I6(t)}function $M(n){return Gf(n)&&n.Pa.length<10}function tL(n,t){n.Pa.push(t);const e=hh(n);e.x_()&&e.Z_&&e.X_(t.mutations)}function D6(n){return Gf(n)&&!hh(n).M_()&&n.Pa.length>0}function I6(n){hh(n).start()}async function eL(n){hh(n).na()}async function nL(n){const t=hh(n);for(const e of n.Pa)t.X_(e.mutations)}async function iL(n,t,e){const i=n.Pa.shift(),s=IE.from(i,t,e);await N6(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await $1(n)}async function sL(n,t){t&&hh(n).Z_&&await(async function(i,s){if((function(c){return BO(c)&&c!==Et.ABORTED})(s.code)){const l=i.Pa.shift();hh(i).N_(),await N6(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,s))),await $1(i)}})(n,t),D6(n)&&I6(n)}async function pb(n,t){const e=ge(n);e.asyncQueue.verifyOperationInProgress(),Yt(Lf,"RemoteStore received new credentials");const i=Gf(e);e.Ia.add(3),await b0(e),i&&e.Aa.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ia.delete(3),await Z1(e)}async function aL(n,t){const e=ge(n);t?(e.Ia.delete(2),await Z1(e)):t||(e.Ia.add(2),await b0(e),e.Aa.set("Unknown"))}function jm(n){return n.Va||(n.Va=(function(e,i,s){const l=ge(e);return l.ia(),new GM(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,s)})(n.datastore,n.asyncQueue,{Zo:KM.bind(null,n),e_:WM.bind(null,n),n_:JM.bind(null,n),J_:ZM.bind(null,n)}),n.da.push((async t=>{t?(n.Va.N_(),jE(n)?BE(n):n.Aa.set("Unknown")):(await n.Va.stop(),x6(n))}))),n.Va}function hh(n){return n.ma||(n.ma=(function(e,i,s){const l=ge(e);return l.ia(),new qM(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,s)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:eL.bind(null,n),n_:sL.bind(null,n),ea:nL.bind(null,n),ta:iL.bind(null,n)}),n.da.push((async t=>{t?(n.ma.N_(),await $1(n)):(await n.ma.stop(),n.Pa.length>0&&(Yt(Lf,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}class HE{constructor(t,e,i,s,l){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=s,this.removalCallback=l,this.deferred=new xu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,s,l){const c=Date.now()+i,f=new HE(t,e,c,s,l);return f.start(i),f}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Gt(Et.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function GE(n,t){if(Lu("AsyncQueue",`${t}: ${n}`),zm(n))return new Gt(Et.UNAVAILABLE,`${t}: ${n}`);throw n}class um{static emptySet(t){return new um(t.comparator)}constructor(t){this.comparator=t?(e,i)=>t(e,i)||Zt.comparator(e.key,i.key):(e,i)=>Zt.comparator(e.key,i.key),this.keyedMap=Sg(),this.sortedSet=new zi(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,i)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof um)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,l=i.getNext().key;if(!s.isEqual(l))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new um;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class gb{constructor(){this.fa=new zi(Zt.comparator)}track(t){const e=t.doc.key,i=this.fa.get(e);i?t.type!==0&&i.type===3?this.fa=this.fa.insert(e,t):t.type===3&&i.type!==1?this.fa=this.fa.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.fa=this.fa.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.fa=this.fa.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.fa=this.fa.remove(e):t.type===1&&i.type===2?this.fa=this.fa.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.fa=this.fa.insert(e,{type:2,doc:t.doc}):oe(63341,{At:t,ga:i}):this.fa=this.fa.insert(e,t)}pa(){const t=[];return this.fa.inorderTraversal(((e,i)=>{t.push(i)})),t}}class Em{constructor(t,e,i,s,l,c,f,m,g){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=f,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(t,e,i,s,l){const c=[];return e.forEach((f=>{c.push({type:0,doc:f})})),new Em(t,e,um.emptySet(e),c,i,s,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Y1(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==i[s].type||!e[s].doc.isEqual(i[s].doc))return!1;return!0}}class rL{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((t=>t.ba()))}}class lL{constructor(){this.queries=_b(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(e,i){const s=ge(e),l=s.queries;s.queries=_b(),l.forEach(((c,f)=>{for(const m of f.wa)m.onError(i)}))})(this,new Gt(Et.ABORTED,"Firestore shutting down"))}}function _b(){return new Hf((n=>Z5(n)),Y1)}async function qE(n,t){const e=ge(n);let i=3;const s=t.query;let l=e.queries.get(s);l?!l.Sa()&&t.ba()&&(i=2):(l=new rL,i=t.ba()?0:1);try{switch(i){case 0:l.ya=await e.onListen(s,!0);break;case 1:l.ya=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(c){const f=GE(c,`Initialization of query '${$d(t.query)}' failed`);return void t.onError(f)}e.queries.set(s,l),l.wa.push(t),t.va(e.onlineState),l.ya&&t.Ca(l.ya)&&YE(e)}async function FE(n,t){const e=ge(n),i=t.query;let s=3;const l=e.queries.get(i);if(l){const c=l.wa.indexOf(t);c>=0&&(l.wa.splice(c,1),l.wa.length===0?s=t.ba()?0:1:!l.Sa()&&t.ba()&&(s=2))}switch(s){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function oL(n,t){const e=ge(n);let i=!1;for(const s of t){const l=s.query,c=e.queries.get(l);if(c){for(const f of c.wa)f.Ca(s)&&(i=!0);c.ya=s}}i&&YE(e)}function uL(n,t,e){const i=ge(n),s=i.queries.get(t);if(s)for(const l of s.wa)l.onError(e);i.queries.delete(t)}function YE(n){n.Da.forEach((t=>{t.next()}))}var _A,yb;(yb=_A||(_A={})).Fa="default",yb.Cache="cache";class QE{constructor(t,e,i){this.query=t,this.Ma=e,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=i||{}}Ca(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new Em(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.xa?this.Na(t)&&(this.Ma.next(t),e=!0):this.Ba(t,this.onlineState)&&(this.La(t),e=!0),this.Oa=t,e}onError(t){this.Ma.error(t)}va(t){this.onlineState=t;let e=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,t)&&(this.La(this.Oa),e=!0),e}Ba(t,e){if(!t.fromCache||!this.ba())return!0;const i=e!=="Offline";return(!this.options.ka||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Na(t){if(t.docChanges.length>0)return!0;const e=this.Oa&&this.Oa.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}La(t){t=Em.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.xa=!0,this.Ma.next(t)}ba(){return this.options.source!==_A.Cache}}class O6{constructor(t){this.key=t}}class M6{constructor(t){this.key=t}}class cL{constructor(t,e){this.query=t,this.Ha=e,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=je(),this.mutatedKeys=je(),this.Xa=$5(t),this.eu=new um(this.Xa)}get tu(){return this.Ha}nu(t,e){const i=e?e.ru:new gb,s=e?e.eu:this.eu;let l=e?e.mutatedKeys:this.mutatedKeys,c=s,f=!1;const m=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,g=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((A,E)=>{const T=s.get(A),x=Q1(this.query,E)?E:null,R=!!T&&this.mutatedKeys.has(T.key),O=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let M=!1;T&&x?T.data.isEqual(x.data)?R!==O&&(i.track({type:3,doc:x}),M=!0):this.iu(T,x)||(i.track({type:2,doc:x}),M=!0,(m&&this.Xa(x,m)>0||g&&this.Xa(x,g)<0)&&(f=!0)):!T&&x?(i.track({type:0,doc:x}),M=!0):T&&!x&&(i.track({type:1,doc:T}),M=!0,(m||g)&&(f=!0)),M&&(x?(c=c.add(x),l=O?l.add(A):l.delete(A)):(c=c.delete(A),l=l.delete(A)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const A=this.query.limitType==="F"?c.last():c.first();c=c.delete(A.key),l=l.delete(A.key),i.track({type:1,doc:A})}return{eu:c,ru:i,Ds:f,mutatedKeys:l}}iu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,s){const l=this.eu;this.eu=t.eu,this.mutatedKeys=t.mutatedKeys;const c=t.ru.pa();c.sort(((A,E)=>(function(x,R){const O=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return oe(20277,{At:M})}};return O(x)-O(R)})(A.type,E.type)||this.Xa(A.doc,E.doc))),this.su(i),s=s!=null&&s;const f=e&&!s?this.ou():[],m=this.Za.size===0&&this.current&&!s?1:0,g=m!==this.Ya;return this.Ya=m,c.length!==0||g?{snapshot:new Em(this.query,t.eu,l,c,t.mutatedKeys,m===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new gb,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(t){return!this.Ha.has(t)&&!!this.eu.has(t)&&!this.eu.get(t).hasLocalMutations}su(t){t&&(t.addedDocuments.forEach((e=>this.Ha=this.Ha.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ha=this.Ha.delete(e))),this.current=t.current)}ou(){if(!this.current)return[];const t=this.Za;this.Za=je(),this.eu.forEach((i=>{this.au(i.key)&&(this.Za=this.Za.add(i.key))}));const e=[];return t.forEach((i=>{this.Za.has(i)||e.push(new M6(i))})),this.Za.forEach((i=>{t.has(i)||e.push(new O6(i))})),e}uu(t){this.Ha=t.qs,this.Za=je();const e=this.nu(t.documents);return this.applyChanges(e,!0)}cu(){return Em.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const XE="SyncEngine";class hL{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class fL{constructor(t){this.key=t,this.lu=!1}}class dL{constructor(t,e,i,s,l,c){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=s,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new Hf((f=>Z5(f)),Y1),this.Tu=new Map,this.Iu=new Set,this.du=new zi(Zt.comparator),this.Eu=new Map,this.Au=new LE,this.Ru={},this.Vu=new Map,this.mu=Am.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function mL(n,t,e=!0){const i=z6(n);let s;const l=i.Pu.get(t);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),s=l.view.cu()):s=await L6(i,t,e,!0),s}async function pL(n,t){const e=z6(n);await L6(e,t,!0,!1)}async function L6(n,t,e,i){const s=await kM(n.localStore,Do(t)),l=s.targetId,c=n.sharedClientState.addLocalQueryTarget(l,e);let f;return i&&(f=await gL(n,t,l,c==="current",s.resumeToken)),n.isPrimaryClient&&e&&w6(n.remoteStore,s),f}async function gL(n,t,e,i,s){n.gu=(E,T,x)=>(async function(O,M,H,B){let Y=M.view.nu(H);Y.Ds&&(Y=await cb(O.localStore,M.query,!1).then((({documents:L})=>M.view.nu(L,Y))));const $=B&&B.targetChanges.get(M.targetId),nt=B&&B.targetMismatches.get(M.targetId)!=null,X=M.view.applyChanges(Y,O.isPrimaryClient,$,nt);return Ab(O,M.targetId,X._u),X.snapshot})(n,E,T,x);const l=await cb(n.localStore,t,!0),c=new cL(t,l.qs),f=c.nu(l.documents),m=T0.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",s),g=c.applyChanges(f,n.isPrimaryClient,m);Ab(n,e,g._u);const A=new hL(t,e,c);return n.Pu.set(t,A),n.Tu.has(e)?n.Tu.get(e).push(t):n.Tu.set(e,[t]),g.snapshot}async function _L(n,t,e){const i=ge(n),s=i.Pu.get(t),l=i.Tu.get(s.targetId);if(l.length>1)return i.Tu.set(s.targetId,l.filter((c=>!Y1(c,t)))),void i.Pu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await pA(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),e&&UE(i.remoteStore,s.targetId),yA(i,s.targetId)})).catch(Um)):(yA(i,s.targetId),await pA(i.localStore,s.targetId,!0))}async function yL(n,t){const e=ge(n),i=e.Pu.get(t),s=e.Tu.get(i.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),UE(e.remoteStore,i.targetId))}async function vL(n,t,e){const i=wL(n);try{const s=await(function(c,f){const m=ge(c),g=sn.now(),A=f.reduce(((x,R)=>x.add(R.key)),je());let E,T;return m.persistence.runTransaction("Locally write mutations","readwrite",(x=>{let R=Pu(),O=je();return m.Os.getEntries(x,A).next((M=>{R=M,R.forEach(((H,B)=>{B.isValidDocument()||(O=O.add(H))}))})).next((()=>m.localDocuments.getOverlayedDocuments(x,R))).next((M=>{E=M;const H=[];for(const B of f){const Y=kO(B,E.get(B.key).overlayedDocument);Y!=null&&H.push(new yh(B.key,Y,q5(Y.value.mapValue),il.exists(!0)))}return m.mutationQueue.addMutationBatch(x,g,H,f)})).next((M=>{T=M;const H=M.applyToLocalDocumentSet(E,O);return m.documentOverlayCache.saveOverlays(x,M.batchId,H)}))})).then((()=>({batchId:T.batchId,changes:e6(E)})))})(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),(function(c,f,m){let g=c.Ru[c.currentUser.toKey()];g||(g=new zi(xe)),g=g.insert(f,m),c.Ru[c.currentUser.toKey()]=g})(i,s.batchId,e),await C0(i,s.changes),await $1(i.remoteStore)}catch(s){const l=GE(s,"Failed to persist write");e.reject(l)}}async function k6(n,t){const e=ge(n);try{const i=await OM(e.localStore,t);t.targetChanges.forEach(((s,l)=>{const c=e.Eu.get(l);c&&(un(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?c.lu=!0:s.modifiedDocuments.size>0?un(c.lu,14607):s.removedDocuments.size>0&&(un(c.lu,42227),c.lu=!1))})),await C0(e,i,t)}catch(i){await Um(i)}}function vb(n,t,e){const i=ge(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const s=[];i.Pu.forEach(((l,c)=>{const f=c.view.va(t);f.snapshot&&s.push(f.snapshot)})),(function(c,f){const m=ge(c);m.onlineState=f;let g=!1;m.queries.forEach(((A,E)=>{for(const T of E.wa)T.va(f)&&(g=!0)})),g&&YE(m)})(i.eventManager,t),s.length&&i.hu.J_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function AL(n,t,e){const i=ge(n);i.sharedClientState.updateQueryState(t,"rejected",e);const s=i.Eu.get(t),l=s&&s.key;if(l){let c=new zi(Zt.comparator);c=c.insert(l,Js.newNoDocument(l,fe.min()));const f=je().add(l),m=new W1(fe.min(),new Map,new zi(xe),c,f);await k6(i,m),i.du=i.du.remove(l),i.Eu.delete(t),KE(i)}else await pA(i.localStore,t,!1).then((()=>yA(i,t,e))).catch(Um)}async function EL(n,t){const e=ge(n),i=t.batch.batchId;try{const s=await IM(e.localStore,t);V6(e,i,null),P6(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await C0(e,s)}catch(s){await Um(s)}}async function SL(n,t,e){const i=ge(n);try{const s=await(function(c,f){const m=ge(c);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let A;return m.mutationQueue.lookupMutationBatch(g,f).next((E=>(un(E!==null,37113),A=E.keys(),m.mutationQueue.removeMutationBatch(g,E)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,A,f))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,A))).next((()=>m.localDocuments.getDocuments(g,A)))}))})(i.localStore,t);V6(i,t,e),P6(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await C0(i,s)}catch(s){await Um(s)}}function P6(n,t){(n.Vu.get(t)||[]).forEach((e=>{e.resolve()})),n.Vu.delete(t)}function V6(n,t,e){const i=ge(n);let s=i.Ru[i.currentUser.toKey()];if(s){const l=s.get(t);l&&(e?l.reject(e):l.resolve(),s=s.remove(t)),i.Ru[i.currentUser.toKey()]=s}}function yA(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Tu.get(t))n.Pu.delete(i),e&&n.hu.pu(i,e);n.Tu.delete(t),n.isPrimaryClient&&n.Au.zr(t).forEach((i=>{n.Au.containsKey(i)||U6(n,i)}))}function U6(n,t){n.Iu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(UE(n.remoteStore,e),n.du=n.du.remove(t),n.Eu.delete(e),KE(n))}function Ab(n,t,e){for(const i of e)i instanceof O6?(n.Au.addReference(i.key,t),TL(n,i)):i instanceof M6?(Yt(XE,"Document no longer in limbo: "+i.key),n.Au.removeReference(i.key,t),n.Au.containsKey(i.key)||U6(n,i.key)):oe(19791,{yu:i})}function TL(n,t){const e=t.key,i=e.path.canonicalString();n.du.get(e)||n.Iu.has(i)||(Yt(XE,"New document in limbo: "+e),n.Iu.add(i),KE(n))}function KE(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Iu.values().next().value;n.Iu.delete(t);const e=new Zt(Tn.fromString(t)),i=n.mu.next();n.Eu.set(i,new fL(e)),n.du=n.du.insert(e,i),w6(n.remoteStore,new Jc(Do(F1(e.path)),i,"TargetPurposeLimboResolution",H1.ue))}}async function C0(n,t,e){const i=ge(n),s=[],l=[],c=[];i.Pu.isEmpty()||(i.Pu.forEach(((f,m)=>{c.push(i.gu(m,t,e).then((g=>{var A;if((g||e)&&i.isPrimaryClient){const E=g?!g.fromCache:(A=e?.targetChanges.get(m.targetId))===null||A===void 0?void 0:A.current;i.sharedClientState.updateQueryState(m.targetId,E?"current":"not-current")}if(g){s.push(g);const E=PE.Es(m.targetId,g);l.push(E)}})))})),await Promise.all(c),i.hu.J_(s),await(async function(m,g){const A=ge(m);try{await A.persistence.runTransaction("notifyLocalViewChanges","readwrite",(E=>Ct.forEach(g,(T=>Ct.forEach(T.Is,(x=>A.persistence.referenceDelegate.addReference(E,T.targetId,x))).next((()=>Ct.forEach(T.ds,(x=>A.persistence.referenceDelegate.removeReference(E,T.targetId,x)))))))))}catch(E){if(!zm(E))throw E;Yt(VE,"Failed to update sequence numbers: "+E)}for(const E of g){const T=E.targetId;if(!E.fromCache){const x=A.Fs.get(T),R=x.snapshotVersion,O=x.withLastLimboFreeSnapshotVersion(R);A.Fs=A.Fs.insert(T,O)}}})(i.localStore,l))}async function bL(n,t){const e=ge(n);if(!e.currentUser.isEqual(t)){Yt(XE,"User change. New user:",t.toKey());const i=await S6(e.localStore,t);e.currentUser=t,(function(l,c){l.Vu.forEach((f=>{f.forEach((m=>{m.reject(new Gt(Et.CANCELLED,c))}))})),l.Vu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await C0(e,i.Bs)}}function CL(n,t){const e=ge(n),i=e.Eu.get(t);if(i&&i.lu)return je().add(i.key);{let s=je();const l=e.Tu.get(t);if(!l)return s;for(const c of l){const f=e.Pu.get(c);s=s.unionWith(f.view.tu)}return s}}function z6(n){const t=ge(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=k6.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=CL.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=AL.bind(null,t),t.hu.J_=oL.bind(null,t.eventManager),t.hu.pu=uL.bind(null,t.eventManager),t}function wL(n){const t=ge(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=EL.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=SL.bind(null,t),t}class c1{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=J1(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,e){return null}Fu(t,e){return null}vu(t){return DM(this.persistence,new RM,t.initialUser,this.serializer)}Du(t){return new E6(kE.Vi,this.serializer)}bu(t){return new VM}async terminate(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}c1.provider={build:()=>new c1};class RL extends c1{constructor(t){super(),this.cacheSizeBytes=t}Cu(t,e){un(this.persistence.referenceDelegate instanceof o1,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new fM(i,t.asyncQueue,e)}Du(t){const e=this.cacheSizeBytes!==void 0?Ga.withCacheSize(this.cacheSizeBytes):Ga.DEFAULT;return new E6((i=>o1.Vi(i,e)),this.serializer)}}class vA{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>vb(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=bL.bind(null,this.syncEngine),await aL(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new lL})()}createDatastore(t){const e=J1(t.databaseInfo.databaseId),i=(function(l){return new HM(l)})(t.databaseInfo);return(function(l,c,f,m){return new YM(l,c,f,m)})(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return(function(i,s,l,c,f){return new XM(i,s,l,c,f)})(this.localStore,this.datastore,t.asyncQueue,(e=>vb(this.syncEngine,e,0)),(function(){return db.C()?new db:new UM})())}createSyncEngine(t,e){return(function(s,l,c,f,m,g,A){const E=new dL(s,l,c,f,m,g);return A&&(E.fu=!0),E})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){var t,e;await(async function(s){const l=ge(s);Yt(Lf,"RemoteStore shutting down."),l.Ia.add(5),await b0(l),l.Ea.shutdown(),l.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(e=this.eventManager)===null||e===void 0||e.terminate()}}vA.provider={build:()=>new vA};class WE{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.xu(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.xu(this.observer.error,t):Lu("Uncaught Error in snapshot listener:",t.toString()))}Ou(){this.muted=!0}xu(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const fh="FirestoreClient";class xL{constructor(t,e,i,s,l){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=s,this.user=Ws.UNAUTHENTICATED,this.clientId=B1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Yt(fh,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Yt(fh,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new xu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=GE(e,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}async function _2(n,t){n.asyncQueue.verifyOperationInProgress(),Yt(fh,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await S6(t.localStore,s),i=s)})),t.persistence.setDatabaseDeletedListener((()=>{ku("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{Yt("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((s=>{ku("Terminating Firestore due to IndexedDb database deletion failed",s)}))})),n._offlineComponents=t}async function Eb(n,t){n.asyncQueue.verifyOperationInProgress();const e=await NL(n);Yt(fh,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((i=>pb(t.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>pb(t.remoteStore,s))),n._onlineComponents=t}async function NL(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Yt(fh,"Using user provided OfflineComponentProvider");try{await _2(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===Et.FAILED_PRECONDITION||s.code===Et.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;ku("Error using user provided cache. Falling back to memory cache: "+e),await _2(n,new c1)}}else Yt(fh,"Using default OfflineComponentProvider"),await _2(n,new RL(void 0));return n._offlineComponents}async function B6(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Yt(fh,"Using user provided OnlineComponentProvider"),await Eb(n,n._uninitializedComponentsProvider._online)):(Yt(fh,"Using default OnlineComponentProvider"),await Eb(n,new vA))),n._onlineComponents}function DL(n){return B6(n).then((t=>t.syncEngine))}async function h1(n){const t=await B6(n),e=t.eventManager;return e.onListen=mL.bind(null,t.syncEngine),e.onUnlisten=_L.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=pL.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=yL.bind(null,t.syncEngine),e}function IL(n,t,e={}){const i=new xu;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,f,m,g){const A=new WE({next:T=>{A.Ou(),c.enqueueAndForget((()=>FE(l,E)));const x=T.docs.has(f);!x&&T.fromCache?g.reject(new Gt(Et.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&T.fromCache&&m&&m.source==="server"?g.reject(new Gt(Et.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(T)},error:T=>g.reject(T)}),E=new QE(F1(f.path),A,{includeMetadataChanges:!0,ka:!0});return qE(l,E)})(await h1(n),n.asyncQueue,t,e,i))),i.promise}function OL(n,t,e={}){const i=new xu;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,f,m,g){const A=new WE({next:T=>{A.Ou(),c.enqueueAndForget((()=>FE(l,E))),T.fromCache&&m.source==="server"?g.reject(new Gt(Et.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(T)},error:T=>g.reject(T)}),E=new QE(f,A,{includeMetadataChanges:!0,ka:!0});return qE(l,E)})(await h1(n),n.asyncQueue,t,e,i))),i.promise}function j6(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const Sb=new Map;const H6="firestore.googleapis.com",Tb=!0;class bb{constructor(t){var e,i;if(t.host===void 0){if(t.ssl!==void 0)throw new Gt(Et.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=H6,this.ssl=Tb}else this.host=t.host,this.ssl=(e=t.ssl)!==null&&e!==void 0?e:Tb;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=A6;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<cM)throw new Gt(Et.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}M5("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j6((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new Gt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new Gt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new Gt(Et.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class w0{constructor(t,e,i,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Gt(Et.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new Gt(Et.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bb(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new I5;switch(i.type){case"firstParty":return new qI(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Gt(Et.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const i=Sb.get(e);i&&(Yt("ComponentProvider","Removing Datastore"),Sb.delete(e),i.terminate())})(this),Promise.resolve()}}function G6(n,t,e,i={}){var s;n=Zs(n,w0);const l=ph(t),c=n._getSettings(),f=Object.assign(Object.assign({},c),{emulatorOptions:n._getEmulatorOptions()}),m=`${t}:${e}`;l&&(oE(`https://${m}`),uE("Firestore",!0)),c.host!==H6&&c.host!==m&&ku("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const g=Object.assign(Object.assign({},c),{host:m,ssl:l,emulatorOptions:i});if(!ah(g,f)&&(n._setSettings(g),i.mockUserToken)){let A,E;if(typeof i.mockUserToken=="string")A=i.mockUserToken,E=Ws.MOCK_USER;else{A=kC(i.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const T=i.mockUserToken.sub||i.mockUserToken.user_id;if(!T)throw new Gt(Et.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");E=new Ws(T)}n._authCredentials=new jI(new D5(A,E))}}class Gu{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Gu(this.firestore,t,this._query)}}class ai{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nu(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new ai(this.firestore,t,this._key)}toJSON(){return{type:ai._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,i){if(E0(e,ai._jsonSchema))return new ai(t,i||null,new Zt(Tn.fromString(e.referencePath)))}}ai._jsonSchemaVersion="firestore/documentReference/1.0",ai._jsonSchema={type:Vi("string",ai._jsonSchemaVersion),referencePath:Vi("string")};class Nu extends Gu{constructor(t,e,i){super(t,e,F1(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new ai(this.firestore,null,new Zt(t))}withConverter(t){return new Nu(this.firestore,t,this._path)}}function Hm(n,t,...e){if(n=On(n),TE("collection","path",t),n instanceof w0){const i=Tn.fromString(t,...e);return VT(i),new Nu(n,null,i)}{if(!(n instanceof ai||n instanceof Nu))throw new Gt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Tn.fromString(t,...e));return VT(i),new Nu(n.firestore,null,i)}}function JE(n,t){if(n=Zs(n,w0),TE("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Gu(n,null,(function(i){return new Bm(Tn.emptyPath(),i)})(t))}function qu(n,t,...e){if(n=On(n),arguments.length===1&&(t=B1.newId()),TE("doc","path",t),n instanceof w0){const i=Tn.fromString(t,...e);return PT(i),new ai(n,null,new Zt(i))}{if(!(n instanceof ai||n instanceof Nu))throw new Gt(Et.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Tn.fromString(t,...e));return PT(i),new ai(n.firestore,n instanceof Nu?n.converter:null,new Zt(i))}}const Cb="AsyncQueue";class wb{constructor(t=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new b6(this,"async_queue_retry"),this.oc=()=>{const i=g2();i&&Yt(Cb,"Visibility state changed to "+i.visibilityState),this.F_.y_()},this._c=t;const e=g2();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.ac(),this.uc(t)}enterRestrictedMode(t){if(!this.Xu){this.Xu=!0,this.rc=t||!1;const e=g2();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.oc)}}enqueue(t){if(this.ac(),this.Xu)return new Promise((()=>{}));const e=new xu;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Zu.push(t),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(t){if(!zm(t))throw t;Yt(Cb,"Operation failed with retryable error: "+t)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(t){const e=this._c.then((()=>(this.nc=!0,t().catch((i=>{throw this.tc=i,this.nc=!1,Lu("INTERNAL UNHANDLED ERROR: ",Rb(i)),i})).then((i=>(this.nc=!1,i))))));return this._c=e,e}enqueueAfterDelay(t,e,i){this.ac(),this.sc.indexOf(t)>-1&&(e=0);const s=HE.createAndSchedule(this,t,e,i,(l=>this.lc(l)));return this.ec.push(s),s}ac(){this.tc&&oe(47125,{hc:Rb(this.tc)})}verifyOperationInProgress(){}async Pc(){let t;do t=this._c,await t;while(t!==this._c)}Tc(t){for(const e of this.ec)if(e.timerId===t)return!0;return!1}Ic(t){return this.Pc().then((()=>{this.ec.sort(((e,i)=>e.targetTimeMs-i.targetTimeMs));for(const e of this.ec)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Pc()}))}dc(t){this.sc.push(t)}lc(t){const e=this.ec.indexOf(t);this.ec.splice(e,1)}}function Rb(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}function xb(n){return(function(e,i){if(typeof e!="object"||e===null)return!1;const s=e;for(const l of i)if(l in s&&typeof s[l]=="function")return!0;return!1})(n,["next","error","complete"])}class Mo extends w0{constructor(t,e,i,s){super(t,e,i,s),this.type="firestore",this._queue=new wb,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new wb(t),this._firestoreClient=void 0,await t}}}function q6(n,t){const e=typeof n=="object"?n:fE(),i=typeof n=="string"?n:n1,s=P1(e,"firestore").getImmediate({identifier:i});if(!s._initialized){const l=OC("firestore");l&&G6(s,...l)}return s}function R0(n){if(n._terminated)throw new Gt(Et.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||ML(n),n._firestoreClient}function ML(n){var t,e,i;const s=n._freezeSettings(),l=(function(f,m,g,A){return new aO(f,m,g,A.host,A.ssl,A.experimentalForceLongPolling,A.experimentalAutoDetectLongPolling,j6(A.experimentalLongPollingOptions),A.useFetchStreams,A.isUsingEmulator)})(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((e=s.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((i=s.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new xL(n._authCredentials,n._appCheckCredentials,n._queue,l,n._componentsProvider&&(function(f){const m=f?._online.build();return{_offline:f?._offline.build(m),_online:m}})(n._componentsProvider))}class mr{constructor(t){this._byteString=t}static fromBase64String(t){try{return new mr(fs.fromBase64String(t))}catch(e){throw new Gt(Et.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new mr(fs.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:mr._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(E0(t,mr._jsonSchema))return mr.fromBase64String(t.bytes)}}mr._jsonSchemaVersion="firestore/bytes/1.0",mr._jsonSchema={type:Vi("string",mr._jsonSchemaVersion),bytes:Vi("string")};class x0{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new Gt(Et.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hs(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class N0{constructor(t){this._methodName=t}}class Ll{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Gt(Et.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Gt(Et.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return xe(this._lat,t._lat)||xe(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ll._jsonSchemaVersion}}static fromJSON(t){if(E0(t,Ll._jsonSchema))return new Ll(t.latitude,t.longitude)}}Ll._jsonSchemaVersion="firestore/geoPoint/1.0",Ll._jsonSchema={type:Vi("string",Ll._jsonSchemaVersion),latitude:Vi("number"),longitude:Vi("number")};class kl{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(i,s){if(i.length!==s.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==s[l])return!1;return!0})(this._values,t._values)}toJSON(){return{type:kl._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(E0(t,kl._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new kl(t.vectorValues);throw new Gt(Et.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}kl._jsonSchemaVersion="firestore/vectorValue/1.0",kl._jsonSchema={type:Vi("string",kl._jsonSchemaVersion),vectorValues:Vi("object")};const LL=/^__.*__$/;class kL{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new yh(t,this.data,this.fieldMask,e,this.fieldTransforms):new S0(t,this.data,e,this.fieldTransforms)}}class F6{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new yh(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function Y6(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw oe(40011,{Ec:n})}}class ZE{constructor(t,e,i,s,l,c){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=s,l===void 0&&this.Ac(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(t){return new ZE(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),s=this.Rc({path:i,mc:!1});return s.fc(t),s}gc(t){var e;const i=(e=this.path)===null||e===void 0?void 0:e.child(t),s=this.Rc({path:i,mc:!1});return s.Ac(),s}yc(t){return this.Rc({path:void 0,mc:!0})}wc(t){return f1(t,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Ac(){if(this.path)for(let t=0;t<this.path.length;t++)this.fc(this.path.get(t))}fc(t){if(t.length===0)throw this.wc("Document fields must not be empty");if(Y6(this.Ec)&&LL.test(t))throw this.wc('Document fields cannot begin and end with "__"')}}class PL{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||J1(t)}Dc(t,e,i,s=!1){return new ZE({Ec:t,methodName:e,bc:i,path:hs.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function tv(n){const t=n._freezeSettings(),e=J1(n._databaseId);return new PL(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Q6(n,t,e,i,s,l={}){const c=n.Dc(l.merge||l.mergeFields?2:0,t,e,s);tS("Data must be an object, but it was:",c,i);const f=X6(i,c);let m,g;if(l.merge)m=new gr(c.fieldMask),g=c.fieldTransforms;else if(l.mergeFields){const A=[];for(const E of l.mergeFields){const T=AA(t,E,e);if(!c.contains(T))throw new Gt(Et.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);W6(A,T)||A.push(T)}m=new gr(A),g=c.fieldTransforms.filter((E=>m.covers(E.field)))}else m=null,g=c.fieldTransforms;return new kL(new qa(f),m,g)}class ev extends N0{_toFieldTransform(t){if(t.Ec!==2)throw t.Ec===1?t.wc(`${this._methodName}() can only appear at the top level of your update data`):t.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof ev}}class $E extends N0{_toFieldTransform(t){return new IO(t.path,new t0)}isEqual(t){return t instanceof $E}}function VL(n,t,e,i){const s=n.Dc(1,t,e);tS("Data must be an object, but it was:",s,i);const l=[],c=qa.empty();_h(i,((m,g)=>{const A=eS(t,m,e);g=On(g);const E=s.gc(A);if(g instanceof ev)l.push(A);else{const T=D0(g,E);T!=null&&(l.push(A),c.set(A,T))}}));const f=new gr(l);return new F6(c,f,s.fieldTransforms)}function UL(n,t,e,i,s,l){const c=n.Dc(1,t,e),f=[AA(t,i,e)],m=[s];if(l.length%2!=0)throw new Gt(Et.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<l.length;T+=2)f.push(AA(t,l[T])),m.push(l[T+1]);const g=[],A=qa.empty();for(let T=f.length-1;T>=0;--T)if(!W6(g,f[T])){const x=f[T];let R=m[T];R=On(R);const O=c.gc(x);if(R instanceof ev)g.push(x);else{const M=D0(R,O);M!=null&&(g.push(x),A.set(x,M))}}const E=new gr(g);return new F6(A,E,c.fieldTransforms)}function zL(n,t,e,i=!1){return D0(e,n.Dc(i?4:3,t))}function D0(n,t){if(K6(n=On(n)))return tS("Unsupported field value:",t,n),X6(n,t);if(n instanceof N0)return(function(i,s){if(!Y6(s.Ec))throw s.wc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(s);l&&s.fieldTransforms.push(l)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.mc&&t.Ec!==4)throw t.wc("Nested arrays are not supported");return(function(i,s){const l=[];let c=0;for(const f of i){let m=D0(f,s.yc(c));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),c++}return{arrayValue:{values:l}}})(n,t)}return(function(i,s){if((i=On(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return xO(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=sn.fromDate(i);return{timestampValue:l1(s.serializer,l)}}if(i instanceof sn){const l=new sn(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:l1(s.serializer,l)}}if(i instanceof Ll)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof mr)return{bytesValue:d6(s.serializer,i._byteString)};if(i instanceof ai){const l=s.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw s.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:ME(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof kl)return(function(c,f){return{mapValue:{fields:{[H5]:{stringValue:G5},[i1]:{arrayValue:{values:c.toArray().map((g=>{if(typeof g!="number")throw f.wc("VectorValues must only contain numeric values.");return NE(f.serializer,g)}))}}}}}})(i,s);throw s.wc(`Unsupported field value: ${j1(i)}`)})(n,t)}function X6(n,t){const e={};return P5(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):_h(n,((i,s)=>{const l=D0(s,t.Vc(i));l!=null&&(e[i]=l)})),{mapValue:{fields:e}}}function K6(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof sn||n instanceof Ll||n instanceof mr||n instanceof ai||n instanceof N0||n instanceof kl)}function tS(n,t,e){if(!K6(e)||!L5(e)){const i=j1(e);throw i==="an object"?t.wc(n+" a custom object"):t.wc(n+" "+i)}}function AA(n,t,e){if((t=On(t))instanceof x0)return t._internalPath;if(typeof t=="string")return eS(n,t);throw f1("Field path arguments must be of type string or ",n,!1,void 0,e)}const BL=new RegExp("[~\\*/\\[\\]]");function eS(n,t,e){if(t.search(BL)>=0)throw f1(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new x0(...t.split("."))._internalPath}catch{throw f1(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function f1(n,t,e,i,s){const l=i&&!i.isEmpty(),c=s!==void 0;let f=`Function ${t}() called with invalid data`;e&&(f+=" (via `toFirestore()`)"),f+=". ";let m="";return(l||c)&&(m+=" (found",l&&(m+=` in field ${i}`),c&&(m+=` in document ${s}`),m+=")"),new Gt(Et.INVALID_ARGUMENT,f+n+m)}function W6(n,t){return n.some((e=>e.isEqual(t)))}class J6{constructor(t,e,i,s,l){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=s,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new ai(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new jL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(nS("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class jL extends J6{data(){return super.data()}}function nS(n,t){return typeof t=="string"?eS(n,t):t instanceof x0?t._internalPath:t._delegate._internalPath}function Z6(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Gt(Et.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class iS{}class $6 extends iS{}function d1(n,t,...e){let i=[];t instanceof iS&&i.push(t),i=i.concat(e),(function(l){const c=l.filter((m=>m instanceof nv)).length,f=l.filter((m=>m instanceof I0)).length;if(c>1||c>0&&f>0)throw new Gt(Et.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class I0 extends $6{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new I0(t,e,i)}_apply(t){const e=this._parse(t);return t9(t._query,e),new Gu(t.firestore,t.converter,uA(t._query,e))}_parse(t){const e=tv(t.firestore);return(function(l,c,f,m,g,A,E){let T;if(g.isKeyField()){if(A==="array-contains"||A==="array-contains-any")throw new Gt(Et.INVALID_ARGUMENT,`Invalid Query. You can't perform '${A}' queries on documentId().`);if(A==="in"||A==="not-in"){Db(E,A);const R=[];for(const O of E)R.push(Nb(m,l,O));T={arrayValue:{values:R}}}else T=Nb(m,l,E)}else A!=="in"&&A!=="not-in"&&A!=="array-contains-any"||Db(E,A),T=zL(f,c,E,A==="in"||A==="not-in");return Pi.create(g,A,T)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}function i0(n,t,e){const i=t,s=nS("where",n);return I0._create(s,i,e)}class nv extends iS{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new nv(t,e)}_parse(t){const e=this._queryConstraints.map((i=>i._parse(t))).filter((i=>i.getFilters().length>0));return e.length===1?e[0]:zl.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(s,l){let c=s;const f=l.getFlattenedFilters();for(const m of f)t9(c,m),c=uA(c,m)})(t._query,e),new Gu(t.firestore,t.converter,uA(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Nb(n,t,e){if(typeof(e=On(e))=="string"){if(e==="")throw new Gt(Et.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!J5(t)&&e.indexOf("/")!==-1)throw new Gt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(Tn.fromString(e));if(!Zt.isDocumentKey(i))throw new Gt(Et.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return FT(n,new Zt(i))}if(e instanceof ai)return FT(n,e._key);throw new Gt(Et.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${j1(e)}.`)}function Db(n,t){if(!Array.isArray(n)||n.length===0)throw new Gt(Et.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function t9(n,t){const e=(function(s,l){for(const c of s)for(const f of c.getFlattenedFilters())if(l.indexOf(f.op)>=0)return f.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new Gt(Et.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Gt(Et.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class e9{convertValue(t,e="none"){switch(ch(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Si(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(uh(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw oe(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return _h(t,((s,l)=>{i[s]=this.convertValue(l,e)})),i}convertVectorValue(t){var e,i,s;const l=(s=(i=(e=t.fields)===null||e===void 0?void 0:e[i1].arrayValue)===null||i===void 0?void 0:i.values)===null||s===void 0?void 0:s.map((c=>Si(c.doubleValue)));return new kl(l)}convertGeoPoint(t){return new Ll(Si(t.latitude),Si(t.longitude))}convertArray(t,e){return(t.values||[]).map((i=>this.convertValue(i,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const i=q1(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Zg(t));default:return null}}convertTimestamp(t){const e=oh(t);return new sn(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=Tn.fromString(t);un(v6(i),9688,{name:t});const s=new _m(i.get(1),i.get(3)),l=new Zt(i.popFirst(5));return s.isEqual(e)||Lu(`Document ${l} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),l}}function n9(n,t,e){let i;return i=n?n.toFirestore(t):t,i}class im{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class nh extends J6{constructor(t,e,i,s,l,c){super(t,e,i,s,c),this._firestore=t,this._firestoreImpl=t,this.metadata=l}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Vg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(nS("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Gt(Et.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=nh._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}nh._jsonSchemaVersion="firestore/documentSnapshot/1.0",nh._jsonSchema={type:Vi("string",nh._jsonSchemaVersion),bundleSource:Vi("string","DocumentSnapshot"),bundleName:Vi("string"),bundle:Vi("string")};class Vg extends nh{data(t={}){return super.data(t)}}class ih{constructor(t,e,i,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new im(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((i=>{t.call(e,new Vg(this._firestore,this._userDataWriter,i.key,i,new im(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Gt(Et.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,l){if(s._snapshot.oldDocs.isEmpty()){let c=0;return s._snapshot.docChanges.map((f=>{const m=new Vg(s._firestore,s._userDataWriter,f.doc.key,f.doc,new im(s._snapshot.mutatedKeys.has(f.doc.key),s._snapshot.fromCache),s.query.converter);return f.doc,{type:"added",doc:m,oldIndex:-1,newIndex:c++}}))}{let c=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((f=>l||f.type!==3)).map((f=>{const m=new Vg(s._firestore,s._userDataWriter,f.doc.key,f.doc,new im(s._snapshot.mutatedKeys.has(f.doc.key),s._snapshot.fromCache),s.query.converter);let g=-1,A=-1;return f.type!==0&&(g=c.indexOf(f.doc.key),c=c.delete(f.doc.key)),f.type!==1&&(c=c.add(f.doc),A=c.indexOf(f.doc.key)),{type:HL(f.type),doc:m,oldIndex:g,newIndex:A}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Gt(Et.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=ih._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=B1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],i=[],s=[];return this.docs.forEach((l=>{l._document!==null&&(e.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),s.push(l.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function HL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return oe(61501,{type:n})}}function iv(n){n=Zs(n,ai);const t=Zs(n.firestore,Mo);return IL(R0(t),n._key).then((e=>i9(t,n,e)))}ih._jsonSchemaVersion="firestore/querySnapshot/1.0",ih._jsonSchema={type:Vi("string",ih._jsonSchemaVersion),bundleSource:Vi("string","QuerySnapshot"),bundleName:Vi("string"),bundle:Vi("string")};class sS extends e9{constructor(t){super(),this.firestore=t}convertBytes(t){return new mr(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new ai(this.firestore,null,e)}}function aS(n){n=Zs(n,Gu);const t=Zs(n.firestore,Mo),e=R0(t),i=new sS(t);return Z6(n._query),OL(e,n._query).then((s=>new ih(t,i,n,s)))}function O0(n,t,e){n=Zs(n,ai);const i=Zs(n.firestore,Mo),s=n9(n.converter,t);return L0(i,[Q6(tv(i),"setDoc",n._key,s,n.converter!==null,e).toMutation(n._key,il.none())])}function vh(n,t,e,...i){n=Zs(n,ai);const s=Zs(n.firestore,Mo),l=tv(s);let c;return c=typeof(t=On(t))=="string"||t instanceof x0?UL(l,"updateDoc",n._key,t,e,i):VL(l,"updateDoc",n._key,t),L0(s,[c.toMutation(n._key,il.exists(!0))])}function sv(n){return L0(Zs(n.firestore,Mo),[new DE(n._key,il.none())])}function M0(n,t){const e=Zs(n.firestore,Mo),i=qu(n),s=n9(n.converter,t);return L0(e,[Q6(tv(n.firestore),"addDoc",i._key,s,n.converter!==null,{}).toMutation(i._key,il.exists(!1))]).then((()=>i))}function s0(n,...t){var e,i,s;n=On(n);let l={includeMetadataChanges:!1,source:"default"},c=0;typeof t[c]!="object"||xb(t[c])||(l=t[c++]);const f={includeMetadataChanges:l.includeMetadataChanges,source:l.source};if(xb(t[c])){const E=t[c];t[c]=(e=E.next)===null||e===void 0?void 0:e.bind(E),t[c+1]=(i=E.error)===null||i===void 0?void 0:i.bind(E),t[c+2]=(s=E.complete)===null||s===void 0?void 0:s.bind(E)}let m,g,A;if(n instanceof ai)g=Zs(n.firestore,Mo),A=F1(n._key.path),m={next:E=>{t[c]&&t[c](i9(g,n,E))},error:t[c+1],complete:t[c+2]};else{const E=Zs(n,Gu);g=Zs(E.firestore,Mo),A=E._query;const T=new sS(g);m={next:x=>{t[c]&&t[c](new ih(g,T,E,x))},error:t[c+1],complete:t[c+2]},Z6(n._query)}return(function(T,x,R,O){const M=new WE(O),H=new QE(x,M,R);return T.asyncQueue.enqueueAndForget((async()=>qE(await h1(T),H))),()=>{M.Ou(),T.asyncQueue.enqueueAndForget((async()=>FE(await h1(T),H)))}})(R0(g),A,f,m)}function L0(n,t){return(function(i,s){const l=new xu;return i.asyncQueue.enqueueAndForget((async()=>vL(await DL(i),s,l))),l.promise})(R0(n),t)}function i9(n,t,e){const i=e.docs.get(t._key),s=new sS(n);return new nh(n,s,t._key,i,new im(e.hasPendingWrites,e.fromCache),t.converter)}function Ui(){return new $E("serverTimestamp")}(function(t,e=!0){(function(s){Vm=s})(Bf),Df(new rh("firestore",((i,{instanceIdentifier:s,options:l})=>{const c=i.getProvider("app").getImmediate(),f=new Mo(new HI(i.getProvider("auth-internal")),new FI(c,i.getProvider("app-check-internal")),(function(g,A){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new Gt(Et.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _m(g.options.projectId,A)})(c,s),c);return l=Object.assign({useFetchStreams:e},l),f._setSettings(l),f}),"PUBLIC").setMultipleInstances(!0)),Ro(IT,OT,t),Ro(IT,OT,"esm2017")})();const s9=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:e9,Bytes:mr,CollectionReference:Nu,DocumentReference:ai,DocumentSnapshot:nh,FieldPath:x0,FieldValue:N0,Firestore:Mo,FirestoreError:Gt,GeoPoint:Ll,Query:Gu,QueryCompositeFilterConstraint:nv,QueryConstraint:$6,QueryDocumentSnapshot:Vg,QueryFieldFilterConstraint:I0,QuerySnapshot:ih,SnapshotMetadata:im,Timestamp:sn,VectorValue:kl,_AutoId:B1,_ByteString:fs,_DatabaseId:_m,_DocumentKey:Zt,_EmptyAuthCredentialsProvider:I5,_FieldPath:hs,_cast:Zs,_logWarn:ku,_validateIsNotUsedTogether:M5,addDoc:M0,collection:Hm,collectionGroup:JE,connectFirestoreEmulator:G6,deleteDoc:sv,doc:qu,ensureFirestoreConfigured:R0,executeWrite:L0,getDoc:iv,getDocs:aS,getFirestore:q6,onSnapshot:s0,query:d1,serverTimestamp:Ui,setDoc:O0,updateDoc:vh,where:i0},Symbol.toStringTag,{value:"Module"}));var Ib={};const Ob="@firebase/database",Mb="1.0.20";let a9="";function GL(n){a9=n}class qL{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){e==null?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),cs(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return e==null?null:Xg(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class FL{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){e==null?delete this.cache_[t]:this.cache_[t]=e}get(t){return ko(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const r9=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const t=window[n];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new qL(t)}}catch{}return new FL},Rf=r9("localStorage"),YL=r9("sessionStorage");const cm=new k1("@firebase/database"),QL=(function(){let n=1;return function(){return n++}})(),l9=function(n){const t=dx(n),e=new ux;e.update(t);const i=e.digest();return lE.encodeByteArray(i)},k0=function(...n){let t="";for(let e=0;e<n.length;e++){const i=n[e];Array.isArray(i)||i&&typeof i=="object"&&typeof i.length=="number"?t+=k0.apply(null,i):typeof i=="object"?t+=cs(i):t+=i,t+=" "}return t};let Ug=null,Lb=!0;const XL=function(n,t){zt(!0,"Can't turn on custom loggers persistently."),cm.logLevel=Ue.VERBOSE,Ug=cm.log.bind(cm)},Os=function(...n){if(Lb===!0&&(Lb=!1,Ug===null&&YL.get("logging_enabled")===!0&&XL()),Ug){const t=k0.apply(null,n);Ug(t)}},P0=function(n){return function(...t){Os(n,...t)}},EA=function(...n){const t="FIREBASE INTERNAL ERROR: "+k0(...n);cm.error(t)},Vu=function(...n){const t=`FIREBASE FATAL ERROR: ${k0(...n)}`;throw cm.error(t),new Error(t)},Qa=function(...n){const t="FIREBASE WARNING: "+k0(...n);cm.warn(t)},KL=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Qa("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},av=function(n){return typeof n=="number"&&(n!==n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},WL=function(n){if(document.readyState==="complete")n();else{let t=!1;const e=function(){if(!document.body){setTimeout(e,Math.floor(10));return}t||(t=!0,n())};document.addEventListener?(document.addEventListener("DOMContentLoaded",e,!1),window.addEventListener("load",e,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&e()}),window.attachEvent("onload",e))}},Sm="[MIN_NAME]",kf="[MAX_NAME]",qf=function(n,t){if(n===t)return 0;if(n===Sm||t===kf)return-1;if(t===Sm||n===kf)return 1;{const e=kb(n),i=kb(t);return e!==null?i!==null?e-i===0?n.length-t.length:e-i:-1:i!==null?1:n<t?-1:1}},JL=function(n,t){return n===t?0:n<t?-1:1},og=function(n,t){if(t&&n in t)return t[n];throw new Error("Missing required key ("+n+") in object: "+cs(t))},rS=function(n){if(typeof n!="object"||n===null)return cs(n);const t=[];for(const i in n)t.push(i);t.sort();let e="{";for(let i=0;i<t.length;i++)i!==0&&(e+=","),e+=cs(t[i]),e+=":",e+=rS(n[t[i]]);return e+="}",e},o9=function(n,t){const e=n.length;if(e<=t)return[n];const i=[];for(let s=0;s<e;s+=t)s+t>e?i.push(n.substring(s,e)):i.push(n.substring(s,s+t));return i};function ta(n,t){for(const e in n)n.hasOwnProperty(e)&&t(e,n[e])}const u9=function(n){zt(!av(n),"Invalid JSON number");const t=11,e=52,i=(1<<t-1)-1;let s,l,c,f,m;n===0?(l=0,c=0,s=1/n===-1/0?1:0):(s=n<0,n=Math.abs(n),n>=Math.pow(2,1-i)?(f=Math.min(Math.floor(Math.log(n)/Math.LN2),i),l=f+i,c=Math.round(n*Math.pow(2,e-f)-Math.pow(2,e))):(l=0,c=Math.round(n/Math.pow(2,1-i-e))));const g=[];for(m=e;m;m-=1)g.push(c%2?1:0),c=Math.floor(c/2);for(m=t;m;m-=1)g.push(l%2?1:0),l=Math.floor(l/2);g.push(s?1:0),g.reverse();const A=g.join("");let E="";for(m=0;m<64;m+=8){let T=parseInt(A.substr(m,8),2).toString(16);T.length===1&&(T="0"+T),E=E+T}return E.toLowerCase()},ZL=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},$L=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function tk(n,t){let e="Unknown Error";n==="too_big"?e="The data requested exceeds the maximum size that can be accessed with a single request.":n==="permission_denied"?e="Client doesn't have permission to access the desired data.":n==="unavailable"&&(e="The service is unavailable");const i=new Error(n+" at "+t._path.toString()+": "+e);return i.code=n.toUpperCase(),i}const ek=new RegExp("^-?(0*)\\d{1,10}$"),nk=-2147483648,ik=2147483647,kb=function(n){if(ek.test(n)){const t=Number(n);if(t>=nk&&t<=ik)return t}return null},Gm=function(n){try{n()}catch(t){setTimeout(()=>{const e=t.stack||"";throw Qa("Exception was thrown by user callback.",e),t},Math.floor(0))}},sk=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},zg=function(n,t){const e=setTimeout(n,t);return typeof e=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(e):typeof e=="object"&&e.unref&&e.unref(),e};class ak{constructor(t,e){this.appCheckProvider=e,this.appName=t.name,dr(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.appCheck=e?.getImmediate({optional:!0}),this.appCheck||e?.get().then(i=>this.appCheck=i)}getToken(t){if(this.serverAppAppCheckToken){if(t)throw new Error("Attempted reuse of `FirebaseServerApp.appCheckToken` after previous usage failed.");return Promise.resolve({token:this.serverAppAppCheckToken})}return this.appCheck?this.appCheck.getToken(t):new Promise((e,i)=>{setTimeout(()=>{this.appCheck?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){var e;(e=this.appCheckProvider)===null||e===void 0||e.get().then(i=>i.addTokenListener(t))}notifyForInvalidToken(){Qa(`Provided AppCheck credentials for the app named "${this.appName}" are invalid. This usually indicates your app was not initialized correctly.`)}}class rk{constructor(t,e,i){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=i,this.auth_=null,this.auth_=i.getImmediate({optional:!0}),this.auth_||i.onInit(s=>this.auth_=s)}getToken(t){return this.auth_?this.auth_.getToken(t).catch(e=>e&&e.code==="auth/token-not-initialized"?(Os("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((e,i)=>{setTimeout(()=>{this.auth_?this.getToken(t).then(e,i):e(null)},0)})}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then(e=>e.addAuthTokenListener(t))}removeTokenChangeListener(t){this.authProvider_.get().then(e=>e.removeAuthTokenListener(t))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Qa(t)}}class By{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}By.OWNER="owner";const lS="5",c9="v",h9="s",f9="r",d9="f",m9=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,p9="ls",g9="p",SA="ac",_9="websocket",y9="long_polling";class v9{constructor(t,e,i,s,l=!1,c="",f=!1,m=!1,g=null){this.secure=e,this.namespace=i,this.webSocketOnly=s,this.nodeAdmin=l,this.persistenceKey=c,this.includeNamespaceInQueryParams=f,this.isUsingEmulator=m,this.emulatorOptions=g,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Rf.get("host:"+t)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Rf.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function lk(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams}function A9(n,t,e){zt(typeof t=="string","typeof type must == string"),zt(typeof e=="object","typeof params must == object");let i;if(t===_9)i=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else if(t===y9)i=(n.secure?"https://":"http://")+n.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+t);lk(n)&&(e.ns=n.namespace);const s=[];return ta(e,(l,c)=>{s.push(l+"="+c)}),i+s.join("&")}class ok{constructor(){this.counters_={}}incrementCounter(t,e=1){ko(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return H7(this.counters_)}}const y2={},v2={};function oS(n){const t=n.toString();return y2[t]||(y2[t]=new ok),y2[t]}function uk(n,t){const e=n.toString();return v2[e]||(v2[e]=t()),v2[e]}class ck{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const i=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let s=0;s<i.length;++s)i[s]&&Gm(()=>{this.onMessage_(i[s])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Pb="start",hk="close",fk="pLPCommand",dk="pRTLPCB",E9="id",S9="pw",T9="ser",mk="cb",pk="seg",gk="ts",_k="d",yk="dframe",b9=1870,C9=30,vk=b9-C9,Ak=25e3,Ek=3e4;class sm{constructor(t,e,i,s,l,c,f){this.connId=t,this.repoInfo=e,this.applicationId=i,this.appCheckToken=s,this.authToken=l,this.transportSessionId=c,this.lastSessionId=f,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=P0(t),this.stats_=oS(e),this.urlFn=m=>(this.appCheckToken&&(m[SA]=this.appCheckToken),A9(e,y9,m))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new ck(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(Ek)),WL(()=>{if(this.isClosed_)return;this.scriptTagHolder=new uS((...l)=>{const[c,f,m,g,A]=l;if(this.incrementIncomingBytes_(l),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,c===Pb)this.id=f,this.password=m;else if(c===hk)f?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(f,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+c)},(...l)=>{const[c,f]=l;this.incrementIncomingBytes_(l),this.myPacketOrderer.handleResponse(c,f)},()=>{this.onClosed_()},this.urlFn);const i={};i[Pb]="t",i[T9]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(i[mk]=this.scriptTagHolder.uniqueCallbackIdentifier),i[c9]=lS,this.transportSessionId&&(i[h9]=this.transportSessionId),this.lastSessionId&&(i[p9]=this.lastSessionId),this.applicationId&&(i[g9]=this.applicationId),this.appCheckToken&&(i[SA]=this.appCheckToken),typeof location<"u"&&location.hostname&&m9.test(location.hostname)&&(i[f9]=d9);const s=this.urlFn(i);this.log_("Connecting via long-poll to "+s),this.scriptTagHolder.addTag(s,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){sm.forceAllow_=!0}static forceDisallow(){sm.forceDisallow_=!0}static isAvailable(){return sm.forceAllow_?!0:!sm.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!ZL()&&!$L()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=cs(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=NC(e),s=o9(i,vk);for(let l=0;l<s.length;l++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,s.length,s[l]),this.curSegmentNum++}addDisconnectPingFrame(t,e){this.myDisconnFrame=document.createElement("iframe");const i={};i[yk]="t",i[E9]=t,i[S9]=e,this.myDisconnFrame.src=this.urlFn(i),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=cs(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class uS{constructor(t,e,i,s){this.onDisconnect=i,this.urlFn=s,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=QL(),window[fk+this.uniqueCallbackIdentifier]=t,window[dk+this.uniqueCallbackIdentifier]=e,this.myIFrame=uS.createIFrame_();let l="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(l='<script>document.domain="'+document.domain+'";<\/script>');const c="<html><body>"+l+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(c),this.myIFrame.doc.close()}catch(f){Os("frame writing exception"),f.stack&&Os(f.stack),Os(f)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",document.body){document.body.appendChild(t);try{t.contentWindow.document||Os("No IE domain setting required")}catch{const i=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+i+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t[E9]=this.myID,t[S9]=this.myPW,t[T9]=this.currentSerial;let e=this.urlFn(t),i="",s=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+C9+i.length<=b9;){const c=this.pendingSegs.shift();i=i+"&"+pk+s+"="+c.seg+"&"+gk+s+"="+c.ts+"&"+_k+s+"="+c.d,s++}return e=e+i,this.addLongPollTag_(e,this.currentSerial),!0}else return!1}enqueueSegment(t,e,i){this.pendingSegs.push({seg:t,ts:e,d:i}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const i=()=>{this.outstandingRequests.delete(e),this.newRequest_()},s=setTimeout(i,Math.floor(Ak)),l=()=>{clearTimeout(s),i()};this.addTag(t,l)}addTag(t,e){setTimeout(()=>{try{if(!this.sendNewPolls)return;const i=this.myIFrame.doc.createElement("script");i.type="text/javascript",i.async=!0,i.src=t,i.onload=i.onreadystatechange=function(){const s=i.readyState;(!s||s==="loaded"||s==="complete")&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),e())},i.onerror=()=>{Os("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(i)}catch{}},Math.floor(1))}}const Sk=16384,Tk=45e3;let m1=null;typeof MozWebSocket<"u"?m1=MozWebSocket:typeof WebSocket<"u"&&(m1=WebSocket);class Il{constructor(t,e,i,s,l,c,f){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=P0(this.connId),this.stats_=oS(e),this.connURL=Il.connectionURL_(e,c,f,s,i),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,i,s,l){const c={};return c[c9]=lS,typeof location<"u"&&location.hostname&&m9.test(location.hostname)&&(c[f9]=d9),e&&(c[h9]=e),i&&(c[p9]=i),s&&(c[SA]=s),l&&(c[g9]=l),A9(t,_9,c)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Rf.set("previous_websocket_failure",!0);try{let i;tx(),this.mySock=new m1(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){Il.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(e);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&m1!==null&&!Il.forceDisallow_}static previouslyFailed(){return Rf.isInMemoryStorage||Rf.get("previous_websocket_failure")===!0}markConnectionHealthy(){Rf.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const i=Xg(e);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(zt(this.frames===null,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(this.mySock===null)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(e);else{const i=this.extractFrameCount_(e);i!==null&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const e=cs(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const i=o9(e,Sk);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(Tk))}sendString_(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Il.responsesRequiredToBeHealthy=2;Il.healthyTimeout=3e4;class a0{static get ALL_TRANSPORTS(){return[sm,Il]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const e=Il&&Il.isAvailable();let i=e&&!Il.previouslyFailed();if(t.webSocketOnly&&(e||Qa("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Il];else{const s=this.transports_=[];for(const l of a0.ALL_TRANSPORTS)l&&l.isAvailable()&&s.push(l);a0.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}a0.globalTransportInitialized_=!1;const bk=6e4,Ck=5e3,wk=10*1024,Rk=100*1024,A2="t",Vb="d",xk="s",Ub="r",Nk="e",zb="o",Bb="a",jb="n",Hb="p",Dk="h";class Ik{constructor(t,e,i,s,l,c,f,m,g,A){this.id=t,this.repoInfo_=e,this.applicationId_=i,this.appCheckToken_=s,this.authToken_=l,this.onMessage_=c,this.onReady_=f,this.onDisconnect_=m,this.onKill_=g,this.lastSessionId=A,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=P0("c:"+this.id+":"),this.transportManager_=new a0(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),i=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(e,i)},Math.floor(0));const s=t.healthyTimeout||0;s>0&&(this.healthyTimeout_=zg(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Rk?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>wk?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(s)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{this.state_!==2&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if(A2 in t){const e=t[A2];e===Bb?this.upgradeIfSecondaryHealthy_():e===Ub?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):e===zb&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=og("t",t),i=og("d",t);if(e==="c")this.onSecondaryControl_(i);else if(e==="d")this.pendingDataMessages.push(i);else throw new Error("Unknown protocol layer: "+e)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Hb,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Bb,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:jb,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=og("t",t),i=og("d",t);e==="c"?this.onControl_(i):e==="d"&&this.onDataMessage_(i)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=og(A2,t);if(Vb in t){const i=t[Vb];if(e===Dk){const s=Object.assign({},i);this.repoInfo_.isUsingEmulator&&(s.h=this.repoInfo_.host),this.onHandshake_(s)}else if(e===jb){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let s=0;s<this.pendingDataMessages.length;++s)this.onDataMessage_(this.pendingDataMessages[s]);this.pendingDataMessages=[],this.tryCleanupConnection()}else e===xk?this.onConnectionShutdown_(i):e===Ub?this.onReset_(i):e===Nk?EA("Server Error: "+i):e===zb?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):EA("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,i=t.v,s=t.h;this.sessionId=t.s,this.repoInfo_.host=s,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),lS!==i&&Qa("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),i=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,i),zg(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(bk))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):zg(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Ck))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Hb,d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===t||this.rx_===t)&&this.close()}onConnectionLost_(t){this.conn_=null,!t&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Rf.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(t)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class w9{put(t,e,i,s){}merge(t,e,i,s){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,i){}onDisconnectMerge(t,e,i){}onDisconnectCancel(t,e){}reportStats(t){}}class R9{constructor(t){this.allowedEvents_=t,this.listeners_={},zt(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const i=[...this.listeners_[t]];for(let s=0;s<i.length;s++)i[s].callback.apply(i[s].context,e)}}on(t,e,i){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:i});const s=this.getInitialEvent(t);s&&e.apply(i,s)}off(t,e,i){this.validateEventType_(t);const s=this.listeners_[t]||[];for(let l=0;l<s.length;l++)if(s[l].callback===e&&(!i||i===s[l].context)){s.splice(l,1);return}}validateEventType_(t){zt(this.allowedEvents_.find(e=>e===t),"Unknown event: "+t)}}class p1 extends R9{static getInstance(){return new p1}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!cE()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(t){return zt(t==="online","Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}const Gb=32,qb=768;let cn=class{constructor(t,e){if(e===void 0){this.pieces_=t.split("/");let i=0;for(let s=0;s<this.pieces_.length;s++)this.pieces_[s].length>0&&(this.pieces_[i]=this.pieces_[s],i++);this.pieces_.length=i,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)this.pieces_[e]!==""&&(t+="/"+this.pieces_[e]);return t||"/"}};function an(){return new cn("")}function Ne(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function dh(n){return n.pieces_.length-n.pieceNum_}function Sn(n){let t=n.pieceNum_;return t<n.pieces_.length&&t++,new cn(n.pieces_,t)}function cS(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function Ok(n){let t="";for(let e=n.pieceNum_;e<n.pieces_.length;e++)n.pieces_[e]!==""&&(t+="/"+encodeURIComponent(String(n.pieces_[e])));return t||"/"}function r0(n,t=0){return n.pieces_.slice(n.pieceNum_+t)}function x9(n){if(n.pieceNum_>=n.pieces_.length)return null;const t=[];for(let e=n.pieceNum_;e<n.pieces_.length-1;e++)t.push(n.pieces_[e]);return new cn(t,0)}function Ti(n,t){const e=[];for(let i=n.pieceNum_;i<n.pieces_.length;i++)e.push(n.pieces_[i]);if(t instanceof cn)for(let i=t.pieceNum_;i<t.pieces_.length;i++)e.push(t.pieces_[i]);else{const i=t.split("/");for(let s=0;s<i.length;s++)i[s].length>0&&e.push(i[s])}return new cn(e,0)}function Me(n){return n.pieceNum_>=n.pieces_.length}function Fa(n,t){const e=Ne(n),i=Ne(t);if(e===null)return t;if(e===i)return Fa(Sn(n),Sn(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+n+")")}function Mk(n,t){const e=r0(n,0),i=r0(t,0);for(let s=0;s<e.length&&s<i.length;s++){const l=qf(e[s],i[s]);if(l!==0)return l}return e.length===i.length?0:e.length<i.length?-1:1}function hS(n,t){if(dh(n)!==dh(t))return!1;for(let e=n.pieceNum_,i=t.pieceNum_;e<=n.pieces_.length;e++,i++)if(n.pieces_[e]!==t.pieces_[i])return!1;return!0}function nl(n,t){let e=n.pieceNum_,i=t.pieceNum_;if(dh(n)>dh(t))return!1;for(;e<n.pieces_.length;){if(n.pieces_[e]!==t.pieces_[i])return!1;++e,++i}return!0}class Lk{constructor(t,e){this.errorPrefix_=e,this.parts_=r0(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let i=0;i<this.parts_.length;i++)this.byteLength_+=L1(this.parts_[i]);N9(this)}}function kk(n,t){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(t),n.byteLength_+=L1(t),N9(n)}function Pk(n){const t=n.parts_.pop();n.byteLength_-=L1(t),n.parts_.length>0&&(n.byteLength_-=1)}function N9(n){if(n.byteLength_>qb)throw new Error(n.errorPrefix_+"has a key path longer than "+qb+" bytes ("+n.byteLength_+").");if(n.parts_.length>Gb)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Gb+") or object contains a cycle "+Cf(n))}function Cf(n){return n.parts_.length===0?"":"in property '"+n.parts_.join(".")+"'"}class fS extends R9{static getInstance(){return new fS}constructor(){super(["visible"]);let t,e;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(e="visibilitychange",t="hidden"):typeof document.mozHidden<"u"?(e="mozvisibilitychange",t="mozHidden"):typeof document.msHidden<"u"?(e="msvisibilitychange",t="msHidden"):typeof document.webkitHidden<"u"&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,()=>{const i=!document[t];i!==this.visible_&&(this.visible_=i,this.trigger("visible",i))},!1)}getInitialEvent(t){return zt(t==="visible","Unknown event type: "+t),[this.visible_]}}const ug=1e3,Vk=300*1e3,Fb=30*1e3,Uk=1.3,zk=3e4,Bk="server_kill",Yb=3;class Du extends w9{constructor(t,e,i,s,l,c,f,m){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=l,this.authTokenProvider_=c,this.appCheckTokenProvider_=f,this.authOverride_=m,this.id=Du.nextPersistentConnectionId_++,this.log_=P0("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ug,this.maxReconnectDelay_=Vk,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,m)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");fS.getInstance().on("visible",this.onVisible_,this),t.host.indexOf("fblocal")===-1&&p1.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,i){const s=++this.requestNumber_,l={r:s,a:t,b:e};this.log_(cs(l)),zt(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const e=new Su,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:c=>{const f=c.d;c.s==="ok"?e.resolve(f):e.reject(f)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;const l=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(l),e.promise}listen(t,e,i,s){this.initConnection_();const l=t._queryIdentifier,c=t._path.toString();this.log_("Listen called for "+c+" "+l),this.listens.has(c)||this.listens.set(c,new Map),zt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),zt(!this.listens.get(c).has(l),"listen() called twice for same path/queryId.");const f={onComplete:s,hashFn:e,query:t,tag:i};this.listens.get(c).set(l,f),this.connected_&&this.sendListen_(f)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(i)})}sendListen_(t){const e=t.query,i=e._path.toString(),s=e._queryIdentifier;this.log_("Listen on "+i+" for "+s);const l={p:i},c="q";t.tag&&(l.q=e._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest(c,l,f=>{const m=f.d,g=f.s;Du.warnOnListenWarnings_(m,e),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",f),g!=="ok"&&this.removeListen_(i,s),t.onComplete&&t.onComplete(g,m))})}static warnOnListenWarnings_(t,e){if(t&&typeof t=="object"&&ko(t,"w")){const i=dm(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+e._queryParams.getIndex().toString()+'"',l=e._path.toString();Qa(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&t.length===40||ox(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Fb)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=lx(t)?"auth":"gauth",i={cred:t};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(e,i,s=>{const l=s.s,c=s.d||"error";this.authToken_===t&&(l==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,c))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const e=t.s,i=t.d||"error";e==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,i)})}unlisten(t,e){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),zt(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,e)}sendUnlisten_(t,e,i,s){this.log_("Unlisten on "+t+" for "+e);const l={p:t},c="n";s&&(l.q=i,l.t=s),this.sendRequest(c,l)}onDisconnectPut(t,e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:i})}onDisconnectMerge(t,e,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:i})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,i,s){const l={p:e,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,c=>{s&&setTimeout(()=>{s(c.s,c.d)},Math.floor(0))})}put(t,e,i,s){this.putInternal("p",t,e,i,s)}merge(t,e,i,s){this.putInternal("m",t,e,i,s)}putInternal(t,e,i,s,l){this.initConnection_();const c={p:e,d:i};l!==void 0&&(c.h=l),this.outstandingPuts_.push({action:t,request:c,onComplete:s}),this.outstandingPutCount_++;const f=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(f):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,i,l=>{this.log_(e+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(l.s,l.d)})}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,i=>{if(i.s!=="ok"){const l=i.d;this.log_("reportStats","Error sending stats: "+l)}})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+cs(t));const e=t.r,i=this.requestCBHash_[e];i&&(delete this.requestCBHash_[e],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),t==="d"?this.onDataUpdate_(e.p,e.d,!1,e.t):t==="m"?this.onDataUpdate_(e.p,e.d,!0,e.t):t==="c"?this.onListenRevoked_(e.p,e.q):t==="ac"?this.onAuthRevoked_(e.s,e.d):t==="apc"?this.onAppCheckRevoked_(e.s,e.d):t==="sd"?this.onSecurityDebugPacket_(e):EA("Unrecognized action received from server: "+cs(t)+`
Are you using the latest client?`)}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){zt(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ug,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ug,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>zk&&(this.reconnectDelay_=ug),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const t=Math.max(0,new Date().getTime()-this.lastConnectionAttemptTime_);let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*Uk)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+Du.nextConnectionId_++,l=this.lastSessionId;let c=!1,f=null;const m=function(){f?f.close():(c=!0,i())},g=function(E){zt(f,"sendRequest call when we're not connected not allowed."),f.sendRequest(E)};this.realtime_={close:m,sendRequest:g};const A=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[E,T]=await Promise.all([this.authTokenProvider_.getToken(A),this.appCheckTokenProvider_.getToken(A)]);c?Os("getToken() completed but was canceled"):(Os("getToken() completed. Creating connection."),this.authToken_=E&&E.accessToken,this.appCheckToken_=T&&T.token,f=new Ik(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,i,x=>{Qa(x+" ("+this.repoInfo_.toString()+")"),this.interrupt(Bk)},l))}catch(E){this.log_("Failed to get token: "+E),c||(this.repoInfo_.nodeAdmin&&Qa(E),m())}}}interrupt(t){Os("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Os("Resuming connection for reason: "+t),delete this.interruptReasons_[t],Yy(this.interruptReasons_)&&(this.reconnectDelay_=ug,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let i;e?i=e.map(l=>rS(l)).join("$"):i="default";const s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,e){const i=new cn(t).toString();let s;if(this.listens.has(i)){const l=this.listens.get(i);s=l.get(e),l.delete(e),l.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,e){Os("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(t==="invalid_token"||t==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=Yb&&(this.reconnectDelay_=Fb,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){Os("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(t==="invalid_token"||t==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=Yb&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";t["sdk."+e+"."+a9.replace(/\./g,"-")]=1,cE()?t["framework.cordova"]=1:PC()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=p1.getInstance().currentlyOnline();return Yy(this.interruptReasons_)&&t}}Du.nextPersistentConnectionId_=0;Du.nextConnectionId_=0;class Le{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new Le(t,e)}}class rv{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const i=new Le(Sm,t),s=new Le(Sm,e);return this.compare(i,s)!==0}minPost(){return Le.MIN}}let py;class D9 extends rv{static get __EMPTY_NODE(){return py}static set __EMPTY_NODE(t){py=t}compare(t,e){return qf(t.name,e.name)}isDefinedOn(t){throw Lm("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return Le.MIN}maxPost(){return new Le(kf,py)}makePost(t,e){return zt(typeof t=="string","KeyIndex indexValue must always be a string."),new Le(t,py)}toString(){return".key"}}const hm=new D9;class gy{constructor(t,e,i,s,l=null){this.isReverse_=s,this.resultGenerator_=l,this.nodeStack_=[];let c=1;for(;!t.isEmpty();)if(t=t,c=e?i(t.key,e):1,s&&(c*=-1),c<0)this.isReverse_?t=t.left:t=t.right;else if(c===0){this.nodeStack_.push(t);break}else this.nodeStack_.push(t),this.isReverse_?t=t.right:t=t.left}getNext(){if(this.nodeStack_.length===0)return null;let t=this.nodeStack_.pop(),e;if(this.resultGenerator_?e=this.resultGenerator_(t.key,t.value):e={key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class us{constructor(t,e,i,s,l){this.key=t,this.value=e,this.color=i??us.RED,this.left=s??Ya.EMPTY_NODE,this.right=l??Ya.EMPTY_NODE}copy(t,e,i,s,l){return new us(t??this.key,e??this.value,i??this.color,s??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const l=i(t,s.key);return l<0?s=s.copy(null,null,null,s.left.insert(t,e,i),null):l===0?s=s.copy(null,e,null,null,null):s=s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Ya.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let i,s;if(i=this,e(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),e(t,i.key)===0){if(i.right.isEmpty())return Ya.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,us.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,us.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}us.RED=!0;us.BLACK=!1;class jk{copy(t,e,i,s,l){return this}insert(t,e,i){return new us(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Ya{constructor(t,e=Ya.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new Ya(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,us.BLACK,null,null))}remove(t){return new Ya(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,us.BLACK,null,null))}get(t){let e,i=this.root_;for(;!i.isEmpty();){if(e=this.comparator_(t,i.key),e===0)return i.value;e<0?i=i.left:e>0&&(i=i.right)}return null}getPredecessorKey(t){let e,i=this.root_,s=null;for(;!i.isEmpty();)if(e=this.comparator_(t,i.key),e===0){if(i.left.isEmpty())return s?s.key:null;for(i=i.left;!i.right.isEmpty();)i=i.right;return i.key}else e<0?i=i.left:e>0&&(s=i,i=i.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new gy(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new gy(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new gy(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new gy(this.root_,null,this.comparator_,!0,t)}}Ya.EMPTY_NODE=new jk;function Hk(n,t){return qf(n.name,t.name)}function dS(n,t){return qf(n,t)}let TA;function Gk(n){TA=n}const I9=function(n){return typeof n=="number"?"number:"+u9(n):"string:"+n},O9=function(n){if(n.isLeafNode()){const t=n.val();zt(typeof t=="string"||typeof t=="number"||typeof t=="object"&&ko(t,".sv"),"Priority must be a string or number.")}else zt(n===TA||n.isEmpty(),"priority of unexpected type.");zt(n===TA||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Qb;class ls{static set __childrenNodeConstructor(t){Qb=t}static get __childrenNodeConstructor(){return Qb}constructor(t,e=ls.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,zt(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),O9(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new ls(this.value_,t)}getImmediateChild(t){return t===".priority"?this.priorityNode_:ls.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Me(t)?this:Ne(t)===".priority"?this.priorityNode_:ls.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return t===".priority"?this.updatePriority(e):e.isEmpty()&&t!==".priority"?this:ls.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const i=Ne(t);return i===null?e:e.isEmpty()&&i!==".priority"?this:(zt(i!==".priority"||dh(t)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,ls.__childrenNodeConstructor.EMPTY_NODE.updateChild(Sn(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+I9(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",e==="number"?t+=u9(this.value_):t+=this.value_,this.lazyHash_=l9(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===ls.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof ls.__childrenNodeConstructor?-1:(zt(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,i=typeof this.value_,s=ls.VALUE_TYPE_ORDER.indexOf(e),l=ls.VALUE_TYPE_ORDER.indexOf(i);return zt(s>=0,"Unknown leaf type: "+e),zt(l>=0,"Unknown leaf type: "+i),s===l?i==="object"?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}else return!1}}ls.VALUE_TYPE_ORDER=["object","boolean","number","string"];let M9,L9;function qk(n){M9=n}function Fk(n){L9=n}class Yk extends rv{compare(t,e){const i=t.node.getPriority(),s=e.node.getPriority(),l=i.compareTo(s);return l===0?qf(t.name,e.name):l}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return Le.MIN}maxPost(){return new Le(kf,new ls("[PRIORITY-POST]",L9))}makePost(t,e){const i=M9(t);return new Le(e,new ls("[PRIORITY-POST]",i))}toString(){return".priority"}}const ri=new Yk;const Qk=Math.log(2);class Xk{constructor(t){const e=l=>parseInt(Math.log(l)/Qk,10),i=l=>parseInt(Array(l+1).join("1"),2);this.count=e(t+1),this.current_=this.count-1;const s=i(this.count);this.bits_=t+1&s}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const g1=function(n,t,e,i){n.sort(t);const s=function(m,g){const A=g-m;let E,T;if(A===0)return null;if(A===1)return E=n[m],T=e?e(E):E,new us(T,E.node,us.BLACK,null,null);{const x=parseInt(A/2,10)+m,R=s(m,x),O=s(x+1,g);return E=n[x],T=e?e(E):E,new us(T,E.node,us.BLACK,R,O)}},l=function(m){let g=null,A=null,E=n.length;const T=function(R,O){const M=E-R,H=E;E-=R;const B=s(M+1,H),Y=n[M],$=e?e(Y):Y;x(new us($,Y.node,O,null,B))},x=function(R){g?(g.left=R,g=R):(A=R,g=R)};for(let R=0;R<m.count;++R){const O=m.nextBitIsOne(),M=Math.pow(2,m.count-(R+1));O?T(M,us.BLACK):(T(M,us.BLACK),T(M,us.RED))}return A},c=new Xk(n.length),f=l(c);return new Ya(i||t,f)};let E2;const Qd={};class Cu{static get Default(){return zt(Qd&&ri,"ChildrenNode.ts has not been loaded"),E2=E2||new Cu({".priority":Qd},{".priority":ri}),E2}constructor(t,e){this.indexes_=t,this.indexSet_=e}get(t){const e=dm(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Ya?e:null}hasIndex(t){return ko(this.indexSet_,t.toString())}addIndex(t,e){zt(t!==hm,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const l=e.getIterator(Le.Wrap);let c=l.getNext();for(;c;)s=s||t.isDefinedOn(c.node),i.push(c),c=l.getNext();let f;s?f=g1(i,t.getCompare()):f=Qd;const m=t.toString(),g=Object.assign({},this.indexSet_);g[m]=t;const A=Object.assign({},this.indexes_);return A[m]=f,new Cu(A,g)}addToIndexes(t,e){const i=Qy(this.indexes_,(s,l)=>{const c=dm(this.indexSet_,l);if(zt(c,"Missing index implementation for "+l),s===Qd)if(c.isDefinedOn(t.node)){const f=[],m=e.getIterator(Le.Wrap);let g=m.getNext();for(;g;)g.name!==t.name&&f.push(g),g=m.getNext();return f.push(t),g1(f,c.getCompare())}else return Qd;else{const f=e.get(t.name);let m=s;return f&&(m=m.remove(new Le(t.name,f))),m.insert(t,t.node)}});return new Cu(i,this.indexSet_)}removeFromIndexes(t,e){const i=Qy(this.indexes_,s=>{if(s===Qd)return s;{const l=e.get(t.name);return l?s.remove(new Le(t.name,l)):s}});return new Cu(i,this.indexSet_)}}let cg;class ce{static get EMPTY_NODE(){return cg||(cg=new ce(new Ya(dS),null,Cu.Default))}constructor(t,e,i){this.children_=t,this.priorityNode_=e,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&O9(this.priorityNode_),this.children_.isEmpty()&&zt(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||cg}updatePriority(t){return this.children_.isEmpty()?this:new ce(this.children_,t,this.indexMap_)}getImmediateChild(t){if(t===".priority")return this.getPriority();{const e=this.children_.get(t);return e===null?cg:e}}getChild(t){const e=Ne(t);return e===null?this:this.getImmediateChild(e).getChild(Sn(t))}hasChild(t){return this.children_.get(t)!==null}updateImmediateChild(t,e){if(zt(e,"We should always be passing snapshot nodes"),t===".priority")return this.updatePriority(e);{const i=new Le(t,e);let s,l;e.isEmpty()?(s=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,e),l=this.indexMap_.addToIndexes(i,this.children_));const c=s.isEmpty()?cg:this.priorityNode_;return new ce(s,c,l)}}updateChild(t,e){const i=Ne(t);if(i===null)return e;{zt(Ne(t)!==".priority"||dh(t)===1,".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Sn(t),e);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let i=0,s=0,l=!0;if(this.forEachChild(ri,(c,f)=>{e[c]=f.val(t),i++,l&&ce.INTEGER_REGEXP_.test(c)?s=Math.max(s,Number(c)):l=!1}),!t&&l&&s<2*i){const c=[];for(const f in e)c[f]=e[f];return c}else return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(this.lazyHash_===null){let t="";this.getPriority().isEmpty()||(t+="priority:"+I9(this.getPriority().val())+":"),this.forEachChild(ri,(e,i)=>{const s=i.hash();s!==""&&(t+=":"+e+":"+s)}),this.lazyHash_=t===""?"":l9(t)}return this.lazyHash_}getPredecessorChildName(t,e,i){const s=this.resolveIndex_(i);if(s){const l=s.getPredecessorKey(new Le(t,e));return l?l.name:null}else return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const i=e.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new Le(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const i=e.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new Le(e,this.children_.get(e)):null}forEachChild(t,e){const i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>e(s.name,s.node)):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const i=this.resolveIndex_(e);if(i)return i.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,Le.Wrap);let l=s.peek();for(;l!=null&&e.compare(l,t)<0;)s.getNext(),l=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const i=this.resolveIndex_(e);if(i)return i.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,Le.Wrap);let l=s.peek();for(;l!=null&&e.compare(l,t)>0;)s.getNext(),l=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===V0?-1:0}withIndex(t){if(t===hm||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new ce(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===hm||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority()))if(this.children_.count()===e.children_.count()){const i=this.getIterator(ri),s=e.getIterator(ri);let l=i.getNext(),c=s.getNext();for(;l&&c;){if(l.name!==c.name||!l.node.equals(c.node))return!1;l=i.getNext(),c=s.getNext()}return l===null&&c===null}else return!1;else return!1}}resolveIndex_(t){return t===hm?null:this.indexMap_.get(t.toString())}}ce.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class Kk extends ce{constructor(){super(new Ya(dS),ce.EMPTY_NODE,Cu.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return ce.EMPTY_NODE}isEmpty(){return!1}}const V0=new Kk;Object.defineProperties(Le,{MIN:{value:new Le(Sm,ce.EMPTY_NODE)},MAX:{value:new Le(kf,V0)}});D9.__EMPTY_NODE=ce.EMPTY_NODE;ls.__childrenNodeConstructor=ce;Gk(V0);Fk(V0);const Wk=!0;function ki(n,t=null){if(n===null)return ce.EMPTY_NODE;if(typeof n=="object"&&".priority"in n&&(t=n[".priority"]),zt(t===null||typeof t=="string"||typeof t=="number"||typeof t=="object"&&".sv"in t,"Invalid priority type found: "+typeof t),typeof n=="object"&&".value"in n&&n[".value"]!==null&&(n=n[".value"]),typeof n!="object"||".sv"in n){const e=n;return new ls(e,ki(t))}if(!(n instanceof Array)&&Wk){const e=[];let i=!1;if(ta(n,(c,f)=>{if(c.substring(0,1)!=="."){const m=ki(f);m.isEmpty()||(i=i||!m.getPriority().isEmpty(),e.push(new Le(c,m)))}}),e.length===0)return ce.EMPTY_NODE;const l=g1(e,Hk,c=>c.name,dS);if(i){const c=g1(e,ri.getCompare());return new ce(l,ki(t),new Cu({".priority":c},{".priority":ri}))}else return new ce(l,ki(t),Cu.Default)}else{let e=ce.EMPTY_NODE;return ta(n,(i,s)=>{if(ko(n,i)&&i.substring(0,1)!=="."){const l=ki(s);(l.isLeafNode()||!l.isEmpty())&&(e=e.updateImmediateChild(i,l))}}),e.updatePriority(ki(t))}}qk(ki);class Jk extends rv{constructor(t){super(),this.indexPath_=t,zt(!Me(t)&&Ne(t)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const i=this.extractChild(t.node),s=this.extractChild(e.node),l=i.compareTo(s);return l===0?qf(t.name,e.name):l}makePost(t,e){const i=ki(t),s=ce.EMPTY_NODE.updateChild(this.indexPath_,i);return new Le(e,s)}maxPost(){const t=ce.EMPTY_NODE.updateChild(this.indexPath_,V0);return new Le(kf,t)}toString(){return r0(this.indexPath_,0).join("/")}}class Zk extends rv{compare(t,e){const i=t.node.compareTo(e.node);return i===0?qf(t.name,e.name):i}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return Le.MIN}maxPost(){return Le.MAX}makePost(t,e){const i=ki(t);return new Le(e,i)}toString(){return".value"}}const $k=new Zk;function k9(n){return{type:"value",snapshotNode:n}}function Tm(n,t){return{type:"child_added",snapshotNode:t,childName:n}}function l0(n,t){return{type:"child_removed",snapshotNode:t,childName:n}}function o0(n,t,e){return{type:"child_changed",snapshotNode:t,childName:n,oldSnap:e}}function tP(n,t){return{type:"child_moved",snapshotNode:t,childName:n}}class mS{constructor(t){this.index_=t}updateChild(t,e,i,s,l,c){zt(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const f=t.getImmediateChild(e);return f.getChild(s).equals(i.getChild(s))&&f.isEmpty()===i.isEmpty()||(c!=null&&(i.isEmpty()?t.hasChild(e)?c.trackChildChange(l0(e,f)):zt(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):f.isEmpty()?c.trackChildChange(Tm(e,i)):c.trackChildChange(o0(e,i,f))),t.isLeafNode()&&i.isEmpty())?t:t.updateImmediateChild(e,i).withIndex(this.index_)}updateFullNode(t,e,i){return i!=null&&(t.isLeafNode()||t.forEachChild(ri,(s,l)=>{e.hasChild(s)||i.trackChildChange(l0(s,l))}),e.isLeafNode()||e.forEachChild(ri,(s,l)=>{if(t.hasChild(s)){const c=t.getImmediateChild(s);c.equals(l)||i.trackChildChange(o0(s,l,c))}else i.trackChildChange(Tm(s,l))})),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?ce.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class u0{constructor(t){this.indexedFilter_=new mS(t.getIndex()),this.index_=t.getIndex(),this.startPost_=u0.getStartPost_(t),this.endPost_=u0.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,i=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&i}updateChild(t,e,i,s,l,c){return this.matches(new Le(e,i))||(i=ce.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,i,s,l,c)}updateFullNode(t,e,i){e.isLeafNode()&&(e=ce.EMPTY_NODE);let s=e.withIndex(this.index_);s=s.updatePriority(ce.EMPTY_NODE);const l=this;return e.forEachChild(ri,(c,f)=>{l.matches(new Le(c,f))||(s=s.updateImmediateChild(c,ce.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,s,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}else return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}else return t.getIndex().maxPost()}}class eP{constructor(t){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const i=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?i<=0:i<0},this.withinEndPost=e=>{const i=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?i<=0:i<0},this.rangedFilter_=new u0(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,i,s,l,c){return this.rangedFilter_.matches(new Le(e,i))||(i=ce.EMPTY_NODE),t.getImmediateChild(e).equals(i)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,i,s,l,c):this.fullLimitUpdateChild_(t,e,i,l,c)}updateFullNode(t,e,i){let s;if(e.isLeafNode()||e.isEmpty())s=ce.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<e.numChildren()&&e.isIndexed(this.index_)){s=ce.EMPTY_NODE.withIndex(this.index_);let l;this.reverse_?l=e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):l=e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let c=0;for(;l.hasNext()&&c<this.limit_;){const f=l.getNext();if(this.withinDirectionalStart(f))if(this.withinDirectionalEnd(f))s=s.updateImmediateChild(f.name,f.node),c++;else break;else continue}}else{s=e.withIndex(this.index_),s=s.updatePriority(ce.EMPTY_NODE);let l;this.reverse_?l=s.getReverseIterator(this.index_):l=s.getIterator(this.index_);let c=0;for(;l.hasNext();){const f=l.getNext();c<this.limit_&&this.withinDirectionalStart(f)&&this.withinDirectionalEnd(f)?c++:s=s.updateImmediateChild(f.name,ce.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,s,i)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,e,i,s,l){let c;if(this.reverse_){const E=this.index_.getCompare();c=(T,x)=>E(x,T)}else c=this.index_.getCompare();const f=t;zt(f.numChildren()===this.limit_,"");const m=new Le(e,i),g=this.reverse_?f.getFirstChild(this.index_):f.getLastChild(this.index_),A=this.rangedFilter_.matches(m);if(f.hasChild(e)){const E=f.getImmediateChild(e);let T=s.getChildAfterChild(this.index_,g,this.reverse_);for(;T!=null&&(T.name===e||f.hasChild(T.name));)T=s.getChildAfterChild(this.index_,T,this.reverse_);const x=T==null?1:c(T,m);if(A&&!i.isEmpty()&&x>=0)return l?.trackChildChange(o0(e,i,E)),f.updateImmediateChild(e,i);{l?.trackChildChange(l0(e,E));const O=f.updateImmediateChild(e,ce.EMPTY_NODE);return T!=null&&this.rangedFilter_.matches(T)?(l?.trackChildChange(Tm(T.name,T.node)),O.updateImmediateChild(T.name,T.node)):O}}else return i.isEmpty()?t:A&&c(g,m)>=0?(l!=null&&(l.trackChildChange(l0(g.name,g.node)),l.trackChildChange(Tm(e,i))),f.updateImmediateChild(e,i).updateImmediateChild(g.name,ce.EMPTY_NODE)):t}}class pS{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ri}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return zt(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return zt(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Sm}hasEnd(){return this.endSet_}getIndexEndValue(){return zt(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return zt(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:kf}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return zt(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ri}copy(){const t=new pS;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function nP(n){return n.loadsAllData()?new mS(n.getIndex()):n.hasLimit()?new eP(n):new u0(n)}function Xb(n){const t={};if(n.isDefault())return t;let e;if(n.index_===ri?e="$priority":n.index_===$k?e="$value":n.index_===hm?e="$key":(zt(n.index_ instanceof Jk,"Unrecognized index type!"),e=n.index_.toString()),t.orderBy=cs(e),n.startSet_){const i=n.startAfterSet_?"startAfter":"startAt";t[i]=cs(n.indexStartValue_),n.startNameSet_&&(t[i]+=","+cs(n.indexStartName_))}if(n.endSet_){const i=n.endBeforeSet_?"endBefore":"endAt";t[i]=cs(n.indexEndValue_),n.endNameSet_&&(t[i]+=","+cs(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?t.limitToFirst=n.limit_:t.limitToLast=n.limit_),t}function Kb(n){const t={};if(n.startSet_&&(t.sp=n.indexStartValue_,n.startNameSet_&&(t.sn=n.indexStartName_),t.sin=!n.startAfterSet_),n.endSet_&&(t.ep=n.indexEndValue_,n.endNameSet_&&(t.en=n.indexEndName_),t.ein=!n.endBeforeSet_),n.limitSet_){t.l=n.limit_;let e=n.viewFrom_;e===""&&(n.isViewFromLeft()?e="l":e="r"),t.vf=e}return n.index_!==ri&&(t.i=n.index_.toString()),t}class _1 extends w9{reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return e!==void 0?"tag$"+e:(zt(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}constructor(t,e,i,s){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=i,this.appCheckTokenProvider_=s,this.log_=P0("p:rest:"),this.listens_={}}listen(t,e,i,s){const l=t._path.toString();this.log_("Listen called for "+l+" "+t._queryIdentifier);const c=_1.getListenId_(t,i),f={};this.listens_[c]=f;const m=Xb(t._queryParams);this.restRequest_(l+".json",m,(g,A)=>{let E=A;if(g===404&&(E=null,g=null),g===null&&this.onDataUpdate_(l,E,!1,i),dm(this.listens_,c)===f){let T;g?g===401?T="permission_denied":T="rest_error:"+g:T="ok",s(T,null)}})}unlisten(t,e){const i=_1.getListenId_(t,e);delete this.listens_[i]}get(t){const e=Xb(t._queryParams),i=t._path.toString(),s=new Su;return this.restRequest_(i+".json",e,(l,c)=>{let f=c;l===404&&(f=null,l=null),l===null?(this.onDataUpdate_(i,f,!1,null),s.resolve(f)):s.reject(new Error(f))}),s.promise}refreshAuthToken(t){}restRequest_(t,e={},i){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([s,l])=>{s&&s.accessToken&&(e.auth=s.accessToken),l&&l.token&&(e.ac=l.token);const c=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+km(e);this.log_("Sending REST request for "+c);const f=new XMLHttpRequest;f.onreadystatechange=()=>{if(i&&f.readyState===4){this.log_("REST Response for "+c+" received. status:",f.status,"response:",f.responseText);let m=null;if(f.status>=200&&f.status<300){try{m=Xg(f.responseText)}catch{Qa("Failed to parse JSON response for "+c+": "+f.responseText)}i(null,m)}else f.status!==401&&f.status!==404&&Qa("Got unsuccessful REST response for "+c+" Status: "+f.status),i(f.status);i=null}},f.open("GET",c,!0),f.send()})}}class iP{constructor(){this.rootNode_=ce.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function y1(){return{value:null,children:new Map}}function qm(n,t,e){if(Me(t))n.value=e,n.children.clear();else if(n.value!==null)n.value=n.value.updateChild(t,e);else{const i=Ne(t);n.children.has(i)||n.children.set(i,y1());const s=n.children.get(i);t=Sn(t),qm(s,t,e)}}function bA(n,t){if(Me(t))return n.value=null,n.children.clear(),!0;if(n.value!==null){if(n.value.isLeafNode())return!1;{const e=n.value;return n.value=null,e.forEachChild(ri,(i,s)=>{qm(n,new cn(i),s)}),bA(n,t)}}else if(n.children.size>0){const e=Ne(t);return t=Sn(t),n.children.has(e)&&bA(n.children.get(e),t)&&n.children.delete(e),n.children.size===0}else return!0}function CA(n,t,e){n.value!==null?e(t,n.value):sP(n,(i,s)=>{const l=new cn(t.toString()+"/"+i);CA(s,l,e)})}function sP(n,t){n.children.forEach((e,i)=>{t(i,e)})}class aP{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&ta(this.last_,(i,s)=>{e[i]=e[i]-s}),this.last_=t,e}}const Wb=10*1e3,rP=30*1e3,lP=300*1e3;class oP{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new aP(t);const i=Wb+(rP-Wb)*Math.random();zg(this.reportStats_.bind(this),Math.floor(i))}reportStats_(){const t=this.statsListener_.get(),e={};let i=!1;ta(t,(s,l)=>{l>0&&ko(this.statsToReport_,s)&&(e[s]=l,i=!0)}),i&&this.server_.reportStats(e),zg(this.reportStats_.bind(this),Math.floor(Math.random()*2*lP))}}var Ml;(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Ml||(Ml={}));function P9(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function gS(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function _S(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class v1{constructor(t,e,i){this.path=t,this.affectedTree=e,this.revert=i,this.type=Ml.ACK_USER_WRITE,this.source=P9()}operationForChild(t){if(Me(this.path)){if(this.affectedTree.value!=null)return zt(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new cn(t));return new v1(an(),e,this.revert)}}else return zt(Ne(this.path)===t,"operationForChild called for unrelated child."),new v1(Sn(this.path),this.affectedTree,this.revert)}}class c0{constructor(t,e){this.source=t,this.path=e,this.type=Ml.LISTEN_COMPLETE}operationForChild(t){return Me(this.path)?new c0(this.source,an()):new c0(this.source,Sn(this.path))}}class Pf{constructor(t,e,i){this.source=t,this.path=e,this.snap=i,this.type=Ml.OVERWRITE}operationForChild(t){return Me(this.path)?new Pf(this.source,an(),this.snap.getImmediateChild(t)):new Pf(this.source,Sn(this.path),this.snap)}}class h0{constructor(t,e,i){this.source=t,this.path=e,this.children=i,this.type=Ml.MERGE}operationForChild(t){if(Me(this.path)){const e=this.children.subtree(new cn(t));return e.isEmpty()?null:e.value?new Pf(this.source,an(),e.value):new h0(this.source,an(),e)}else return zt(Ne(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new h0(this.source,Sn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Vf{constructor(t,e,i){this.node_=t,this.fullyInitialized_=e,this.filtered_=i}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Me(t))return this.isFullyInitialized()&&!this.filtered_;const e=Ne(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class uP{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function cP(n,t,e,i){const s=[],l=[];return t.forEach(c=>{c.type==="child_changed"&&n.index_.indexedValueChanged(c.oldSnap,c.snapshotNode)&&l.push(tP(c.childName,c.snapshotNode))}),hg(n,s,"child_removed",t,i,e),hg(n,s,"child_added",t,i,e),hg(n,s,"child_moved",l,i,e),hg(n,s,"child_changed",t,i,e),hg(n,s,"value",t,i,e),s}function hg(n,t,e,i,s,l){const c=i.filter(f=>f.type===e);c.sort((f,m)=>fP(n,f,m)),c.forEach(f=>{const m=hP(n,f,l);s.forEach(g=>{g.respondsTo(f.type)&&t.push(g.createEvent(m,n.query_))})})}function hP(n,t,e){return t.type==="value"||t.type==="child_removed"||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,n.index_)),t}function fP(n,t,e){if(t.childName==null||e.childName==null)throw Lm("Should only compare child_ events.");const i=new Le(t.childName,t.snapshotNode),s=new Le(e.childName,e.snapshotNode);return n.index_.compare(i,s)}function lv(n,t){return{eventCache:n,serverCache:t}}function Bg(n,t,e,i){return lv(new Vf(t,e,i),n.serverCache)}function V9(n,t,e,i){return lv(n.eventCache,new Vf(t,e,i))}function wA(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Uf(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let S2;const dP=()=>(S2||(S2=new Ya(JL)),S2);class Yn{static fromObject(t){let e=new Yn(null);return ta(t,(i,s)=>{e=e.set(new cn(i),s)}),e}constructor(t,e=dP()){this.value=t,this.children=e}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(this.value!=null&&e(this.value))return{path:an(),value:this.value};if(Me(t))return null;{const i=Ne(t),s=this.children.get(i);if(s!==null){const l=s.findRootMostMatchingPathAndValue(Sn(t),e);return l!=null?{path:Ti(new cn(i),l.path),value:l.value}:null}else return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,()=>!0)}subtree(t){if(Me(t))return this;{const e=Ne(t),i=this.children.get(e);return i!==null?i.subtree(Sn(t)):new Yn(null)}}set(t,e){if(Me(t))return new Yn(e,this.children);{const i=Ne(t),l=(this.children.get(i)||new Yn(null)).set(Sn(t),e),c=this.children.insert(i,l);return new Yn(this.value,c)}}remove(t){if(Me(t))return this.children.isEmpty()?new Yn(null):new Yn(null,this.children);{const e=Ne(t),i=this.children.get(e);if(i){const s=i.remove(Sn(t));let l;return s.isEmpty()?l=this.children.remove(e):l=this.children.insert(e,s),this.value===null&&l.isEmpty()?new Yn(null):new Yn(this.value,l)}else return this}}get(t){if(Me(t))return this.value;{const e=Ne(t),i=this.children.get(e);return i?i.get(Sn(t)):null}}setTree(t,e){if(Me(t))return e;{const i=Ne(t),l=(this.children.get(i)||new Yn(null)).setTree(Sn(t),e);let c;return l.isEmpty()?c=this.children.remove(i):c=this.children.insert(i,l),new Yn(this.value,c)}}fold(t){return this.fold_(an(),t)}fold_(t,e){const i={};return this.children.inorderTraversal((s,l)=>{i[s]=l.fold_(Ti(t,s),e)}),e(t,this.value,i)}findOnPath(t,e){return this.findOnPath_(t,an(),e)}findOnPath_(t,e,i){const s=this.value?i(e,this.value):!1;if(s)return s;if(Me(t))return null;{const l=Ne(t),c=this.children.get(l);return c?c.findOnPath_(Sn(t),Ti(e,l),i):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,an(),e)}foreachOnPath_(t,e,i){if(Me(t))return this;{this.value&&i(e,this.value);const s=Ne(t),l=this.children.get(s);return l?l.foreachOnPath_(Sn(t),Ti(e,s),i):new Yn(null)}}foreach(t){this.foreach_(an(),t)}foreach_(t,e){this.children.inorderTraversal((i,s)=>{s.foreach_(Ti(t,i),e)}),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal((e,i)=>{i.value&&t(e,i.value)})}}class Pl{constructor(t){this.writeTree_=t}static empty(){return new Pl(new Yn(null))}}function jg(n,t,e){if(Me(t))return new Pl(new Yn(e));{const i=n.writeTree_.findRootMostValueAndPath(t);if(i!=null){const s=i.path;let l=i.value;const c=Fa(s,t);return l=l.updateChild(c,e),new Pl(n.writeTree_.set(s,l))}else{const s=new Yn(e),l=n.writeTree_.setTree(t,s);return new Pl(l)}}}function Jb(n,t,e){let i=n;return ta(e,(s,l)=>{i=jg(i,Ti(t,s),l)}),i}function Zb(n,t){if(Me(t))return Pl.empty();{const e=n.writeTree_.setTree(t,new Yn(null));return new Pl(e)}}function RA(n,t){return Ff(n,t)!=null}function Ff(n,t){const e=n.writeTree_.findRootMostValueAndPath(t);return e!=null?n.writeTree_.get(e.path).getChild(Fa(e.path,t)):null}function $b(n){const t=[],e=n.writeTree_.value;return e!=null?e.isLeafNode()||e.forEachChild(ri,(i,s)=>{t.push(new Le(i,s))}):n.writeTree_.children.inorderTraversal((i,s)=>{s.value!=null&&t.push(new Le(i,s.value))}),t}function sh(n,t){if(Me(t))return n;{const e=Ff(n,t);return e!=null?new Pl(new Yn(e)):new Pl(n.writeTree_.subtree(t))}}function xA(n){return n.writeTree_.isEmpty()}function bm(n,t){return U9(an(),n.writeTree_,t)}function U9(n,t,e){if(t.value!=null)return e.updateChild(n,t.value);{let i=null;return t.children.inorderTraversal((s,l)=>{s===".priority"?(zt(l.value!==null,"Priority writes must always be leaf nodes"),i=l.value):e=U9(Ti(n,s),l,e)}),!e.getChild(n).isEmpty()&&i!==null&&(e=e.updateChild(Ti(n,".priority"),i)),e}}function yS(n,t){return H9(t,n)}function mP(n,t,e,i,s){zt(i>n.lastWriteId,"Stacking an older write on top of newer ones"),s===void 0&&(s=!0),n.allWrites.push({path:t,snap:e,writeId:i,visible:s}),s&&(n.visibleWrites=jg(n.visibleWrites,t,e)),n.lastWriteId=i}function pP(n,t){for(let e=0;e<n.allWrites.length;e++){const i=n.allWrites[e];if(i.writeId===t)return i}return null}function gP(n,t){const e=n.allWrites.findIndex(f=>f.writeId===t);zt(e>=0,"removeWrite called with nonexistent writeId.");const i=n.allWrites[e];n.allWrites.splice(e,1);let s=i.visible,l=!1,c=n.allWrites.length-1;for(;s&&c>=0;){const f=n.allWrites[c];f.visible&&(c>=e&&_P(f,i.path)?s=!1:nl(i.path,f.path)&&(l=!0)),c--}if(s){if(l)return yP(n),!0;if(i.snap)n.visibleWrites=Zb(n.visibleWrites,i.path);else{const f=i.children;ta(f,m=>{n.visibleWrites=Zb(n.visibleWrites,Ti(i.path,m))})}return!0}else return!1}function _P(n,t){if(n.snap)return nl(n.path,t);for(const e in n.children)if(n.children.hasOwnProperty(e)&&nl(Ti(n.path,e),t))return!0;return!1}function yP(n){n.visibleWrites=z9(n.allWrites,vP,an()),n.allWrites.length>0?n.lastWriteId=n.allWrites[n.allWrites.length-1].writeId:n.lastWriteId=-1}function vP(n){return n.visible}function z9(n,t,e){let i=Pl.empty();for(let s=0;s<n.length;++s){const l=n[s];if(t(l)){const c=l.path;let f;if(l.snap)nl(e,c)?(f=Fa(e,c),i=jg(i,f,l.snap)):nl(c,e)&&(f=Fa(c,e),i=jg(i,an(),l.snap.getChild(f)));else if(l.children){if(nl(e,c))f=Fa(e,c),i=Jb(i,f,l.children);else if(nl(c,e))if(f=Fa(c,e),Me(f))i=Jb(i,an(),l.children);else{const m=dm(l.children,Ne(f));if(m){const g=m.getChild(Sn(f));i=jg(i,an(),g)}}}else throw Lm("WriteRecord should have .snap or .children")}}return i}function B9(n,t,e,i,s){if(!i&&!s){const l=Ff(n.visibleWrites,t);if(l!=null)return l;{const c=sh(n.visibleWrites,t);if(xA(c))return e;if(e==null&&!RA(c,an()))return null;{const f=e||ce.EMPTY_NODE;return bm(c,f)}}}else{const l=sh(n.visibleWrites,t);if(!s&&xA(l))return e;if(!s&&e==null&&!RA(l,an()))return null;{const c=function(g){return(g.visible||s)&&(!i||!~i.indexOf(g.writeId))&&(nl(g.path,t)||nl(t,g.path))},f=z9(n.allWrites,c,t),m=e||ce.EMPTY_NODE;return bm(f,m)}}}function AP(n,t,e){let i=ce.EMPTY_NODE;const s=Ff(n.visibleWrites,t);if(s)return s.isLeafNode()||s.forEachChild(ri,(l,c)=>{i=i.updateImmediateChild(l,c)}),i;if(e){const l=sh(n.visibleWrites,t);return e.forEachChild(ri,(c,f)=>{const m=bm(sh(l,new cn(c)),f);i=i.updateImmediateChild(c,m)}),$b(l).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}else{const l=sh(n.visibleWrites,t);return $b(l).forEach(c=>{i=i.updateImmediateChild(c.name,c.node)}),i}}function EP(n,t,e,i,s){zt(i||s,"Either existingEventSnap or existingServerSnap must exist");const l=Ti(t,e);if(RA(n.visibleWrites,l))return null;{const c=sh(n.visibleWrites,l);return xA(c)?s.getChild(e):bm(c,s.getChild(e))}}function SP(n,t,e,i){const s=Ti(t,e),l=Ff(n.visibleWrites,s);if(l!=null)return l;if(i.isCompleteForChild(e)){const c=sh(n.visibleWrites,s);return bm(c,i.getNode().getImmediateChild(e))}else return null}function TP(n,t){return Ff(n.visibleWrites,t)}function bP(n,t,e,i,s,l,c){let f;const m=sh(n.visibleWrites,t),g=Ff(m,an());if(g!=null)f=g;else if(e!=null)f=bm(m,e);else return[];if(f=f.withIndex(c),!f.isEmpty()&&!f.isLeafNode()){const A=[],E=c.getCompare(),T=l?f.getReverseIteratorFrom(i,c):f.getIteratorFrom(i,c);let x=T.getNext();for(;x&&A.length<s;)E(x,i)!==0&&A.push(x),x=T.getNext();return A}else return[]}function CP(){return{visibleWrites:Pl.empty(),allWrites:[],lastWriteId:-1}}function A1(n,t,e,i){return B9(n.writeTree,n.treePath,t,e,i)}function vS(n,t){return AP(n.writeTree,n.treePath,t)}function t3(n,t,e,i){return EP(n.writeTree,n.treePath,t,e,i)}function E1(n,t){return TP(n.writeTree,Ti(n.treePath,t))}function wP(n,t,e,i,s,l){return bP(n.writeTree,n.treePath,t,e,i,s,l)}function AS(n,t,e){return SP(n.writeTree,n.treePath,t,e)}function j9(n,t){return H9(Ti(n.treePath,t),n.writeTree)}function H9(n,t){return{treePath:n,writeTree:t}}class RP{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,i=t.childName;zt(e==="child_added"||e==="child_changed"||e==="child_removed","Only child changes supported for tracking"),zt(i!==".priority","Only non-priority child changes can be tracked.");const s=this.changeMap.get(i);if(s){const l=s.type;if(e==="child_added"&&l==="child_removed")this.changeMap.set(i,o0(i,t.snapshotNode,s.snapshotNode));else if(e==="child_removed"&&l==="child_added")this.changeMap.delete(i);else if(e==="child_removed"&&l==="child_changed")this.changeMap.set(i,l0(i,s.oldSnap));else if(e==="child_changed"&&l==="child_added")this.changeMap.set(i,Tm(i,t.snapshotNode));else if(e==="child_changed"&&l==="child_changed")this.changeMap.set(i,o0(i,t.snapshotNode,s.oldSnap));else throw Lm("Illegal combination of changes: "+t+" occurred after "+s)}else this.changeMap.set(i,t)}getChanges(){return Array.from(this.changeMap.values())}}class xP{getCompleteChild(t){return null}getChildAfterChild(t,e,i){return null}}const G9=new xP;class ES{constructor(t,e,i=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=i}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const i=this.optCompleteServerCache_!=null?new Vf(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return AS(this.writes_,t,i)}}getChildAfterChild(t,e,i){const s=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Uf(this.viewCache_),l=wP(this.writes_,s,e,1,i,t);return l.length===0?null:l[0]}}function NP(n){return{filter:n}}function DP(n,t){zt(t.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),zt(t.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}function IP(n,t,e,i,s){const l=new RP;let c,f;if(e.type===Ml.OVERWRITE){const g=e;g.source.fromUser?c=NA(n,t,g.path,g.snap,i,s,l):(zt(g.source.fromServer,"Unknown source."),f=g.source.tagged||t.serverCache.isFiltered()&&!Me(g.path),c=S1(n,t,g.path,g.snap,i,s,f,l))}else if(e.type===Ml.MERGE){const g=e;g.source.fromUser?c=MP(n,t,g.path,g.children,i,s,l):(zt(g.source.fromServer,"Unknown source."),f=g.source.tagged||t.serverCache.isFiltered(),c=DA(n,t,g.path,g.children,i,s,f,l))}else if(e.type===Ml.ACK_USER_WRITE){const g=e;g.revert?c=PP(n,t,g.path,i,s,l):c=LP(n,t,g.path,g.affectedTree,i,s,l)}else if(e.type===Ml.LISTEN_COMPLETE)c=kP(n,t,e.path,i,l);else throw Lm("Unknown operation type: "+e.type);const m=l.getChanges();return OP(t,c,m),{viewCache:c,changes:m}}function OP(n,t,e){const i=t.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),l=wA(n);(e.length>0||!n.eventCache.isFullyInitialized()||s&&!i.getNode().equals(l)||!i.getNode().getPriority().equals(l.getPriority()))&&e.push(k9(wA(t)))}}function q9(n,t,e,i,s,l){const c=t.eventCache;if(E1(i,e)!=null)return t;{let f,m;if(Me(e))if(zt(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const g=Uf(t),A=g instanceof ce?g:ce.EMPTY_NODE,E=vS(i,A);f=n.filter.updateFullNode(t.eventCache.getNode(),E,l)}else{const g=A1(i,Uf(t));f=n.filter.updateFullNode(t.eventCache.getNode(),g,l)}else{const g=Ne(e);if(g===".priority"){zt(dh(e)===1,"Can't have a priority with additional path components");const A=c.getNode();m=t.serverCache.getNode();const E=t3(i,e,A,m);E!=null?f=n.filter.updatePriority(A,E):f=c.getNode()}else{const A=Sn(e);let E;if(c.isCompleteForChild(g)){m=t.serverCache.getNode();const T=t3(i,e,c.getNode(),m);T!=null?E=c.getNode().getImmediateChild(g).updateChild(A,T):E=c.getNode().getImmediateChild(g)}else E=AS(i,g,t.serverCache);E!=null?f=n.filter.updateChild(c.getNode(),g,E,A,s,l):f=c.getNode()}}return Bg(t,f,c.isFullyInitialized()||Me(e),n.filter.filtersNodes())}}function S1(n,t,e,i,s,l,c,f){const m=t.serverCache;let g;const A=c?n.filter:n.filter.getIndexedFilter();if(Me(e))g=A.updateFullNode(m.getNode(),i,null);else if(A.filtersNodes()&&!m.isFiltered()){const x=m.getNode().updateChild(e,i);g=A.updateFullNode(m.getNode(),x,null)}else{const x=Ne(e);if(!m.isCompleteForPath(e)&&dh(e)>1)return t;const R=Sn(e),M=m.getNode().getImmediateChild(x).updateChild(R,i);x===".priority"?g=A.updatePriority(m.getNode(),M):g=A.updateChild(m.getNode(),x,M,R,G9,null)}const E=V9(t,g,m.isFullyInitialized()||Me(e),A.filtersNodes()),T=new ES(s,E,l);return q9(n,E,e,s,T,f)}function NA(n,t,e,i,s,l,c){const f=t.eventCache;let m,g;const A=new ES(s,t,l);if(Me(e))g=n.filter.updateFullNode(t.eventCache.getNode(),i,c),m=Bg(t,g,!0,n.filter.filtersNodes());else{const E=Ne(e);if(E===".priority")g=n.filter.updatePriority(t.eventCache.getNode(),i),m=Bg(t,g,f.isFullyInitialized(),f.isFiltered());else{const T=Sn(e),x=f.getNode().getImmediateChild(E);let R;if(Me(T))R=i;else{const O=A.getCompleteChild(E);O!=null?cS(T)===".priority"&&O.getChild(x9(T)).isEmpty()?R=O:R=O.updateChild(T,i):R=ce.EMPTY_NODE}if(x.equals(R))m=t;else{const O=n.filter.updateChild(f.getNode(),E,R,T,A,c);m=Bg(t,O,f.isFullyInitialized(),n.filter.filtersNodes())}}}return m}function e3(n,t){return n.eventCache.isCompleteForChild(t)}function MP(n,t,e,i,s,l,c){let f=t;return i.foreach((m,g)=>{const A=Ti(e,m);e3(t,Ne(A))&&(f=NA(n,f,A,g,s,l,c))}),i.foreach((m,g)=>{const A=Ti(e,m);e3(t,Ne(A))||(f=NA(n,f,A,g,s,l,c))}),f}function n3(n,t,e){return e.foreach((i,s)=>{t=t.updateChild(i,s)}),t}function DA(n,t,e,i,s,l,c,f){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let m=t,g;Me(e)?g=i:g=new Yn(null).setTree(e,i);const A=t.serverCache.getNode();return g.children.inorderTraversal((E,T)=>{if(A.hasChild(E)){const x=t.serverCache.getNode().getImmediateChild(E),R=n3(n,x,T);m=S1(n,m,new cn(E),R,s,l,c,f)}}),g.children.inorderTraversal((E,T)=>{const x=!t.serverCache.isCompleteForChild(E)&&T.value===null;if(!A.hasChild(E)&&!x){const R=t.serverCache.getNode().getImmediateChild(E),O=n3(n,R,T);m=S1(n,m,new cn(E),O,s,l,c,f)}}),m}function LP(n,t,e,i,s,l,c){if(E1(s,e)!=null)return t;const f=t.serverCache.isFiltered(),m=t.serverCache;if(i.value!=null){if(Me(e)&&m.isFullyInitialized()||m.isCompleteForPath(e))return S1(n,t,e,m.getNode().getChild(e),s,l,f,c);if(Me(e)){let g=new Yn(null);return m.getNode().forEachChild(hm,(A,E)=>{g=g.set(new cn(A),E)}),DA(n,t,e,g,s,l,f,c)}else return t}else{let g=new Yn(null);return i.foreach((A,E)=>{const T=Ti(e,A);m.isCompleteForPath(T)&&(g=g.set(A,m.getNode().getChild(T)))}),DA(n,t,e,g,s,l,f,c)}}function kP(n,t,e,i,s){const l=t.serverCache,c=V9(t,l.getNode(),l.isFullyInitialized()||Me(e),l.isFiltered());return q9(n,c,e,i,G9,s)}function PP(n,t,e,i,s,l){let c;if(E1(i,e)!=null)return t;{const f=new ES(i,t,s),m=t.eventCache.getNode();let g;if(Me(e)||Ne(e)===".priority"){let A;if(t.serverCache.isFullyInitialized())A=A1(i,Uf(t));else{const E=t.serverCache.getNode();zt(E instanceof ce,"serverChildren would be complete if leaf node"),A=vS(i,E)}A=A,g=n.filter.updateFullNode(m,A,l)}else{const A=Ne(e);let E=AS(i,A,t.serverCache);E==null&&t.serverCache.isCompleteForChild(A)&&(E=m.getImmediateChild(A)),E!=null?g=n.filter.updateChild(m,A,E,Sn(e),f,l):t.eventCache.getNode().hasChild(A)?g=n.filter.updateChild(m,A,ce.EMPTY_NODE,Sn(e),f,l):g=m,g.isEmpty()&&t.serverCache.isFullyInitialized()&&(c=A1(i,Uf(t)),c.isLeafNode()&&(g=n.filter.updateFullNode(g,c,l)))}return c=t.serverCache.isFullyInitialized()||E1(i,an())!=null,Bg(t,g,c,n.filter.filtersNodes())}}class VP{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const i=this.query_._queryParams,s=new mS(i.getIndex()),l=nP(i);this.processor_=NP(l);const c=e.serverCache,f=e.eventCache,m=s.updateFullNode(ce.EMPTY_NODE,c.getNode(),null),g=l.updateFullNode(ce.EMPTY_NODE,f.getNode(),null),A=new Vf(m,c.isFullyInitialized(),s.filtersNodes()),E=new Vf(g,f.isFullyInitialized(),l.filtersNodes());this.viewCache_=lv(E,A),this.eventGenerator_=new uP(this.query_)}get query(){return this.query_}}function UP(n){return n.viewCache_.serverCache.getNode()}function zP(n,t){const e=Uf(n.viewCache_);return e&&(n.query._queryParams.loadsAllData()||!Me(t)&&!e.getImmediateChild(Ne(t)).isEmpty())?e.getChild(t):null}function i3(n){return n.eventRegistrations_.length===0}function BP(n,t){n.eventRegistrations_.push(t)}function s3(n,t,e){const i=[];if(e){zt(t==null,"A cancel should cancel all event registrations.");const s=n.query._path;n.eventRegistrations_.forEach(l=>{const c=l.createCancelEvent(e,s);c&&i.push(c)})}if(t){let s=[];for(let l=0;l<n.eventRegistrations_.length;++l){const c=n.eventRegistrations_[l];if(!c.matches(t))s.push(c);else if(t.hasAnyCallback()){s=s.concat(n.eventRegistrations_.slice(l+1));break}}n.eventRegistrations_=s}else n.eventRegistrations_=[];return i}function a3(n,t,e,i){t.type===Ml.MERGE&&t.source.queryId!==null&&(zt(Uf(n.viewCache_),"We should always have a full cache before handling merges"),zt(wA(n.viewCache_),"Missing event cache, even though we have a server cache"));const s=n.viewCache_,l=IP(n.processor_,s,t,e,i);return DP(n.processor_,l.viewCache),zt(l.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=l.viewCache,F9(n,l.changes,l.viewCache.eventCache.getNode(),null)}function jP(n,t){const e=n.viewCache_.eventCache,i=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(ri,(l,c)=>{i.push(Tm(l,c))}),e.isFullyInitialized()&&i.push(k9(e.getNode())),F9(n,i,e.getNode(),t)}function F9(n,t,e,i){const s=i?[i]:n.eventRegistrations_;return cP(n.eventGenerator_,t,e,s)}let T1;class HP{constructor(){this.views=new Map}}function GP(n){zt(!T1,"__referenceConstructor has already been defined"),T1=n}function qP(){return zt(T1,"Reference.ts has not been loaded"),T1}function FP(n){return n.views.size===0}function SS(n,t,e,i){const s=t.source.queryId;if(s!==null){const l=n.views.get(s);return zt(l!=null,"SyncTree gave us an op for an invalid query."),a3(l,t,e,i)}else{let l=[];for(const c of n.views.values())l=l.concat(a3(c,t,e,i));return l}}function YP(n,t,e,i,s){const l=t._queryIdentifier,c=n.views.get(l);if(!c){let f=A1(e,s?i:null),m=!1;f?m=!0:i instanceof ce?(f=vS(e,i),m=!1):(f=ce.EMPTY_NODE,m=!1);const g=lv(new Vf(f,m,!1),new Vf(i,s,!1));return new VP(t,g)}return c}function QP(n,t,e,i,s,l){const c=YP(n,t,i,s,l);return n.views.has(t._queryIdentifier)||n.views.set(t._queryIdentifier,c),BP(c,e),jP(c,e)}function XP(n,t,e,i){const s=t._queryIdentifier,l=[];let c=[];const f=mh(n);if(s==="default")for(const[m,g]of n.views.entries())c=c.concat(s3(g,e,i)),i3(g)&&(n.views.delete(m),g.query._queryParams.loadsAllData()||l.push(g.query));else{const m=n.views.get(s);m&&(c=c.concat(s3(m,e,i)),i3(m)&&(n.views.delete(s),m.query._queryParams.loadsAllData()||l.push(m.query)))}return f&&!mh(n)&&l.push(new(qP())(t._repo,t._path)),{removed:l,events:c}}function Y9(n){const t=[];for(const e of n.views.values())e.query._queryParams.loadsAllData()||t.push(e);return t}function fm(n,t){let e=null;for(const i of n.views.values())e=e||zP(i,t);return e}function Q9(n,t){if(t._queryParams.loadsAllData())return ov(n);{const i=t._queryIdentifier;return n.views.get(i)}}function X9(n,t){return Q9(n,t)!=null}function mh(n){return ov(n)!=null}function ov(n){for(const t of n.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let b1;function KP(n){zt(!b1,"__referenceConstructor has already been defined"),b1=n}function WP(){return zt(b1,"Reference.ts has not been loaded"),b1}let JP=1;class r3{constructor(t){this.listenProvider_=t,this.syncPointTree_=new Yn(null),this.pendingWriteTree_=CP(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function K9(n,t,e,i,s){return mP(n.pendingWriteTree_,t,e,i,s),s?U0(n,new Pf(P9(),t,e)):[]}function xf(n,t,e=!1){const i=pP(n.pendingWriteTree_,t);if(gP(n.pendingWriteTree_,t)){let l=new Yn(null);return i.snap!=null?l=l.set(an(),!0):ta(i.children,c=>{l=l.set(new cn(c),!0)}),U0(n,new v1(i.path,l,e))}else return[]}function uv(n,t,e){return U0(n,new Pf(gS(),t,e))}function ZP(n,t,e){const i=Yn.fromObject(e);return U0(n,new h0(gS(),t,i))}function $P(n,t){return U0(n,new c0(gS(),t))}function tV(n,t,e){const i=bS(n,e);if(i){const s=CS(i),l=s.path,c=s.queryId,f=Fa(l,t),m=new c0(_S(c),f);return wS(n,l,m)}else return[]}function IA(n,t,e,i,s=!1){const l=t._path,c=n.syncPointTree_.get(l);let f=[];if(c&&(t._queryIdentifier==="default"||X9(c,t))){const m=XP(c,t,e,i);FP(c)&&(n.syncPointTree_=n.syncPointTree_.remove(l));const g=m.removed;if(f=m.events,!s){const A=g.findIndex(T=>T._queryParams.loadsAllData())!==-1,E=n.syncPointTree_.findOnPath(l,(T,x)=>mh(x));if(A&&!E){const T=n.syncPointTree_.subtree(l);if(!T.isEmpty()){const x=iV(T);for(let R=0;R<x.length;++R){const O=x[R],M=O.query,H=Z9(n,O);n.listenProvider_.startListening(Hg(M),C1(n,M),H.hashFn,H.onComplete)}}}!E&&g.length>0&&!i&&(A?n.listenProvider_.stopListening(Hg(t),null):g.forEach(T=>{const x=n.queryToTagMap.get(cv(T));n.listenProvider_.stopListening(Hg(T),x)}))}sV(n,g)}return f}function eV(n,t,e,i){const s=bS(n,i);if(s!=null){const l=CS(s),c=l.path,f=l.queryId,m=Fa(c,t),g=new Pf(_S(f),m,e);return wS(n,c,g)}else return[]}function nV(n,t,e,i){const s=bS(n,i);if(s){const l=CS(s),c=l.path,f=l.queryId,m=Fa(c,t),g=Yn.fromObject(e),A=new h0(_S(f),m,g);return wS(n,c,A)}else return[]}function l3(n,t,e,i=!1){const s=t._path;let l=null,c=!1;n.syncPointTree_.foreachOnPath(s,(T,x)=>{const R=Fa(T,s);l=l||fm(x,R),c=c||mh(x)});let f=n.syncPointTree_.get(s);f?(c=c||mh(f),l=l||fm(f,an())):(f=new HP,n.syncPointTree_=n.syncPointTree_.set(s,f));let m;l!=null?m=!0:(m=!1,l=ce.EMPTY_NODE,n.syncPointTree_.subtree(s).foreachChild((x,R)=>{const O=fm(R,an());O&&(l=l.updateImmediateChild(x,O))}));const g=X9(f,t);if(!g&&!t._queryParams.loadsAllData()){const T=cv(t);zt(!n.queryToTagMap.has(T),"View does not exist, but we have a tag");const x=aV();n.queryToTagMap.set(T,x),n.tagToQueryMap.set(x,T)}const A=yS(n.pendingWriteTree_,s);let E=QP(f,t,e,A,l,m);if(!g&&!c&&!i){const T=Q9(f,t);E=E.concat(rV(n,t,T))}return E}function TS(n,t,e){const s=n.pendingWriteTree_,l=n.syncPointTree_.findOnPath(t,(c,f)=>{const m=Fa(c,t),g=fm(f,m);if(g)return g});return B9(s,t,l,e,!0)}function U0(n,t){return W9(t,n.syncPointTree_,null,yS(n.pendingWriteTree_,an()))}function W9(n,t,e,i){if(Me(n.path))return J9(n,t,e,i);{const s=t.get(an());e==null&&s!=null&&(e=fm(s,an()));let l=[];const c=Ne(n.path),f=n.operationForChild(c),m=t.children.get(c);if(m&&f){const g=e?e.getImmediateChild(c):null,A=j9(i,c);l=l.concat(W9(f,m,g,A))}return s&&(l=l.concat(SS(s,n,i,e))),l}}function J9(n,t,e,i){const s=t.get(an());e==null&&s!=null&&(e=fm(s,an()));let l=[];return t.children.inorderTraversal((c,f)=>{const m=e?e.getImmediateChild(c):null,g=j9(i,c),A=n.operationForChild(c);A&&(l=l.concat(J9(A,f,m,g)))}),s&&(l=l.concat(SS(s,n,i,e))),l}function Z9(n,t){const e=t.query,i=C1(n,e);return{hashFn:()=>(UP(t)||ce.EMPTY_NODE).hash(),onComplete:s=>{if(s==="ok")return i?tV(n,e._path,i):$P(n,e._path);{const l=tk(s,e);return IA(n,e,null,l)}}}}function C1(n,t){const e=cv(t);return n.queryToTagMap.get(e)}function cv(n){return n._path.toString()+"$"+n._queryIdentifier}function bS(n,t){return n.tagToQueryMap.get(t)}function CS(n){const t=n.indexOf("$");return zt(t!==-1&&t<n.length-1,"Bad queryKey."),{queryId:n.substr(t+1),path:new cn(n.substr(0,t))}}function wS(n,t,e){const i=n.syncPointTree_.get(t);zt(i,"Missing sync point for query tag that we're tracking");const s=yS(n.pendingWriteTree_,t);return SS(i,e,s,null)}function iV(n){return n.fold((t,e,i)=>{if(e&&mh(e))return[ov(e)];{let s=[];return e&&(s=Y9(e)),ta(i,(l,c)=>{s=s.concat(c)}),s}})}function Hg(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(WP())(n._repo,n._path):n}function sV(n,t){for(let e=0;e<t.length;++e){const i=t[e];if(!i._queryParams.loadsAllData()){const s=cv(i),l=n.queryToTagMap.get(s);n.queryToTagMap.delete(s),n.tagToQueryMap.delete(l)}}}function aV(){return JP++}function rV(n,t,e){const i=t._path,s=C1(n,t),l=Z9(n,e),c=n.listenProvider_.startListening(Hg(t),s,l.hashFn,l.onComplete),f=n.syncPointTree_.subtree(i);if(s)zt(!mh(f.value),"If we're adding a query, it shouldn't be shadowed");else{const m=f.fold((g,A,E)=>{if(!Me(g)&&A&&mh(A))return[ov(A).query];{let T=[];return A&&(T=T.concat(Y9(A).map(x=>x.query))),ta(E,(x,R)=>{T=T.concat(R)}),T}});for(let g=0;g<m.length;++g){const A=m[g];n.listenProvider_.stopListening(Hg(A),C1(n,A))}}return c}class RS{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new RS(e)}node(){return this.node_}}class xS{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Ti(this.path_,t);return new xS(this.syncTree_,e)}node(){return TS(this.syncTree_,this.path_)}}const lV=function(n){return n=n||{},n.timestamp=n.timestamp||new Date().getTime(),n},o3=function(n,t,e){if(!n||typeof n!="object")return n;if(zt(".sv"in n,"Unexpected leaf node or priority contents"),typeof n[".sv"]=="string")return oV(n[".sv"],t,e);if(typeof n[".sv"]=="object")return uV(n[".sv"],t);zt(!1,"Unexpected server value: "+JSON.stringify(n,null,2))},oV=function(n,t,e){if(n==="timestamp")return e.timestamp;zt(!1,"Unexpected server value: "+n)},uV=function(n,t,e){n.hasOwnProperty("increment")||zt(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const i=n.increment;typeof i!="number"&&zt(!1,"Unexpected increment value: "+i);const s=t.node();if(zt(s!==null&&typeof s<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!s.isLeafNode())return i;const c=s.getValue();return typeof c!="number"?i:c+i},cV=function(n,t,e,i){return NS(t,new xS(e,n),i)},$9=function(n,t,e){return NS(n,new RS(t),e)};function NS(n,t,e){const i=n.getPriority().val(),s=o3(i,t.getImmediateChild(".priority"),e);let l;if(n.isLeafNode()){const c=n,f=o3(c.getValue(),t,e);return f!==c.getValue()||s!==c.getPriority().val()?new ls(f,ki(s)):n}else{const c=n;return l=c,s!==c.getPriority().val()&&(l=l.updatePriority(new ls(s))),c.forEachChild(ri,(f,m)=>{const g=NS(m,t.getImmediateChild(f),e);g!==m&&(l=l.updateImmediateChild(f,g))}),l}}class DS{constructor(t="",e=null,i={children:{},childCount:0}){this.name=t,this.parent=e,this.node=i}}function IS(n,t){let e=t instanceof cn?t:new cn(t),i=n,s=Ne(e);for(;s!==null;){const l=dm(i.node.children,s)||{children:{},childCount:0};i=new DS(s,i,l),e=Sn(e),s=Ne(e)}return i}function Fm(n){return n.node.value}function t8(n,t){n.node.value=t,OA(n)}function e8(n){return n.node.childCount>0}function hV(n){return Fm(n)===void 0&&!e8(n)}function hv(n,t){ta(n.node.children,(e,i)=>{t(new DS(e,n,i))})}function n8(n,t,e,i){e&&t(n),hv(n,s=>{n8(s,t,!0)})}function fV(n,t,e){let i=n.parent;for(;i!==null;){if(t(i))return!0;i=i.parent}return!1}function z0(n){return new cn(n.parent===null?n.name:z0(n.parent)+"/"+n.name)}function OA(n){n.parent!==null&&dV(n.parent,n.name,n)}function dV(n,t,e){const i=hV(e),s=ko(n.node.children,t);i&&s?(delete n.node.children[t],n.node.childCount--,OA(n)):!i&&!s&&(n.node.children[t]=e.node,n.node.childCount++,OA(n))}const mV=/[\[\].#$\/\u0000-\u001F\u007F]/,pV=/[\[\].#$\u0000-\u001F\u007F]/,T2=10*1024*1024,OS=function(n){return typeof n=="string"&&n.length!==0&&!mV.test(n)},i8=function(n){return typeof n=="string"&&n.length!==0&&!pV.test(n)},gV=function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),i8(n)},s8=function(n){return n===null||typeof n=="string"||typeof n=="number"&&!av(n)||n&&typeof n=="object"&&ko(n,".sv")},MA=function(n,t,e,i){fv(mm(n,"value"),t,e)},fv=function(n,t,e){const i=e instanceof cn?new Lk(e,n):e;if(t===void 0)throw new Error(n+"contains undefined "+Cf(i));if(typeof t=="function")throw new Error(n+"contains a function "+Cf(i)+" with contents = "+t.toString());if(av(t))throw new Error(n+"contains "+t.toString()+" "+Cf(i));if(typeof t=="string"&&t.length>T2/3&&L1(t)>T2)throw new Error(n+"contains a string greater than "+T2+" utf8 bytes "+Cf(i)+" ('"+t.substring(0,50)+"...')");if(t&&typeof t=="object"){let s=!1,l=!1;if(ta(t,(c,f)=>{if(c===".value")s=!0;else if(c!==".priority"&&c!==".sv"&&(l=!0,!OS(c)))throw new Error(n+" contains an invalid key ("+c+") "+Cf(i)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);kk(i,c),fv(n,f,i),Pk(i)}),s&&l)throw new Error(n+' contains ".value" child '+Cf(i)+" in addition to actual children.")}},_V=function(n,t){let e,i;for(e=0;e<t.length;e++){i=t[e];const l=r0(i);for(let c=0;c<l.length;c++)if(!(l[c]===".priority"&&c===l.length-1)){if(!OS(l[c]))throw new Error(n+"contains an invalid key ("+l[c]+") in path "+i.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}t.sort(Mk);let s=null;for(e=0;e<t.length;e++){if(i=t[e],s!==null&&nl(s,i))throw new Error(n+"contains a path "+s.toString()+" that is ancestor of another path "+i.toString());s=i}},yV=function(n,t,e,i){const s=mm(n,"values");if(!(t&&typeof t=="object")||Array.isArray(t))throw new Error(s+" must be an object containing the children to replace.");const l=[];ta(t,(c,f)=>{const m=new cn(c);if(fv(s,f,Ti(e,m)),cS(m)===".priority"&&!s8(f))throw new Error(s+"contains an invalid value for '"+m.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");l.push(m)}),_V(s,l)},vV=function(n,t,e){if(av(t))throw new Error(mm(n,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!s8(t))throw new Error(mm(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},a8=function(n,t,e,i){if(!i8(e))throw new Error(mm(n,t)+'was an invalid path = "'+e+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},AV=function(n,t,e,i){e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),a8(n,t,e)},bg=function(n,t){if(Ne(t)===".info")throw new Error(n+" failed = Can't modify data under /.info/")},EV=function(n,t){const e=t.path.toString();if(typeof t.repoInfo.host!="string"||t.repoInfo.host.length===0||!OS(t.repoInfo.namespace)&&t.repoInfo.host.split(":")[0]!=="localhost"||e.length!==0&&!gV(e))throw new Error(mm(n,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class SV{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function MS(n,t){let e=null;for(let i=0;i<t.length;i++){const s=t[i],l=s.getPath();e!==null&&!hS(l,e.path)&&(n.eventLists_.push(e),e=null),e===null&&(e={events:[],path:l}),e.events.push(s)}e&&n.eventLists_.push(e)}function r8(n,t,e){MS(n,e),l8(n,i=>hS(i,t))}function Uu(n,t,e){MS(n,e),l8(n,i=>nl(i,t)||nl(t,i))}function l8(n,t){n.recursionDepth_++;let e=!0;for(let i=0;i<n.eventLists_.length;i++){const s=n.eventLists_[i];if(s){const l=s.path;t(l)?(TV(n.eventLists_[i]),n.eventLists_[i]=null):e=!1}}e&&(n.eventLists_=[]),n.recursionDepth_--}function TV(n){for(let t=0;t<n.events.length;t++){const e=n.events[t];if(e!==null){n.events[t]=null;const i=e.getEventRunner();Ug&&Os("event: "+e.toString()),Gm(i)}}}const bV="repo_interrupt",CV=25;class wV{constructor(t,e,i,s){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=i,this.appCheckProvider_=s,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new SV,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=y1(),this.transactionQueueTree_=new DS,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function RV(n,t,e){if(n.stats_=oS(n.repoInfo_),n.forceRestClient_||sk())n.server_=new _1(n.repoInfo_,(i,s,l,c)=>{u3(n,i,s,l,c)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>c3(n,!0),0);else{if(typeof e<"u"&&e!==null){if(typeof e!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{cs(e)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}n.persistentConnection_=new Du(n.repoInfo_,t,(i,s,l,c)=>{u3(n,i,s,l,c)},i=>{c3(n,i)},i=>{NV(n,i)},n.authTokenProvider_,n.appCheckProvider_,e),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(i=>{n.server_.refreshAuthToken(i)}),n.appCheckProvider_.addTokenChangeListener(i=>{n.server_.refreshAppCheckToken(i.token)}),n.statsReporter_=uk(n.repoInfo_,()=>new oP(n.stats_,n.server_)),n.infoData_=new iP,n.infoSyncTree_=new r3({startListening:(i,s,l,c)=>{let f=[];const m=n.infoData_.getNode(i._path);return m.isEmpty()||(f=uv(n.infoSyncTree_,i._path,m),setTimeout(()=>{c("ok")},0)),f},stopListening:()=>{}}),kS(n,"connected",!1),n.serverSyncTree_=new r3({startListening:(i,s,l,c)=>(n.server_.listen(i,l,s,(f,m)=>{const g=c(f,m);Uu(n.eventQueue_,i._path,g)}),[]),stopListening:(i,s)=>{n.server_.unlisten(i,s)}})}function xV(n){const e=n.infoData_.getNode(new cn(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e}function LS(n){return lV({timestamp:xV(n)})}function u3(n,t,e,i,s){n.dataUpdateCount++;const l=new cn(t);e=n.interceptServerDataCallback_?n.interceptServerDataCallback_(t,e):e;let c=[];if(s)if(i){const m=Qy(e,g=>ki(g));c=nV(n.serverSyncTree_,l,m,s)}else{const m=ki(e);c=eV(n.serverSyncTree_,l,m,s)}else if(i){const m=Qy(e,g=>ki(g));c=ZP(n.serverSyncTree_,l,m)}else{const m=ki(e);c=uv(n.serverSyncTree_,l,m)}let f=l;c.length>0&&(f=dv(n,l)),Uu(n.eventQueue_,f,c)}function c3(n,t){kS(n,"connected",t),t===!1&&IV(n)}function NV(n,t){ta(t,(e,i)=>{kS(n,e,i)})}function kS(n,t,e){const i=new cn("/.info/"+t),s=ki(e);n.infoData_.updateSnapshot(i,s);const l=uv(n.infoSyncTree_,i,s);Uu(n.eventQueue_,i,l)}function o8(n){return n.nextWriteId_++}function DV(n,t,e,i,s){PS(n,"set",{path:t.toString(),value:e,priority:i});const l=LS(n),c=ki(e,i),f=TS(n.serverSyncTree_,t),m=$9(c,f,l),g=o8(n),A=K9(n.serverSyncTree_,t,m,g,!0);MS(n.eventQueue_,A),n.server_.put(t.toString(),c.val(!0),(T,x)=>{const R=T==="ok";R||Qa("set at "+t+" failed: "+T);const O=xf(n.serverSyncTree_,g,!R);Uu(n.eventQueue_,t,O),Cm(n,s,T,x)});const E=d8(n,t);dv(n,E),Uu(n.eventQueue_,E,[])}function IV(n){PS(n,"onDisconnectEvents");const t=LS(n),e=y1();CA(n.onDisconnect_,an(),(s,l)=>{const c=cV(s,l,n.serverSyncTree_,t);qm(e,s,c)});let i=[];CA(e,an(),(s,l)=>{i=i.concat(uv(n.serverSyncTree_,s,l));const c=d8(n,s);dv(n,c)}),n.onDisconnect_=y1(),Uu(n.eventQueue_,an(),i)}function OV(n,t,e){n.server_.onDisconnectCancel(t.toString(),(i,s)=>{i==="ok"&&bA(n.onDisconnect_,t),Cm(n,e,i,s)})}function h3(n,t,e,i){const s=ki(e);n.server_.onDisconnectPut(t.toString(),s.val(!0),(l,c)=>{l==="ok"&&qm(n.onDisconnect_,t,s),Cm(n,i,l,c)})}function MV(n,t,e,i,s){const l=ki(e,i);n.server_.onDisconnectPut(t.toString(),l.val(!0),(c,f)=>{c==="ok"&&qm(n.onDisconnect_,t,l),Cm(n,s,c,f)})}function LV(n,t,e,i){if(Yy(e)){Os("onDisconnect().update() called with empty data.  Don't do anything."),Cm(n,i,"ok",void 0);return}n.server_.onDisconnectMerge(t.toString(),e,(s,l)=>{s==="ok"&&ta(e,(c,f)=>{const m=ki(f);qm(n.onDisconnect_,Ti(t,c),m)}),Cm(n,i,s,l)})}function kV(n,t,e){let i;Ne(t._path)===".info"?i=l3(n.infoSyncTree_,t,e):i=l3(n.serverSyncTree_,t,e),r8(n.eventQueue_,t._path,i)}function PV(n,t,e){let i;Ne(t._path)===".info"?i=IA(n.infoSyncTree_,t,e):i=IA(n.serverSyncTree_,t,e),r8(n.eventQueue_,t._path,i)}function VV(n){n.persistentConnection_&&n.persistentConnection_.interrupt(bV)}function PS(n,...t){let e="";n.persistentConnection_&&(e=n.persistentConnection_.id+":"),Os(e,...t)}function Cm(n,t,e,i){t&&Gm(()=>{if(e==="ok")t(null);else{const s=(e||"error").toUpperCase();let l=s;i&&(l+=": "+i);const c=new Error(l);c.code=s,t(c)}})}function u8(n,t,e){return TS(n.serverSyncTree_,t,e)||ce.EMPTY_NODE}function VS(n,t=n.transactionQueueTree_){if(t||mv(n,t),Fm(t)){const e=h8(n,t);zt(e.length>0,"Sending zero length transaction queue"),e.every(s=>s.status===0)&&UV(n,z0(t),e)}else e8(t)&&hv(t,e=>{VS(n,e)})}function UV(n,t,e){const i=e.map(g=>g.currentWriteId),s=u8(n,t,i);let l=s;const c=s.hash();for(let g=0;g<e.length;g++){const A=e[g];zt(A.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),A.status=1,A.retryCount++;const E=Fa(t,A.path);l=l.updateChild(E,A.currentOutputSnapshotRaw)}const f=l.val(!0),m=t;n.server_.put(m.toString(),f,g=>{PS(n,"transaction put response",{path:m.toString(),status:g});let A=[];if(g==="ok"){const E=[];for(let T=0;T<e.length;T++)e[T].status=2,A=A.concat(xf(n.serverSyncTree_,e[T].currentWriteId)),e[T].onComplete&&E.push(()=>e[T].onComplete(null,!0,e[T].currentOutputSnapshotResolved)),e[T].unwatcher();mv(n,IS(n.transactionQueueTree_,t)),VS(n,n.transactionQueueTree_),Uu(n.eventQueue_,t,A);for(let T=0;T<E.length;T++)Gm(E[T])}else{if(g==="datastale")for(let E=0;E<e.length;E++)e[E].status===3?e[E].status=4:e[E].status=0;else{Qa("transaction at "+m.toString()+" failed: "+g);for(let E=0;E<e.length;E++)e[E].status=4,e[E].abortReason=g}dv(n,t)}},c)}function dv(n,t){const e=c8(n,t),i=z0(e),s=h8(n,e);return zV(n,s,i),i}function zV(n,t,e){if(t.length===0)return;const i=[];let s=[];const c=t.filter(f=>f.status===0).map(f=>f.currentWriteId);for(let f=0;f<t.length;f++){const m=t[f],g=Fa(e,m.path);let A=!1,E;if(zt(g!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),m.status===4)A=!0,E=m.abortReason,s=s.concat(xf(n.serverSyncTree_,m.currentWriteId,!0));else if(m.status===0)if(m.retryCount>=CV)A=!0,E="maxretry",s=s.concat(xf(n.serverSyncTree_,m.currentWriteId,!0));else{const T=u8(n,m.path,c);m.currentInputSnapshot=T;const x=t[f].update(T.val());if(x!==void 0){fv("transaction failed: Data returned ",x,m.path);let R=ki(x);typeof x=="object"&&x!=null&&ko(x,".priority")||(R=R.updatePriority(T.getPriority()));const M=m.currentWriteId,H=LS(n),B=$9(R,T,H);m.currentOutputSnapshotRaw=R,m.currentOutputSnapshotResolved=B,m.currentWriteId=o8(n),c.splice(c.indexOf(M),1),s=s.concat(K9(n.serverSyncTree_,m.path,B,m.currentWriteId,m.applyLocally)),s=s.concat(xf(n.serverSyncTree_,M,!0))}else A=!0,E="nodata",s=s.concat(xf(n.serverSyncTree_,m.currentWriteId,!0))}Uu(n.eventQueue_,e,s),s=[],A&&(t[f].status=2,(function(T){setTimeout(T,Math.floor(0))})(t[f].unwatcher),t[f].onComplete&&(E==="nodata"?i.push(()=>t[f].onComplete(null,!1,t[f].currentInputSnapshot)):i.push(()=>t[f].onComplete(new Error(E),!1,null))))}mv(n,n.transactionQueueTree_);for(let f=0;f<i.length;f++)Gm(i[f]);VS(n,n.transactionQueueTree_)}function c8(n,t){let e,i=n.transactionQueueTree_;for(e=Ne(t);e!==null&&Fm(i)===void 0;)i=IS(i,e),t=Sn(t),e=Ne(t);return i}function h8(n,t){const e=[];return f8(n,t,e),e.sort((i,s)=>i.order-s.order),e}function f8(n,t,e){const i=Fm(t);if(i)for(let s=0;s<i.length;s++)e.push(i[s]);hv(t,s=>{f8(n,s,e)})}function mv(n,t){const e=Fm(t);if(e){let i=0;for(let s=0;s<e.length;s++)e[s].status!==2&&(e[i]=e[s],i++);e.length=i,t8(t,e.length>0?e:void 0)}hv(t,i=>{mv(n,i)})}function d8(n,t){const e=z0(c8(n,t)),i=IS(n.transactionQueueTree_,t);return fV(i,s=>{b2(n,s)}),b2(n,i),n8(i,s=>{b2(n,s)}),e}function b2(n,t){const e=Fm(t);if(e){const i=[];let s=[],l=-1;for(let c=0;c<e.length;c++)e[c].status===3||(e[c].status===1?(zt(l===c-1,"All SENT items should be at beginning of queue."),l=c,e[c].status=3,e[c].abortReason="set"):(zt(e[c].status===0,"Unexpected transaction status in abort"),e[c].unwatcher(),s=s.concat(xf(n.serverSyncTree_,e[c].currentWriteId,!0)),e[c].onComplete&&i.push(e[c].onComplete.bind(null,new Error("set"),!1,null))));l===-1?t8(t,void 0):e.length=l+1,Uu(n.eventQueue_,z0(t),s);for(let c=0;c<i.length;c++)Gm(i[c])}}function BV(n){let t="";const e=n.split("/");for(let i=0;i<e.length;i++)if(e[i].length>0){let s=e[i];try{s=decodeURIComponent(s.replace(/\+/g," "))}catch{}t+="/"+s}return t}function jV(n){const t={};n.charAt(0)==="?"&&(n=n.substring(1));for(const e of n.split("&")){if(e.length===0)continue;const i=e.split("=");i.length===2?t[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):Qa(`Invalid query segment '${e}' in query '${n}'`)}return t}const f3=function(n,t){const e=HV(n),i=e.namespace;e.domain==="firebase.com"&&Vu(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!i||i==="undefined")&&e.domain!=="localhost"&&Vu("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||KL();const s=e.scheme==="ws"||e.scheme==="wss";return{repoInfo:new v9(e.host,e.secure,i,s,t,"",i!==e.subdomain),path:new cn(e.pathString)}},HV=function(n){let t="",e="",i="",s="",l="",c=!0,f="https",m=443;if(typeof n=="string"){let g=n.indexOf("//");g>=0&&(f=n.substring(0,g-1),n=n.substring(g+2));let A=n.indexOf("/");A===-1&&(A=n.length);let E=n.indexOf("?");E===-1&&(E=n.length),t=n.substring(0,Math.min(A,E)),A<E&&(s=BV(n.substring(A,E)));const T=jV(n.substring(Math.min(n.length,E)));g=t.indexOf(":"),g>=0?(c=f==="https"||f==="wss",m=parseInt(t.substring(g+1),10)):g=t.length;const x=t.slice(0,g);if(x.toLowerCase()==="localhost")e="localhost";else if(x.split(".").length<=2)e=x;else{const R=t.indexOf(".");i=t.substring(0,R).toLowerCase(),e=t.substring(R+1),l=i}"ns"in T&&(l=T.ns)}return{host:t,port:m,domain:e,subdomain:i,secure:c,scheme:f,pathString:s,namespace:l}};class GV{constructor(t,e,i,s){this.eventType=t,this.eventRegistration=e,this.snapshot=i,this.prevName=s}getPath(){const t=this.snapshot.ref;return this.eventType==="value"?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+cs(this.snapshot.exportVal())}}class qV{constructor(t,e,i){this.eventRegistration=t,this.error=e,this.path=i}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class FV{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return zt(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class YV{constructor(t,e){this._repo=t,this._path=e}cancel(){const t=new Su;return OV(this._repo,this._path,t.wrapCallback(()=>{})),t.promise}remove(){bg("OnDisconnect.remove",this._path);const t=new Su;return h3(this._repo,this._path,null,t.wrapCallback(()=>{})),t.promise}set(t){bg("OnDisconnect.set",this._path),MA("OnDisconnect.set",t,this._path);const e=new Su;return h3(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}setWithPriority(t,e){bg("OnDisconnect.setWithPriority",this._path),MA("OnDisconnect.setWithPriority",t,this._path),vV("OnDisconnect.setWithPriority",e);const i=new Su;return MV(this._repo,this._path,t,e,i.wrapCallback(()=>{})),i.promise}update(t){bg("OnDisconnect.update",this._path),yV("OnDisconnect.update",t,this._path);const e=new Su;return LV(this._repo,this._path,t,e.wrapCallback(()=>{})),e.promise}}class US{constructor(t,e,i,s){this._repo=t,this._path=e,this._queryParams=i,this._orderByCalled=s}get key(){return Me(this._path)?null:cS(this._path)}get ref(){return new Ah(this._repo,this._path)}get _queryIdentifier(){const t=Kb(this._queryParams),e=rS(t);return e==="{}"?"default":e}get _queryObject(){return Kb(this._queryParams)}isEqual(t){if(t=On(t),!(t instanceof US))return!1;const e=this._repo===t._repo,i=hS(this._path,t._path),s=this._queryIdentifier===t._queryIdentifier;return e&&i&&s}toJSON(){return this.toString()}toString(){return this._repo.toString()+Ok(this._path)}}class Ah extends US{constructor(t,e){super(t,e,new pS,!1)}get parent(){const t=x9(this._path);return t===null?null:new Ah(this._repo,t)}get root(){let t=this;for(;t.parent!==null;)t=t.parent;return t}}class w1{constructor(t,e,i){this._node=t,this.ref=e,this._index=i}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new cn(t),i=LA(this.ref,t);return new w1(this._node.getChild(e),i,ri)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(i,s)=>t(new w1(s,LA(this.ref,i),ri)))}hasChild(t){const e=new cn(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function wm(n,t){return n=On(n),n._checkNotDeleted("ref"),t!==void 0?LA(n._root,t):n._root}function LA(n,t){return n=On(n),Ne(n._path)===null?AV("child","path",t):a8("child","path",t),new Ah(n._repo,Ti(n._path,t))}function d3(n){return n=On(n),new YV(n._repo,n._path)}function kA(n,t){n=On(n),bg("set",n._path),MA("set",t,n._path);const e=new Su;return DV(n._repo,n._path,t,null,e.wrapCallback(()=>{})),e.promise}class zS{constructor(t){this.callbackContext=t}respondsTo(t){return t==="value"}createEvent(t,e){const i=e._queryParams.getIndex();return new GV("value",this,new w1(t.snapshotNode,new Ah(e._repo,e._path),i))}getEventRunner(t){return t.getEventType()==="cancel"?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new qV(this,t,e):null}matches(t){return t instanceof zS?!t.callbackContext||!this.callbackContext?!0:t.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}function QV(n,t,e,i,s){const l=new FV(e,void 0),c=new zS(l);return kV(n._repo,n,c),()=>PV(n._repo,n,c)}function m8(n,t,e,i){return QV(n,"value",t)}GP(Ah);KP(Ah);const XV="FIREBASE_DATABASE_EMULATOR_HOST",PA={};let KV=!1;function WV(n,t,e,i){const s=t.lastIndexOf(":"),l=t.substring(0,s),c=ph(l);n.repoInfo_=new v9(t,c,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0,e),i&&(n.authTokenProvider_=i)}function JV(n,t,e,i,s){let l=i||n.options.databaseURL;l===void 0&&(n.options.projectId||Vu("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Os("Using default host for project ",n.options.projectId),l=`${n.options.projectId}-default-rtdb.firebaseio.com`);let c=f3(l,s),f=c.repoInfo,m;typeof process<"u"&&Ib&&(m=Ib[XV]),m?(l=`http://${m}?ns=${f.namespace}`,c=f3(l,s),f=c.repoInfo):c.repoInfo.secure;const g=new rk(n.name,n.options,t);EV("Invalid Firebase Database URL",c),Me(c.path)||Vu("Database URL must point to the root of a Firebase Database (not including a child path).");const A=$V(f,n,g,new ak(n,e));return new tU(A,n)}function ZV(n,t){const e=PA[t];(!e||e[n.key]!==n)&&Vu(`Database ${t}(${n.repoInfo_}) has already been deleted.`),VV(n),delete e[n.key]}function $V(n,t,e,i){let s=PA[t.name];s||(s={},PA[t.name]=s);let l=s[n.toURLString()];return l&&Vu("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),l=new wV(n,KV,e,i),s[n.toURLString()]=l,l}class tU{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(RV(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ah(this._repo,an())),this._rootInternal}_delete(){return this._rootInternal!==null&&(ZV(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){this._rootInternal===null&&Vu("Cannot call "+t+" on a deleted database.")}}function eU(n=fE(),t){const e=P1(n,"database").getImmediate({identifier:t});if(!e._instanceStarted){const i=OC("database");i&&nU(e,...i)}return e}function nU(n,t,e,i={}){n=On(n),n._checkNotDeleted("useEmulator");const s=`${t}:${e}`,l=n._repoInternal;if(n._instanceStarted){if(s===n._repoInternal.repoInfo_.host&&ah(i,l.repoInfo_.emulatorOptions))return;Vu("connectDatabaseEmulator() cannot initialize or alter the emulator configuration after the database instance has started.")}let c;if(l.repoInfo_.nodeAdmin)i.mockUserToken&&Vu('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),c=new By(By.OWNER);else if(i.mockUserToken){const f=typeof i.mockUserToken=="string"?i.mockUserToken:kC(i.mockUserToken,n.app.options.projectId);c=new By(f)}ph(t)&&(oE(t),uE("Database",!0)),WV(l,s,i,c)}function iU(n){GL(Bf),Df(new rh("database",(t,{instanceIdentifier:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),l=t.getProvider("app-check-internal");return JV(i,s,l,e)},"PUBLIC").setMultipleInstances(!0)),Ro(Ob,Mb,n),Ro(Ob,Mb,"esm2017")}Du.prototype.simpleListen=function(n,t){this.sendRequest("q",{p:n},t)};Du.prototype.echo=function(n,t){this.sendRequest("echo",{d:n},t)};iU();const sU={apiKey:"AIzaSyBRoQv-CjY6LEEY2rAyX6Gp9PD0Q5vZZCA",authDomain:"vellum-6f172.firebaseapp.com",projectId:"vellum-6f172",storageBucket:"vellum-6f172.firebasestorage.app",messagingSenderId:"865208426663",appId:"1:865208426663:web:196559740c44bb241bfb82",databaseURL:"https://vellum-6f172-default-rtdb.firebaseio.com"};let Ef,C2,w2,R2;function aU(){return typeof Ef<"u"?{app:Ef,auth:C2,db:w2,rtdb:R2}:(Ef=BC(sU),C2=zI(Ef),w2=q6(Ef),R2=eU(Ef),{app:Ef,auth:C2,db:w2,rtdb:R2})}const{app:KG,auth:Ms,db:Xa,rtdb:Rm}=aU();async function rU(n,t){return SD(Ms,n,t)}async function lU(n,t,e){const i=await ED(Ms,n,t);return e?.trim()&&await bD(i.user,{displayName:e.trim()}),i}async function oU(){return xD(Ms)}function uU(n){return RD(Ms,n)}const p8=j.createContext(null);function cU({children:n}){const[t,e]=j.useState(null),[i,s]=j.useState(!0);return j.useEffect(()=>uU(c=>{e(c),s(!1)}),[]),I.jsx(p8.Provider,{value:{user:t,loading:i},children:n})}function BS(){const n=j.useContext(p8);if(!n)throw new Error("useAuth must be used within AuthProvider");return n}function hU(){const n=zf();function t(){document.getElementById("about")?.scrollIntoView({behavior:"smooth"})}return I.jsxs("div",{className:"landing-page",children:[I.jsxs("nav",{className:"landing-nav",children:[I.jsx("span",{className:"landing-logo",children:"Vellum"}),I.jsxs("div",{className:"landing-nav-actions",children:[I.jsx("button",{type:"button",className:"landing-nav-btn",onClick:t,children:"About"}),I.jsx("button",{type:"button",className:"landing-nav-btn",onClick:()=>n("/login"),children:"Login"}),I.jsx("button",{type:"button",className:"landing-nav-btn landing-nav-btn-primary",onClick:()=>n("/login"),children:"Sign Up"})]})]}),I.jsxs("main",{className:"landing-main",children:[I.jsxs("section",{className:"landing-hero",children:[I.jsx("h1",{className:"landing-hero-title",children:"From rough ideas to real plans."}),I.jsx("button",{type:"button",className:"landing-hero-cta",onClick:()=>n("/login"),children:"Get Started"}),I.jsx("p",{className:"landing-hero-subtext",children:"Canvas-first planning with a clean, collaborative experience."})]}),I.jsxs("section",{id:"about",className:"landing-about",children:[I.jsx("h2",{className:"landing-about-title",children:"About"}),I.jsx("p",{className:"landing-about-content",children:"Under construction"})]})]})]})}function fU(){const n=zf(),e=Lo().state?.from??"/dashboard",[i,s]=j.useState(""),[l,c]=j.useState(""),[f,m]=j.useState(""),[g,A]=j.useState(!1),[E,T]=j.useState(null),[x,R]=j.useState(!1);async function O(M){M.preventDefault(),T(null),R(!0);try{g?await lU(l,f,i):await rU(l,f),n(e,{replace:!0})}catch(H){const B=H instanceof Error?H.message:"Something went wrong";B.includes("password")?T("Incorrect password"):B.includes("email")||B.includes("user")?T("Invalid email or user not found"):T(B)}finally{R(!1)}}return I.jsx("div",{className:"login-page",children:I.jsxs("div",{className:"login-card",children:[I.jsx("h1",{children:"Vellum"}),I.jsx("p",{className:"login-subtitle",children:"Real-time collaborative whiteboard"}),I.jsxs("form",{onSubmit:O,className:"login-form",children:[g&&I.jsx("input",{type:"text",placeholder:"Username",value:i,onChange:M=>s(M.target.value),autoComplete:"username"}),I.jsx("input",{type:"email",placeholder:"Email",value:l,onChange:M=>c(M.target.value),required:!0,autoComplete:"email"}),I.jsx("input",{type:"password",placeholder:"Password",value:f,onChange:M=>m(M.target.value),required:!0,autoComplete:g?"new-password":"current-password"}),E&&I.jsx("p",{className:"login-error",children:E}),I.jsx("button",{type:"submit",disabled:x,children:x?"Please wait":g?"Create account":"Sign in"})]}),I.jsx("button",{type:"button",className:"login-toggle",onClick:()=>{A(M=>!M),T(null),s("")},children:g?"Already have an account? Sign in":"Need an account? Sign up"})]})})}const dU="modulepreload",mU=function(n){return"/"+n},m3={},jS=function(t,e,i){let s=Promise.resolve();if(e&&e.length>0){let g=function(A){return Promise.all(A.map(E=>Promise.resolve(E).then(T=>({status:"fulfilled",value:T}),T=>({status:"rejected",reason:T}))))};var c=g;document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),m=f?.nonce||f?.getAttribute("nonce");s=g(e.map(A=>{if(A=mU(A),A in m3)return;m3[A]=!0;const E=A.endsWith(".css"),T=E?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${A}"]${T}`))return;const x=document.createElement("link");if(x.rel=E?"stylesheet":dU,E||(x.as="script"),x.crossOrigin="",x.href=A,m&&x.setAttribute("nonce",m),document.head.appendChild(x),E)return new Promise((R,O)=>{x.addEventListener("load",R),x.addEventListener("error",()=>O(new Error(`Unable to preload CSS for ${A}`)))})}))}function l(f){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=f,window.dispatchEvent(m),!m.defaultPrevented)throw f}return s.then(f=>{for(const m of f||[])m.status==="rejected"&&l(m.reason);return t().catch(l)})},B0="boards",HS="members";function g8(){return Hm(Xa,B0)}function j0(n){return qu(Xa,B0,n)}function pU(n){return Hm(Xa,B0,n,HS)}function pv(n,t){return qu(Xa,B0,n,HS,t)}async function _8(n){const t=Ms.currentUser;if(!t)throw new Error("Not authenticated");const e={name:n||"Untitled Board",ownerId:t.uid,publicAccess:"none",createdAt:Ui(),updatedAt:Ui()},i=await M0(g8(),e);return console.log("[board] createBoard saved to Firestore:",{boardId:i.id,name:n,ownerId:t.uid}),console.log("[board] createBoard saved to Firestore:",{boardId:i.id,name:n,ownerId:t.uid}),await O0(pv(i.id,t.uid),{userId:t.uid,email:t.email??"",displayName:t.displayName??null,role:"edit",addedAt:Ui()}),i.id}async function zu(n){const t=await iv(j0(n));if(!t.exists())return null;const e=t.data();return{id:t.id,...e,publicAccess:e.publicAccess??"none"}}async function GS(n,t){await vh(j0(n),{...t,updatedAt:Ui()})}async function y8(n){const t=Ms.currentUser;if(!t)throw new Error("Not authenticated");const e=await zu(n);if(!e||e.ownerId!==t.uid)throw new Error("Only the board owner can delete it");await sv(j0(n))}function p3(n){return[...n].sort((t,e)=>{const i=t.updatedAt?.toMillis?.()??0;return(e.updatedAt?.toMillis?.()??0)-i})}function v8(n){const t=Ms.currentUser;if(!t)return n({owned:[],shared:[]}),()=>{};let e=[],i=[];const s=()=>{const f=new Set(e.map(g=>g.id)),m=i.filter(g=>!f.has(g.id));n({owned:p3(e),shared:p3(m)})},l=s0(d1(g8(),i0("ownerId","==",t.uid)),f=>{e=f.docs.map(m=>{const g=m.data();return{id:m.id,...g}}),s()},f=>{console.error("[board] subscribeToBoardsForUser (owned):",f),e=[],s()});let c=()=>{};try{c=s0(d1(JE(Xa,HS),i0("userId","==",t.uid)),async f=>{const m=new Set;f.docs.forEach(E=>{const T=E.ref.path.split("/"),x=T.indexOf(B0);x>=0&&T[x+1]&&m.add(T[x+1])});const g=[...m],A=[];for(const E of g){const T=await zu(E);T&&T.ownerId!==t.uid&&A.push(T)}i=A,s()},f=>{console.warn("[board] subscribeToBoardsForUser (shared) failed, showing owned only:",f.message),i=[],s()})}catch(f){console.warn("[board] subscribeToBoardsForUser (shared) setup failed:",f)}return()=>{l(),c()}}async function VA(n){return(await aS(pU(n))).docs.map(e=>{const i=e.data();return{...i,addedAt:i.addedAt}})}async function A8(n,t,e,i,s){const l=Ms.currentUser?.uid;l&&t!==l&&await vh(j0(n),{updatedAt:Ui()}),await O0(pv(n,t),{userId:t,email:e,displayName:i,role:s,addedAt:Ui()})}async function E8(n,t){await vh(j0(n),{updatedAt:Ui()});const e=pv(n,t),{deleteDoc:i}=await jS(async()=>{const{deleteDoc:s}=await Promise.resolve().then(()=>s9);return{deleteDoc:s}},[]);await i(e)}async function qS(n){const t=Ms.currentUser;if(!t)return null;const e=await zu(n);if(!e)return null;if(e.ownerId===t.uid)return"owner";const i=await iv(pv(n,t.uid));if(i.exists())return i.data().role??null;const s=e.publicAccess??"none";return s==="edit"?"edit":s==="view"?"view":null}async function UA(n){const t=await qS(n);return t==="owner"||t==="edit"}const gU=Object.freeze(Object.defineProperty({__proto__:null,addBoardMember:A8,canCurrentUserEdit:UA,createBoard:_8,deleteBoard:y8,getBoard:zu,getBoardMembers:VA,getCurrentUserRole:qS,removeBoardMember:E8,subscribeToBoardsForUser:v8,updateBoard:GS},Symbol.toStringTag,{value:"Module"})),FS="invites";function _U(n){return Hm(Xa,"boards",n,FS)}function S8(n,t){return qu(Xa,"boards",n,FS,t)}async function yU(n){const t=Ms.currentUser;if(!t)throw new Error("Not authenticated");const e=await zu(n.boardId);if(!e||e.ownerId!==t.uid)throw new Error("Only the board owner can send invites");const s={email:n.email.trim().toLowerCase(),role:n.role,invitedBy:t.uid,invitedByName:t.displayName??null,status:"pending",createdAt:Ui(),updatedAt:Ui()};return(await M0(_U(n.boardId),s)).id}async function vU(n){const t=n.trim().toLowerCase();return(await aS(d1(JE(Xa,FS),i0("email","==",t),i0("status","==","pending")))).docs.map(i=>{const s=i.data(),l=i.ref.parent.parent?.id??"";return{id:i.id,boardId:l,...s}})}function T8(){const n=Ms.currentUser;if(!n)return null;if(n.email)return n.email.trim().toLowerCase();const t=n.providerData?.[0];return t?.email?t.email.trim().toLowerCase():null}async function Cg(){const n=T8();if(!n)return[];try{return await vU(n)}catch(t){return console.error("[invites] getMyPendingInvites failed:",t),[]}}async function AU(n){return(await Cg()).find(e=>e.boardId===n)??null}async function b8(n,t){const e=Ms.currentUser;if(!e)throw new Error("Not authenticated");const i=S8(n,t),s=await iv(i);if(!s.exists())throw new Error("Invite not found");const l=s.data();if(l.status!=="pending")throw new Error("Invite already used");const c=T8();if(!c||l.email!==c)throw new Error("This invite was sent to a different email");try{await A8(n,e.uid,e.email??"",e.displayName??null,l.role)}catch(f){throw console.error("[invites] addBoardMember failed:",f),new Error("Failed to join board. You may already be a member.")}try{await vh(i,{status:"accepted",updatedAt:Ui()})}catch(f){throw console.error("[invites] updateDoc invite failed:",f),new Error("Failed to update invite. You have been added to the board.")}}async function EU(n,t){const e=S8(n,t);await vh(e,{status:"rejected",updatedAt:Ui()})}const g3=["#4f46e5","#059669","#dc2626","#d97706","#7c3aed","#0891b2"];function _3(n){let t=0;for(let e=0;e<n.length;e++)t=(t<<5)-t+n.charCodeAt(e);return g3[Math.abs(t)%g3.length]}function y3(n){if(!n?.toMillis)return"";const t=new Date(n.toMillis()),e=new Date,i=e.getTime()-t.getTime();return e.toDateString()===t.toDateString()?"Today":i<864e5*2?"Yesterday":i<864e5*7?t.toLocaleDateString("en-US",{weekday:"short"}):t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}function SU(n){return n?.toMillis?new Date(n.toMillis()).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):""}function TU({ownedBoards:n,sharedBoards:t,currentUserId:e,onOpen:i,onShare:s,onDelete:l,onCreateBoard:c}){const[f,m]=j.useState("all"),[g,A]=j.useState("lastOpened"),[E,T]=j.useState("list"),[x,R]=j.useState(new Set),[O,M]=j.useState(null),H=j.useMemo(()=>{const X=n.map(k=>({...k,isOwner:!0})),L=t.map(k=>({...k,isOwner:!1}));return[...X,...L]},[n,t]),B=j.useMemo(()=>{let X=H;return f==="created"?X=X.filter(L=>L.isOwner):f==="shared"&&(X=X.filter(L=>!L.isOwner)),X},[H,f]),Y=j.useMemo(()=>[...B].sort((X,L)=>{if(g==="name")return(X.name||"").localeCompare(L.name||"");if(g==="dateCreated"){const q=X.createdAt?.toMillis?.()??0;return(L.createdAt?.toMillis?.()??0)-q}if(g==="dateModified"){const q=X.updatedAt?.toMillis?.()??0;return(L.updatedAt?.toMillis?.()??0)-q}const k=X.updatedAt?.toMillis?.()??0;return(L.updatedAt?.toMillis?.()??0)-k}),[B,g]),$=(X,L)=>{L.stopPropagation(),R(k=>{const V=new Set(k);return V.has(X)?V.delete(X):V.add(X),V})},nt=(X,L,k,V)=>{if(V.stopPropagation(),M(null),L==="share"&&s(X),L==="delete"&&l(X),L==="removeFromDashboard"&&E8(X,e),L==="rename"&&k){const q=prompt("Rename board:");q&&jS(async()=>{const{updateBoard:Q}=await Promise.resolve().then(()=>gU);return{updateBoard:Q}},void 0).then(({updateBoard:Q})=>Q(X,{name:q}))}};return I.jsxs("div",{className:"board-list-section",children:[I.jsxs("div",{className:"board-list-header",children:[I.jsx("h2",{className:"board-list-heading",children:"Your Boards"}),I.jsxs("div",{className:"board-list-header-actions",children:[I.jsx("button",{type:"button",className:"board-list-btn-secondary",children:"Explore templates"}),I.jsx("button",{type:"button",className:"board-list-btn-primary",onClick:c,children:"+ Create new"})]})]}),I.jsxs("div",{className:"board-list-filters",children:[I.jsx("div",{className:"board-list-filters-left",children:I.jsx("label",{className:"board-list-filter-label",children:I.jsxs("select",{value:f,onChange:X=>m(X.target.value),className:"board-list-select",children:[I.jsx("option",{value:"all",children:"All"}),I.jsx("option",{value:"shared",children:"Shared with me"}),I.jsx("option",{value:"created",children:"Created by me"})]})})}),I.jsxs("div",{className:"board-list-filters-right",children:[I.jsxs("label",{className:"board-list-filter-label",children:["Sort by",I.jsxs("select",{value:g,onChange:X=>A(X.target.value),className:"board-list-select",children:[I.jsx("option",{value:"lastOpened",children:"Last opened"}),I.jsx("option",{value:"name",children:"Name"}),I.jsx("option",{value:"dateCreated",children:"Date created"}),I.jsx("option",{value:"dateModified",children:"Date modified"})]})]}),I.jsxs("div",{className:"board-list-view-toggle",children:[I.jsx("button",{type:"button",className:`board-list-view-btn ${E==="grid"?"board-list-view-btn-active":""}`,title:"Grid view","aria-label":"Grid view",onClick:()=>T("grid"),children:I.jsx(bU,{})}),I.jsx("button",{type:"button",className:`board-list-view-btn ${E==="list"?"board-list-view-btn-active":""}`,title:"List view","aria-label":"List view",onClick:()=>T("list"),children:I.jsx(CU,{})})]})]})]}),E==="list"?I.jsx("div",{className:"board-list-table-wrapper",children:I.jsxs("table",{className:"board-list-table",children:[I.jsx("thead",{children:I.jsxs("tr",{children:[I.jsx("th",{className:"board-list-th-name",children:"Name"}),I.jsx("th",{className:"board-list-th-center",children:"Online users"}),I.jsx("th",{className:"board-list-th-center",children:"Last opened"}),I.jsx("th",{className:"board-list-th-center",children:"Owner"}),I.jsx("th",{className:"board-list-th-actions"})]})}),I.jsx("tbody",{children:Y.length===0?null:Y.map((X,L)=>{const k=L>=Y.length-3;return I.jsxs("tr",{className:"board-list-row",onClick:()=>i(X.id),children:[I.jsx("td",{className:"board-list-td-name",children:I.jsxs("div",{className:"board-list-name-cell",children:[I.jsx("span",{className:"board-list-icon",style:{backgroundColor:_3(X.id)}}),I.jsxs("div",{children:[I.jsx("span",{className:"board-list-name",children:X.name||"Untitled Board"}),I.jsxs("span",{className:"board-list-subtitle",children:["Modified ",SU(X.updatedAt)]})]})]})}),I.jsx("td",{className:"board-list-td-center",children:""}),I.jsx("td",{className:"board-list-td-center",children:y3(X.updatedAt)}),I.jsx("td",{className:"board-list-td-center",children:X.isOwner?"You":"Shared"}),I.jsxs("td",{className:"board-list-td-actions",children:[I.jsx("button",{type:"button",className:"board-list-action-btn",onClick:V=>$(X.id,V),title:x.has(X.id)?"Remove from favorites":"Add to favorites",children:x.has(X.id)?I.jsx("span",{className:"board-list-star-filled",children:I.jsx(A3,{})}):I.jsx(v3,{})}),I.jsxs("div",{className:"board-list-menu-wrapper",children:[I.jsx("button",{type:"button",className:"board-list-action-btn",onClick:V=>{V.stopPropagation(),M(O===X.id?null:X.id)},title:"More actions",children:I.jsx(E3,{})}),O===X.id&&I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"board-list-menu-backdrop",onClick:V=>{V.stopPropagation(),M(null)}}),I.jsxs("div",{className:`board-list-menu ${k?"board-list-menu-up":""}`,children:[X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item",onClick:V=>nt(X.id,"share",X.isOwner,V),children:"Share"}),X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item",onClick:V=>nt(X.id,"rename",X.isOwner,V),children:"Rename"}),X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item board-list-menu-item-danger",onClick:V=>nt(X.id,"delete",X.isOwner,V),children:"Delete"}),!X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item board-list-menu-item-danger",onClick:V=>nt(X.id,"removeFromDashboard",X.isOwner,V),children:"Remove from Dashboard"})]})]})]})]})]},X.id)})})]})}):I.jsx("div",{className:"board-list-grid",children:Y.map((X,L)=>{const k=L>=Y.length-3;return I.jsxs("div",{className:"board-list-grid-card",onClick:()=>i(X.id),children:[I.jsx("div",{className:"board-list-grid-thumb",style:{backgroundColor:_3(X.id)}}),I.jsxs("div",{className:"board-list-grid-body",children:[I.jsx("span",{className:"board-list-grid-name",children:X.name||"Untitled Board"}),I.jsxs("span",{className:"board-list-grid-meta",children:[X.isOwner?"You":"Shared","  ",y3(X.updatedAt)]})]}),I.jsxs("div",{className:"board-list-grid-actions",children:[I.jsx("button",{type:"button",className:"board-list-action-btn",onClick:V=>$(X.id,V),title:x.has(X.id)?"Remove from favorites":"Add to favorites",children:x.has(X.id)?I.jsx("span",{className:"board-list-star-filled",children:I.jsx(A3,{})}):I.jsx(v3,{})}),I.jsxs("div",{className:"board-list-menu-wrapper",children:[I.jsx("button",{type:"button",className:"board-list-action-btn",onClick:V=>{V.stopPropagation(),M(O===X.id?null:X.id)},title:"More actions",children:I.jsx(E3,{})}),O===X.id&&I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"board-list-menu-backdrop",onClick:V=>{V.stopPropagation(),M(null)}}),I.jsxs("div",{className:`board-list-menu ${k?"board-list-menu-up":""}`,children:[X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item",onClick:V=>nt(X.id,"share",X.isOwner,V),children:"Share"}),X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item",onClick:V=>nt(X.id,"rename",X.isOwner,V),children:"Rename"}),X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item board-list-menu-item-danger",onClick:V=>nt(X.id,"delete",X.isOwner,V),children:"Delete"}),!X.isOwner&&I.jsx("button",{type:"button",className:"board-list-menu-item board-list-menu-item-danger",onClick:V=>nt(X.id,"removeFromDashboard",X.isOwner,V),children:"Remove from Dashboard"})]})]})]})]})]},X.id)})}),H.length===0&&I.jsx("div",{className:"board-list-empty",children:I.jsx("p",{children:"No boards yet. Create one to get started."})})]})}function bU(){return I.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[I.jsx("rect",{x:"3",y:"3",width:"7",height:"7"}),I.jsx("rect",{x:"14",y:"3",width:"7",height:"7"}),I.jsx("rect",{x:"3",y:"14",width:"7",height:"7"}),I.jsx("rect",{x:"14",y:"14",width:"7",height:"7"})]})}function CU(){return I.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[I.jsx("line",{x1:"8",y1:"6",x2:"21",y2:"6"}),I.jsx("line",{x1:"8",y1:"12",x2:"21",y2:"12"}),I.jsx("line",{x1:"8",y1:"18",x2:"21",y2:"18"}),I.jsx("line",{x1:"3",y1:"6",x2:"3.01",y2:"6"}),I.jsx("line",{x1:"3",y1:"12",x2:"3.01",y2:"12"}),I.jsx("line",{x1:"3",y1:"18",x2:"3.01",y2:"18"})]})}function v3(){return I.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:I.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}function A3(){return I.jsx("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",stroke:"currentColor",strokeWidth:"2",children:I.jsx("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})})}function E3(){return I.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"currentColor",children:[I.jsx("circle",{cx:"12",cy:"6",r:"1.5"}),I.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),I.jsx("circle",{cx:"12",cy:"18",r:"1.5"})]})}function wU({onClose:n,onCreate:t}){const[e,i]=j.useState(""),[s,l]=j.useState(!1),[c,f]=j.useState(null),m=j.useRef(null);j.useEffect(()=>{m.current?.focus()},[]);async function g(A){A.preventDefault();const E=e.trim();if(!E){f("Please enter a board name");return}f(null),l(!0);try{await t(E),n()}catch(T){f(T instanceof Error?T.message:"Failed to create board")}finally{l(!1)}}return I.jsx("div",{className:"modal-overlay",onClick:n,children:I.jsxs("div",{className:"modal create-board-modal",onClick:A=>A.stopPropagation(),children:[I.jsxs("div",{className:"modal-header",children:[I.jsx("h2",{children:"Create New Board"}),I.jsx("button",{type:"button",className:"modal-close",onClick:n,"aria-label":"Close",children:""})]}),I.jsxs("form",{onSubmit:g,className:"create-board-form",children:[I.jsx("label",{htmlFor:"board-name",children:"Board name"}),I.jsx("input",{ref:m,id:"board-name",type:"text",placeholder:"Enter board name",value:e,onChange:A=>i(A.target.value),disabled:s,autoComplete:"off"}),c&&I.jsx("p",{className:"create-board-error",children:c}),I.jsxs("div",{className:"create-board-actions",children:[I.jsx("button",{type:"button",className:"btn-secondary",onClick:n,children:"Cancel"}),I.jsx("button",{type:"submit",className:"btn-primary",disabled:s,children:s?"Creating":"Create"})]})]})]})})}function C8({boardId:n,onClose:t,onBoardUpdated:e}){const[i,s]=j.useState("email"),[l,c]=j.useState(""),[f,m]=j.useState("edit"),[g,A]=j.useState([]),[E,T]=j.useState(!1),[x,R]=j.useState(null),[O,M]=j.useState(null),[H,B]=j.useState(!1),[Y,$]=j.useState("none"),[nt,X]=j.useState(!1),L=typeof window<"u"?`${window.location.origin}/board/${n}`:"",k=Y==="view"||Y==="edit";j.useEffect(()=>{VA(n).then(A),zu(n).then(F=>{F&&$(F.publicAccess??"none")})},[n]);async function V(F){F.preventDefault(),R(null),M(null),T(!0);try{await yU({boardId:n,email:l.trim(),role:f}),M(`Invite sent to ${l.trim()}`),c(""),VA(n).then(A)}catch(G){R(G instanceof Error?G.message:"Failed to send invite")}finally{T(!1)}}async function q(){try{await navigator.clipboard.writeText(L),B(!0),setTimeout(()=>B(!1),2e3)}catch{R("Failed to copy link")}}async function Q(F,G){R(null),M(null),X(!0);try{const Ot=F?G??"edit":"none";await GS(n,{publicAccess:Ot}),$(Ot),e?.(),M(F?"Link is now public. Anyone with the link can access.":"Public link disabled.")}catch(Ot){R(Ot instanceof Error?Ot.message:"Failed to update link access")}finally{X(!1)}}return I.jsx("div",{className:"modal-overlay",onClick:t,children:I.jsxs("div",{className:"modal invite-modal",onClick:F=>F.stopPropagation(),children:[I.jsxs("div",{className:"modal-header",children:[I.jsx("h2",{children:"Share board"}),I.jsx("button",{type:"button",className:"modal-close",onClick:t,"aria-label":"Close",children:""})]}),I.jsxs("div",{className:"invite-tabs",children:[I.jsx("button",{type:"button",className:`invite-tab ${i==="email"?"active":""}`,onClick:()=>s("email"),children:"Invite by Email"}),I.jsx("button",{type:"button",className:`invite-tab ${i==="link"?"active":""}`,onClick:()=>s("link"),children:"Share Link"})]}),i==="email"&&I.jsxs("form",{onSubmit:V,className:"invite-form",children:[I.jsxs("div",{className:"invite-form-row",children:[I.jsx("input",{type:"email",placeholder:"Email address",value:l,onChange:F=>c(F.target.value),required:!0}),I.jsxs("select",{value:f,onChange:F=>m(F.target.value),children:[I.jsx("option",{value:"edit",children:"Can Edit"}),I.jsx("option",{value:"view",children:"Can View"})]}),I.jsx("button",{type:"submit",disabled:E,children:E?"Sending":"Send invite"})]}),x&&I.jsx("p",{className:"invite-error",children:x}),O&&I.jsx("p",{className:"invite-success",children:O})]}),i==="link"&&I.jsxs("div",{className:"invite-link-section",children:[I.jsx("p",{className:"invite-link-intro",children:"Share this link so others can access the board. Enable the option below for the link to work."}),I.jsxs("div",{className:"invite-link-row",children:[I.jsx("input",{type:"text",readOnly:!0,value:L,className:"invite-link-input"}),I.jsx("button",{type:"button",className:"invite-copy-btn",onClick:q,children:H?"Copied!":"Copy link"})]}),I.jsxs("div",{className:"invite-public-toggle",children:[I.jsxs("label",{className:"invite-toggle-label",children:[I.jsx("input",{type:"checkbox",checked:k,onChange:F=>Q(F.target.checked,F.target.checked?Y==="none"?"edit":Y:void 0),disabled:nt}),I.jsx("span",{children:"Anyone with the link can"})]}),k&&I.jsxs("select",{value:Y,onChange:F=>Q(!0,F.target.value),disabled:nt,className:"invite-public-select",children:[I.jsx("option",{value:"view",children:"view"}),I.jsx("option",{value:"edit",children:"edit"})]})]}),!k&&I.jsx("p",{className:"invite-link-enable-hint",children:"Turn on the option above to let anyone with the link open this board."}),k&&I.jsxs("p",{className:"invite-link-success-hint",children:["Public link is on. Anyone with the link can ",Y==="edit"?"view and edit":"view"," this board."]}),i==="link"&&x&&I.jsx("p",{className:"invite-error",children:x}),i==="link"&&O&&I.jsx("p",{className:"invite-success",children:O})]}),I.jsxs("div",{className:"invite-members",children:[I.jsx("h3",{children:"Board members"}),g.length===0?I.jsx("p",{className:"invite-muted",children:"Only you so far. Send an invite to add others."}):I.jsx("ul",{className:"members-list",children:g.map(F=>I.jsx("li",{className:"members-list-item",children:I.jsx("span",{className:"member-email",children:F.email})},F.userId))})]})]})})}function RU({invites:n,onAccept:t,onReject:e,onRefresh:i}){const[s,l]=j.useState(!1),[c,f]=j.useState(null),[m,g]=j.useState(null),A=j.useRef(null),E=zf();j.useEffect(()=>{s&&i()},[s,i]),j.useEffect(()=>{function R(O){A.current&&!A.current.contains(O.target)&&l(!1)}if(s)return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[s]);async function T(R){f(null),g(R.id);try{await b8(R.boardId,R.id),t(R.boardId),l(!1),E(`/board/${R.boardId}`)}catch(O){f(O instanceof Error?O.message:"Failed to accept invite"),t()}finally{g(null)}}async function x(R){f(null);try{await EU(R.boardId,R.id),e()}catch(O){f(O instanceof Error?O.message:"Failed to decline invite"),e()}}return I.jsxs("div",{className:"notifications-dropdown",ref:A,children:[I.jsxs("button",{type:"button",className:"notifications-trigger",onClick:()=>l(R=>!R),title:"Notifications","aria-expanded":s,"aria-haspopup":"true",children:["Notifications",n.length>0&&I.jsx("span",{className:"notifications-badge",children:n.length})]}),s&&I.jsxs("div",{className:"notifications-panel",children:[I.jsx("div",{className:"notifications-header",children:I.jsx("h3",{children:"Pending invites"})}),I.jsxs("div",{className:"notifications-content",children:[c&&I.jsx("p",{className:"notifications-error",children:c}),n.length===0?I.jsx("p",{className:"notifications-empty",children:"No pending invites."}):I.jsx("ul",{className:"notifications-list",children:n.map(R=>I.jsxs("li",{className:"notifications-item",children:[I.jsxs("div",{className:"notifications-item-info",children:[I.jsx("strong",{children:R.invitedByName||R.invitedBy}),I.jsxs("span",{children:["invited you to a board (",R.role," access)"]})]}),I.jsxs("div",{className:"notifications-item-actions",children:[I.jsx("button",{type:"button",className:"notifications-btn-accept",onClick:()=>T(R),disabled:m===R.id,children:m===R.id?"Accepting":"Accept"}),I.jsx("button",{type:"button",className:"notifications-btn-reject",onClick:()=>x(R),children:"Decline"})]})]},`${R.boardId}-${R.id}`))})]})]})]})}function xU(){const[n,t]=j.useState(!1),e=j.useRef(null);j.useEffect(()=>{function s(l){e.current&&!e.current.contains(l.target)&&t(!1)}if(n)return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[n]);const i=[{label:"Update Username",comingSoon:!0},{label:"Update Password",comingSoon:!0},{label:"Update Title/Bio",comingSoon:!0}];return I.jsxs("div",{className:"account-dropdown",ref:e,children:[I.jsx("button",{type:"button",className:"account-trigger",onClick:()=>t(s=>!s),title:"Account","aria-expanded":n,"aria-haspopup":"true",children:"Account"}),n&&I.jsx("div",{className:"account-panel",children:I.jsx("ul",{className:"account-menu",children:i.map(s=>I.jsx("li",{children:I.jsxs("button",{type:"button",className:"account-menu-item",disabled:s.comingSoon,title:s.comingSoon?"Coming soon":void 0,children:[s.label,s.comingSoon&&I.jsx("span",{className:"account-coming-soon",children:"Coming soon"})]})},s.label))})})]})}function NU({expanded:n,onToggle:t,onCreateBoard:e,onDashboardClick:i}){return I.jsxs("aside",{className:`dashboard-sidebar ${n?"dashboard-sidebar-expanded":"dashboard-sidebar-collapsed"}`,children:[I.jsx("button",{type:"button",className:"sidebar-toggle",onClick:t,"aria-label":n?"Collapse sidebar":"Expand sidebar",children:I.jsx("span",{className:"sidebar-toggle-icon","aria-hidden":!0,children:n?"":""})}),n&&I.jsxs("nav",{className:"sidebar-nav",children:[I.jsx("button",{type:"button",className:"sidebar-btn sidebar-btn-primary",onClick:e,children:"Create Board"}),I.jsx("button",{type:"button",className:"sidebar-btn",onClick:i,children:"Dashboard"})]})]})}function DU(){const{user:n}=BS(),t=zf(),e=j.useRef(null),[i,s]=j.useState({owned:[],shared:[]}),[l,c]=j.useState([]),[f,m]=j.useState(!0),[g,A]=j.useState(null),[E,T]=j.useState(!1),[x,R]=j.useState(!0);j.useEffect(()=>{if(!n?.uid){m(!1),s({owned:[],shared:[]}),c([]);return}m(!0);const nt=v8(L=>{s(L),m(!1)});let X=!1;return Cg().then(L=>{X||c(L)}),()=>{X=!0,nt()}},[n?.uid,n?.email]);async function O(nt){const X=await _8(nt);t(`/board/${X}`)}async function M(nt){t(`/board/${nt}`)}async function H(nt){if(Cg().then(c),nt){const X=await zu(nt);X&&s(L=>L.owned.some(V=>V.id===nt)||L.shared.some(V=>V.id===nt)?L:{...L,shared:[X,...L.shared]})}}function B(){e.current?.scrollIntoView({behavior:"smooth"})}async function Y(nt){try{await y8(nt)}catch(X){console.error("Failed to delete board:",X),alert(X instanceof Error?X.message:"Failed to delete board")}}const $=n?.displayName||n?.email||"User";return I.jsxs("div",{className:"dashboard",children:[I.jsxs("header",{className:"dashboard-topnav",children:[I.jsx("span",{className:"dashboard-brand",children:"Vellum"}),I.jsxs("div",{className:"dashboard-topnav-actions",children:[I.jsx("span",{className:"dashboard-user",children:$}),I.jsx(RU,{invites:l,onAccept:H,onReject:()=>Cg().then(c),onRefresh:()=>Cg().then(c)}),I.jsx(xU,{}),I.jsx("button",{type:"button",className:"dashboard-logout",onClick:()=>oU(),children:"Log Out"})]})]}),I.jsx(NU,{expanded:x,onToggle:()=>R(nt=>!nt),onCreateBoard:()=>T(!0),onDashboardClick:B}),I.jsxs("main",{className:"dashboard-main",style:{left:x?300:72},children:[I.jsxs("section",{className:"dashboard-ai-placeholder",children:[I.jsx("h2",{className:"dashboard-ai-title",children:"Need help drafting a template?"}),I.jsx("p",{className:"dashboard-ai-subtext",children:"Under construction  come back for an AI template and feature generator"})]}),I.jsx("section",{className:"dashboard-template-section",children:I.jsxs("div",{className:"dashboard-template-row",children:[I.jsxs("button",{type:"button",className:"dashboard-template-blank",onClick:()=>T(!0),children:[I.jsx("span",{className:"dashboard-template-blank-icon",children:"+"}),I.jsx("span",{className:"dashboard-template-blank-text",children:"Start from Scratch"})]}),I.jsxs("div",{className:"dashboard-template-recent",children:[I.jsx("h3",{className:"dashboard-template-recent-title",children:"Recently Used Templates"}),I.jsx("div",{className:"dashboard-template-tiles",children:[1,2,3,4,5,6].map(nt=>I.jsx("div",{className:"dashboard-template-tile-slot","aria-hidden":!0},nt))}),I.jsx("p",{className:"dashboard-template-recent-message",children:!f&&(i.owned.length>0||i.shared.length>0)?"Templates coming soon  we're building AI-powered templates for you":"No templates yet  create your first board to get started!"})]})]})}),I.jsx("section",{ref:e,className:"dashboard-boards",children:f?I.jsx("p",{className:"dashboard-loading",children:"Loading boards"}):I.jsx(TU,{ownedBoards:i.owned,sharedBoards:i.shared,currentUserId:n?.uid??"",onOpen:M,onShare:A,onDelete:Y,onCreateBoard:()=>T(!0)})})]}),E&&I.jsx(wU,{onClose:()=>T(!1),onCreate:O}),g&&I.jsx(C8,{boardId:g,onClose:()=>A(null)})]})}const R1={fontFamily:"Inter, system-ui, sans-serif",fontSize:14,fontColor:"#1a1a1a",bold:!1,italic:!1,underline:!1,textAlign:"left"},w8="objects";function R8(n){return Hm(Xa,"boards",n,w8)}function YS(n,t){return qu(Xa,"boards",n,w8,t)}function zA(n){if(n&&typeof n=="object"&&"seconds"in n&&typeof n.seconds=="number"){const t=n;return sn.fromMillis(t.seconds*1e3+(t.nanoseconds??0)/1e6)}return sn.now()}function IU(n,t,e){const i=e.type,s={objectId:t,type:i,createdBy:e.createdBy,createdAt:zA(e.createdAt),updatedAt:zA(e.updatedAt)};switch(i){case"sticky":return{...s,type:"sticky",position:e.position,dimensions:e.dimensions,content:e.content??"",fillColor:e.fillColor??"#fef08a",textStyle:e.textStyle??R1};case"rectangle":return{...s,type:"rectangle",position:e.position,dimensions:e.dimensions,fillColor:e.fillColor??"#93c5fd"};case"circle":return{...s,type:"circle",position:e.position,dimensions:e.dimensions,fillColor:e.fillColor??"#93c5fd"};case"triangle":return{...s,type:"triangle",position:e.position,dimensions:e.dimensions,fillColor:e.fillColor??"#93c5fd"};case"line":return{...s,type:"line",start:e.start,end:e.end,strokeColor:e.strokeColor,strokeWidth:e.strokeWidth};case"text":return{...s,type:"text",position:e.position,dimensions:e.dimensions,content:e.content??"",textStyle:e.textStyle??R1};case"emoji":return{...s,type:"emoji",position:e.position,emoji:e.emoji??"",fontSize:e.fontSize};default:throw new Error(`Unknown object type: ${s.type}`)}}function OU(n,t){return s0(R8(n),e=>{const i={};e.docs.forEach(s=>{i[s.id]=IU(n,s.id,s.data())}),t(i)},e=>{console.error("[objects] subscribeToObjects:",e),t({})})}async function _y(n,t){const e=Ms.currentUser;if(!e)throw new Error("Not authenticated");const i={};t.type==="sticky"?(i.content=t.content??"",i.textStyle=t.textStyle??R1,i.fillColor=t.fillColor??"#fef08a"):t.type==="rectangle"||t.type==="circle"||t.type==="triangle"?i.fillColor=t.fillColor??"#93c5fd":t.type==="text"&&(i.content=t.content??"",i.textStyle=t.textStyle??R1);const s={...t,...i,createdBy:e.uid,createdAt:Ui(),updatedAt:Ui()};return(await M0(R8(n),s)).id}async function Sf(n,t,e){await vh(YS(n,t),{...e,updatedAt:Ui()})}async function x2(n,t){await sv(YS(n,t))}function MU(n){const t={type:n.type,createdBy:n.createdBy,createdAt:n.createdAt,updatedAt:n.updatedAt};switch(n.type){case"sticky":return{...t,position:n.position,dimensions:n.dimensions,content:n.content,fillColor:n.fillColor,textStyle:n.textStyle};case"rectangle":case"circle":case"triangle":return{...t,position:n.position,dimensions:n.dimensions,fillColor:n.fillColor};case"line":return{...t,start:n.start,end:n.end,strokeColor:n.strokeColor,strokeWidth:n.strokeWidth};case"text":return{...t,position:n.position,dimensions:n.dimensions,content:n.content,textStyle:n.textStyle};case"emoji":return{...t,position:n.position,emoji:n.emoji,fontSize:n.fontSize};default:throw new Error(`Unknown object type: ${n.type}`)}}async function LU(n,t,e){const i={...e,createdAt:zA(e.createdAt),updatedAt:Ui()};await O0(YS(n,t),i)}function x8(n){return Hm(Xa,"boards",n,"comments")}async function kU(n,t,e){const i=Ms.currentUser;if(!i)throw new Error("Not authenticated");const s=i.displayName??(i.email?i.email.split("@")[0]:null),l={position:t,authorId:i.uid,authorName:s,text:e,replies:[],createdAt:Ui(),updatedAt:Ui()};return(await M0(x8(n),l)).id}async function PU(n,t,e){const i=Ms.currentUser;if(!i)throw new Error("Not authenticated");const s=qu(Xa,"boards",n,"comments",t),l=i.displayName??(i.email?i.email.split("@")[0]:null),c={authorId:i.uid,authorName:l,text:e,timestamp:sn.now()},g=(await jS(async()=>{const{getDoc:A}=await Promise.resolve().then(()=>s9);return{getDoc:A}},void 0).then(({getDoc:A})=>A(s))).data()?.replies??[];await vh(s,{replies:[...g,c],updatedAt:Ui()})}async function S3(n,t){const e=qu(Xa,"boards",n,"comments",t);await sv(e)}function T3(n){if(n&&typeof n=="object"&&"seconds"in n&&typeof n.seconds=="number"){const t=n;return sn.fromMillis(t.seconds*1e3+(t.nanoseconds??0)/1e6)}return sn.now()}async function VU(n,t,e){const i=qu(Xa,"boards",n,"comments",t),s=(e.replies??[]).map(l=>({...l,timestamp:T3(l.timestamp)}));await O0(i,{position:e.position,authorId:e.authorId,authorName:e.authorName,text:e.text,replies:s,createdAt:T3(e.createdAt),updatedAt:Ui()})}function UU(n,t){return s0(x8(n),e=>{const i=e.docs.map(s=>{const l=s.data();return{id:s.id,boardId:n,position:l.position,authorId:l.authorId,authorName:l.authorName,text:l.text,replies:l.replies??[],createdAt:l.createdAt,updatedAt:l.updatedAt}});t(i)})}const zU="vellum-undo",BU=1,f0="stacks";function N8(){return new Promise((n,t)=>{const e=indexedDB.open(zU,BU);e.onerror=()=>t(e.error),e.onsuccess=()=>n(e.result),e.onupgradeneeded=()=>{e.result.createObjectStore(f0,{keyPath:"boardId"})}})}async function jU(n){try{const t=await N8();return new Promise((e,i)=>{const c=t.transaction(f0,"readonly").objectStore(f0).get(n);c.onsuccess=()=>{const f=c.result;e(f?{undoStack:f.undoStack??[],redoStack:f.redoStack??[]}:null)},c.onerror=()=>i(c.error),t.close()})}catch{return null}}async function N2(n,t,e){try{const i=await N8();return new Promise((s,l)=>{const c=i.transaction(f0,"readwrite");c.objectStore(f0).put({boardId:n,undoStack:t,redoStack:e}),c.oncomplete=()=>s(),c.onerror=()=>l(c.error),i.close()})}catch{}}const b3=50,C3=["#ef4444","#f97316","#eab308","#22c55e","#14b8a6","#3b82f6","#8b5cf6","#ec4899"];function BA(n){let t=0;for(let i=0;i<n.length;i++)t=(t<<5)-t+n.charCodeAt(i);const e=Math.abs(t)%C3.length;return C3[e]}async function HU(n){const t=Ms.currentUser;if(!t)return;const e=wm(Rm,`presence/${n}/${t.uid}`),i=wm(Rm,`cursors/${n}/${t.uid}`),s={userId:t.uid,displayName:t.displayName??null,email:t.email??"",color:BA(t.uid),joinedAt:Date.now()};await kA(e,s),d3(e).remove(),d3(i).remove()}let D2=0,Xd=null,I2=null;function w3(n,t,e){const i=Ms.currentUser;if(!i)return;const s=Date.now();if(s-D2<b3){Xd={x:t,y:e},I2||(I2=setTimeout(()=>{if(Xd){D2=Date.now();const f=wm(Rm,`cursors/${n}/${i.uid}`),m={x:Xd.x,y:Xd.y,displayName:i.displayName??(i.email?i.email.split("@")[0]:null),color:BA(i.uid),lastUpdated:Date.now()};kA(f,m),Xd=null}I2=null},b3));return}D2=s,Xd=null;const l=wm(Rm,`cursors/${n}/${i.uid}`),c={x:t,y:e,displayName:i.displayName??(i.email?i.email.split("@")[0]:null),color:BA(i.uid),lastUpdated:Date.now()};kA(l,c)}function GU(n,t){const e=wm(Rm,`presence/${n}`);return m8(e,i=>{const s=i.val(),l=[];if(s&&typeof s=="object")for(const[c,f]of Object.entries(s)){const m=f;m&&typeof m=="object"&&l.push({userId:c,displayName:m.displayName??null,email:m.email??"",color:m.color??"#888",joinedAt:m.joinedAt??0})}t(l)})}function qU(n,t){const e=wm(Rm,`cursors/${n}`);return m8(e,i=>{const s=i.val(),l=[];if(s&&typeof s=="object")for(const[c,f]of Object.entries(s)){const m=f;m&&typeof m=="object"&&typeof m.x=="number"&&typeof m.y=="number"&&l.push({userId:c,x:m.x,y:m.y,displayName:m.displayName??null,color:m.color??"#888",lastUpdated:typeof m.lastUpdated=="number"?m.lastUpdated:void 0})}t(l)})}const FU=Math.PI/180;function YU(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}const Nf=typeof global<"u"?global:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},Ut={_global:Nf,version:"10.2.0",isBrowser:YU(),isUnminified:/param/.test((function(n){}).toString()),dblClickWindow:400,getAngle(n){return Ut.angleDeg?n*FU:n},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_renderBackend:"web",legacyTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return Ut.DD.isDragging},isTransforming(){var n,t;return(t=(n=Ut.Transformer)===null||n===void 0?void 0:n.isTransforming())!==null&&t!==void 0?t:!1},isDragReady(){return!!Ut.DD.node},releaseCanvasOnDestroy:!0,document:Nf.document,_injectGlobal(n){typeof Nf.Konva<"u"&&console.error("Several Konva instances detected. It is not recommended to use multiple Konva instances in the same environment."),Nf.Konva=n}},li=n=>{Ut[n.prototype.getClassName()]=n};Ut._injectGlobal(Ut);const QU=`Konva.js unsupported environment.

Looks like you are trying to use Konva.js in Node.js environment. because "document" object is undefined.

To use Konva.js in Node.js environment, you need to use the "canvas-backend" or "skia-backend" module.

bash: npm install canvas
js: import "konva/canvas-backend";

or

bash: npm install skia-canvas
js: import "konva/skia-backend";
`,R3=()=>{if(typeof document>"u")throw new Error(QU)};class pr{constructor(t=[1,0,0,1,0,0]){this.dirty=!1,this.m=t&&t.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new pr(this.m)}copyInto(t){t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5]}point(t){const e=this.m;return{x:e[0]*t.x+e[2]*t.y+e[4],y:e[1]*t.x+e[3]*t.y+e[5]}}translate(t,e){return this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e,this}scale(t,e){return this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e,this}rotate(t){const e=Math.cos(t),i=Math.sin(t),s=this.m[0]*e+this.m[2]*i,l=this.m[1]*e+this.m[3]*i,c=this.m[0]*-i+this.m[2]*e,f=this.m[1]*-i+this.m[3]*e;return this.m[0]=s,this.m[1]=l,this.m[2]=c,this.m[3]=f,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(t,e){const i=this.m[0]+this.m[2]*e,s=this.m[1]+this.m[3]*e,l=this.m[2]+this.m[0]*t,c=this.m[3]+this.m[1]*t;return this.m[0]=i,this.m[1]=s,this.m[2]=l,this.m[3]=c,this}multiply(t){const e=this.m[0]*t.m[0]+this.m[2]*t.m[1],i=this.m[1]*t.m[0]+this.m[3]*t.m[1],s=this.m[0]*t.m[2]+this.m[2]*t.m[3],l=this.m[1]*t.m[2]+this.m[3]*t.m[3],c=this.m[0]*t.m[4]+this.m[2]*t.m[5]+this.m[4],f=this.m[1]*t.m[4]+this.m[3]*t.m[5]+this.m[5];return this.m[0]=e,this.m[1]=i,this.m[2]=s,this.m[3]=l,this.m[4]=c,this.m[5]=f,this}invert(){const t=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),e=this.m[3]*t,i=-this.m[1]*t,s=-this.m[2]*t,l=this.m[0]*t,c=t*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),f=t*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=e,this.m[1]=i,this.m[2]=s,this.m[3]=l,this.m[4]=c,this.m[5]=f,this}getMatrix(){return this.m}decompose(){const t=this.m[0],e=this.m[1],i=this.m[2],s=this.m[3],l=this.m[4],c=this.m[5],f=t*s-e*i,m={x:l,y:c,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(t!=0||e!=0){const g=Math.sqrt(t*t+e*e);m.rotation=e>0?Math.acos(t/g):-Math.acos(t/g),m.scaleX=g,m.scaleY=f/g,m.skewX=(t*i+e*s)/f,m.skewY=0}else if(i!=0||s!=0){const g=Math.sqrt(i*i+s*s);m.rotation=Math.PI/2-(s>0?Math.acos(-i/g):-Math.acos(i/g)),m.scaleX=f/g,m.scaleY=g,m.skewX=0,m.skewY=(t*i+e*s)/f}return m.rotation=st._getRotation(m.rotation),m}}const XU="[object Array]",KU="[object Number]",WU="[object String]",JU="[object Boolean]",ZU=Math.PI/180,$U=180/Math.PI,fg="#",tz="",ez="0",nz="Konva warning: ",x3="Konva error: ",iz="rgb(",O2={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},sz=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let yy=[],dg=null;const az=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(n){setTimeout(n,16)},st={_isElement(n){return!!(n&&n.nodeType==1)},_isFunction(n){return!!(n&&n.constructor&&n.call&&n.apply)},_isPlainObject(n){return!!n&&n.constructor===Object},_isArray(n){return Object.prototype.toString.call(n)===XU},_isNumber(n){return Object.prototype.toString.call(n)===KU&&!isNaN(n)&&isFinite(n)},_isString(n){return Object.prototype.toString.call(n)===WU},_isBoolean(n){return Object.prototype.toString.call(n)===JU},isObject(n){return n instanceof Object},isValidSelector(n){if(typeof n!="string")return!1;const t=n[0];return t==="#"||t==="."||t===t.toUpperCase()},_sign(n){return n===0||n>0?1:-1},requestAnimFrame(n){yy.push(n),yy.length===1&&az(function(){const t=yy;yy=[],t.forEach(function(e){e()})})},createCanvasElement(){R3();const n=document.createElement("canvas");try{n.style=n.style||{}}catch{}return n},createImageElement(){return R3(),document.createElement("img")},_isInDocument(n){for(;n=n.parentNode;)if(n==document)return!0;return!1},_urlToImage(n,t){const e=st.createImageElement();e.onload=function(){t(e)},e.src=n},_rgbToHex(n,t,e){return((1<<24)+(n<<16)+(t<<8)+e).toString(16).slice(1)},_hexToRgb(n){n=n.replace(fg,tz);const t=parseInt(n,16);return{r:t>>16&255,g:t>>8&255,b:t&255}},getRandomColor(){let n=(Math.random()*16777215<<0).toString(16);for(;n.length<6;)n=ez+n;return fg+n},isCanvasFarblingActive(){if(dg!==null)return dg;if(typeof document>"u")return dg=!1,!1;const n=this.createCanvasElement();n.width=10,n.height=10;const t=n.getContext("2d",{willReadFrequently:!0});t.clearRect(0,0,10,10),t.fillStyle="#282828",t.fillRect(0,0,10,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=0;s<100;s++)if(e[s*4]!==40||e[s*4+1]!==40||e[s*4+2]!==40||e[s*4+3]!==255){i=!0;break}return dg=i,this.releaseCanvas(n),dg},getHitColor(){const n=this.getRandomColor();return this.isCanvasFarblingActive()?this.getSnappedHexColor(n):n},getHitColorKey(n,t,e){return this.isCanvasFarblingActive()&&(n=Math.round(n/5)*5,t=Math.round(t/5)*5,e=Math.round(e/5)*5),fg+this._rgbToHex(n,t,e)},getSnappedHexColor(n){const t=this._hexToRgb(n);return fg+this._rgbToHex(Math.round(t.r/5)*5,Math.round(t.g/5)*5,Math.round(t.b/5)*5)},getRGB(n){let t;return n in O2?(t=O2[n],{r:t[0],g:t[1],b:t[2]}):n[0]===fg?this._hexToRgb(n.substring(1)):n.substr(0,4)===iz?(t=sz.exec(n.replace(/ /g,"")),{r:parseInt(t[1],10),g:parseInt(t[2],10),b:parseInt(t[3],10)}):{r:0,g:0,b:0}},colorToRGBA(n){return n=n||"black",st._namedColorToRBA(n)||st._hex3ColorToRGBA(n)||st._hex4ColorToRGBA(n)||st._hex6ColorToRGBA(n)||st._hex8ColorToRGBA(n)||st._rgbColorToRGBA(n)||st._rgbaColorToRGBA(n)||st._hslColorToRGBA(n)},_namedColorToRBA(n){const t=O2[n.toLowerCase()];return t?{r:t[0],g:t[1],b:t[2],a:1}:null},_rgbColorToRGBA(n){if(n.indexOf("rgb(")===0){n=n.match(/rgb\(([^)]+)\)/)[1];const t=n.split(/ *, */).map(Number);return{r:t[0],g:t[1],b:t[2],a:1}}},_rgbaColorToRGBA(n){if(n.indexOf("rgba(")===0){n=n.match(/rgba\(([^)]+)\)/)[1];const t=n.split(/ *, */).map((e,i)=>e.slice(-1)==="%"?i===3?parseInt(e)/100:parseInt(e)/100*255:Number(e));return{r:t[0],g:t[1],b:t[2],a:t[3]}}},_hex8ColorToRGBA(n){if(n[0]==="#"&&n.length===9)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:parseInt(n.slice(7,9),16)/255}},_hex6ColorToRGBA(n){if(n[0]==="#"&&n.length===7)return{r:parseInt(n.slice(1,3),16),g:parseInt(n.slice(3,5),16),b:parseInt(n.slice(5,7),16),a:1}},_hex4ColorToRGBA(n){if(n[0]==="#"&&n.length===5)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:parseInt(n[4]+n[4],16)/255}},_hex3ColorToRGBA(n){if(n[0]==="#"&&n.length===4)return{r:parseInt(n[1]+n[1],16),g:parseInt(n[2]+n[2],16),b:parseInt(n[3]+n[3],16),a:1}},_hslColorToRGBA(n){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(n)){const[t,...e]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(n),i=Number(e[0])/360,s=Number(e[1])/100,l=Number(e[2])/100;let c,f,m;if(s===0)return m=l*255,{r:Math.round(m),g:Math.round(m),b:Math.round(m),a:1};l<.5?c=l*(1+s):c=l+s-l*s;const g=2*l-c,A=[0,0,0];for(let E=0;E<3;E++)f=i+1/3*-(E-1),f<0&&f++,f>1&&f--,6*f<1?m=g+(c-g)*6*f:2*f<1?m=c:3*f<2?m=g+(c-g)*(2/3-f)*6:m=g,A[E]=m*255;return{r:Math.round(A[0]),g:Math.round(A[1]),b:Math.round(A[2]),a:1}}},haveIntersection(n,t){return!(t.x>n.x+n.width||t.x+t.width<n.x||t.y>n.y+n.height||t.y+t.height<n.y)},cloneObject(n){const t={};for(const e in n)this._isPlainObject(n[e])?t[e]=this.cloneObject(n[e]):this._isArray(n[e])?t[e]=this.cloneArray(n[e]):t[e]=n[e];return t},cloneArray(n){return n.slice(0)},degToRad(n){return n*ZU},radToDeg(n){return n*$U},_degToRad(n){return st.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),st.degToRad(n)},_radToDeg(n){return st.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),st.radToDeg(n)},_getRotation(n){return Ut.angleDeg?st.radToDeg(n):n},_capitalize(n){return n.charAt(0).toUpperCase()+n.slice(1)},throw(n){throw new Error(x3+n)},error(n){console.error(x3+n)},warn(n){Ut.showWarnings&&console.warn(nz+n)},each(n,t){for(const e in n)t(e,n[e])},_inRange(n,t,e){return t<=n&&n<e},_getProjectionToSegment(n,t,e,i,s,l){let c,f,m;const g=(n-e)*(n-e)+(t-i)*(t-i);if(g==0)c=n,f=t,m=(s-e)*(s-e)+(l-i)*(l-i);else{const A=((s-n)*(e-n)+(l-t)*(i-t))/g;A<0?(c=n,f=t,m=(n-s)*(n-s)+(t-l)*(t-l)):A>1?(c=e,f=i,m=(e-s)*(e-s)+(i-l)*(i-l)):(c=n+A*(e-n),f=t+A*(i-t),m=(c-s)*(c-s)+(f-l)*(f-l))}return[c,f,m]},_getProjectionToLine(n,t,e){const i=st.cloneObject(n);let s=Number.MAX_VALUE;return t.forEach(function(l,c){if(!e&&c===t.length-1)return;const f=t[(c+1)%t.length],m=st._getProjectionToSegment(l.x,l.y,f.x,f.y,n.x,n.y),g=m[0],A=m[1],E=m[2];E<s&&(i.x=g,i.y=A,s=E)}),i},_prepareArrayForTween(n,t,e){const i=[],s=[];if(n.length>t.length){const c=t;t=n,n=c}for(let c=0;c<n.length;c+=2)i.push({x:n[c],y:n[c+1]});for(let c=0;c<t.length;c+=2)s.push({x:t[c],y:t[c+1]});const l=[];return s.forEach(function(c){const f=st._getProjectionToLine(c,i,e);l.push(f.x),l.push(f.y)}),l},_prepareToStringify(n){let t;n.visitedByCircularReferenceRemoval=!0;for(const e in n)if(n.hasOwnProperty(e)&&n[e]&&typeof n[e]=="object"){if(t=Object.getOwnPropertyDescriptor(n,e),n[e].visitedByCircularReferenceRemoval||st._isElement(n[e]))if(t.configurable)delete n[e];else return null;else if(st._prepareToStringify(n[e])===null)if(t.configurable)delete n[e];else return null}return delete n.visitedByCircularReferenceRemoval,n},_assign(n,t){for(const e in t)n[e]=t[e];return n},_getFirstPointerId(n){return n.touches?n.changedTouches[0].identifier:n.pointerId||999},releaseCanvas(...n){Ut.releaseCanvasOnDestroy&&n.forEach(t=>{t.width=0,t.height=0})},drawRoundedRectPath(n,t,e,i){let s=t<0?t:0,l=e<0?e:0;t=Math.abs(t),e=Math.abs(e);let c=0,f=0,m=0,g=0;typeof i=="number"?c=f=m=g=Math.min(i,t/2,e/2):(c=Math.min(i[0]||0,t/2,e/2),f=Math.min(i[1]||0,t/2,e/2),g=Math.min(i[2]||0,t/2,e/2),m=Math.min(i[3]||0,t/2,e/2)),n.moveTo(s+c,l),n.lineTo(s+t-f,l),n.arc(s+t-f,l+f,f,Math.PI*3/2,0,!1),n.lineTo(s+t,l+e-g),n.arc(s+t-g,l+e-g,g,0,Math.PI/2,!1),n.lineTo(s+m,l+e),n.arc(s+m,l+e-m,m,Math.PI/2,Math.PI,!1),n.lineTo(s,l+c),n.arc(s+c,l+c,c,Math.PI,Math.PI*3/2,!1)},drawRoundedPolygonPath(n,t,e,i,s){i=Math.abs(i);for(let l=0;l<e;l++){const c=t[(l-1+e)%e],f=t[l],m=t[(l+1)%e],g={x:f.x-c.x,y:f.y-c.y},A={x:m.x-f.x,y:m.y-f.y},E=Math.hypot(g.x,g.y),T=Math.hypot(A.x,A.y);let x;typeof s=="number"?x=s:x=l<s.length?s[l]:0,x=i*Math.cos(Math.PI/e)*Math.min(1,x/i*2);const O={x:g.x/E,y:g.y/E},M={x:A.x/T,y:A.y/T},H={x:f.x-O.x*x,y:f.y-O.y*x},B={x:f.x+M.x*x,y:f.y+M.y*x};l===0?n.moveTo(H.x,H.y):n.lineTo(H.x,H.y),n.arcTo(f.x,f.y,B.x,B.y,x)}}};function rz(n){const t=[],e=n.length,i=st;for(let s=0;s<e;s++){let l=n[s];i._isNumber(l)?l=Math.round(l*1e3)/1e3:i._isString(l)||(l=l+""),t.push(l)}return t}const N3=",",lz="(",oz=")",uz="([",cz="])",hz=";",fz="()",dz="=",D3=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],mz=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled","filter"],pz=100;let vy=null;function I3(){if(vy!==null)return vy;try{const t=st.createCanvasElement().getContext("2d");return t?!!t&&"filter"in t:(vy=!1,!1)}catch{return vy=!1,!1}}class gv{constructor(t){this.canvas=t,Ut.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(t){t.fillEnabled()&&this._fill(t)}_fill(t){}strokeShape(t){t.hasStroke()&&this._stroke(t)}_stroke(t){}fillStrokeShape(t){t.attrs.fillAfterStrokeEnabled?(this.strokeShape(t),this.fillShape(t)):(this.fillShape(t),this.strokeShape(t))}getTrace(t,e){let i=this.traceArr,s=i.length,l="",c,f,m,g;for(c=0;c<s;c++)f=i[c],m=f.method,m?(g=f.args,l+=m,t?l+=fz:st._isArray(g[0])?l+=uz+g.join(N3)+cz:(e&&(g=g.map(A=>typeof A=="number"?Math.floor(A):A)),l+=lz+g.join(N3)+oz)):(l+=f.property,t||(l+=dz+f.val)),l+=hz;return l}clearTrace(){this.traceArr=[]}_trace(t){let e=this.traceArr,i;e.push(t),i=e.length,i>=pz&&e.shift()}reset(){const t=this.getCanvas().getPixelRatio();this.setTransform(1*t,0,0,1*t,0,0)}getCanvas(){return this.canvas}clear(t){const e=this.getCanvas();t?this.clearRect(t.x||0,t.y||0,t.width||0,t.height||0):this.clearRect(0,0,e.getWidth()/e.pixelRatio,e.getHeight()/e.pixelRatio)}_applyLineCap(t){const e=t.attrs.lineCap;e&&this.setAttr("lineCap",e)}_applyOpacity(t){const e=t.getAbsoluteOpacity();e!==1&&this.setAttr("globalAlpha",e)}_applyLineJoin(t){const e=t.attrs.lineJoin;e&&this.setAttr("lineJoin",e)}_applyMiterLimit(t){const e=t.attrs.miterLimit;e!=null&&this.setAttr("miterLimit",e)}setAttr(t,e){this._context[t]=e}arc(t,e,i,s,l,c){this._context.arc(t,e,i,s,l,c)}arcTo(t,e,i,s,l){this._context.arcTo(t,e,i,s,l)}beginPath(){this._context.beginPath()}bezierCurveTo(t,e,i,s,l,c){this._context.bezierCurveTo(t,e,i,s,l,c)}clearRect(t,e,i,s){this._context.clearRect(t,e,i,s)}clip(...t){this._context.clip.apply(this._context,t)}closePath(){this._context.closePath()}createImageData(t,e){const i=arguments;if(i.length===2)return this._context.createImageData(t,e);if(i.length===1)return this._context.createImageData(t)}createLinearGradient(t,e,i,s){return this._context.createLinearGradient(t,e,i,s)}createPattern(t,e){return this._context.createPattern(t,e)}createRadialGradient(t,e,i,s,l,c){return this._context.createRadialGradient(t,e,i,s,l,c)}drawImage(t,e,i,s,l,c,f,m,g){const A=arguments,E=this._context;A.length===3?E.drawImage(t,e,i):A.length===5?E.drawImage(t,e,i,s,l):A.length===9&&E.drawImage(t,e,i,s,l,c,f,m,g)}ellipse(t,e,i,s,l,c,f,m){this._context.ellipse(t,e,i,s,l,c,f,m)}isPointInPath(t,e,i,s){return i?this._context.isPointInPath(i,t,e,s):this._context.isPointInPath(t,e,s)}fill(...t){this._context.fill.apply(this._context,t)}fillRect(t,e,i,s){this._context.fillRect(t,e,i,s)}strokeRect(t,e,i,s){this._context.strokeRect(t,e,i,s)}fillText(t,e,i,s){s?this._context.fillText(t,e,i,s):this._context.fillText(t,e,i)}measureText(t){return this._context.measureText(t)}getImageData(t,e,i,s){return this._context.getImageData(t,e,i,s)}lineTo(t,e){this._context.lineTo(t,e)}moveTo(t,e){this._context.moveTo(t,e)}rect(t,e,i,s){this._context.rect(t,e,i,s)}roundRect(t,e,i,s,l){this._context.roundRect(t,e,i,s,l)}putImageData(t,e,i){this._context.putImageData(t,e,i)}quadraticCurveTo(t,e,i,s){this._context.quadraticCurveTo(t,e,i,s)}restore(){this._context.restore()}rotate(t){this._context.rotate(t)}save(){this._context.save()}scale(t,e){this._context.scale(t,e)}setLineDash(t){this._context.setLineDash?this._context.setLineDash(t):"mozDash"in this._context?this._context.mozDash=t:"webkitLineDash"in this._context&&(this._context.webkitLineDash=t)}getLineDash(){return this._context.getLineDash()}setTransform(t,e,i,s,l,c){this._context.setTransform(t,e,i,s,l,c)}stroke(t){t?this._context.stroke(t):this._context.stroke()}strokeText(t,e,i,s){this._context.strokeText(t,e,i,s)}transform(t,e,i,s,l,c){this._context.transform(t,e,i,s,l,c)}translate(t,e){this._context.translate(t,e)}_enableTrace(){let t=this,e=D3.length,i=this.setAttr,s,l;const c=function(f){let m=t[f],g;t[f]=function(){return l=rz(Array.prototype.slice.call(arguments,0)),g=m.apply(t,arguments),t._trace({method:f,args:l}),g}};for(s=0;s<e;s++)c(D3[s]);t.setAttr=function(){i.apply(t,arguments);const f=arguments[0];let m=arguments[1];(f==="shadowOffsetX"||f==="shadowOffsetY"||f==="shadowBlur")&&(m=m/this.canvas.getPixelRatio()),t._trace({property:f,val:m})}}_applyGlobalCompositeOperation(t){const e=t.attrs.globalCompositeOperation;!e||e==="source-over"||this.setAttr("globalCompositeOperation",e)}}mz.forEach(function(n){Object.defineProperty(gv.prototype,n,{get(){return this._context[n]},set(t){this._context[n]=t}})});class gz extends gv{constructor(t,{willReadFrequently:e=!1}={}){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:e})}_fillColor(t){const e=t.fill();this.setAttr("fillStyle",e),t._fillFunc(this)}_fillPattern(t){this.setAttr("fillStyle",t._getFillPattern()),t._fillFunc(this)}_fillLinearGradient(t){const e=t._getLinearGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fillRadialGradient(t){const e=t._getRadialGradient();e&&(this.setAttr("fillStyle",e),t._fillFunc(this))}_fill(t){const e=t.fill(),i=t.getFillPriority();if(e&&i==="color"){this._fillColor(t);return}const s=t.getFillPatternImage();if(s&&i==="pattern"){this._fillPattern(t);return}const l=t.getFillLinearGradientColorStops();if(l&&i==="linear-gradient"){this._fillLinearGradient(t);return}const c=t.getFillRadialGradientColorStops();if(c&&i==="radial-gradient"){this._fillRadialGradient(t);return}e?this._fillColor(t):s?this._fillPattern(t):l?this._fillLinearGradient(t):c&&this._fillRadialGradient(t)}_strokeLinearGradient(t){const e=t.getStrokeLinearGradientStartPoint(),i=t.getStrokeLinearGradientEndPoint(),s=t.getStrokeLinearGradientColorStops(),l=this.createLinearGradient(e.x,e.y,i.x,i.y);if(s){for(let c=0;c<s.length;c+=2)l.addColorStop(s[c],s[c+1]);this.setAttr("strokeStyle",l)}}_stroke(t){const e=t.dash(),i=t.getStrokeScaleEnabled();if(t.hasStroke()){if(!i){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t),e&&t.dashEnabled()&&(this.setLineDash(e),this.setAttr("lineDashOffset",t.dashOffset())),this.setAttr("lineWidth",t.strokeWidth()),t.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),t.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(t):this.setAttr("strokeStyle",t.stroke()),t._strokeFunc(this),i||this.restore()}}_applyShadow(t){var e,i,s;const l=(e=t.getShadowRGBA())!==null&&e!==void 0?e:"black",c=(i=t.getShadowBlur())!==null&&i!==void 0?i:5,f=(s=t.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},m=t.getAbsoluteScale(),g=this.canvas.getPixelRatio(),A=m.x*g,E=m.y*g;this.setAttr("shadowColor",l),this.setAttr("shadowBlur",c*Math.min(Math.abs(A),Math.abs(E))),this.setAttr("shadowOffsetX",f.x*A),this.setAttr("shadowOffsetY",f.y*E)}}class _z extends gv{constructor(t){super(t),this._context=t._canvas.getContext("2d",{willReadFrequently:!0})}_fill(t){this.save(),this.setAttr("fillStyle",t.colorKey),t._fillFuncHit(this),this.restore()}strokeShape(t){t.hasHitStroke()&&this._stroke(t)}_stroke(t){if(t.hasHitStroke()){const e=t.getStrokeScaleEnabled();if(!e){this.save();const l=this.getCanvas().getPixelRatio();this.setTransform(l,0,0,l,0,0)}this._applyLineCap(t);const i=t.hitStrokeWidth(),s=i==="auto"?t.strokeWidth():i;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",t.colorKey),t._strokeFuncHit(this),e||this.restore()}}}let Ay;function yz(){if(Ay)return Ay;const n=st.createCanvasElement(),t=n.getContext("2d");return Ay=(function(){const e=Ut._global.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i})(),st.releaseCanvas(n),Ay}class QS{constructor(t){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const i=(t||{}).pixelRatio||Ut.pixelRatio||yz();this.pixelRatio=i,this._canvas=st.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(t){const e=this.pixelRatio;this.pixelRatio=t,this.setSize(this.getWidth()/e,this.getHeight()/e)}setWidth(t){this.width=this._canvas.width=t*this.pixelRatio,this._canvas.style.width=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}setHeight(t){this.height=this._canvas.height=t*this.pixelRatio,this._canvas.style.height=t+"px";const e=this.pixelRatio;this.getContext()._context.scale(e,e)}getWidth(){return this.width}getHeight(){return this.height}setSize(t,e){this.setWidth(t||0),this.setHeight(e||0)}toDataURL(t,e){try{return this._canvas.toDataURL(t,e)}catch{try{return this._canvas.toDataURL()}catch(s){return st.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}class Wc extends QS{constructor(t={width:0,height:0,willReadFrequently:!1}){super(t),this.context=new gz(this,{willReadFrequently:t.willReadFrequently}),this.setSize(t.width,t.height)}}class XS extends QS{constructor(t={width:0,height:0}){super(t),this.hitCanvas=!0,this.context=new _z(this),this.setSize(t.width,t.height)}}const nn={get isDragging(){let n=!1;return nn._dragElements.forEach(t=>{t.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return nn._dragElements.forEach(t=>{n=t.node}),n},_dragElements:new Map,_drag(n){const t=[];nn._dragElements.forEach((e,i)=>{const{node:s}=e,l=s.getStage();l.setPointersPositions(n),e.pointerId===void 0&&(e.pointerId=st._getFirstPointerId(n));const c=l._changedPointerPositions.find(f=>f.id===e.pointerId);if(c){if(e.dragStatus!=="dragging"){const f=s.dragDistance();if(Math.max(Math.abs(c.x-e.startPointerPos.x),Math.abs(c.y-e.startPointerPos.y))<f||(s.startDrag({evt:n}),!s.isDragging()))return}s._setDragPosition(n,e),t.push(s)}}),t.forEach(e=>{e.fire("dragmove",{type:"dragmove",target:e,evt:n},!0)})},_endDragBefore(n){const t=[];nn._dragElements.forEach(e=>{const{node:i}=e,s=i.getStage();if(n&&s.setPointersPositions(n),!s._changedPointerPositions.find(f=>f.id===e.pointerId))return;(e.dragStatus==="dragging"||e.dragStatus==="stopped")&&(nn.justDragged=!0,Ut._mouseListenClick=!1,Ut._touchListenClick=!1,Ut._pointerListenClick=!1,e.dragStatus="stopped");const c=e.node.getLayer()||e.node instanceof Ut.Stage&&e.node;c&&t.indexOf(c)===-1&&t.push(c)}),t.forEach(e=>{e.draw()})},_endDragAfter(n){nn._dragElements.forEach((t,e)=>{t.dragStatus==="stopped"&&t.node.fire("dragend",{type:"dragend",target:t.node,evt:n},!0),t.dragStatus!=="dragging"&&nn._dragElements.delete(e)})}};Ut.isBrowser&&(window.addEventListener("mouseup",nn._endDragBefore,!0),window.addEventListener("touchend",nn._endDragBefore,!0),window.addEventListener("touchcancel",nn._endDragBefore,!0),window.addEventListener("mousemove",nn._drag),window.addEventListener("touchmove",nn._drag),window.addEventListener("mouseup",nn._endDragAfter,!1),window.addEventListener("touchend",nn._endDragAfter,!1),window.addEventListener("touchcancel",nn._endDragAfter,!1));function Eh(n){return st._isString(n)?'"'+n+'"':Object.prototype.toString.call(n)==="[object Number]"||st._isBoolean(n)?n:Object.prototype.toString.call(n)}function D8(n){return n>255?255:n<0?0:Math.round(n)}function kt(){if(Ut.isUnminified)return function(n,t){return st._isNumber(n)||st.warn(Eh(n)+' is a not valid value for "'+t+'" attribute. The value should be a number.'),n}}function _v(n){if(Ut.isUnminified)return function(t,e){let i=st._isNumber(t),s=st._isArray(t)&&t.length==n;return!i&&!s&&st.warn(Eh(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or Array<number>('+n+")"),t}}function KS(){if(Ut.isUnminified)return function(n,t){return st._isNumber(n)||n==="auto"||st.warn(Eh(n)+' is a not valid value for "'+t+'" attribute. The value should be a number or "auto".'),n}}function Yf(){if(Ut.isUnminified)return function(n,t){return st._isString(n)||st.warn(Eh(n)+' is a not valid value for "'+t+'" attribute. The value should be a string.'),n}}function I8(){if(Ut.isUnminified)return function(n,t){const e=st._isString(n),i=Object.prototype.toString.call(n)==="[object CanvasGradient]"||n&&n.addColorStop;return e||i||st.warn(Eh(n)+' is a not valid value for "'+t+'" attribute. The value should be a string or a native gradient.'),n}}function vz(){if(Ut.isUnminified)return function(n,t){const e=Int8Array?Object.getPrototypeOf(Int8Array):null;return e&&n instanceof e||(st._isArray(n)?n.forEach(function(i){st._isNumber(i)||st.warn('"'+t+'" attribute has non numeric element '+i+". Make sure that all elements are numbers.")}):st.warn(Eh(n)+' is a not valid value for "'+t+'" attribute. The value should be a array of numbers.')),n}}function jl(){if(Ut.isUnminified)return function(n,t){return n===!0||n===!1||st.warn(Eh(n)+' is a not valid value for "'+t+'" attribute. The value should be a boolean.'),n}}function Az(n){if(Ut.isUnminified)return function(t,e){return t==null||st.isObject(t)||st.warn(Eh(t)+' is a not valid value for "'+e+'" attribute. The value should be an object with properties '+n),t}}const mg="get",pg="set",K={addGetterSetter(n,t,e,i,s){K.addGetter(n,t,e),K.addSetter(n,t,i,s),K.addOverloadedGetterSetter(n,t)},addGetter(n,t,e){const i=mg+st._capitalize(t);n.prototype[i]=n.prototype[i]||function(){const s=this.attrs[t];return s===void 0?e:s}},addSetter(n,t,e,i){const s=pg+st._capitalize(t);n.prototype[s]||K.overWriteSetter(n,t,e,i)},overWriteSetter(n,t,e,i){const s=pg+st._capitalize(t);n.prototype[s]=function(l){return e&&l!==void 0&&l!==null&&(l=e.call(this,l,t)),this._setAttr(t,l),i&&i.call(this),this}},addComponentsGetterSetter(n,t,e,i,s){const l=e.length,c=st._capitalize,f=mg+c(t),m=pg+c(t);n.prototype[f]=function(){const A={};for(let E=0;E<l;E++){const T=e[E];A[T]=this.getAttr(t+c(T))}return A};const g=Az(e);n.prototype[m]=function(A){const E=this.attrs[t];i&&(A=i.call(this,A,t)),g&&g.call(this,A,t);for(const T in A)A.hasOwnProperty(T)&&this._setAttr(t+c(T),A[T]);return A||e.forEach(T=>{this._setAttr(t+c(T),void 0)}),this._fireChangeEvent(t,E,A),s&&s.call(this),this},K.addOverloadedGetterSetter(n,t)},addOverloadedGetterSetter(n,t){const e=st._capitalize(t),i=pg+e,s=mg+e;n.prototype[t]=function(){return arguments.length?(this[i](arguments[0]),this):this[s]()}},addDeprecatedGetterSetter(n,t,e,i){st.error("Adding deprecated "+t);const s=mg+st._capitalize(t),l=t+" property is deprecated and will be removed soon. Look at Konva change log for more information.";n.prototype[s]=function(){st.error(l);const c=this.attrs[t];return c===void 0?e:c},K.addSetter(n,t,i,function(){st.error(l)}),K.addOverloadedGetterSetter(n,t)},backCompat(n,t){st.each(t,function(e,i){const s=n.prototype[i],l=mg+st._capitalize(e),c=pg+st._capitalize(e);function f(){s.apply(this,arguments),st.error('"'+e+'" method is deprecated and will be removed soon. Use ""'+i+'" instead.')}n.prototype[e]=f,n.prototype[l]=f,n.prototype[c]=f})},afterSetFilter(){this._filterUpToDate=!1}};function Ez(n){const t=/(\w+)\(([^)]+)\)/g;let e;for(;(e=t.exec(n))!==null;){const[,i,s]=e;switch(i){case"blur":{const l=parseFloat(s.replace("px",""));return function(c){this.blurRadius(l*.5);const f=Ut.Filters;f&&f.Blur&&f.Blur.call(this,c)}}case"brightness":{const l=s.includes("%")?parseFloat(s)/100:parseFloat(s);return function(c){this.brightness(l);const f=Ut.Filters;f&&f.Brightness&&f.Brightness.call(this,c)}}case"contrast":{const l=parseFloat(s);return function(c){const f=100*(Math.sqrt(l)-1);this.contrast(f);const m=Ut.Filters;m&&m.Contrast&&m.Contrast.call(this,c)}}case"grayscale":return function(l){const c=Ut.Filters;c&&c.Grayscale&&c.Grayscale.call(this,l)};case"sepia":return function(l){const c=Ut.Filters;c&&c.Sepia&&c.Sepia.call(this,l)};case"invert":return function(l){const c=Ut.Filters;c&&c.Invert&&c.Invert.call(this,l)};default:st.warn(`CSS filter "${i}" is not supported in fallback mode. Consider using function filters for better compatibility.`);break}}return()=>{}}const jy="absoluteOpacity",O3="allEventListeners",Eu="absoluteTransform",M3="absoluteScale",Tf="canvas",Sz="Change",Tz="children",bz="konva",jA="listening",Cz="mouseenter",wz="mouseleave",Rz="pointerenter",xz="pointerleave",Nz="touchenter",Dz="touchleave",L3="set",k3="Shape",Hy=" ",P3="stage",qc="transform",Iz="Stage",HA="visible",Oz=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Hy);let Mz=1;class It{constructor(t){this._id=Mz++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(t),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(t){(t===qc||t===Eu)&&this._cache.get(t)?this._cache.get(t).dirty=!0:t?this._cache.delete(t):this._cache.clear()}_getCache(t,e){let i=this._cache.get(t);return(i===void 0||(t===qc||t===Eu)&&i.dirty===!0)&&(i=e.call(this),this._cache.set(t,i)),i}_calculate(t,e,i){if(!this._attachedDepsListeners.get(t)){const s=e.map(l=>l+"Change.konva").join(Hy);this.on(s,()=>{this._clearCache(t)}),this._attachedDepsListeners.set(t,!0)}return this._getCache(t,i)}_getCanvasCache(){return this._cache.get(Tf)}_clearSelfAndDescendantCache(t){this._clearCache(t),t===Eu&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(Tf)){const{scene:t,filter:e,hit:i}=this._cache.get(Tf);st.releaseCanvas(t._canvas,e._canvas,i._canvas),this._cache.delete(Tf)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(t){const e=t||{};let i={};(e.x===void 0||e.y===void 0||e.width===void 0||e.height===void 0)&&(i=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(e.width||i.width),l=Math.ceil(e.height||i.height),c=e.pixelRatio,f=e.x===void 0?Math.floor(i.x):e.x,m=e.y===void 0?Math.floor(i.y):e.y,g=e.offset||0,A=e.drawBorder||!1,E=e.hitCanvasPixelRatio||1;if(!s||!l){st.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const T=Math.abs(Math.round(i.x)-f)>.5?1:0,x=Math.abs(Math.round(i.y)-m)>.5?1:0;s+=g*2+T,l+=g*2+x,f-=g,m-=g;const R=new Wc({pixelRatio:c,width:s,height:l}),O=new Wc({pixelRatio:c,width:0,height:0,willReadFrequently:!0}),M=new XS({pixelRatio:E,width:s,height:l}),H=R.getContext(),B=M.getContext(),Y=new Wc({width:R.width/R.pixelRatio+Math.abs(f),height:R.height/R.pixelRatio+Math.abs(m),pixelRatio:R.pixelRatio}),$=Y.getContext();return M.isCache=!0,R.isCache=!0,this._cache.delete(Tf),this._filterUpToDate=!1,e.imageSmoothingEnabled===!1&&(R.getContext()._context.imageSmoothingEnabled=!1,O.getContext()._context.imageSmoothingEnabled=!1),H.save(),B.save(),$.save(),H.translate(-f,-m),B.translate(-f,-m),$.translate(-f,-m),Y.x=f,Y.y=m,this._isUnderCache=!0,this._clearSelfAndDescendantCache(jy),this._clearSelfAndDescendantCache(M3),this.drawScene(R,this,Y),this.drawHit(M,this),this._isUnderCache=!1,H.restore(),B.restore(),A&&(H.save(),H.beginPath(),H.rect(0,0,s,l),H.closePath(),H.setAttr("strokeStyle","red"),H.setAttr("lineWidth",5),H.stroke(),H.restore()),st.releaseCanvas(Y._canvas),this._cache.set(Tf,{scene:R,filter:O,hit:M,x:f,y:m}),this._requestDraw(),this}isCached(){return this._cache.has(Tf)}getClientRect(t){throw new Error('abstract "getClientRect" method call')}_transformedRect(t,e){const i=[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}];let s=1/0,l=1/0,c=-1/0,f=-1/0;const m=this.getAbsoluteTransform(e);return i.forEach(function(g){const A=m.point(g);s===void 0&&(s=c=A.x,l=f=A.y),s=Math.min(s,A.x),l=Math.min(l,A.y),c=Math.max(c,A.x),f=Math.max(f,A.y)}),{x:s,y:l,width:c-s,height:f-l}}_drawCachedSceneCanvas(t){t.save(),t._applyOpacity(this),t._applyGlobalCompositeOperation(this);const e=this._getCanvasCache();t.translate(e.x,e.y);const i=this._getCachedSceneCanvas(),s=i.pixelRatio;t.drawImage(i._canvas,0,0,i.width/s,i.height/s),t.restore()}_drawCachedHitCanvas(t){const e=this._getCanvasCache(),i=e.hit;t.save(),t.translate(e.x,e.y),t.drawImage(i._canvas,0,0,i.width/i.pixelRatio,i.height/i.pixelRatio),t.restore()}_getCachedSceneCanvas(){let t=this.filters(),e=this._getCanvasCache(),i=e.scene,s=e.filter,l=s.getContext(),c,f,m,g;if(!t||t.length===0)return i;if(this._filterUpToDate)return s;let A=!0;for(let T=0;T<t.length;T++)if(typeof t[T]=="string"&&I3(),typeof t[T]!="string"||!I3()){A=!1;break}const E=i.pixelRatio;if(s.setSize(i.width/i.pixelRatio,i.height/i.pixelRatio),A){const T=t.join(" ");return l.save(),l.setAttr("filter",T),l.drawImage(i._canvas,0,0,i.getWidth()/E,i.getHeight()/E),l.restore(),this._filterUpToDate=!0,s}try{for(c=t.length,l.clear(),l.drawImage(i._canvas,0,0,i.getWidth()/E,i.getHeight()/E),f=l.getImageData(0,0,s.getWidth(),s.getHeight()),m=0;m<c;m++)g=t[m],typeof g=="string"&&(g=Ez(g)),g.call(this,f),l.putImageData(f,0,0)}catch(T){st.error("Unable to apply filter. "+T.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}return this._filterUpToDate=!0,s}on(t,e){if(this._cache&&this._cache.delete(O3),arguments.length===3)return this._delegate.apply(this,arguments);const i=t.split(Hy);for(let s=0;s<i.length;s++){const c=i[s].split("."),f=c[0],m=c[1]||"";this.eventListeners[f]||(this.eventListeners[f]=[]),this.eventListeners[f].push({name:m,handler:e})}return this}off(t,e){let i=(t||"").split(Hy),s=i.length,l,c,f,m,g,A;if(this._cache&&this._cache.delete(O3),!t)for(c in this.eventListeners)this._off(c);for(l=0;l<s;l++)if(f=i[l],m=f.split("."),g=m[0],A=m[1],g)this.eventListeners[g]&&this._off(g,A,e);else for(c in this.eventListeners)this._off(c,A,e);return this}dispatchEvent(t){const e={target:this,type:t.type,evt:t};return this.fire(t.type,e),this}addEventListener(t,e){return this.on(t,function(i){e.call(this,i.evt)}),this}removeEventListener(t){return this.off(t),this}_delegate(t,e,i){const s=this;this.on(t,function(l){const c=l.target.findAncestors(e,!0,s);for(let f=0;f<c.length;f++)l=st.cloneObject(l),l.currentTarget=c[f],i.call(c[f],l)})}remove(){return this.isDragging()&&this.stopDrag(),nn._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Eu),this._clearSelfAndDescendantCache(jy),this._clearSelfAndDescendantCache(M3),this._clearSelfAndDescendantCache(P3),this._clearSelfAndDescendantCache(HA),this._clearSelfAndDescendantCache(jA)}_remove(){this._clearCaches();const t=this.getParent();t&&t.children&&(t.children.splice(this.index,1),t._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(t){const e="get"+st._capitalize(t);return st._isFunction(this[e])?this[e]():this.attrs[t]}getAncestors(){let t=this.getParent(),e=[];for(;t;)e.push(t),t=t.getParent();return e}getAttrs(){return this.attrs||{}}setAttrs(t){return this._batchTransformChanges(()=>{let e,i;if(!t)return this;for(e in t)e!==Tz&&(i=L3+st._capitalize(e),st._isFunction(this[i])?this[i](t[e]):this._setAttr(e,t[e]))}),this}isListening(){return this._getCache(jA,this._isListening)}_isListening(t){if(!this.listening())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isListening(t):!0}isVisible(){return this._getCache(HA,this._isVisible)}_isVisible(t){if(!this.visible())return!1;const i=this.getParent();return i&&i!==t&&this!==t?i._isVisible(t):!0}shouldDrawHit(t,e=!1){if(t)return this._isVisible(t)&&this._isListening(t);const i=this.getLayer();let s=!1;nn._dragElements.forEach(c=>{c.dragStatus==="dragging"&&(c.node.nodeType==="Stage"||c.node.getLayer()===i)&&(s=!0)});const l=!e&&!Ut.hitOnDragEnabled&&(s||Ut.isTransforming());return this.isListening()&&this.isVisible()&&!l}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let t=this.getDepth(),e=this,i=0,s,l,c,f;function m(A){for(s=[],l=A.length,c=0;c<l;c++)f=A[c],i++,f.nodeType!==k3&&(s=s.concat(f.getChildren().slice())),f._id===e._id&&(c=l);s.length>0&&s[0].getDepth()<=t&&m(s)}const g=this.getStage();return e.nodeType!==Iz&&g&&m(g.getChildren()),i}getDepth(){let t=0,e=this.parent;for(;e;)t++,e=e.parent;return t}_batchTransformChanges(t){this._batchingTransformChange=!0,t(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(qc),this._clearSelfAndDescendantCache(Eu)),this._needClearTransformCache=!1}setPosition(t){return this._batchTransformChanges(()=>{this.x(t.x),this.y(t.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const t=this.getStage();if(!t)return null;const e=t.getPointerPosition();if(!e)return null;const i=this.getAbsoluteTransform().copy();return i.invert(),i.point(e)}getAbsolutePosition(t){let e=!1,i=this.parent;for(;i;){if(i.isCached()){e=!0;break}i=i.parent}e&&!t&&(t=!0);const s=this.getAbsoluteTransform(t).getMatrix(),l=new pr,c=this.offset();return l.m=s.slice(),l.translate(c.x,c.y),l.getTranslation()}setAbsolutePosition(t){const{x:e,y:i,...s}=this._clearTransform();this.attrs.x=e,this.attrs.y=i,this._clearCache(qc);const l=this._getAbsoluteTransform().copy();return l.invert(),l.translate(t.x,t.y),t={x:this.attrs.x+l.getTranslation().x,y:this.attrs.y+l.getTranslation().y},this._setTransform(s),this.setPosition({x:t.x,y:t.y}),this._clearCache(qc),this._clearSelfAndDescendantCache(Eu),this}_setTransform(t){let e;for(e in t)this.attrs[e]=t[e]}_clearTransform(){const t={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,t}move(t){let e=t.x,i=t.y,s=this.x(),l=this.y();return e!==void 0&&(s+=e),i!==void 0&&(l+=i),this.setPosition({x:s,y:l}),this}_eachAncestorReverse(t,e){let i=[],s=this.getParent(),l,c;if(!(e&&e._id===this._id)){for(i.unshift(this);s&&(!e||s._id!==e._id);)i.unshift(s),s=s.parent;for(l=i.length,c=0;c<l;c++)t(i[c])}}rotate(t){return this.rotation(this.rotation()+t),this}moveToTop(){if(!this.parent)return st.warn("Node has no parent. moveToTop function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return st.warn("Node has no parent. moveUp function is ignored."),!1;const t=this.index,e=this.parent.getChildren().length;return t<e-1?(this.parent.children.splice(t,1),this.parent.children.splice(t+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return st.warn("Node has no parent. moveDown function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.splice(t-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return st.warn("Node has no parent. moveToBottom function is ignored."),!1;const t=this.index;return t>0?(this.parent.children.splice(t,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(t){if(!this.parent)return st.warn("Node has no parent. zIndex parameter is ignored."),this;(t<0||t>=this.parent.children.length)&&st.warn("Unexpected value "+t+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const e=this.index;return this.parent.children.splice(e,1),this.parent.children.splice(t,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(jy,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let t=this.opacity();const e=this.getParent();return e&&!e._isUnderCache&&(t*=e.getAbsoluteOpacity()),t}moveTo(t){return this.getParent()!==t&&(this._remove(),t.add(this)),this}toObject(){let t=this.getAttrs(),e,i,s,l,c;const f={attrs:{},className:this.getClassName()};for(e in t)i=t[e],c=st.isObject(i)&&!st._isPlainObject(i)&&!st._isArray(i),!c&&(s=typeof this[e]=="function"&&this[e],delete t[e],l=s?s.call(this):null,t[e]=i,l!==i&&(f.attrs[e]=i));return st._prepareToStringify(f)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(t,e,i){const s=[];e&&this._isMatch(t)&&s.push(this);let l=this.parent;for(;l;){if(l===i)return s;l._isMatch(t)&&s.push(l),l=l.parent}return s}isAncestorOf(t){return!1}findAncestor(t,e,i){return this.findAncestors(t,e,i)[0]}_isMatch(t){if(!t)return!1;if(typeof t=="function")return t(this);let e=t.replace(/ /g,"").split(","),i=e.length,s,l;for(s=0;s<i;s++)if(l=e[s],st.isValidSelector(l)||(st.warn('Selector "'+l+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),st.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),st.warn("Konva is awesome, right?")),l.charAt(0)==="#"){if(this.id()===l.slice(1))return!0}else if(l.charAt(0)==="."){if(this.hasName(l.slice(1)))return!0}else if(this.className===l||this.nodeType===l)return!0;return!1}getLayer(){const t=this.getParent();return t?t.getLayer():null}getStage(){return this._getCache(P3,this._getStage)}_getStage(){const t=this.getParent();return t?t.getStage():null}fire(t,e={},i){return e.target=e.target||this,i?this._fireAndBubble(t,e):this._fire(t,e),this}getAbsoluteTransform(t){return t?this._getAbsoluteTransform(t):this._getCache(Eu,this._getAbsoluteTransform)}_getAbsoluteTransform(t){let e;if(t)return e=new pr,this._eachAncestorReverse(function(i){const s=i.transformsEnabled();s==="all"?e.multiply(i.getTransform()):s==="position"&&e.translate(i.x()-i.offsetX(),i.y()-i.offsetY())},t),e;{e=this._cache.get(Eu)||new pr,this.parent?this.parent.getAbsoluteTransform().copyInto(e):e.reset();const i=this.transformsEnabled();if(i==="all")e.multiply(this.getTransform());else if(i==="position"){const s=this.attrs.x||0,l=this.attrs.y||0,c=this.attrs.offsetX||0,f=this.attrs.offsetY||0;e.translate(s-c,l-f)}return e.dirty=!1,e}}getAbsoluteScale(t){let e=this;for(;e;)e._isUnderCache&&(t=e),e=e.getParent();const s=this.getAbsoluteTransform(t).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(qc,this._getTransform)}_getTransform(){var t,e;const i=this._cache.get(qc)||new pr;i.reset();const s=this.x(),l=this.y(),c=Ut.getAngle(this.rotation()),f=(t=this.attrs.scaleX)!==null&&t!==void 0?t:1,m=(e=this.attrs.scaleY)!==null&&e!==void 0?e:1,g=this.attrs.skewX||0,A=this.attrs.skewY||0,E=this.attrs.offsetX||0,T=this.attrs.offsetY||0;return(s!==0||l!==0)&&i.translate(s,l),c!==0&&i.rotate(c),(g!==0||A!==0)&&i.skew(g,A),(f!==1||m!==1)&&i.scale(f,m),(E!==0||T!==0)&&i.translate(-1*E,-1*T),i.dirty=!1,i}clone(t){let e=st.cloneObject(this.attrs),i,s,l,c,f;for(i in t)e[i]=t[i];const m=new this.constructor(e);for(i in this.eventListeners)for(s=this.eventListeners[i],l=s.length,c=0;c<l;c++)f=s[c],f.name.indexOf(bz)<0&&(m.eventListeners[i]||(m.eventListeners[i]=[]),m.eventListeners[i].push(f));return m}_toKonvaCanvas(t){t=t||{};const e=this.getClientRect(),i=this.getStage(),s=t.x!==void 0?t.x:Math.floor(e.x),l=t.y!==void 0?t.y:Math.floor(e.y),c=t.pixelRatio||1,f=new Wc({width:t.width||Math.ceil(e.width)||(i?i.width():0),height:t.height||Math.ceil(e.height)||(i?i.height():0),pixelRatio:c}),m=f.getContext(),g=new Wc({width:f.width/f.pixelRatio+Math.abs(s),height:f.height/f.pixelRatio+Math.abs(l),pixelRatio:f.pixelRatio});return t.imageSmoothingEnabled===!1&&(m._context.imageSmoothingEnabled=!1),m.save(),(s||l)&&m.translate(-1*s,-1*l),this.drawScene(f,void 0,g),m.restore(),f}toCanvas(t){return this._toKonvaCanvas(t)._canvas}toDataURL(t){t=t||{};const e=t.mimeType||null,i=t.quality||null,s=this._toKonvaCanvas(t).toDataURL(e,i);return t.callback&&t.callback(s),s}toImage(t){return new Promise((e,i)=>{try{const s=t?.callback;s&&delete t.callback,st._urlToImage(this.toDataURL(t),function(l){e(l),s?.(l)})}catch(s){i(s)}})}toBlob(t){return new Promise((e,i)=>{try{const s=t?.callback;s&&delete t.callback,this.toCanvas(t).toBlob(l=>{e(l),s?.(l)},t?.mimeType,t?.quality)}catch(s){i(s)}})}setSize(t){return this.width(t.width),this.height(t.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Ut.dragDistance}_off(t,e,i){let s=this.eventListeners[t],l,c,f;for(l=0;l<s.length;l++)if(c=s[l].name,f=s[l].handler,(c!=="konva"||e==="konva")&&(!e||c===e)&&(!i||i===f)){if(s.splice(l,1),s.length===0){delete this.eventListeners[t];break}l--}}_fireChangeEvent(t,e,i){this._fire(t+Sz,{oldVal:e,newVal:i})}addName(t){if(!this.hasName(t)){const e=this.name(),i=e?e+" "+t:t;this.name(i)}return this}hasName(t){if(!t)return!1;const e=this.name();return e?(e||"").split(/\s/g).indexOf(t)!==-1:!1}removeName(t){const e=(this.name()||"").split(/\s/g),i=e.indexOf(t);return i!==-1&&(e.splice(i,1),this.name(e.join(" "))),this}setAttr(t,e){const i=this[L3+st._capitalize(t)];return st._isFunction(i)?i.call(this,e):this._setAttr(t,e),this}_requestDraw(){if(Ut.autoDrawEnabled){const t=this.getLayer()||this.getStage();t?.batchDraw()}}_setAttr(t,e){const i=this.attrs[t];i===e&&!st.isObject(e)||(e==null?delete this.attrs[t]:this.attrs[t]=e,this._shouldFireChangeEvents&&this._fireChangeEvent(t,i,e),this._requestDraw())}_setComponentAttr(t,e,i){let s;i!==void 0&&(s=this.attrs[t],s||(this.attrs[t]=this.getAttr(t)),this.attrs[t][e]=i,this._fireChangeEvent(t,s,i))}_fireAndBubble(t,e,i){e&&this.nodeType===k3&&(e.target=this);const s=[Cz,wz,Rz,xz,Nz,Dz];if(!(s.indexOf(t)!==-1&&(i&&(this===i||this.isAncestorOf&&this.isAncestorOf(i))||this.nodeType==="Stage"&&!i))){this._fire(t,e);const c=s.indexOf(t)!==-1&&i&&i.isAncestorOf&&i.isAncestorOf(this)&&!i.isAncestorOf(this.parent);(e&&!e.cancelBubble||!e)&&this.parent&&this.parent.isListening()&&!c&&(i&&i.parent?this._fireAndBubble.call(this.parent,t,e,i):this._fireAndBubble.call(this.parent,t,e))}}_getProtoListeners(t){var e,i;const{nodeType:s}=this,l=It.protoListenerMap.get(s)||{};let c=l?.[t];if(c===void 0){c=[];let f=Object.getPrototypeOf(this);for(;f;){const m=(i=(e=f.eventListeners)===null||e===void 0?void 0:e[t])!==null&&i!==void 0?i:[];c.push(...m),f=Object.getPrototypeOf(f)}l[t]=c,It.protoListenerMap.set(s,l)}return c}_fire(t,e){e=e||{},e.currentTarget=this,e.type=t;const i=this._getProtoListeners(t);if(i)for(let l=0;l<i.length;l++)i[l].handler.call(this,e);const s=this.eventListeners[t];if(s)for(let l=0;l<s.length;l++)s[l].handler.call(this,e)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(t){const e=t?t.pointerId:void 0,i=this.getStage(),s=this.getAbsolutePosition();if(!i)return;const l=i._getPointerById(e)||i._changedPointerPositions[0]||s;nn._dragElements.set(this._id,{node:this,startPointerPos:l,offset:{x:l.x-s.x,y:l.y-s.y},dragStatus:"ready",pointerId:e})}startDrag(t,e=!0){nn._dragElements.has(this._id)||this._createDragElement(t);const i=nn._dragElements.get(this._id);i.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:t&&t.evt},e)}_setDragPosition(t,e){const i=this.getStage()._getPointerById(e.pointerId);if(!i)return;let s={x:i.x-e.offset.x,y:i.y-e.offset.y};const l=this.dragBoundFunc();if(l!==void 0){const c=l.call(this,s,t);c?s=c:st.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(t){const e=nn._dragElements.get(this._id);e&&(e.dragStatus="stopped"),nn._endDragBefore(t),nn._endDragAfter(t)}setDraggable(t){this._setAttr("draggable",t),this._dragChange()}isDragging(){const t=nn._dragElements.get(this._id);return t?t.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(t){if(!(!(t.evt.button!==void 0)||Ut.dragButtons.indexOf(t.evt.button)>=0)||this.isDragging())return;let s=!1;nn._dragElements.forEach(l=>{this.isAncestorOf(l.node)&&(s=!0)}),s||this._createDragElement(t)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const e=nn._dragElements.get(this._id),i=e&&e.dragStatus==="dragging",s=e&&e.dragStatus==="ready";i?this.stopDrag():s&&nn._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(t={x:0,y:0}){const e=this.getStage();if(!e)return!1;const i={x:-t.x,y:-t.y,width:e.width()+2*t.x,height:e.height()+2*t.y};return st.haveIntersection(i,this.getClientRect())}static create(t,e){return st._isString(t)&&(t=JSON.parse(t)),this._createNode(t,e)}static _createNode(t,e){let i=It.prototype.getClassName.call(t),s=t.children,l,c,f;e&&(t.attrs.container=e),Ut[i]||(st.warn('Can not find a node with class name "'+i+'". Fallback to "Shape".'),i="Shape");const m=Ut[i];if(l=new m(t.attrs),s)for(c=s.length,f=0;f<c;f++)l.add(It._createNode(s[f]));return l}}It.protoListenerMap=new Map;It.prototype.nodeType="Node";It.prototype._attrsAffectingSize=[];It.prototype.eventListeners={};It.prototype.on.call(It.prototype,Oz,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(qc),this._clearSelfAndDescendantCache(Eu)});It.prototype.on.call(It.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(HA)});It.prototype.on.call(It.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(jA)});It.prototype.on.call(It.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(jy)});const bn=K.addGetterSetter;bn(It,"zIndex");bn(It,"absolutePosition");bn(It,"position");bn(It,"x",0,kt());bn(It,"y",0,kt());bn(It,"globalCompositeOperation","source-over",Yf());bn(It,"opacity",1,kt());bn(It,"name","",Yf());bn(It,"id","",Yf());bn(It,"rotation",0,kt());K.addComponentsGetterSetter(It,"scale",["x","y"]);bn(It,"scaleX",1,kt());bn(It,"scaleY",1,kt());K.addComponentsGetterSetter(It,"skew",["x","y"]);bn(It,"skewX",0,kt());bn(It,"skewY",0,kt());K.addComponentsGetterSetter(It,"offset",["x","y"]);bn(It,"offsetX",0,kt());bn(It,"offsetY",0,kt());bn(It,"dragDistance",void 0,kt());bn(It,"width",0,kt());bn(It,"height",0,kt());bn(It,"listening",!0,jl());bn(It,"preventDefault",!0,jl());bn(It,"filters",void 0,function(n){return this._filterUpToDate=!1,n});bn(It,"visible",!0,jl());bn(It,"transformsEnabled","all",Yf());bn(It,"size");bn(It,"dragBoundFunc");bn(It,"draggable",!1,jl());K.backCompat(It,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});class _r extends It{constructor(){super(...arguments),this.children=[]}getChildren(t){const e=this.children||[];return t?e.filter(t):e}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(t=>{t.parent=null,t.index=0,t.destroy()}),this.children=[],this._requestDraw(),this}add(...t){if(t.length===0)return this;if(t.length>1){for(let i=0;i<t.length;i++)this.add(t[i]);return this}const e=t[0];return e.getParent()?(e.moveTo(this),this):(this._validateAdd(e),e.index=this.getChildren().length,e.parent=this,e._clearCaches(),this.getChildren().push(e),this._fire("add",{child:e}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(t){return this._generalFind(t,!1)}findOne(t){const e=this._generalFind(t,!0);return e.length>0?e[0]:void 0}_generalFind(t,e){const i=[];return this._descendants(s=>{const l=s._isMatch(t);return l&&i.push(s),!!(l&&e)}),i}_descendants(t){let e=!1;const i=this.getChildren();for(const s of i){if(e=t(s),e)return!0;if(s.hasChildren()&&(e=s._descendants(t),e))return!0}return!1}toObject(){const t=It.prototype.toObject.call(this);return t.children=[],this.getChildren().forEach(e=>{t.children.push(e.toObject())}),t}isAncestorOf(t){let e=t.getParent();for(;e;){if(e._id===this._id)return!0;e=e.getParent()}return!1}clone(t){const e=It.prototype.clone.call(this,t);return this.getChildren().forEach(function(i){e.add(i.clone())}),e}getAllIntersections(t){const e=[];return this.find("Shape").forEach(i=>{i.isVisible()&&i.intersects(t)&&e.push(i)}),e}_clearSelfAndDescendantCache(t){var e;super._clearSelfAndDescendantCache(t),!this.isCached()&&((e=this.children)===null||e===void 0||e.forEach(function(i){i._clearSelfAndDescendantCache(t)}))}_setChildrenIndices(){var t;(t=this.children)===null||t===void 0||t.forEach(function(e,i){e.index=i}),this._requestDraw()}drawScene(t,e,i){const s=this.getLayer(),l=t||s&&s.getCanvas(),c=l&&l.getContext(),f=this._getCanvasCache(),m=f&&f.scene,g=l&&l.isCache;if(!this.isVisible()&&!g)return this;if(m){c.save();const A=this.getAbsoluteTransform(e).getMatrix();c.transform(A[0],A[1],A[2],A[3],A[4],A[5]),this._drawCachedSceneCanvas(c),c.restore()}else this._drawChildren("drawScene",l,e,i);return this}drawHit(t,e){if(!this.shouldDrawHit(e))return this;const i=this.getLayer(),s=t||i&&i.hitCanvas,l=s&&s.getContext(),c=this._getCanvasCache();if(c&&c.hit){l.save();const m=this.getAbsoluteTransform(e).getMatrix();l.transform(m[0],m[1],m[2],m[3],m[4],m[5]),this._drawCachedHitCanvas(l),l.restore()}else this._drawChildren("drawHit",s,e);return this}_drawChildren(t,e,i,s){var l;const c=e&&e.getContext(),f=this.clipWidth(),m=this.clipHeight(),g=this.clipFunc(),A=typeof f=="number"&&typeof m=="number"||g,E=i===this;if(A){c.save();const x=this.getAbsoluteTransform(i);let R=x.getMatrix();c.transform(R[0],R[1],R[2],R[3],R[4],R[5]),c.beginPath();let O;if(g)O=g.call(this,c,this);else{const M=this.clipX(),H=this.clipY();c.rect(M||0,H||0,f,m)}c.clip.apply(c,O),R=x.copy().invert().getMatrix(),c.transform(R[0],R[1],R[2],R[3],R[4],R[5])}const T=!E&&this.globalCompositeOperation()!=="source-over"&&t==="drawScene";T&&(c.save(),c._applyGlobalCompositeOperation(this)),(l=this.children)===null||l===void 0||l.forEach(function(x){x[t](e,i,s)}),T&&c.restore(),A&&c.restore()}getClientRect(t={}){var e;const i=t.skipTransform,s=t.relativeTo;let l,c,f,m,g={x:1/0,y:1/0,width:0,height:0};const A=this;(e=this.children)===null||e===void 0||e.forEach(function(x){if(!x.visible())return;const R=x.getClientRect({relativeTo:A,skipShadow:t.skipShadow,skipStroke:t.skipStroke});R.width===0&&R.height===0||(l===void 0?(l=R.x,c=R.y,f=R.x+R.width,m=R.y+R.height):(l=Math.min(l,R.x),c=Math.min(c,R.y),f=Math.max(f,R.x+R.width),m=Math.max(m,R.y+R.height)))});const E=this.find("Shape");let T=!1;for(let x=0;x<E.length;x++)if(E[x]._isVisible(this)){T=!0;break}return T&&l!==void 0?g={x:l,y:c,width:f-l,height:m-c}:g={x:0,y:0,width:0,height:0},i?g:this._transformedRect(g,s)}}K.addComponentsGetterSetter(_r,"clip",["x","y","width","height"]);K.addGetterSetter(_r,"clipX",void 0,kt());K.addGetterSetter(_r,"clipY",void 0,kt());K.addGetterSetter(_r,"clipWidth",void 0,kt());K.addGetterSetter(_r,"clipHeight",void 0,kt());K.addGetterSetter(_r,"clipFunc");const d0=new Map,O8=Ut._global.PointerEvent!==void 0;function M2(n){return d0.get(n)}function WS(n){return{evt:n,pointerId:n.pointerId}}function M8(n,t){return d0.get(n)===t}function L8(n,t){Gg(n),t.getStage()&&(d0.set(n,t),O8&&t._fire("gotpointercapture",WS(new PointerEvent("gotpointercapture"))))}function Gg(n,t){const e=d0.get(n);if(!e)return;const i=e.getStage();i&&i.content,d0.delete(n),O8&&e._fire("lostpointercapture",WS(new PointerEvent("lostpointercapture")))}const Lz="Stage",kz="string",V3="px",Pz="mouseout",k8="mouseleave",P8="mouseover",V8="mouseenter",U8="mousemove",z8="mousedown",B8="mouseup",wg="pointermove",Rg="pointerdown",am="pointerup",xg="pointercancel",Vz="lostpointercapture",Ey="pointerout",Ng="pointerleave",Sy="pointerover",Ty="pointerenter",GA="contextmenu",j8="touchstart",H8="touchend",G8="touchmove",q8="touchcancel",qA="wheel",Uz=5,zz=[[V8,"_pointerenter"],[z8,"_pointerdown"],[U8,"_pointermove"],[B8,"_pointerup"],[k8,"_pointerleave"],[j8,"_pointerdown"],[G8,"_pointermove"],[H8,"_pointerup"],[q8,"_pointercancel"],[P8,"_pointerover"],[qA,"_wheel"],[GA,"_contextmenu"],[Rg,"_pointerdown"],[wg,"_pointermove"],[am,"_pointerup"],[xg,"_pointercancel"],[Ng,"_pointerleave"],[Vz,"_lostpointercapture"]],L2={mouse:{[Ey]:Pz,[Ng]:k8,[Sy]:P8,[Ty]:V8,[wg]:U8,[Rg]:z8,[am]:B8,[xg]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[Ey]:"touchout",[Ng]:"touchleave",[Sy]:"touchover",[Ty]:"touchenter",[wg]:G8,[Rg]:j8,[am]:H8,[xg]:q8,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[Ey]:Ey,[Ng]:Ng,[Sy]:Sy,[Ty]:Ty,[wg]:wg,[Rg]:Rg,[am]:am,[xg]:xg,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},Dg=n=>n.indexOf("pointer")>=0?"pointer":n.indexOf("touch")>=0?"touch":"mouse",Kd=n=>{const t=Dg(n);if(t==="pointer")return Ut.pointerEventsEnabled&&L2.pointer;if(t==="touch")return L2.touch;if(t==="mouse")return L2.mouse};function U3(n={}){return(n.clipFunc||n.clipWidth||n.clipHeight)&&st.warn("Stage does not support clipping. Please use clip for Layers or Groups."),n}const Bz="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);",qg=[];let yv=class extends _r{constructor(t){super(U3(t)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),qg.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{U3(this.attrs)}),this._checkVisibility()}_validateAdd(t){const e=t.getType()==="Layer",i=t.getType()==="FastLayer";e||i||st.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const t=this.visible()?"":"none";this.content.style.display=t}setContainer(t){if(typeof t===kz){let e;if(t.charAt(0)==="."){const i=t.slice(1);t=document.getElementsByClassName(i)[0]}else t.charAt(0)!=="#"?e=t:e=t.slice(1),t=document.getElementById(e);if(!t)throw"Can not find container in document with id "+e}return this._setAttr("container",t),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),t.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const t=this.children,e=t.length;for(let i=0;i<e;i++)t[i].clear();return this}clone(t){return t||(t={}),t.container=typeof document<"u"&&document.createElement("div"),_r.prototype.clone.call(this,t)}destroy(){super.destroy();const t=this.content;t&&st._isInDocument(t)&&this.container().removeChild(t);const e=qg.indexOf(this);return e>-1&&qg.splice(e,1),st.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const t=this._pointerPositions[0]||this._changedPointerPositions[0];return t?{x:t.x,y:t.y}:(st.warn(Bz),null)}_getPointerById(t){return this._pointerPositions.find(e=>e.id===t)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(t){t={...t},t.x=t.x||0,t.y=t.y||0,t.width=t.width||this.width(),t.height=t.height||this.height();const e=new Wc({width:t.width,height:t.height,pixelRatio:t.pixelRatio||1}),i=e.getContext()._context,s=this.children;return(t.x||t.y)&&i.translate(-1*t.x,-1*t.y),s.forEach(function(l){if(!l.isVisible())return;const c=l._toKonvaCanvas(t);i.drawImage(c._canvas,t.x,t.y,c.getWidth()/c.getPixelRatio(),c.getHeight()/c.getPixelRatio())}),e}getIntersection(t){if(!t)return null;const e=this.children,i=e.length,s=i-1;for(let l=s;l>=0;l--){const c=e[l].getIntersection(t);if(c)return c}return null}_resizeDOM(){const t=this.width(),e=this.height();this.content&&(this.content.style.width=t+V3,this.content.style.height=e+V3),this.bufferCanvas.setSize(t,e),this.bufferHitCanvas.setSize(t,e),this.children.forEach(i=>{i.setSize({width:t,height:e}),i.draw()})}add(t,...e){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}super.add(t);const i=this.children.length;return i>Uz&&st.warn("The stage has "+i+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),t.setSize({width:this.width(),height:this.height()}),t.draw(),Ut.isBrowser&&this.content.appendChild(t.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(t){return M8(t,this)}setPointerCapture(t){L8(t,this)}releaseCapture(t){Gg(t)}getLayers(){return this.children}_bindContentEvents(){Ut.isBrowser&&zz.forEach(([t,e])=>{this.content.addEventListener(t,i=>{this[e](i)},{passive:!1})})}_pointerenter(t){this.setPointersPositions(t);const e=Kd(t.type);e&&this._fire(e.pointerenter,{evt:t,target:this,currentTarget:this})}_pointerover(t){this.setPointersPositions(t);const e=Kd(t.type);e&&this._fire(e.pointerover,{evt:t,target:this,currentTarget:this})}_getTargetShape(t){let e=this[t+"targetShape"];return e&&!e.getStage()&&(e=null),e}_pointerleave(t){const e=Kd(t.type),i=Dg(t.type);if(!e)return;this.setPointersPositions(t);const s=this._getTargetShape(i),l=!(Ut.isDragging()||Ut.isTransforming())||Ut.hitOnDragEnabled;s&&l?(s._fireAndBubble(e.pointerout,{evt:t}),s._fireAndBubble(e.pointerleave,{evt:t}),this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this[i+"targetShape"]=null):l&&(this._fire(e.pointerleave,{evt:t,target:this,currentTarget:this}),this._fire(e.pointerout,{evt:t,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(t){const e=Kd(t.type),i=Dg(t.type);if(!e)return;this.setPointersPositions(t);let s=!1;this._changedPointerPositions.forEach(l=>{const c=this.getIntersection(l);if(nn.justDragged=!1,Ut["_"+i+"ListenClick"]=!0,!c||!c.isListening()){this[i+"ClickStartShape"]=void 0;return}Ut.capturePointerEventsEnabled&&c.setPointerCapture(l.id),this[i+"ClickStartShape"]=c,c._fireAndBubble(e.pointerdown,{evt:t,pointerId:l.id}),s=!0;const f=t.type.indexOf("touch")>=0;c.preventDefault()&&t.cancelable&&f&&t.preventDefault()}),s||this._fire(e.pointerdown,{evt:t,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(t){const e=Kd(t.type),i=Dg(t.type);if(!e)return;const s=t.type.indexOf("touch")>=0||t.pointerType==="touch";if(Ut.isDragging()&&nn.node.preventDefault()&&t.cancelable&&s&&t.preventDefault(),this.setPointersPositions(t),!(!(Ut.isDragging()||Ut.isTransforming())||Ut.hitOnDragEnabled))return;const c={};let f=!1;const m=this._getTargetShape(i);this._changedPointerPositions.forEach(g=>{const A=M2(g.id)||this.getIntersection(g),E=g.id,T={evt:t,pointerId:E},x=m!==A;if(x&&m&&(m._fireAndBubble(e.pointerout,{...T},A),m._fireAndBubble(e.pointerleave,{...T},A)),A){if(c[A._id])return;c[A._id]=!0}A&&A.isListening()?(f=!0,x&&(A._fireAndBubble(e.pointerover,{...T},m),A._fireAndBubble(e.pointerenter,{...T},m),this[i+"targetShape"]=A),A._fireAndBubble(e.pointermove,{...T})):m&&(this._fire(e.pointerover,{evt:t,target:this,currentTarget:this,pointerId:E}),this[i+"targetShape"]=null)}),f||this._fire(e.pointermove,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(t){const e=Kd(t.type),i=Dg(t.type);if(!e)return;this.setPointersPositions(t);const s=this[i+"ClickStartShape"],l=this[i+"ClickEndShape"],c={};let f=!1;this._changedPointerPositions.forEach(m=>{const g=M2(m.id)||this.getIntersection(m);if(g){if(g.releaseCapture(m.id),c[g._id])return;c[g._id]=!0}const A=m.id,E={evt:t,pointerId:A};let T=!1;Ut["_"+i+"InDblClickWindow"]?(T=!0,clearTimeout(this[i+"DblTimeout"])):nn.justDragged||(Ut["_"+i+"InDblClickWindow"]=!0,clearTimeout(this[i+"DblTimeout"])),this[i+"DblTimeout"]=setTimeout(function(){Ut["_"+i+"InDblClickWindow"]=!1},Ut.dblClickWindow),g&&g.isListening()?(f=!0,this[i+"ClickEndShape"]=g,g._fireAndBubble(e.pointerup,{...E}),Ut["_"+i+"ListenClick"]&&s&&s===g&&(g._fireAndBubble(e.pointerclick,{...E}),T&&l&&l===g&&g._fireAndBubble(e.pointerdblclick,{...E}))):(this[i+"ClickEndShape"]=null,f||(this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),f=!0),Ut["_"+i+"ListenClick"]&&this._fire(e.pointerclick,{evt:t,target:this,currentTarget:this,pointerId:A}),T&&this._fire(e.pointerdblclick,{evt:t,target:this,currentTarget:this,pointerId:A}))}),f||this._fire(e.pointerup,{evt:t,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),Ut["_"+i+"ListenClick"]=!1,t.cancelable&&i!=="touch"&&i!=="pointer"&&t.preventDefault()}_contextmenu(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(GA,{evt:t}):this._fire(GA,{evt:t,target:this,currentTarget:this})}_wheel(t){this.setPointersPositions(t);const e=this.getIntersection(this.getPointerPosition());e&&e.isListening()?e._fireAndBubble(qA,{evt:t}):this._fire(qA,{evt:t,target:this,currentTarget:this})}_pointercancel(t){this.setPointersPositions(t);const e=M2(t.pointerId)||this.getIntersection(this.getPointerPosition());e&&e._fireAndBubble(am,WS(t)),Gg(t.pointerId)}_lostpointercapture(t){Gg(t.pointerId)}setPointersPositions(t){const e=this._getContentPosition();let i=null,s=null;t=t||window.event,t.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(t.touches,l=>{this._pointerPositions.push({id:l.identifier,x:(l.clientX-e.left)/e.scaleX,y:(l.clientY-e.top)/e.scaleY})}),Array.prototype.forEach.call(t.changedTouches||t.touches,l=>{this._changedPointerPositions.push({id:l.identifier,x:(l.clientX-e.left)/e.scaleX,y:(l.clientY-e.top)/e.scaleY})})):(i=(t.clientX-e.left)/e.scaleX,s=(t.clientY-e.top)/e.scaleY,this.pointerPos={x:i,y:s},this._pointerPositions=[{x:i,y:s,id:st._getFirstPointerId(t)}],this._changedPointerPositions=[{x:i,y:s,id:st._getFirstPointerId(t)}])}_setPointerPosition(t){st.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(t)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const t=this.content.getBoundingClientRect();return{top:t.top,left:t.left,scaleX:t.width/this.content.clientWidth||1,scaleY:t.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new Wc({width:this.width(),height:this.height()}),this.bufferHitCanvas=new XS({pixelRatio:1,width:this.width(),height:this.height()}),!Ut.isBrowser)return;const t=this.container();if(!t)throw"Stage has no container. A container is required.";t.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),t.appendChild(this.content),this._resizeDOM()}cache(){return st.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(t){t.batchDraw()}),this}};yv.prototype.nodeType=Lz;li(yv);K.addGetterSetter(yv,"container");Ut.isBrowser&&document.addEventListener("visibilitychange",()=>{qg.forEach(n=>{n.batchDraw()})});const F8="hasShadow",Y8="shadowRGBA",Q8="patternImage",X8="linearGradient",K8="radialGradient";let by;function k2(){return by||(by=st.createCanvasElement().getContext("2d"),by)}const Fg={};function jz(n){const t=this.attrs.fillRule;t?n.fill(t):n.fill()}function Hz(n){n.stroke()}function Gz(n){const t=this.attrs.fillRule;t?n.fill(t):n.fill()}function qz(n){n.stroke()}function Fz(){this._clearCache(F8)}function Yz(){this._clearCache(Y8)}function Qz(){this._clearCache(Q8)}function Xz(){this._clearCache(X8)}function Kz(){this._clearCache(K8)}class xt extends It{constructor(t){super(t);let e,i=0;for(;e=st.getHitColor(),!(e&&!(e in Fg));)if(i++,i>=1e4){st.warn("Failed to find a unique color key for a shape. Konva may work incorrectly. Most likely your browser is using canvas farbling. Consider disabling it."),e=st.getRandomColor();break}this.colorKey=e,Fg[e]=this}getContext(){return st.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return st.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(F8,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(Q8,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const e=k2().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(e&&e.setTransform){const i=new pr;i.translate(this.fillPatternX(),this.fillPatternY()),i.rotate(Ut.getAngle(this.fillPatternRotation())),i.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),i.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const s=i.getMatrix(),l=typeof DOMMatrix>"u"?{a:s[0],b:s[1],c:s[2],d:s[3],e:s[4],f:s[5]}:new DOMMatrix(s);e.setTransform(l)}return e}}_getLinearGradient(){return this._getCache(X8,this.__getLinearGradient)}__getLinearGradient(){const t=this.fillLinearGradientColorStops();if(t){const e=k2(),i=this.fillLinearGradientStartPoint(),s=this.fillLinearGradientEndPoint(),l=e.createLinearGradient(i.x,i.y,s.x,s.y);for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}_getRadialGradient(){return this._getCache(K8,this.__getRadialGradient)}__getRadialGradient(){const t=this.fillRadialGradientColorStops();if(t){const e=k2(),i=this.fillRadialGradientStartPoint(),s=this.fillRadialGradientEndPoint(),l=e.createRadialGradient(i.x,i.y,this.fillRadialGradientStartRadius(),s.x,s.y,this.fillRadialGradientEndRadius());for(let c=0;c<t.length;c+=2)l.addColorStop(t[c],t[c+1]);return l}}getShadowRGBA(){return this._getCache(Y8,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const t=st.colorToRGBA(this.shadowColor());if(t)return"rgba("+t.r+","+t.g+","+t.b+","+t.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const t=this.hitStrokeWidth();return t==="auto"?this.hasStroke():this.strokeEnabled()&&!!t}intersects(t){const e=this.getStage();if(!e)return!1;const i=e.bufferHitCanvas;return i.getContext().clear(),this.drawHit(i,void 0,!0),i.context.getImageData(Math.round(t.x),Math.round(t.y),1,1).data[3]>0}destroy(){return It.prototype.destroy.call(this),delete Fg[this.colorKey],delete this.colorKey,this}_useBufferCanvas(t){var e;if(!((e=this.attrs.perfectDrawEnabled)!==null&&e!==void 0?e:!0))return!1;const s=t||this.hasFill(),l=this.hasStroke(),c=this.getAbsoluteOpacity()!==1;if(s&&l&&c)return!0;const f=this.hasShadow(),m=this.shadowForStrokeEnabled();return!!(s&&l&&f&&m)}setStrokeHitEnabled(t){st.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),t?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const t=this.size();return{x:this._centroid?-t.width/2:0,y:this._centroid?-t.height/2:0,width:t.width,height:t.height}}getClientRect(t={}){let e=!1,i=this.getParent();for(;i;){if(i.isCached()){e=!0;break}i=i.getParent()}const s=t.skipTransform,l=t.relativeTo||e&&this.getStage()||void 0,c=this.getSelfRect(),m=!t.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,g=c.width+m,A=c.height+m,E=!t.skipShadow&&this.hasShadow(),T=E?this.shadowOffsetX():0,x=E?this.shadowOffsetY():0,R=g+Math.abs(T),O=A+Math.abs(x),M=E&&this.shadowBlur()||0,H=R+M*2,B=O+M*2,Y={width:H,height:B,x:-(m/2+M)+Math.min(T,0)+c.x,y:-(m/2+M)+Math.min(x,0)+c.y};return s?Y:this._transformedRect(Y,l)}drawScene(t,e,i){const s=this.getLayer(),l=t||s.getCanvas(),c=l.getContext(),f=this._getCanvasCache(),m=this.getSceneFunc(),g=this.hasShadow();let A;const E=e===this;if(!this.isVisible()&&!E)return this;if(f){c.save();const T=this.getAbsoluteTransform(e).getMatrix();return c.transform(T[0],T[1],T[2],T[3],T[4],T[5]),this._drawCachedSceneCanvas(c),c.restore(),this}if(!m)return this;if(c.save(),this._useBufferCanvas()){A=this.getStage();const T=i||A.bufferCanvas,x=T.getContext();i?(x.save(),x.setTransform(1,0,0,1,0,0),x.clearRect(0,0,T.width,T.height),x.restore()):x.clear(),x.save(),x._applyLineJoin(this),x._applyMiterLimit(this);const R=this.getAbsoluteTransform(e).getMatrix();x.transform(R[0],R[1],R[2],R[3],R[4],R[5]),m.call(this,x,this),x.restore();const O=T.pixelRatio;g&&c._applyShadow(this),E||(c._applyOpacity(this),c._applyGlobalCompositeOperation(this)),c.drawImage(T._canvas,T.x||0,T.y||0,T.width/O,T.height/O)}else{if(c._applyLineJoin(this),c._applyMiterLimit(this),!E){const T=this.getAbsoluteTransform(e).getMatrix();c.transform(T[0],T[1],T[2],T[3],T[4],T[5]),c._applyOpacity(this),c._applyGlobalCompositeOperation(this)}g&&c._applyShadow(this),m.call(this,c,this)}return c.restore(),this}drawHit(t,e,i=!1){if(!this.shouldDrawHit(e,i))return this;const s=this.getLayer(),l=t||s.hitCanvas,c=l&&l.getContext(),f=this.hitFunc()||this.sceneFunc(),m=this._getCanvasCache(),g=m&&m.hit;if(this.colorKey||st.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),g){c.save();const E=this.getAbsoluteTransform(e).getMatrix();return c.transform(E[0],E[1],E[2],E[3],E[4],E[5]),this._drawCachedHitCanvas(c),c.restore(),this}if(!f)return this;if(c.save(),c._applyLineJoin(this),c._applyMiterLimit(this),!(this===e)){const E=this.getAbsoluteTransform(e).getMatrix();c.transform(E[0],E[1],E[2],E[3],E[4],E[5])}return f.call(this,c,this),c.restore(),this}drawHitFromCache(t=0){const e=this._getCanvasCache(),i=this._getCachedSceneCanvas(),s=e.hit,l=s.getContext(),c=s.getWidth(),f=s.getHeight();l.clear(),l.drawImage(i._canvas,0,0,c,f);try{const m=l.getImageData(0,0,c,f),g=m.data,A=g.length,E=st._hexToRgb(this.colorKey);for(let T=0;T<A;T+=4)g[T+3]>t?(g[T]=E.r,g[T+1]=E.g,g[T+2]=E.b,g[T+3]=255):g[T+3]=0;l.putImageData(m,0,0)}catch(m){st.error("Unable to draw hit graph from cached scene canvas. "+m.message)}return this}hasPointerCapture(t){return M8(t,this)}setPointerCapture(t){L8(t,this)}releaseCapture(t){Gg(t)}}xt.prototype._fillFunc=jz;xt.prototype._strokeFunc=Hz;xt.prototype._fillFuncHit=Gz;xt.prototype._strokeFuncHit=qz;xt.prototype._centroid=!1;xt.prototype.nodeType="Shape";li(xt);xt.prototype.eventListeners={};xt.prototype.on.call(xt.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Fz);xt.prototype.on.call(xt.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",Yz);xt.prototype.on.call(xt.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",Qz);xt.prototype.on.call(xt.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",Xz);xt.prototype.on.call(xt.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",Kz);K.addGetterSetter(xt,"stroke",void 0,I8());K.addGetterSetter(xt,"strokeWidth",2,kt());K.addGetterSetter(xt,"fillAfterStrokeEnabled",!1);K.addGetterSetter(xt,"hitStrokeWidth","auto",KS());K.addGetterSetter(xt,"strokeHitEnabled",!0,jl());K.addGetterSetter(xt,"perfectDrawEnabled",!0,jl());K.addGetterSetter(xt,"shadowForStrokeEnabled",!0,jl());K.addGetterSetter(xt,"lineJoin");K.addGetterSetter(xt,"lineCap");K.addGetterSetter(xt,"miterLimit");K.addGetterSetter(xt,"sceneFunc");K.addGetterSetter(xt,"hitFunc");K.addGetterSetter(xt,"dash");K.addGetterSetter(xt,"dashOffset",0,kt());K.addGetterSetter(xt,"shadowColor",void 0,Yf());K.addGetterSetter(xt,"shadowBlur",0,kt());K.addGetterSetter(xt,"shadowOpacity",1,kt());K.addComponentsGetterSetter(xt,"shadowOffset",["x","y"]);K.addGetterSetter(xt,"shadowOffsetX",0,kt());K.addGetterSetter(xt,"shadowOffsetY",0,kt());K.addGetterSetter(xt,"fillPatternImage");K.addGetterSetter(xt,"fill",void 0,I8());K.addGetterSetter(xt,"fillPatternX",0,kt());K.addGetterSetter(xt,"fillPatternY",0,kt());K.addGetterSetter(xt,"fillLinearGradientColorStops");K.addGetterSetter(xt,"strokeLinearGradientColorStops");K.addGetterSetter(xt,"fillRadialGradientStartRadius",0);K.addGetterSetter(xt,"fillRadialGradientEndRadius",0);K.addGetterSetter(xt,"fillRadialGradientColorStops");K.addGetterSetter(xt,"fillPatternRepeat","repeat");K.addGetterSetter(xt,"fillEnabled",!0);K.addGetterSetter(xt,"strokeEnabled",!0);K.addGetterSetter(xt,"shadowEnabled",!0);K.addGetterSetter(xt,"dashEnabled",!0);K.addGetterSetter(xt,"strokeScaleEnabled",!0);K.addGetterSetter(xt,"fillPriority","color");K.addComponentsGetterSetter(xt,"fillPatternOffset",["x","y"]);K.addGetterSetter(xt,"fillPatternOffsetX",0,kt());K.addGetterSetter(xt,"fillPatternOffsetY",0,kt());K.addComponentsGetterSetter(xt,"fillPatternScale",["x","y"]);K.addGetterSetter(xt,"fillPatternScaleX",1,kt());K.addGetterSetter(xt,"fillPatternScaleY",1,kt());K.addComponentsGetterSetter(xt,"fillLinearGradientStartPoint",["x","y"]);K.addComponentsGetterSetter(xt,"strokeLinearGradientStartPoint",["x","y"]);K.addGetterSetter(xt,"fillLinearGradientStartPointX",0);K.addGetterSetter(xt,"strokeLinearGradientStartPointX",0);K.addGetterSetter(xt,"fillLinearGradientStartPointY",0);K.addGetterSetter(xt,"strokeLinearGradientStartPointY",0);K.addComponentsGetterSetter(xt,"fillLinearGradientEndPoint",["x","y"]);K.addComponentsGetterSetter(xt,"strokeLinearGradientEndPoint",["x","y"]);K.addGetterSetter(xt,"fillLinearGradientEndPointX",0);K.addGetterSetter(xt,"strokeLinearGradientEndPointX",0);K.addGetterSetter(xt,"fillLinearGradientEndPointY",0);K.addGetterSetter(xt,"strokeLinearGradientEndPointY",0);K.addComponentsGetterSetter(xt,"fillRadialGradientStartPoint",["x","y"]);K.addGetterSetter(xt,"fillRadialGradientStartPointX",0);K.addGetterSetter(xt,"fillRadialGradientStartPointY",0);K.addComponentsGetterSetter(xt,"fillRadialGradientEndPoint",["x","y"]);K.addGetterSetter(xt,"fillRadialGradientEndPointX",0);K.addGetterSetter(xt,"fillRadialGradientEndPointY",0);K.addGetterSetter(xt,"fillPatternRotation",0);K.addGetterSetter(xt,"fillRule",void 0,Yf());K.backCompat(xt,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"});const Wz="beforeDraw",Jz="draw",W8=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],Zz=W8.length;let Qf=class extends _r{constructor(t){super(t),this.canvas=new Wc,this.hitCanvas=new XS({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(t){return this.getContext().clear(t),this.getHitCanvas().getContext().clear(t),this}setZIndex(t){super.setZIndex(t);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),t<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[t+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){It.prototype.moveToTop.call(this);const t=this.getStage();return t&&t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!It.prototype.moveUp.call(this))return!1;const e=this.getStage();return!e||!e.content?!1:(e.content.removeChild(this.getNativeCanvasElement()),this.index<e.children.length-1?e.content.insertBefore(this.getNativeCanvasElement(),e.children[this.index+1].getCanvas()._canvas):e.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(It.prototype.moveDown.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(It.prototype.moveToBottom.call(this)){const t=this.getStage();if(t){const e=t.children;t.content&&(t.content.removeChild(this.getNativeCanvasElement()),t.content.insertBefore(this.getNativeCanvasElement(),e[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const t=this.getNativeCanvasElement();return It.prototype.remove.call(this),t&&t.parentNode&&st._isInDocument(t)&&t.parentNode.removeChild(t),this}getStage(){return this.parent}setSize({width:t,height:e}){return this.canvas.setSize(t,e),this.hitCanvas.setSize(t,e),this._setSmoothEnabled(),this}_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&st.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(t){return t={...t},t.width=t.width||this.getWidth(),t.height=t.height||this.getHeight(),t.x=t.x!==void 0?t.x:this.x(),t.y=t.y!==void 0?t.y:this.y(),It.prototype._toKonvaCanvas.call(this,t)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){st.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){st.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,st.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(t){if(!this.isListening()||!this.isVisible())return null;let e=1,i=!1;for(;;){for(let s=0;s<Zz;s++){const l=W8[s],c=this._getIntersection({x:t.x+l.x*e,y:t.y+l.y*e}),f=c.shape;if(f)return f;if(i=!!c.antialiased,!c.antialiased)break}if(i)e+=1;else return null}}_getIntersection(t){const e=this.hitCanvas.pixelRatio,i=this.hitCanvas.context.getImageData(Math.round(t.x*e),Math.round(t.y*e),1,1).data,s=i[3];if(s===255){const l=st.getHitColorKey(i[0],i[1],i[2]),c=Fg[l];return c?{shape:c}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(t,e,i){const s=this.getLayer(),l=t||s&&s.getCanvas();return this._fire(Wz,{node:this}),this.clearBeforeDraw()&&l.getContext().clear(),_r.prototype.drawScene.call(this,l,e,i),this._fire(Jz,{node:this}),this}drawHit(t,e){const i=this.getLayer(),s=t||i&&i.hitCanvas;return i&&i.clearBeforeDraw()&&i.getHitCanvas().getContext().clear(),_r.prototype.drawHit.call(this,s,e),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(t){st.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(t)}getHitGraphEnabled(t){return st.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const t=this.parent;!!this.hitCanvas._canvas.parentNode?t.content.removeChild(this.hitCanvas._canvas):t.content.appendChild(this.hitCanvas._canvas)}destroy(){return st.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};Qf.prototype.nodeType="Layer";li(Qf);K.addGetterSetter(Qf,"imageSmoothingEnabled",!0);K.addGetterSetter(Qf,"clearBeforeDraw",!0);K.addGetterSetter(Qf,"hitGraphEnabled",!0,jl());class JS extends Qf{constructor(t){super(t),this.listening(!1),st.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}JS.prototype.nodeType="FastLayer";li(JS);let xm=class extends _r{_validateAdd(t){const e=t.getType();e!=="Group"&&e!=="Shape"&&st.throw("You may only add groups and shapes to groups.")}};xm.prototype.nodeType="Group";li(xm);const P2=(function(){return Nf.performance&&Nf.performance.now?function(){return Nf.performance.now()}:function(){return new Date().getTime()}})();class el{constructor(t,e){this.id=el.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:P2(),frameRate:0},this.func=t,this.setLayers(e)}setLayers(t){let e=[];return t&&(e=Array.isArray(t)?t:[t]),this.layers=e,this}getLayers(){return this.layers}addLayer(t){const e=this.layers,i=e.length;for(let s=0;s<i;s++)if(e[s]._id===t._id)return!1;return this.layers.push(t),!0}isRunning(){const e=el.animations,i=e.length;for(let s=0;s<i;s++)if(e[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=P2(),el._addAnimation(this),this}stop(){return el._removeAnimation(this),this}_updateFrameObject(t){this.frame.timeDiff=t-this.frame.lastTime,this.frame.lastTime=t,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(t){this.animations.push(t),this._handleAnimation()}static _removeAnimation(t){const e=t.id,i=this.animations,s=i.length;for(let l=0;l<s;l++)if(i[l].id===e){this.animations.splice(l,1);break}}static _runFrames(){const t={},e=this.animations;for(let i=0;i<e.length;i++){const s=e[i],l=s.layers,c=s.func;s._updateFrameObject(P2());const f=l.length;let m;if(c?m=c.call(s,s.frame)!==!1:m=!0,!!m)for(let g=0;g<f;g++){const A=l[g];A._id!==void 0&&(t[A._id]=A)}}for(const i in t)t.hasOwnProperty(i)&&t[i].batchDraw()}static _animationLoop(){const t=el;t.animations.length?(t._runFrames(),st.requestAnimFrame(t._animationLoop)):t.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,st.requestAnimFrame(this._animationLoop))}}el.animations=[];el.animIdCounter=0;el.animRunning=!1;const $z={node:1,duration:1,easing:1,onFinish:1,yoyo:1},tB=1,z3=2,B3=3,j3=["fill","stroke","shadowColor"];let eB=0;class nB{constructor(t,e,i,s,l,c,f){this.prop=t,this.propFunc=e,this.begin=s,this._pos=s,this.duration=c,this._change=0,this.prevPos=0,this.yoyo=f,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=i,this._change=l-this.begin,this.pause()}fire(t){const e=this[t];e&&e()}setTime(t){t>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():t<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=t,this.update())}getTime(){return this._time}setPosition(t){this.prevPos=this._pos,this.propFunc(t),this._pos=t}getPosition(t){return t===void 0&&(t=this._time),this.func(t,this.begin,this._change,this.duration)}play(){this.state=z3,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=B3,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(t){this.pause(),this._time=t,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const t=this.getTimer()-this._startTime;this.state===z3?this.setTime(t):this.state===B3&&this.setTime(this.duration-t)}pause(){this.state=tB,this.fire("onPause")}getTimer(){return new Date().getTime()}}class Dn{constructor(t){const e=this,i=t.node,s=i._id,l=t.easing||Yg.Linear,c=!!t.yoyo;let f,m;typeof t.duration>"u"?f=.3:t.duration===0?f=.001:f=t.duration,this.node=i,this._id=eB++;const g=i.getLayer()||(i instanceof Ut.Stage?i.getLayers():null);g||st.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new el(function(){e.tween.onEnterFrame()},g),this.tween=new nB(m,function(A){e._tweenFunc(A)},l,0,1,f*1e3,c),this._addListeners(),Dn.attrs[s]||(Dn.attrs[s]={}),Dn.attrs[s][this._id]||(Dn.attrs[s][this._id]={}),Dn.tweens[s]||(Dn.tweens[s]={});for(m in t)$z[m]===void 0&&this._addAttr(m,t[m]);this.reset(),this.onFinish=t.onFinish,this.onReset=t.onReset,this.onUpdate=t.onUpdate}_addAttr(t,e){const i=this.node,s=i._id;let l,c,f,m,g;const A=Dn.tweens[s][t];A&&delete Dn.attrs[s][A][t];let E=i.getAttr(t);if(st._isArray(e))if(l=[],c=Math.max(e.length,E.length),t==="points"&&e.length!==E.length&&(e.length>E.length?(m=E,E=st._prepareArrayForTween(E,e,i.closed())):(f=e,e=st._prepareArrayForTween(e,E,i.closed()))),t.indexOf("fill")===0)for(let T=0;T<c;T++)if(T%2===0)l.push(e[T]-E[T]);else{const x=st.colorToRGBA(E[T]);g=st.colorToRGBA(e[T]),E[T]=x,l.push({r:g.r-x.r,g:g.g-x.g,b:g.b-x.b,a:g.a-x.a})}else for(let T=0;T<c;T++)l.push(e[T]-E[T]);else j3.indexOf(t)!==-1?(E=st.colorToRGBA(E),g=st.colorToRGBA(e),l={r:g.r-E.r,g:g.g-E.g,b:g.b-E.b,a:g.a-E.a}):l=e-E;Dn.attrs[s][this._id][t]={start:E,diff:l,end:e,trueEnd:f,trueStart:m},Dn.tweens[s][t]=this._id}_tweenFunc(t){const e=this.node,i=Dn.attrs[e._id][this._id];let s,l,c,f,m,g,A,E;for(s in i){if(l=i[s],c=l.start,f=l.diff,E=l.end,st._isArray(c))if(m=[],A=Math.max(c.length,E.length),s.indexOf("fill")===0)for(g=0;g<A;g++)g%2===0?m.push((c[g]||0)+f[g]*t):m.push("rgba("+Math.round(c[g].r+f[g].r*t)+","+Math.round(c[g].g+f[g].g*t)+","+Math.round(c[g].b+f[g].b*t)+","+(c[g].a+f[g].a*t)+")");else for(g=0;g<A;g++)m.push((c[g]||0)+f[g]*t);else j3.indexOf(s)!==-1?m="rgba("+Math.round(c.r+f.r*t)+","+Math.round(c.g+f.g*t)+","+Math.round(c.b+f.b*t)+","+(c.a+f.a*t)+")":m=c+f*t;e.setAttr(s,m)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const t=this.node,e=Dn.attrs[t._id][this._id];e.points&&e.points.trueEnd&&t.setAttr("points",e.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const t=this.node,e=Dn.attrs[t._id][this._id];e.points&&e.points.trueStart&&t.points(e.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(t){return this.tween.seek(t*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const t=this.node._id,e=this._id,i=Dn.tweens[t];this.pause(),this.anim&&this.anim.stop();for(const s in i)delete Dn.tweens[t][s];delete Dn.attrs[t][e],Dn.tweens[t]&&(Object.keys(Dn.tweens[t]).length===0&&delete Dn.tweens[t],Object.keys(Dn.attrs[t]).length===0&&delete Dn.attrs[t])}}Dn.attrs={};Dn.tweens={};It.prototype.to=function(n){const t=n.onFinish;n.node=this,n.onFinish=function(){this.destroy(),t&&t()},new Dn(n).play()};const Yg={BackEaseIn(n,t,e,i){return e*(n/=i)*n*((1.70158+1)*n-1.70158)+t},BackEaseOut(n,t,e,i){return e*((n=n/i-1)*n*((1.70158+1)*n+1.70158)+1)+t},BackEaseInOut(n,t,e,i){let s=1.70158;return(n/=i/2)<1?e/2*(n*n*(((s*=1.525)+1)*n-s))+t:e/2*((n-=2)*n*(((s*=1.525)+1)*n+s)+2)+t},ElasticEaseIn(n,t,e,i,s,l){let c=0;return n===0?t:(n/=i)===1?t+e:(l||(l=i*.3),!s||s<Math.abs(e)?(s=e,c=l/4):c=l/(2*Math.PI)*Math.asin(e/s),-(s*Math.pow(2,10*(n-=1))*Math.sin((n*i-c)*(2*Math.PI)/l))+t)},ElasticEaseOut(n,t,e,i,s,l){let c=0;return n===0?t:(n/=i)===1?t+e:(l||(l=i*.3),!s||s<Math.abs(e)?(s=e,c=l/4):c=l/(2*Math.PI)*Math.asin(e/s),s*Math.pow(2,-10*n)*Math.sin((n*i-c)*(2*Math.PI)/l)+e+t)},ElasticEaseInOut(n,t,e,i,s,l){let c=0;return n===0?t:(n/=i/2)===2?t+e:(l||(l=i*(.3*1.5)),!s||s<Math.abs(e)?(s=e,c=l/4):c=l/(2*Math.PI)*Math.asin(e/s),n<1?-.5*(s*Math.pow(2,10*(n-=1))*Math.sin((n*i-c)*(2*Math.PI)/l))+t:s*Math.pow(2,-10*(n-=1))*Math.sin((n*i-c)*(2*Math.PI)/l)*.5+e+t)},BounceEaseOut(n,t,e,i){return(n/=i)<1/2.75?e*(7.5625*n*n)+t:n<2/2.75?e*(7.5625*(n-=1.5/2.75)*n+.75)+t:n<2.5/2.75?e*(7.5625*(n-=2.25/2.75)*n+.9375)+t:e*(7.5625*(n-=2.625/2.75)*n+.984375)+t},BounceEaseIn(n,t,e,i){return e-Yg.BounceEaseOut(i-n,0,e,i)+t},BounceEaseInOut(n,t,e,i){return n<i/2?Yg.BounceEaseIn(n*2,0,e,i)*.5+t:Yg.BounceEaseOut(n*2-i,0,e,i)*.5+e*.5+t},EaseIn(n,t,e,i){return e*(n/=i)*n+t},EaseOut(n,t,e,i){return-e*(n/=i)*(n-2)+t},EaseInOut(n,t,e,i){return(n/=i/2)<1?e/2*n*n+t:-e/2*(--n*(n-2)-1)+t},StrongEaseIn(n,t,e,i){return e*(n/=i)*n*n*n*n+t},StrongEaseOut(n,t,e,i){return e*((n=n/i-1)*n*n*n*n+1)+t},StrongEaseInOut(n,t,e,i){return(n/=i/2)<1?e/2*n*n*n*n*n+t:e/2*((n-=2)*n*n*n*n+2)+t},Linear(n,t,e,i){return e*n/i+t}},Nm=st._assign(Ut,{Util:st,Transform:pr,Node:It,Container:_r,Stage:yv,stages:qg,Layer:Qf,FastLayer:JS,Group:xm,DD:nn,Shape:xt,shapes:Fg,Animation:el,Tween:Dn,Easings:Yg,Context:gv,Canvas:QS});class Fu extends xt{_sceneFunc(t){const e=Ut.getAngle(this.angle()),i=this.clockwise();t.beginPath(),t.arc(0,0,this.outerRadius(),0,e,i),t.arc(0,0,this.innerRadius(),e,0,!i),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}getSelfRect(){const t=this.innerRadius(),e=this.outerRadius(),i=this.clockwise(),s=Ut.getAngle(i?360-this.angle():this.angle()),l=Math.cos(Math.min(s,Math.PI)),c=1,f=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),m=Math.sin(Math.min(s,Math.PI/2)),g=l*(l>0?t:e),A=c*e,E=f*(f>0?t:e),T=m*(m>0?e:t);return{x:g,y:i?-1*T:E,width:A-g,height:T-E}}}Fu.prototype._centroid=!0;Fu.prototype.className="Arc";Fu.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];li(Fu);K.addGetterSetter(Fu,"innerRadius",0,kt());K.addGetterSetter(Fu,"outerRadius",0,kt());K.addGetterSetter(Fu,"angle",0,kt());K.addGetterSetter(Fu,"clockwise",!1,jl());function FA(n,t,e,i,s,l,c){const f=Math.sqrt(Math.pow(e-n,2)+Math.pow(i-t,2)),m=Math.sqrt(Math.pow(s-e,2)+Math.pow(l-i,2)),g=c*f/(f+m),A=c*m/(f+m),E=e-g*(s-n),T=i-g*(l-t),x=e+A*(s-n),R=i+A*(l-t);return[E,T,x,R]}function H3(n,t){const e=n.length,i=[];for(let s=2;s<e-2;s+=2){const l=FA(n[s-2],n[s-1],n[s],n[s+1],n[s+2],n[s+3],t);isNaN(l[0])||(i.push(l[0]),i.push(l[1]),i.push(n[s]),i.push(n[s+1]),i.push(l[2]),i.push(l[3]))}return i}function iB(n){const t=[[n[0],n[2],n[4],n[6]],[n[1],n[3],n[5],n[7]]],e=[];for(const i of t){const s=-3*i[0]+9*i[1]-9*i[2]+3*i[3];if(s!==0){const l=6*i[0]-12*i[1]+6*i[2],c=-3*i[0]+3*i[1],f=l*l-4*s*c;if(f>=0){const m=Math.sqrt(f);e.push((-l+m)/(2*s)),e.push((-l-m)/(2*s))}}}return e.filter(i=>i>0&&i<1).flatMap(i=>t.map(s=>{const l=1-i;return l*l*l*s[0]+3*l*l*i*s[1]+3*l*i*i*s[2]+i*i*i*s[3]}))}let Yu=class extends xt{constructor(t){super(t),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(t){const e=this.points(),i=e.length,s=this.tension(),l=this.closed(),c=this.bezier();if(!i)return;let f=0;if(t.beginPath(),t.moveTo(e[0],e[1]),s!==0&&i>4){const m=this.getTensionPoints(),g=m.length;for(f=l?0:4,l||t.quadraticCurveTo(m[0],m[1],m[2],m[3]);f<g-2;)t.bezierCurveTo(m[f++],m[f++],m[f++],m[f++],m[f++],m[f++]);l||t.quadraticCurveTo(m[g-2],m[g-1],e[i-2],e[i-1])}else if(c)for(f=2;f<i;)t.bezierCurveTo(e[f++],e[f++],e[f++],e[f++],e[f++],e[f++]);else for(f=2;f<i;f+=2)t.lineTo(e[f],e[f+1]);l?(t.closePath(),t.fillStrokeShape(this)):t.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():H3(this.points(),this.tension())}_getTensionPointsClosed(){const t=this.points(),e=t.length,i=this.tension(),s=FA(t[e-2],t[e-1],t[0],t[1],t[2],t[3],i),l=FA(t[e-4],t[e-3],t[e-2],t[e-1],t[0],t[1],i),c=H3(t,i);return[s[2],s[3]].concat(c).concat([l[0],l[1],t[e-2],t[e-1],l[2],l[3],s[0],s[1],t[0],t[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let t=this.points();if(t.length<4)return{x:t[0]||0,y:t[1]||0,width:0,height:0};this.tension()!==0?t=[t[0],t[1],...this._getTensionPoints(),t[t.length-2],t[t.length-1]]:this.bezier()?t=[t[0],t[1],...iB(this.points()),t[t.length-2],t[t.length-1]]:t=this.points();let e=t[0],i=t[0],s=t[1],l=t[1],c,f;for(let m=0;m<t.length/2;m++)c=t[m*2],f=t[m*2+1],e=Math.min(e,c),i=Math.max(i,c),s=Math.min(s,f),l=Math.max(l,f);return{x:e,y:s,width:i-e,height:l-s}}};Yu.prototype.className="Line";Yu.prototype._attrsAffectingSize=["points","bezier","tension"];li(Yu);K.addGetterSetter(Yu,"closed",!1);K.addGetterSetter(Yu,"bezier",!1);K.addGetterSetter(Yu,"tension",0,kt());K.addGetterSetter(Yu,"points",[],vz());const sB=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],aB=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],rB=[[1],[1,1],[1,2,1],[1,3,3,1]],G3=(n,t,e)=>{let i,s;const c=e/2;i=0;for(let f=0;f<20;f++)s=c*sB[20][f]+c,i+=aB[20][f]*lB(n,t,s);return c*i},q3=(n,t,e)=>{e===void 0&&(e=1);const i=n[0]-2*n[1]+n[2],s=t[0]-2*t[1]+t[2],l=2*n[1]-2*n[0],c=2*t[1]-2*t[0],f=4*(i*i+s*s),m=4*(i*l+s*c),g=l*l+c*c;if(f===0)return e*Math.sqrt(Math.pow(n[2]-n[0],2)+Math.pow(t[2]-t[0],2));const A=m/(2*f),E=g/f,T=e+A,x=E-A*A,R=T*T+x>0?Math.sqrt(T*T+x):0,O=A*A+x>0?Math.sqrt(A*A+x):0,M=A+Math.sqrt(A*A+x)!==0?x*Math.log(Math.abs((T+R)/(A+O))):0;return Math.sqrt(f)/2*(T*R-A*O+M)};function lB(n,t,e){const i=YA(1,e,n),s=YA(1,e,t),l=i*i+s*s;return Math.sqrt(l)}const YA=(n,t,e)=>{const i=e.length-1;let s,l;if(i===0)return 0;if(n===0){l=0;for(let c=0;c<=i;c++)l+=rB[i][c]*Math.pow(1-t,i-c)*Math.pow(t,c)*e[c];return l}else{s=new Array(i);for(let c=0;c<i;c++)s[c]=i*(e[c+1]-e[c]);return YA(n-1,t,s)}},F3=(n,t,e)=>{let i=1,s=n/t,l=(n-e(s))/t,c=0;for(;i>.001;){const f=e(s+l),m=Math.abs(n-f)/t;if(m<i)i=m,s+=l;else{const g=e(s-l),A=Math.abs(n-g)/t;A<i?(i=A,s-=l):l/=2}if(c++,c>500)break}return s};class In extends xt{constructor(t){super(t),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=In.parsePathData(this.data()),this.pathLength=In.getPathLength(this.dataArray)}_sceneFunc(t){const e=this.dataArray;t.beginPath();let i=!1;for(let s=0;s<e.length;s++){const l=e[s].command,c=e[s].points;switch(l){case"L":t.lineTo(c[0],c[1]);break;case"M":t.moveTo(c[0],c[1]);break;case"C":t.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5]);break;case"Q":t.quadraticCurveTo(c[0],c[1],c[2],c[3]);break;case"A":const f=c[0],m=c[1],g=c[2],A=c[3],E=c[4],T=c[5],x=c[6],R=c[7],O=g>A?g:A,M=g>A?1:g/A,H=g>A?A/g:1;t.translate(f,m),t.rotate(x),t.scale(M,H),t.arc(0,0,O,E,E+T,1-R),t.scale(1/M,1/H),t.rotate(-x),t.translate(-f,-m);break;case"z":i=!0,t.closePath();break}}!i&&!this.hasFill()?t.strokeShape(this):t.fillStrokeShape(this)}getSelfRect(){let t=[];this.dataArray.forEach(function(m){if(m.command==="A"){const g=m.points[4],A=m.points[5],E=m.points[4]+A;let T=Math.PI/180;if(Math.abs(g-E)<T&&(T=Math.abs(g-E)),A<0)for(let x=g-T;x>E;x-=T){const R=In.getPointOnEllipticalArc(m.points[0],m.points[1],m.points[2],m.points[3],x,0);t.push(R.x,R.y)}else for(let x=g+T;x<E;x+=T){const R=In.getPointOnEllipticalArc(m.points[0],m.points[1],m.points[2],m.points[3],x,0);t.push(R.x,R.y)}}else if(m.command==="C")for(let g=0;g<=1;g+=.01){const A=In.getPointOnCubicBezier(g,m.start.x,m.start.y,m.points[0],m.points[1],m.points[2],m.points[3],m.points[4],m.points[5]);t.push(A.x,A.y)}else t=t.concat(m.points)});let e=t[0],i=t[0],s=t[1],l=t[1],c,f;for(let m=0;m<t.length/2;m++)c=t[m*2],f=t[m*2+1],isNaN(c)||(e=Math.min(e,c),i=Math.max(i,c)),isNaN(f)||(s=Math.min(s,f),l=Math.max(l,f));return{x:e,y:s,width:i-e,height:l-s}}getLength(){return this.pathLength}getPointAtLength(t){return In.getPointAtLengthOfDataArray(t,this.dataArray)}static getLineLength(t,e,i,s){return Math.sqrt((i-t)*(i-t)+(s-e)*(s-e))}static getPathLength(t){let e=0;for(let i=0;i<t.length;++i)e+=t[i].pathLength;return e}static getPointAtLengthOfDataArray(t,e){let i,s=0,l=e.length;if(!l)return null;for(;s<l&&t>e[s].pathLength;)t-=e[s].pathLength,++s;if(s===l)return i=e[s-1].points.slice(-2),{x:i[0],y:i[1]};if(t<.01)return e[s].command==="M"?(i=e[s].points.slice(0,2),{x:i[0],y:i[1]}):{x:e[s].start.x,y:e[s].start.y};const c=e[s],f=c.points;switch(c.command){case"L":return In.getPointOnLine(t,c.start.x,c.start.y,f[0],f[1]);case"C":return In.getPointOnCubicBezier(F3(t,In.getPathLength(e),O=>G3([c.start.x,f[0],f[2],f[4]],[c.start.y,f[1],f[3],f[5]],O)),c.start.x,c.start.y,f[0],f[1],f[2],f[3],f[4],f[5]);case"Q":return In.getPointOnQuadraticBezier(F3(t,In.getPathLength(e),O=>q3([c.start.x,f[0],f[2]],[c.start.y,f[1],f[3]],O)),c.start.x,c.start.y,f[0],f[1],f[2],f[3]);case"A":const m=f[0],g=f[1],A=f[2],E=f[3],T=f[5],x=f[6];let R=f[4];return R+=T*t/c.pathLength,In.getPointOnEllipticalArc(m,g,A,E,R,x)}return null}static getPointOnLine(t,e,i,s,l,c,f){c=c??e,f=f??i;const m=this.getLineLength(e,i,s,l);if(m<1e-10)return{x:e,y:i};if(s===e)return{x:c,y:f+(l>i?t:-t)};const g=(l-i)/(s-e),A=Math.sqrt(t*t/(1+g*g))*(s<e?-1:1),E=g*A;if(Math.abs(f-i-g*(c-e))<1e-10)return{x:c+A,y:f+E};const T=((c-e)*(s-e)+(f-i)*(l-i))/(m*m),x=e+T*(s-e),R=i+T*(l-i),O=this.getLineLength(c,f,x,R),M=Math.sqrt(t*t-O*O),H=Math.sqrt(M*M/(1+g*g))*(s<e?-1:1),B=g*H;return{x:x+H,y:R+B}}static getPointOnCubicBezier(t,e,i,s,l,c,f,m,g){function A(M){return M*M*M}function E(M){return 3*M*M*(1-M)}function T(M){return 3*M*(1-M)*(1-M)}function x(M){return(1-M)*(1-M)*(1-M)}const R=m*A(t)+c*E(t)+s*T(t)+e*x(t),O=g*A(t)+f*E(t)+l*T(t)+i*x(t);return{x:R,y:O}}static getPointOnQuadraticBezier(t,e,i,s,l,c,f){function m(x){return x*x}function g(x){return 2*x*(1-x)}function A(x){return(1-x)*(1-x)}const E=c*m(t)+s*g(t)+e*A(t),T=f*m(t)+l*g(t)+i*A(t);return{x:E,y:T}}static getPointOnEllipticalArc(t,e,i,s,l,c){const f=Math.cos(c),m=Math.sin(c),g={x:i*Math.cos(l),y:s*Math.sin(l)};return{x:t+(g.x*f-g.y*m),y:e+(g.x*m+g.y*f)}}static parsePathData(t){if(!t)return[];let e=t;const i=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let E=0;E<i.length;E++)e=e.replace(new RegExp(i[E],"g"),"|"+i[E]);const s=e.split("|"),l=[],c=[];let f=0,m=0;const g=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let A;for(let E=1;E<s.length;E++){let T=s[E],x=T.charAt(0);for(T=T.slice(1),c.length=0;A=g.exec(T);)c.push(A[0]);let R=[],O=x==="A"||x==="a"?0:-1;for(let M=0,H=c.length;M<H;M++){const B=c[M];if(B==="00"){R.push(0,0),O>=0&&(O+=2,O>=7&&(O-=7));continue}if(O>=0){if(O===3){if(/^[01]{2}\d+(?:\.\d+)?$/.test(B)){R.push(parseInt(B[0],10)),R.push(parseInt(B[1],10)),R.push(parseFloat(B.slice(2))),O+=3,O>=7&&(O-=7);continue}if(B==="11"||B==="10"||B==="01"){R.push(parseInt(B[0],10)),R.push(parseInt(B[1],10)),O+=2,O>=7&&(O-=7);continue}if(B==="0"||B==="1"){R.push(parseInt(B,10)),O+=1,O>=7&&(O-=7);continue}}else if(O===4){if(/^[01]\d+(?:\.\d+)?$/.test(B)){R.push(parseInt(B[0],10)),R.push(parseFloat(B.slice(1))),O+=2,O>=7&&(O-=7);continue}if(B==="0"||B==="1"){R.push(parseInt(B,10)),O+=1,O>=7&&(O-=7);continue}}const Y=parseFloat(B);isNaN(Y)?R.push(0):R.push(Y),O+=1,O>=7&&(O-=7)}else{const Y=parseFloat(B);isNaN(Y)?R.push(0):R.push(Y)}}for(;R.length>0&&!isNaN(R[0]);){let M="",H=[];const B=f,Y=m;let $,nt,X,L,k,V,q,Q,F,G;switch(x){case"l":f+=R.shift(),m+=R.shift(),M="L",H.push(f,m);break;case"L":f=R.shift(),m=R.shift(),H.push(f,m);break;case"m":const Ot=R.shift(),Vt=R.shift();if(f+=Ot,m+=Vt,M="M",l.length>2&&l[l.length-1].command==="z"){for(let tt=l.length-2;tt>=0;tt--)if(l[tt].command==="M"){f=l[tt].points[0]+Ot,m=l[tt].points[1]+Vt;break}}H.push(f,m),x="l";break;case"M":f=R.shift(),m=R.shift(),M="M",H.push(f,m),x="L";break;case"h":f+=R.shift(),M="L",H.push(f,m);break;case"H":f=R.shift(),M="L",H.push(f,m);break;case"v":m+=R.shift(),M="L",H.push(f,m);break;case"V":m=R.shift(),M="L",H.push(f,m);break;case"C":H.push(R.shift(),R.shift(),R.shift(),R.shift()),f=R.shift(),m=R.shift(),H.push(f,m);break;case"c":H.push(f+R.shift(),m+R.shift(),f+R.shift(),m+R.shift()),f+=R.shift(),m+=R.shift(),M="C",H.push(f,m);break;case"S":nt=f,X=m,$=l[l.length-1],$.command==="C"&&(nt=f+(f-$.points[2]),X=m+(m-$.points[3])),H.push(nt,X,R.shift(),R.shift()),f=R.shift(),m=R.shift(),M="C",H.push(f,m);break;case"s":nt=f,X=m,$=l[l.length-1],$.command==="C"&&(nt=f+(f-$.points[2]),X=m+(m-$.points[3])),H.push(nt,X,f+R.shift(),m+R.shift()),f+=R.shift(),m+=R.shift(),M="C",H.push(f,m);break;case"Q":H.push(R.shift(),R.shift()),f=R.shift(),m=R.shift(),H.push(f,m);break;case"q":H.push(f+R.shift(),m+R.shift()),f+=R.shift(),m+=R.shift(),M="Q",H.push(f,m);break;case"T":nt=f,X=m,$=l[l.length-1],$.command==="Q"&&(nt=f+(f-$.points[0]),X=m+(m-$.points[1])),f=R.shift(),m=R.shift(),M="Q",H.push(nt,X,f,m);break;case"t":nt=f,X=m,$=l[l.length-1],$.command==="Q"&&(nt=f+(f-$.points[0]),X=m+(m-$.points[1])),f+=R.shift(),m+=R.shift(),M="Q",H.push(nt,X,f,m);break;case"A":L=R.shift(),k=R.shift(),V=R.shift(),q=R.shift(),Q=R.shift(),F=f,G=m,f=R.shift(),m=R.shift(),M="A",H=this.convertEndpointToCenterParameterization(F,G,f,m,q,Q,L,k,V);break;case"a":L=R.shift(),k=R.shift(),V=R.shift(),q=R.shift(),Q=R.shift(),F=f,G=m,f+=R.shift(),m+=R.shift(),M="A",H=this.convertEndpointToCenterParameterization(F,G,f,m,q,Q,L,k,V);break}l.push({command:M||x,points:H,start:{x:B,y:Y},pathLength:this.calcLength(B,Y,M||x,H)})}(x==="z"||x==="Z")&&l.push({command:"z",points:[],start:void 0,pathLength:0})}return l}static calcLength(t,e,i,s){let l,c,f,m;const g=In;switch(i){case"L":return g.getLineLength(t,e,s[0],s[1]);case"C":return G3([t,s[0],s[2],s[4]],[e,s[1],s[3],s[5]],1);case"Q":return q3([t,s[0],s[2]],[e,s[1],s[3]],1);case"A":l=0;const A=s[4],E=s[5],T=s[4]+E;let x=Math.PI/180;if(Math.abs(A-T)<x&&(x=Math.abs(A-T)),c=g.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],A,0),E<0)for(m=A-x;m>T;m-=x)f=g.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],m,0),l+=g.getLineLength(c.x,c.y,f.x,f.y),c=f;else for(m=A+x;m<T;m+=x)f=g.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],m,0),l+=g.getLineLength(c.x,c.y,f.x,f.y),c=f;return f=g.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],T,0),l+=g.getLineLength(c.x,c.y,f.x,f.y),l}return 0}static convertEndpointToCenterParameterization(t,e,i,s,l,c,f,m,g){const A=g*(Math.PI/180),E=Math.cos(A)*(t-i)/2+Math.sin(A)*(e-s)/2,T=-1*Math.sin(A)*(t-i)/2+Math.cos(A)*(e-s)/2,x=E*E/(f*f)+T*T/(m*m);x>1&&(f*=Math.sqrt(x),m*=Math.sqrt(x));let R=Math.sqrt((f*f*(m*m)-f*f*(T*T)-m*m*(E*E))/(f*f*(T*T)+m*m*(E*E)));l===c&&(R*=-1),isNaN(R)&&(R=0);const O=R*f*T/m,M=R*-m*E/f,H=(t+i)/2+Math.cos(A)*O-Math.sin(A)*M,B=(e+s)/2+Math.sin(A)*O+Math.cos(A)*M,Y=function(q){return Math.sqrt(q[0]*q[0]+q[1]*q[1])},$=function(q,Q){return(q[0]*Q[0]+q[1]*Q[1])/(Y(q)*Y(Q))},nt=function(q,Q){return(q[0]*Q[1]<q[1]*Q[0]?-1:1)*Math.acos($(q,Q))},X=nt([1,0],[(E-O)/f,(T-M)/m]),L=[(E-O)/f,(T-M)/m],k=[(-1*E-O)/f,(-1*T-M)/m];let V=nt(L,k);return $(L,k)<=-1&&(V=Math.PI),$(L,k)>=1&&(V=0),c===0&&V>0&&(V=V-2*Math.PI),c===1&&V<0&&(V=V+2*Math.PI),[H,B,f,m,X,V,A,c]}}In.prototype.className="Path";In.prototype._attrsAffectingSize=["data"];li(In);K.addGetterSetter(In,"data");class Xf extends Yu{_sceneFunc(t){super._sceneFunc(t);const e=Math.PI*2,i=this.points();let s=i;const l=this.tension()!==0&&i.length>4;l&&(s=this.getTensionPoints());const c=this.pointerLength(),f=i.length;let m,g;if(l){const T=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],i[f-2],i[f-1]],x=In.calcLength(s[s.length-4],s[s.length-3],"C",T),R=In.getPointOnQuadraticBezier(Math.min(1,1-c/x),T[0],T[1],T[2],T[3],T[4],T[5]);m=i[f-2]-R.x,g=i[f-1]-R.y}else m=i[f-2]-i[f-4],g=i[f-1]-i[f-3];const A=(Math.atan2(g,m)+e)%e,E=this.pointerWidth();this.pointerAtEnding()&&(t.save(),t.beginPath(),t.translate(i[f-2],i[f-1]),t.rotate(A),t.moveTo(0,0),t.lineTo(-c,E/2),t.lineTo(-c,-E/2),t.closePath(),t.restore(),this.__fillStroke(t)),this.pointerAtBeginning()&&(t.save(),t.beginPath(),t.translate(i[0],i[1]),l?(m=(s[0]+s[2])/2-i[0],g=(s[1]+s[3])/2-i[1]):(m=i[2]-i[0],g=i[3]-i[1]),t.rotate((Math.atan2(-g,-m)+e)%e),t.moveTo(0,0),t.lineTo(-c,E/2),t.lineTo(-c,-E/2),t.closePath(),t.restore(),this.__fillStroke(t))}__fillStroke(t){const e=this.dashEnabled();e&&(this.attrs.dashEnabled=!1,t.setLineDash([])),t.fillStrokeShape(this),e&&(this.attrs.dashEnabled=!0)}getSelfRect(){const t=super.getSelfRect(),e=this.pointerWidth()/2;return{x:t.x,y:t.y-e,width:t.width,height:t.height+e*2}}}Xf.prototype.className="Arrow";li(Xf);K.addGetterSetter(Xf,"pointerLength",10,kt());K.addGetterSetter(Xf,"pointerWidth",10,kt());K.addGetterSetter(Xf,"pointerAtBeginning",!1);K.addGetterSetter(Xf,"pointerAtEnding",!0);let Ym=class extends xt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius()!==t/2&&this.radius(t/2)}setHeight(t){this.radius()!==t/2&&this.radius(t/2)}};Ym.prototype._centroid=!0;Ym.prototype.className="Circle";Ym.prototype._attrsAffectingSize=["radius"];li(Ym);K.addGetterSetter(Ym,"radius",0,kt());let Sh=class extends xt{_sceneFunc(t){const e=this.radiusX(),i=this.radiusY();t.beginPath(),t.save(),e!==i&&t.scale(1,i/e),t.arc(0,0,e,0,Math.PI*2,!1),t.restore(),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(t){this.radiusX(t/2)}setHeight(t){this.radiusY(t/2)}};Sh.prototype.className="Ellipse";Sh.prototype._centroid=!0;Sh.prototype._attrsAffectingSize=["radiusX","radiusY"];li(Sh);K.addComponentsGetterSetter(Sh,"radius",["x","y"]);K.addGetterSetter(Sh,"radiusX",0,kt());K.addGetterSetter(Sh,"radiusY",0,kt());let Hl=class J8 extends xt{constructor(t){super(t),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",e=>{this._removeImageLoad(e.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const t=this.image();t&&t.complete||t&&t.readyState===4||t&&t.addEventListener&&t.addEventListener("load",this._loadListener)}_removeImageLoad(t){t&&t.removeEventListener&&t.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const t=!!this.cornerRadius(),e=this.hasShadow();return t&&e?!0:super._useBufferCanvas(!0)}_sceneFunc(t){const e=this.getWidth(),i=this.getHeight(),s=this.cornerRadius(),l=this.attrs.image;let c;if(l){const f=this.attrs.cropWidth,m=this.attrs.cropHeight;f&&m?c=[l,this.cropX(),this.cropY(),f,m,0,0,e,i]:c=[l,0,0,e,i]}(this.hasFill()||this.hasStroke()||s)&&(t.beginPath(),s?st.drawRoundedRectPath(t,e,i,s):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)),l&&(s&&t.clip(),t.drawImage.apply(t,c))}_hitFunc(t){const e=this.width(),i=this.height(),s=this.cornerRadius();t.beginPath(),s?st.drawRoundedRectPath(t,e,i,s):t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}getWidth(){var t,e,i;return(i=(t=this.attrs.width)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.width)!==null&&i!==void 0?i:0}getHeight(){var t,e,i;return(i=(t=this.attrs.height)!==null&&t!==void 0?t:(e=this.image())===null||e===void 0?void 0:e.height)!==null&&i!==void 0?i:0}static fromURL(t,e,i=null){const s=st.createImageElement();s.onload=function(){const l=new J8({image:s});e(l)},s.onerror=i,s.crossOrigin="Anonymous",s.src=t}};Hl.prototype.className="Image";Hl.prototype._attrsAffectingSize=["image"];li(Hl);K.addGetterSetter(Hl,"cornerRadius",0,_v(4));K.addGetterSetter(Hl,"image");K.addComponentsGetterSetter(Hl,"crop",["x","y","width","height"]);K.addGetterSetter(Hl,"cropX",0,kt());K.addGetterSetter(Hl,"cropY",0,kt());K.addGetterSetter(Hl,"cropWidth",0,kt());K.addGetterSetter(Hl,"cropHeight",0,kt());const Z8=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],oB="Change.konva",uB="none",QA="up",XA="right",KA="down",WA="left",cB=Z8.length;class ZS extends xm{constructor(t){super(t),this.on("add.konva",function(e){this._addListeners(e.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(t){let e=this,i;const s=function(){e._sync()};for(i=0;i<cB;i++)t.on(Z8[i]+oB,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let t=this.getText(),e=this.getTag(),i,s,l,c,f,m,g;if(t&&e){switch(i=t.width(),s=t.height(),l=e.pointerDirection(),c=e.pointerWidth(),g=e.pointerHeight(),f=0,m=0,l){case QA:f=i/2,m=-1*g;break;case XA:f=i+c,m=s/2;break;case KA:f=i/2,m=s+g;break;case WA:f=-1*c,m=s/2;break}e.setAttrs({x:-1*f,y:-1*m,width:i,height:s}),t.setAttrs({x:-1*f,y:-1*m})}}}ZS.prototype.className="Label";li(ZS);class Kf extends xt{_sceneFunc(t){const e=this.width(),i=this.height(),s=this.pointerDirection(),l=this.pointerWidth(),c=this.pointerHeight(),f=this.cornerRadius();let m=0,g=0,A=0,E=0;typeof f=="number"?m=g=A=E=Math.min(f,e/2,i/2):(m=Math.min(f[0]||0,e/2,i/2),g=Math.min(f[1]||0,e/2,i/2),E=Math.min(f[2]||0,e/2,i/2),A=Math.min(f[3]||0,e/2,i/2)),t.beginPath(),t.moveTo(m,0),s===QA&&(t.lineTo((e-l)/2,0),t.lineTo(e/2,-1*c),t.lineTo((e+l)/2,0)),t.lineTo(e-g,0),t.arc(e-g,g,g,Math.PI*3/2,0,!1),s===XA&&(t.lineTo(e,(i-c)/2),t.lineTo(e+l,i/2),t.lineTo(e,(i+c)/2)),t.lineTo(e,i-E),t.arc(e-E,i-E,E,0,Math.PI/2,!1),s===KA&&(t.lineTo((e+l)/2,i),t.lineTo(e/2,i+c),t.lineTo((e-l)/2,i)),t.lineTo(A,i),t.arc(A,i-A,A,Math.PI/2,Math.PI,!1),s===WA&&(t.lineTo(0,(i+c)/2),t.lineTo(-1*l,i/2),t.lineTo(0,(i-c)/2)),t.lineTo(0,m),t.arc(m,m,m,Math.PI,Math.PI*3/2,!1),t.closePath(),t.fillStrokeShape(this)}getSelfRect(){let t=0,e=0,i=this.pointerWidth(),s=this.pointerHeight(),l=this.pointerDirection(),c=this.width(),f=this.height();return l===QA?(e-=s,f+=s):l===KA?f+=s:l===WA?(t-=i*1.5,c+=i):l===XA&&(c+=i*1.5),{x:t,y:e,width:c,height:f}}}Kf.prototype.className="Tag";li(Kf);K.addGetterSetter(Kf,"pointerDirection",uB);K.addGetterSetter(Kf,"pointerWidth",0,kt());K.addGetterSetter(Kf,"pointerHeight",0,kt());K.addGetterSetter(Kf,"cornerRadius",0,_v(4));let H0=class extends xt{_sceneFunc(t){const e=this.cornerRadius(),i=this.width(),s=this.height();t.beginPath(),e?st.drawRoundedRectPath(t,i,s,e):t.rect(0,0,i,s),t.closePath(),t.fillStrokeShape(this)}};H0.prototype.className="Rect";li(H0);K.addGetterSetter(H0,"cornerRadius",0,_v(4));class Th extends xt{_sceneFunc(t){const e=this._getPoints(),i=this.radius(),s=this.sides(),l=this.cornerRadius();if(t.beginPath(),l)st.drawRoundedPolygonPath(t,e,s,i,l);else{t.moveTo(e[0].x,e[0].y);for(let c=1;c<e.length;c++)t.lineTo(e[c].x,e[c].y)}t.closePath(),t.fillStrokeShape(this)}_getPoints(){const t=this.attrs.sides,e=this.attrs.radius||0,i=[];for(let s=0;s<t;s++)i.push({x:e*Math.sin(s*2*Math.PI/t),y:-1*e*Math.cos(s*2*Math.PI/t)});return i}getSelfRect(){const t=this._getPoints();let e=t[0].x,i=t[0].x,s=t[0].y,l=t[0].y;return t.forEach(c=>{e=Math.min(e,c.x),i=Math.max(i,c.x),s=Math.min(s,c.y),l=Math.max(l,c.y)}),{x:e,y:s,width:i-e,height:l-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Th.prototype.className="RegularPolygon";Th.prototype._centroid=!0;Th.prototype._attrsAffectingSize=["radius"];li(Th);K.addGetterSetter(Th,"radius",0,kt());K.addGetterSetter(Th,"sides",0,kt());K.addGetterSetter(Th,"cornerRadius",0,_v(4));const Y3=Math.PI*2;class Wf extends xt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.innerRadius(),0,Y3,!1),t.moveTo(this.outerRadius(),0),t.arc(0,0,this.outerRadius(),Y3,0,!0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}Wf.prototype.className="Ring";Wf.prototype._centroid=!0;Wf.prototype._attrsAffectingSize=["innerRadius","outerRadius"];li(Wf);K.addGetterSetter(Wf,"innerRadius",0,kt());K.addGetterSetter(Wf,"outerRadius",0,kt());class Po extends xt{constructor(t){super(t),this._updated=!0,this.anim=new el(()=>{const e=this._updated;return this._updated=!1,e}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(t){const e=this.animation(),i=this.frameIndex(),s=i*4,l=this.animations()[e],c=this.frameOffsets(),f=l[s+0],m=l[s+1],g=l[s+2],A=l[s+3],E=this.image();if((this.hasFill()||this.hasStroke())&&(t.beginPath(),t.rect(0,0,g,A),t.closePath(),t.fillStrokeShape(this)),E)if(c){const T=c[e],x=i*2;t.drawImage(E,f,m,g,A,T[x+0],T[x+1],g,A)}else t.drawImage(E,f,m,g,A,0,0,g,A)}_hitFunc(t){const e=this.animation(),i=this.frameIndex(),s=i*4,l=this.animations()[e],c=this.frameOffsets(),f=l[s+2],m=l[s+3];if(t.beginPath(),c){const g=c[e],A=i*2;t.rect(g[A+0],g[A+1],f,m)}else t.rect(0,0,f,m);t.closePath(),t.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const t=this;this.interval=setInterval(function(){t._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const t=this.getLayer();this.anim.setLayers(t),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const t=this.frameIndex(),e=this.animation(),i=this.animations(),s=i[e],l=s.length/4;t<l-1?this.frameIndex(t+1):this.frameIndex(0)}}Po.prototype.className="Sprite";li(Po);K.addGetterSetter(Po,"animation");K.addGetterSetter(Po,"animations");K.addGetterSetter(Po,"frameOffsets");K.addGetterSetter(Po,"image");K.addGetterSetter(Po,"frameIndex",0,kt());K.addGetterSetter(Po,"frameRate",17,kt());K.backCompat(Po,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});class bh extends xt{_sceneFunc(t){const e=this.innerRadius(),i=this.outerRadius(),s=this.numPoints();t.beginPath(),t.moveTo(0,0-i);for(let l=1;l<s*2;l++){const c=l%2===0?i:e,f=c*Math.sin(l*Math.PI/s),m=-1*c*Math.cos(l*Math.PI/s);t.lineTo(f,m)}t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(t){this.outerRadius(t/2)}setHeight(t){this.outerRadius(t/2)}}bh.prototype.className="Star";bh.prototype._centroid=!0;bh.prototype._attrsAffectingSize=["innerRadius","outerRadius"];li(bh);K.addGetterSetter(bh,"numPoints",5,kt());K.addGetterSetter(bh,"innerRadius",0,kt());K.addGetterSetter(bh,"outerRadius",0,kt());function Fc(n){return[...n].reduce((t,e,i,s)=>{if(new RegExp("\\p{Emoji}","u").test(e)){const l=s[i+1];l&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(l)?(t.push(e+l),s[i+1]=""):t.push(e)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(e+(s[i+1]||""))?t.push(e+s[i+1]):i>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(e)?t[t.length-1]+=e:e&&t.push(e);return t},[])}const Wd="auto",hB="center",$8="inherit",gg="justify",fB="Change.konva",dB="2d",Q3="-",tw="left",mB="text",pB="Text",gB="top",_B="bottom",X3="middle",ew="normal",yB="px ",Cy=" ",vB="right",K3="rtl",AB="word",EB="char",W3="none",V2="",nw=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],SB=nw.length;function TB(n){return n.split(",").map(t=>{t=t.trim();const e=t.indexOf(" ")>=0,i=t.indexOf('"')>=0||t.indexOf("'")>=0;return e&&!i&&(t=`"${t}"`),t}).join(", ")}let wy;function U2(){return wy||(wy=st.createCanvasElement().getContext(dB),wy)}function bB(n){n.fillText(this._partialText,this._partialTextX,this._partialTextY)}function CB(n){n.setAttr("miterLimit",2),n.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function wB(n){return n=n||{},!n.fillLinearGradientColorStops&&!n.fillRadialGradientColorStops&&!n.fillPatternImage&&(n.fill=n.fill||"black"),n}let Mn=class extends xt{constructor(t){super(wB(t)),this._partialTextX=0,this._partialTextY=0;for(let e=0;e<SB;e++)this.on(nw[e]+fB,this._setTextData);this._setTextData()}_sceneFunc(t){var e,i;const s=this.textArr,l=s.length;if(!this.text())return;let c=this.padding(),f=this.fontSize(),m=this.lineHeight()*f,g=this.verticalAlign(),A=this.direction(),E=0,T=this.align(),x=this.getWidth(),R=this.letterSpacing(),O=this.charRenderFunc(),M=this.fill(),H=this.textDecoration(),B=this.underlineOffset(),Y=H.indexOf("underline")!==-1,$=H.indexOf("line-through")!==-1,nt;A=A===$8?t.direction:A;let X=m/2,L=X3;if(!Ut.legacyTextRendering){const k=this.measureSize("M");L="alphabetic";const V=(e=k.fontBoundingBoxAscent)!==null&&e!==void 0?e:k.actualBoundingBoxAscent,q=(i=k.fontBoundingBoxDescent)!==null&&i!==void 0?i:k.actualBoundingBoxDescent;X=(V-q)/2+m/2}for(A===K3&&t.setAttr("direction",A),t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",L),t.setAttr("textAlign",tw),g===X3?E=(this.getHeight()-l*m-c*2)/2:g===_B&&(E=this.getHeight()-l*m-c*2),t.translate(c,E+c),nt=0;nt<l;nt++){let k=0,V=0;const q=s[nt],Q=q.text,F=q.width,G=q.lastInParagraph;if(t.save(),T===vB?k+=x-F-c*2:T===hB&&(k+=(x-F-c*2)/2),Y){t.save(),t.beginPath();const Vt=B??(Ut.legacyTextRendering?Math.round(f/2):Math.round(f/4)),tt=k,At=X+V+Vt;t.moveTo(tt,At);const yt=T===gg&&!G?x-c*2:F;t.lineTo(tt+Math.round(yt),At),t.lineWidth=f/15;const Mt=this._getLinearGradient();t.strokeStyle=Mt||M,t.stroke(),t.restore()}const Ot=k;if(A!==K3&&(R!==0||T===gg||O)){const Vt=Q.split(" ").length-1,tt=Fc(Q);for(let At=0;At<tt.length;At++){const yt=tt[At];if(yt===" "&&!G&&T===gg&&(k+=(x-c*2-F)/Vt),this._partialTextX=k,this._partialTextY=X+V,this._partialText=yt,O){t.save();const Qt=s.slice(0,nt).reduce((ft,bt)=>ft+Fc(bt.text).length,0),W=At+Qt;O({char:yt,index:W,x:k,y:X+V,lineIndex:nt,column:At,isLastInLine:G,width:this.measureSize(yt).width,context:t})}t.fillStrokeShape(this),O&&t.restore(),k+=this.measureSize(yt).width+R}}else R!==0&&t.setAttr("letterSpacing",`${R}px`),this._partialTextX=k,this._partialTextY=X+V,this._partialText=Q,t.fillStrokeShape(this);if($){t.save(),t.beginPath();const Vt=Ut.legacyTextRendering?0:-Math.round(f/4),tt=Ot;t.moveTo(tt,X+V+Vt);const At=T===gg&&!G?x-c*2:F;t.lineTo(tt+Math.round(At),X+V+Vt),t.lineWidth=f/15;const yt=this._getLinearGradient();t.strokeStyle=yt||M,t.stroke(),t.restore()}t.restore(),l>1&&(X+=m)}}_hitFunc(t){const e=this.getWidth(),i=this.getHeight();t.beginPath(),t.rect(0,0,e,i),t.closePath(),t.fillStrokeShape(this)}setText(t){const e=st._isString(t)?t:t==null?"":t+"";return this._setAttr(mB,e),this}getWidth(){return this.attrs.width===Wd||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Wd||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return st.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(t){var e,i,s,l,c,f,m,g,A,E,T;let x=U2(),R=this.fontSize(),O;x.save(),x.font=this._getContextFont(),O=x.measureText(t),x.restore();const M=R/100;return{actualBoundingBoxAscent:(e=O.actualBoundingBoxAscent)!==null&&e!==void 0?e:71.58203125*M,actualBoundingBoxDescent:(i=O.actualBoundingBoxDescent)!==null&&i!==void 0?i:0,actualBoundingBoxLeft:(s=O.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*M,actualBoundingBoxRight:(l=O.actualBoundingBoxRight)!==null&&l!==void 0?l:75.732421875*M,alphabeticBaseline:(c=O.alphabeticBaseline)!==null&&c!==void 0?c:0,emHeightAscent:(f=O.emHeightAscent)!==null&&f!==void 0?f:100*M,emHeightDescent:(m=O.emHeightDescent)!==null&&m!==void 0?m:-20*M,fontBoundingBoxAscent:(g=O.fontBoundingBoxAscent)!==null&&g!==void 0?g:91*M,fontBoundingBoxDescent:(A=O.fontBoundingBoxDescent)!==null&&A!==void 0?A:21*M,hangingBaseline:(E=O.hangingBaseline)!==null&&E!==void 0?E:72.80000305175781*M,ideographicBaseline:(T=O.ideographicBaseline)!==null&&T!==void 0?T:-21*M,width:O.width,height:R}}_getContextFont(){return this.fontStyle()+Cy+this.fontVariant()+Cy+(this.fontSize()+yB)+TB(this.fontFamily())}_addTextLine(t){this.align()===gg&&(t=t.trim());const i=this._getTextWidth(t);return this.textArr.push({text:t,width:i,lastInParagraph:!1})}_getTextWidth(t){const e=this.letterSpacing(),i=t.length;return U2().measureText(t).width+e*i}_setTextData(){let t=this.text().split(`
`),e=+this.fontSize(),i=0,s=this.lineHeight()*e,l=this.attrs.width,c=this.attrs.height,f=l!==Wd&&l!==void 0,m=c!==Wd&&c!==void 0,g=this.padding(),A=l-g*2,E=c-g*2,T=0,x=this.wrap(),R=x!==W3,O=x!==EB&&R,M=this.ellipsis();this.textArr=[],U2().font=this._getContextFont();const H=M?this._getTextWidth(V2):0;for(let B=0,Y=t.length;B<Y;++B){let $=t[B],nt=this._getTextWidth($);if(f&&nt>A)for(;$.length>0;){let X=0,L=Fc($).length,k="",V=0;for(;X<L;){const q=X+L>>>1,Q=Fc($),F=Q.slice(0,q+1).join(""),G=this._getTextWidth(F);(M&&m&&T+s>E?G+H:G)<=A?(X=q+1,k=F,V=G):L=q}if(k){if(O){const F=Fc($),G=Fc(k),Ot=F[G.length],Vt=Ot===Cy||Ot===Q3;let tt;if(Vt&&V<=A)tt=G.length;else{const At=G.lastIndexOf(Cy),yt=G.lastIndexOf(Q3);tt=Math.max(At,yt)+1}tt>0&&(X=tt,k=F.slice(0,X).join(""),V=this._getTextWidth(k))}if(k=k.trimRight(),this._addTextLine(k),i=Math.max(i,V),T+=s,this._shouldHandleEllipsis(T)){this._tryToAddEllipsisToLastLine();break}if($=Fc($).slice(X).join("").trimLeft(),$.length>0&&(nt=this._getTextWidth($),nt<=A)){this._addTextLine($),T+=s,i=Math.max(i,nt);break}}else break}else this._addTextLine($),T+=s,i=Math.max(i,nt),this._shouldHandleEllipsis(T)&&B<Y-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),m&&T+s>E)break}this.textHeight=e,this.textWidth=i}_shouldHandleEllipsis(t){const e=+this.fontSize(),i=this.lineHeight()*e,s=this.attrs.height,l=s!==Wd&&s!==void 0,c=this.padding(),f=s-c*2;return!(this.wrap()!==W3)||l&&t+i>f}_tryToAddEllipsisToLastLine(){const t=this.attrs.width,e=t!==Wd&&t!==void 0,i=this.padding(),s=t-i*2,l=this.ellipsis(),c=this.textArr[this.textArr.length-1];!c||!l||(e&&(this._getTextWidth(c.text+V2)<s||(c.text=c.text.slice(0,c.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(c.text+V2))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const t=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,e=this.hasShadow();return t&&e?!0:super._useBufferCanvas()}};Mn.prototype._fillFunc=bB;Mn.prototype._strokeFunc=CB;Mn.prototype.className=pB;Mn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];li(Mn);K.overWriteSetter(Mn,"width",KS());K.overWriteSetter(Mn,"height",KS());K.addGetterSetter(Mn,"direction",$8);K.addGetterSetter(Mn,"fontFamily","Arial");K.addGetterSetter(Mn,"fontSize",12,kt());K.addGetterSetter(Mn,"fontStyle",ew);K.addGetterSetter(Mn,"fontVariant",ew);K.addGetterSetter(Mn,"padding",0,kt());K.addGetterSetter(Mn,"align",tw);K.addGetterSetter(Mn,"verticalAlign",gB);K.addGetterSetter(Mn,"lineHeight",1,kt());K.addGetterSetter(Mn,"wrap",AB);K.addGetterSetter(Mn,"ellipsis",!1,jl());K.addGetterSetter(Mn,"letterSpacing",0,kt());K.addGetterSetter(Mn,"text","",Yf());K.addGetterSetter(Mn,"textDecoration","");K.addGetterSetter(Mn,"underlineOffset",void 0,kt());K.addGetterSetter(Mn,"charRenderFunc",void 0);const RB="",iw="normal";function sw(n){n.fillText(this.partialText,0,0)}function aw(n){n.strokeText(this.partialText,0,0)}class Ji extends xt{constructor(t){super(t),this.dummyCanvas=st.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return In.getPathLength(this.dataArray)}_getPointAtLength(t){if(!this.attrs.data)return null;const e=this.pathLength;return t>e?null:In.getPointAtLengthOfDataArray(t,this.dataArray)}_readDataAttribute(){this.dataArray=In.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(t){t.setAttr("font",this._getContextFont()),t.setAttr("textBaseline",this.textBaseline()),t.setAttr("textAlign","left"),t.save();const e=this.textDecoration(),i=this.fill(),s=this.fontSize(),l=this.glyphInfo,c=e.indexOf("underline")!==-1,f=e.indexOf("line-through")!==-1;c&&t.beginPath();for(let m=0;m<l.length;m++){t.save();const g=l[m].p0;t.translate(g.x,g.y),t.rotate(l[m].rotation),this.partialText=l[m].text,t.fillStrokeShape(this),c&&(m===0&&t.moveTo(0,s/2+1),t.lineTo(l[m].width,s/2+1)),t.restore()}if(c&&(t.strokeStyle=i,t.lineWidth=s/20,t.stroke()),f){t.beginPath();for(let m=0;m<l.length;m++){t.save();const g=l[m].p0;t.translate(g.x,g.y),t.rotate(l[m].rotation),m===0&&t.moveTo(0,0),t.lineTo(l[m].width,0),t.restore()}t.strokeStyle=i,t.lineWidth=s/20,t.stroke()}t.restore()}_hitFunc(t){t.beginPath();const e=this.glyphInfo;if(e.length>=1){const i=e[0].p0;t.moveTo(i.x,i.y)}for(let i=0;i<e.length;i++){const s=e[i].p1;t.lineTo(s.x,s.y)}t.setAttr("lineWidth",this.fontSize()),t.setAttr("strokeStyle",this.colorKey),t.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return st.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(t){return Mn.prototype.setText.call(this,t)}_getContextFont(){return Mn.prototype._getContextFont.call(this)}_getTextSize(t){const i=this.dummyCanvas.getContext("2d");i.save(),i.font=this._getContextFont();const s=i.measureText(t);return i.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const t=Fc(this.text()),e=[];let i=0;for(let E=0;E<t.length;E++)e.push({char:t[E],width:this._getTextSize(t[E]).width}),i+=e[E].width;const{height:s}=this._getTextSize(this.attrs.text);if(this.textWidth=i,this.textHeight=s,this.glyphInfo=[],!this.attrs.data)return null;const l=this.letterSpacing(),c=this.align(),f=this.kerningFunc(),m=Math.max(this.textWidth+((this.attrs.text||"").length-1)*l,0);let g=0;c==="center"&&(g=Math.max(0,this.pathLength/2-m/2)),c==="right"&&(g=Math.max(0,this.pathLength-m));let A=g;for(let E=0;E<e.length;E++){const T=this._getPointAtLength(A);if(!T)return;const x=e[E].char;let R=e[E].width+l;if(x===" "&&c==="justify"){const $=this.text().split(" ").length-1;R+=(this.pathLength-m)/$}const O=this._getPointAtLength(A+R);if(!O)return;const M=In.getLineLength(T.x,T.y,O.x,O.y);let H=0;if(f)try{H=f(e[E-1].char,x)*this.fontSize()}catch{H=0}T.x+=H,O.x+=H,this.textWidth+=H;const B=In.getPointOnLine(H+M/2,T.x,T.y,O.x,O.y),Y=Math.atan2(O.y-T.y,O.x-T.x);this.glyphInfo.push({transposeX:B.x,transposeY:B.y,text:t[E],rotation:Y,p0:T,p1:O,width:M}),A+=R}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const t=[];this.glyphInfo.forEach(function(g){t.push(g.p0.x),t.push(g.p0.y),t.push(g.p1.x),t.push(g.p1.y)});let e=t[0]||0,i=t[0]||0,s=t[1]||0,l=t[1]||0,c,f;for(let g=0;g<t.length/2;g++)c=t[g*2],f=t[g*2+1],e=Math.min(e,c),i=Math.max(i,c),s=Math.min(s,f),l=Math.max(l,f);const m=this.fontSize();return{x:e-m/2,y:s-m/2,width:i-e+m,height:l-s+m}}destroy(){return st.releaseCanvas(this.dummyCanvas),super.destroy()}}Ji.prototype._fillFunc=sw;Ji.prototype._strokeFunc=aw;Ji.prototype._fillFuncHit=sw;Ji.prototype._strokeFuncHit=aw;Ji.prototype.className="TextPath";Ji.prototype._attrsAffectingSize=["text","fontSize","data"];li(Ji);K.addGetterSetter(Ji,"data");K.addGetterSetter(Ji,"fontFamily","Arial");K.addGetterSetter(Ji,"fontSize",12,kt());K.addGetterSetter(Ji,"fontStyle",iw);K.addGetterSetter(Ji,"align","left");K.addGetterSetter(Ji,"letterSpacing",0,kt());K.addGetterSetter(Ji,"textBaseline","middle");K.addGetterSetter(Ji,"fontVariant",iw);K.addGetterSetter(Ji,"text",RB);K.addGetterSetter(Ji,"textDecoration","");K.addGetterSetter(Ji,"kerningFunc",void 0);const rw="tr-konva",xB=["resizeEnabledChange","rotateAnchorOffsetChange","rotateAnchorAngleChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(n=>n+`.${rw}`).join(" "),J3="nodesRect",NB=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange","draggableChange"],DB={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},IB="ontouchstart"in Ut._global;function OB(n,t,e){if(n==="rotater")return e;t+=st.degToRad(DB[n]||0);const i=(st.radToDeg(t)%360+360)%360;return st._inRange(i,315+22.5,360)||st._inRange(i,0,22.5)?"ns-resize":st._inRange(i,45-22.5,45+22.5)?"nesw-resize":st._inRange(i,90-22.5,90+22.5)?"ew-resize":st._inRange(i,135-22.5,135+22.5)?"nwse-resize":st._inRange(i,180-22.5,180+22.5)?"ns-resize":st._inRange(i,225-22.5,225+22.5)?"nesw-resize":st._inRange(i,270-22.5,270+22.5)?"ew-resize":st._inRange(i,315-22.5,315+22.5)?"nwse-resize":(st.error("Transformer has unknown angle for cursor detection: "+i),"pointer")}const x1=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function MB(n){return{x:n.x+n.width/2*Math.cos(n.rotation)+n.height/2*Math.sin(-n.rotation),y:n.y+n.height/2*Math.cos(n.rotation)+n.width/2*Math.sin(n.rotation)}}function lw(n,t,e){const i=e.x+(n.x-e.x)*Math.cos(t)-(n.y-e.y)*Math.sin(t),s=e.y+(n.x-e.x)*Math.sin(t)+(n.y-e.y)*Math.cos(t);return{...n,rotation:n.rotation+t,x:i,y:s}}function LB(n,t){const e=MB(n);return lw(n,t,e)}function kB(n,t,e){let i=t;for(let s=0;s<n.length;s++){const l=Ut.getAngle(n[s]),c=Math.abs(l-t)%(Math.PI*2);Math.min(c,Math.PI*2-c)<e&&(i=l)}return i}let JA=0,He=class extends xm{constructor(t){super(t),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(xB,this.update),this.getNode()&&this.update()}attachTo(t){return this.setNode(t),this}setNode(t){return st.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([t])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return rw+this._id}setNodes(t=[]){this._nodes&&this._nodes.length&&this.detach();const e=t.filter(s=>s.isAncestorOf(this)?(st.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=t=e,t.length===1&&this.useSingleNodeRotation()?this.rotation(t[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const l=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const c=s._attrsAffectingSize.map(f=>f+"Change."+this._getEventNamespace()).join(" ");s.on(c,l)}s.on(NB.map(c=>c+`.${this._getEventNamespace()}`).join(" "),l),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,l),this._proxyDrag(s)}),this._resetTransformCache(),this.findOne(".top-left")&&this.update(),this}_proxyDrag(t){let e;t.on(`dragstart.${this._getEventNamespace()}`,i=>{e=t.getAbsolutePosition(),!this.isDragging()&&t!==this.findOne(".back")&&this.startDrag(i,!1)}),t.on(`dragmove.${this._getEventNamespace()}`,i=>{if(!e)return;const s=t.getAbsolutePosition(),l=s.x-e.x,c=s.y-e.y;this.nodes().forEach(f=>{if(f===t||f.isDragging())return;const m=f.getAbsolutePosition();f.setAbsolutePosition({x:m.x+l,y:m.y+c}),f.startDrag(i)}),e=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(t=>{t.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(J3),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(J3,this.__getNodeRect)}__getNodeShape(t,e=this.rotation(),i){const s=t.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),l=t.getAbsoluteScale(i),c=t.getAbsolutePosition(i),f=s.x*l.x-t.offsetX()*l.x,m=s.y*l.y-t.offsetY()*l.y,g=(Ut.getAngle(t.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),A={x:c.x+f*Math.cos(g)+m*Math.sin(-g),y:c.y+m*Math.cos(g)+f*Math.sin(g),width:s.width*l.x,height:s.height*l.y,rotation:g};return lw(A,-Ut.getAngle(e),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const e=[];this.nodes().map(g=>{const A=g.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),E=[{x:A.x,y:A.y},{x:A.x+A.width,y:A.y},{x:A.x+A.width,y:A.y+A.height},{x:A.x,y:A.y+A.height}],T=g.getAbsoluteTransform();E.forEach(function(x){const R=T.point(x);e.push(R)})});const i=new pr;i.rotate(-Ut.getAngle(this.rotation()));let s=1/0,l=1/0,c=-1/0,f=-1/0;e.forEach(function(g){const A=i.point(g);s===void 0&&(s=c=A.x,l=f=A.y),s=Math.min(s,A.x),l=Math.min(l,A.y),c=Math.max(c,A.x),f=Math.max(f,A.y)}),i.invert();const m=i.point({x:s,y:l});return{x:m.x,y:m.y,width:c-s,height:f-l,rotation:Ut.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),x1.forEach(t=>{this._createAnchor(t)}),this._createAnchor("rotater")}_createAnchor(t){const e=new H0({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:t+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:IB?10:"auto"}),i=this;e.on("mousedown touchstart",function(s){i._handleMouseDown(s)}),e.on("dragstart",s=>{e.stopDrag(),s.cancelBubble=!0}),e.on("dragend",s=>{s.cancelBubble=!0}),e.on("mouseenter",()=>{const s=Ut.getAngle(this.rotation()),l=this.rotateAnchorCursor(),c=OB(t,s,l);e.getStage().content&&(e.getStage().content.style.cursor=c),this._cursorChange=!0}),e.on("mouseout",()=>{e.getStage().content&&(e.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(e)}_createBack(){const t=new xt({name:"back",width:0,height:0,sceneFunc(e,i){const s=i.getParent(),l=s.padding(),c=i.width(),f=i.height();if(e.beginPath(),e.rect(-l,-l,c+l*2,f+l*2),s.rotateEnabled()&&s.rotateLineVisible()){const m=s.rotateAnchorAngle(),g=s.rotateAnchorOffset(),A=st.degToRad(m),E=Math.sin(A),T=-Math.cos(A),x=c/2,R=f/2;let O=1/0;T<0?O=Math.min(O,-R/T):T>0&&(O=Math.min(O,(f-R)/T)),E<0?O=Math.min(O,-x/E):E>0&&(O=Math.min(O,(c-x)/E));const M=x+E*O,H=R+T*O,B=st._sign(f),Y=M+E*g*B,$=H+T*g*B;e.moveTo(M,H),e.lineTo(Y,$)}e.fillStrokeShape(i)},hitFunc:(e,i)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();e.beginPath(),e.rect(-s,-s,i.width()+s*2,i.height()+s*2),e.fillStrokeShape(i)}});this.add(t),this._proxyDrag(t),t.on("dragstart",e=>{e.cancelBubble=!0}),t.on("dragmove",e=>{e.cancelBubble=!0}),t.on("dragend",e=>{e.cancelBubble=!0}),this.on("dragmove",e=>{this.update()})}_handleMouseDown(t){if(this._transforming)return;this._movingAnchorName=t.target.name().split(" ")[0];const e=this._getNodeRect(),i=e.width,s=e.height,l=Math.sqrt(Math.pow(i,2)+Math.pow(s,2));this.sin=Math.abs(s/l),this.cos=Math.abs(i/l),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const c=t.target.getAbsolutePosition(),f=t.target.getStage().getPointerPosition();this._anchorDragOffset={x:f.x-c.x,y:f.y-c.y},JA++,this._fire("transformstart",{evt:t.evt,target:this.getNode()}),this._nodes.forEach(m=>{m._fire("transformstart",{evt:t.evt,target:m})})}_handleMouseMove(t){let e,i,s;const l=this.findOne("."+this._movingAnchorName),c=l.getStage();c.setPointersPositions(t);const f=c.getPointerPosition();let m={x:f.x-this._anchorDragOffset.x,y:f.y-this._anchorDragOffset.y};const g=l.getAbsolutePosition();this.anchorDragBoundFunc()&&(m=this.anchorDragBoundFunc()(g,m,t)),l.setAbsolutePosition(m);const A=l.getAbsolutePosition();if(g.x===A.x&&g.y===A.y)return;if(this._movingAnchorName==="rotater"){const B=this._getNodeRect();e=l.x()-B.width/2,i=-l.y()+B.height/2;const Y=Ut.getAngle(this.rotateAnchorAngle());let $=Math.atan2(-i,e)+Math.PI/2-Y;B.height<0&&($-=Math.PI);const X=Ut.getAngle(this.rotation())+$,L=Ut.getAngle(this.rotationSnapTolerance()),V=kB(this.rotationSnaps(),X,L)-B.rotation,q=LB(B,V);this._fitNodesInto(q,t);return}const E=this.shiftBehavior();let T;E==="inverted"?T=this.keepRatio()&&!t.shiftKey:E==="none"?T=this.keepRatio():T=this.keepRatio()||t.shiftKey;let x=this.centeredScaling()||t.altKey;if(this._movingAnchorName==="top-left"){if(T){const B=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(B.x-l.x(),2)+Math.pow(B.y-l.y(),2));const Y=this.findOne(".top-left").x()>B.x?-1:1,$=this.findOne(".top-left").y()>B.y?-1:1;e=s*this.cos*Y,i=s*this.sin*$,this.findOne(".top-left").x(B.x-e),this.findOne(".top-left").y(B.y-i)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(l.y());else if(this._movingAnchorName==="top-right"){if(T){const B=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(l.x()-B.x,2)+Math.pow(B.y-l.y(),2));const Y=this.findOne(".top-right").x()<B.x?-1:1,$=this.findOne(".top-right").y()>B.y?-1:1;e=s*this.cos*Y,i=s*this.sin*$,this.findOne(".top-right").x(B.x+e),this.findOne(".top-right").y(B.y-i)}var R=l.position();this.findOne(".top-left").y(R.y),this.findOne(".bottom-right").x(R.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(l.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(l.x());else if(this._movingAnchorName==="bottom-left"){if(T){const B=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(B.x-l.x(),2)+Math.pow(l.y()-B.y,2));const Y=B.x<l.x()?-1:1,$=l.y()<B.y?-1:1;e=s*this.cos*Y,i=s*this.sin*$,l.x(B.x-e),l.y(B.y+i)}R=l.position(),this.findOne(".top-left").x(R.x),this.findOne(".bottom-right").y(R.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(l.y());else if(this._movingAnchorName==="bottom-right"){if(T){const B=x?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(l.x()-B.x,2)+Math.pow(l.y()-B.y,2));const Y=this.findOne(".bottom-right").x()<B.x?-1:1,$=this.findOne(".bottom-right").y()<B.y?-1:1;e=s*this.cos*Y,i=s*this.sin*$,this.findOne(".bottom-right").x(B.x+e),this.findOne(".bottom-right").y(B.y+i)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(x=this.centeredScaling()||t.altKey,x){const B=this.findOne(".top-left"),Y=this.findOne(".bottom-right"),$=B.x(),nt=B.y(),X=this.getWidth()-Y.x(),L=this.getHeight()-Y.y();Y.move({x:-$,y:-nt}),B.move({x:X,y:L})}const O=this.findOne(".top-left").getAbsolutePosition();e=O.x,i=O.y;const M=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),H=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:e,y:i,width:M,height:H,rotation:Ut.getAngle(this.rotation())},t)}_handleMouseUp(t){this._removeEvents(t)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(t){var e;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const i=this.getNode();JA--,this._fire("transformend",{evt:t,target:i}),(e=this.getLayer())===null||e===void 0||e.batchDraw(),i&&this._nodes.forEach(s=>{var l;s._fire("transformend",{evt:t,target:s}),(l=s.getLayer())===null||l===void 0||l.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(t,e){const i=this._getNodeRect(),s=1;if(st._inRange(t.width,-this.padding()*2-s,s)){this.update();return}if(st._inRange(t.height,-this.padding()*2-s,s)){this.update();return}const l=new pr;if(l.rotate(Ut.getAngle(this.rotation())),this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("left")>=0){const T=l.point({x:-this.padding()*2,y:0});t.x+=T.x,t.y+=T.y,t.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=T.x,this._anchorDragOffset.y-=T.y}else if(this._movingAnchorName&&t.width<0&&this._movingAnchorName.indexOf("right")>=0){const T=l.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=T.x,this._anchorDragOffset.y-=T.y,t.width+=this.padding()*2}if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("top")>=0){const T=l.point({x:0,y:-this.padding()*2});t.x+=T.x,t.y+=T.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=T.x,this._anchorDragOffset.y-=T.y,t.height+=this.padding()*2}else if(this._movingAnchorName&&t.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const T=l.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=T.x,this._anchorDragOffset.y-=T.y,t.height+=this.padding()*2}if(this.boundBoxFunc()){const T=this.boundBoxFunc()(i,t);T?t=T:st.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const c=1e7,f=new pr;f.translate(i.x,i.y),f.rotate(i.rotation),f.scale(i.width/c,i.height/c);const m=new pr,g=t.width/c,A=t.height/c;this.flipEnabled()===!1?(m.translate(t.x,t.y),m.rotate(t.rotation),m.translate(t.width<0?t.width:0,t.height<0?t.height:0),m.scale(Math.abs(g),Math.abs(A))):(m.translate(t.x,t.y),m.rotate(t.rotation),m.scale(g,A));const E=m.multiply(f.invert());this._nodes.forEach(T=>{var x;if(!T.getStage())return;const R=T.getParent().getAbsoluteTransform(),O=T.getTransform().copy();O.translate(T.offsetX(),T.offsetY());const M=new pr;M.multiply(R.copy().invert()).multiply(E).multiply(R).multiply(O);const H=M.decompose();T.setAttrs(H),(x=T.getLayer())===null||x===void 0||x.batchDraw()}),this.rotation(st._getRotation(t.rotation)),this._nodes.forEach(T=>{this._fire("transform",{evt:e,target:T}),T._fire("transform",{evt:e,target:T})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(t,e){this.findOne(t).setAttrs(e)}update(){var t;const e=this._getNodeRect();this.rotation(st._getRotation(e.rotation));const i=e.width,s=e.height,l=this.enabledAnchors(),c=this.resizeEnabled(),f=this.padding(),m=this.anchorSize(),g=this.find("._anchor");g.forEach(X=>{X.setAttrs({width:m,height:m,offsetX:m/2,offsetY:m/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:m/2+f,offsetY:m/2+f,visible:c&&l.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:i/2,y:0,offsetY:m/2+f,visible:c&&l.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:i,y:0,offsetX:m/2-f,offsetY:m/2+f,visible:c&&l.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:m/2+f,visible:c&&l.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:i,y:s/2,offsetX:m/2-f,visible:c&&l.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:m/2+f,offsetY:m/2-f,visible:c&&l.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:i/2,y:s,offsetY:m/2-f,visible:c&&l.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:i,y:s,offsetX:m/2-f,offsetY:m/2-f,visible:c&&l.indexOf("bottom-right")>=0});const A=this.rotateAnchorAngle(),E=this.rotateAnchorOffset(),T=st.degToRad(A),x=Math.sin(T),R=-Math.cos(T),O=i/2,M=s/2;let H=1/0;R<0?H=Math.min(H,-M/R):R>0&&(H=Math.min(H,(s-M)/R)),x<0?H=Math.min(H,-O/x):x>0&&(H=Math.min(H,(i-O)/x));const B=O+x*H,Y=M+R*H,$=st._sign(s);this._batchChangeChild(".rotater",{x:B+x*E*$,y:Y+R*E*$-f*R,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:i,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),draggable:this.nodes().some(X=>X.draggable()),x:0,y:0});const nt=this.anchorStyleFunc();nt&&g.forEach(X=>{nt(X)}),(t=this.getLayer())===null||t===void 0||t.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const t=this.findOne("."+this._movingAnchorName);t&&t.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),xm.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return It.prototype.toObject.call(this)}clone(t){return It.prototype.clone.call(this,t)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};He.isTransforming=()=>JA>0;function PB(n){return n instanceof Array||st.warn("enabledAnchors value should be an array"),n instanceof Array&&n.forEach(function(t){x1.indexOf(t)===-1&&st.warn("Unknown anchor name: "+t+". Available names are: "+x1.join(", "))}),n||[]}He.prototype.className="Transformer";li(He);K.addGetterSetter(He,"enabledAnchors",x1,PB);K.addGetterSetter(He,"flipEnabled",!0,jl());K.addGetterSetter(He,"resizeEnabled",!0);K.addGetterSetter(He,"anchorSize",10,kt());K.addGetterSetter(He,"rotateEnabled",!0);K.addGetterSetter(He,"rotateLineVisible",!0);K.addGetterSetter(He,"rotationSnaps",[]);K.addGetterSetter(He,"rotateAnchorOffset",50,kt());K.addGetterSetter(He,"rotateAnchorAngle",0,kt());K.addGetterSetter(He,"rotateAnchorCursor","crosshair");K.addGetterSetter(He,"rotationSnapTolerance",5,kt());K.addGetterSetter(He,"borderEnabled",!0);K.addGetterSetter(He,"anchorStroke","rgb(0, 161, 255)");K.addGetterSetter(He,"anchorStrokeWidth",1,kt());K.addGetterSetter(He,"anchorFill","white");K.addGetterSetter(He,"anchorCornerRadius",0,kt());K.addGetterSetter(He,"borderStroke","rgb(0, 161, 255)");K.addGetterSetter(He,"borderStrokeWidth",1,kt());K.addGetterSetter(He,"borderDash");K.addGetterSetter(He,"keepRatio",!0);K.addGetterSetter(He,"shiftBehavior","default");K.addGetterSetter(He,"centeredScaling",!1);K.addGetterSetter(He,"ignoreStroke",!1);K.addGetterSetter(He,"padding",0,kt());K.addGetterSetter(He,"nodes");K.addGetterSetter(He,"node");K.addGetterSetter(He,"boundBoxFunc");K.addGetterSetter(He,"anchorDragBoundFunc");K.addGetterSetter(He,"anchorStyleFunc");K.addGetterSetter(He,"shouldOverdrawWholeArea",!1);K.addGetterSetter(He,"useSingleNodeRotation",!0);K.backCompat(He,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});class Qu extends xt{_sceneFunc(t){t.beginPath(),t.arc(0,0,this.radius(),0,Ut.getAngle(this.angle()),this.clockwise()),t.lineTo(0,0),t.closePath(),t.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(t){this.radius(t/2)}setHeight(t){this.radius(t/2)}}Qu.prototype.className="Wedge";Qu.prototype._centroid=!0;Qu.prototype._attrsAffectingSize=["radius"];li(Qu);K.addGetterSetter(Qu,"radius",0,kt());K.addGetterSetter(Qu,"angle",0,kt());K.addGetterSetter(Qu,"clockwise",!1);K.backCompat(Qu,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});function Z3(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const VB=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],UB=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function zB(n,t){const e=n.data,i=n.width,s=n.height;let l,c,f,m,g,A,E,T,x,R,O,M,H,B,Y,$,nt,X,L,k;const V=t+t+1,q=i-1,Q=s-1,F=t+1,G=F*(F+1)/2,Ot=new Z3,Vt=VB[t],tt=UB[t];let At=null,yt=Ot,Mt=null,Qt=null;for(let W=1;W<V;W++)yt=yt.next=new Z3,W===F&&(At=yt);yt.next=Ot,f=c=0;for(let W=0;W<s;W++){M=H=B=Y=m=g=A=E=0,T=F*($=e[c]),x=F*(nt=e[c+1]),R=F*(X=e[c+2]),O=F*(L=e[c+3]),m+=G*$,g+=G*nt,A+=G*X,E+=G*L,yt=Ot;for(let ft=0;ft<F;ft++)yt.r=$,yt.g=nt,yt.b=X,yt.a=L,yt=yt.next;for(let ft=1;ft<F;ft++)l=c+((q<ft?q:ft)<<2),m+=(yt.r=$=e[l])*(k=F-ft),g+=(yt.g=nt=e[l+1])*k,A+=(yt.b=X=e[l+2])*k,E+=(yt.a=L=e[l+3])*k,M+=$,H+=nt,B+=X,Y+=L,yt=yt.next;Mt=Ot,Qt=At;for(let ft=0;ft<i;ft++)e[c+3]=L=E*Vt>>tt,L!==0?(L=255/L,e[c]=(m*Vt>>tt)*L,e[c+1]=(g*Vt>>tt)*L,e[c+2]=(A*Vt>>tt)*L):e[c]=e[c+1]=e[c+2]=0,m-=T,g-=x,A-=R,E-=O,T-=Mt.r,x-=Mt.g,R-=Mt.b,O-=Mt.a,l=f+((l=ft+t+1)<q?l:q)<<2,M+=Mt.r=e[l],H+=Mt.g=e[l+1],B+=Mt.b=e[l+2],Y+=Mt.a=e[l+3],m+=M,g+=H,A+=B,E+=Y,Mt=Mt.next,T+=$=Qt.r,x+=nt=Qt.g,R+=X=Qt.b,O+=L=Qt.a,M-=$,H-=nt,B-=X,Y-=L,Qt=Qt.next,c+=4;f+=i}for(let W=0;W<i;W++){H=B=Y=M=g=A=E=m=0,c=W<<2,T=F*($=e[c]),x=F*(nt=e[c+1]),R=F*(X=e[c+2]),O=F*(L=e[c+3]),m+=G*$,g+=G*nt,A+=G*X,E+=G*L,yt=Ot;for(let bt=0;bt<F;bt++)yt.r=$,yt.g=nt,yt.b=X,yt.a=L,yt=yt.next;let ft=i;for(let bt=1;bt<=t;bt++)c=ft+W<<2,m+=(yt.r=$=e[c])*(k=F-bt),g+=(yt.g=nt=e[c+1])*k,A+=(yt.b=X=e[c+2])*k,E+=(yt.a=L=e[c+3])*k,M+=$,H+=nt,B+=X,Y+=L,yt=yt.next,bt<Q&&(ft+=i);c=W,Mt=Ot,Qt=At;for(let bt=0;bt<s;bt++)l=c<<2,e[l+3]=L=E*Vt>>tt,L>0?(L=255/L,e[l]=(m*Vt>>tt)*L,e[l+1]=(g*Vt>>tt)*L,e[l+2]=(A*Vt>>tt)*L):e[l]=e[l+1]=e[l+2]=0,m-=T,g-=x,A-=R,E-=O,T-=Mt.r,x-=Mt.g,R-=Mt.b,O-=Mt.a,l=W+((l=bt+F)<Q?l:Q)*i<<2,m+=M+=Mt.r=e[l],g+=H+=Mt.g=e[l+1],A+=B+=Mt.b=e[l+2],E+=Y+=Mt.a=e[l+3],Mt=Mt.next,T+=$=Qt.r,x+=nt=Qt.g,R+=X=Qt.b,O+=L=Qt.a,M-=$,H-=nt,B-=X,Y-=L,Qt=Qt.next,c+=i}}const BB=function(t){const e=Math.round(this.blurRadius());e>0&&zB(t,e)};K.addGetterSetter(It,"blurRadius",0,kt(),K.afterSetFilter);const jB=function(n){const t=this.brightness()*255,e=n.data,i=e.length;for(let s=0;s<i;s+=4)e[s]+=t,e[s+1]+=t,e[s+2]+=t};K.addGetterSetter(It,"brightness",0,kt(),K.afterSetFilter);const HB=function(n){const t=this.brightness(),e=n.data,i=e.length;for(let s=0;s<i;s+=4)e[s]=Math.min(255,e[s]*t),e[s+1]=Math.min(255,e[s+1]*t),e[s+2]=Math.min(255,e[s+2]*t)},GB=function(n){const t=Math.pow((this.contrast()+100)/100,2),e=n.data,i=e.length;let s=150,l=150,c=150;for(let f=0;f<i;f+=4)s=e[f],l=e[f+1],c=e[f+2],s/=255,s-=.5,s*=t,s+=.5,s*=255,l/=255,l-=.5,l*=t,l+=.5,l*=255,c/=255,c-=.5,c*=t,c+=.5,c*=255,s=s<0?0:s>255?255:s,l=l<0?0:l>255?255:l,c=c<0?0:c>255?255:c,e[f]=s,e[f+1]=l,e[f+2]=c};K.addGetterSetter(It,"contrast",0,kt(),K.afterSetFilter);const qB=function(n){var t,e,i,s,l,c,f,m,g;const A=n.data,E=n.width,T=n.height,x=Math.min(1,Math.max(0,(e=(t=this.embossStrength)===null||t===void 0?void 0:t.call(this))!==null&&e!==void 0?e:.5)),R=Math.min(1,Math.max(0,(s=(i=this.embossWhiteLevel)===null||i===void 0?void 0:i.call(this))!==null&&s!==void 0?s:.5)),M=(f={"top-left":315,top:270,"top-right":225,right:180,"bottom-right":135,bottom:90,"bottom-left":45,left:0}[(c=(l=this.embossDirection)===null||l===void 0?void 0:l.call(this))!==null&&c!==void 0?c:"top-left"])!==null&&f!==void 0?f:315,H=!!((g=(m=this.embossBlend)===null||m===void 0?void 0:m.call(this))!==null&&g!==void 0&&g),B=x*10,Y=R*255,$=M*Math.PI/180,nt=Math.cos($),X=Math.sin($),L=128/1020*B,k=new Uint8ClampedArray(A),V=new Float32Array(E*T);for(let Ot=0,Vt=0;Vt<A.length;Vt+=4,Ot++)V[Ot]=.2126*k[Vt]+.7152*k[Vt+1]+.0722*k[Vt+2];const q=[-1,0,1,-2,0,2,-1,0,1],Q=[-1,-2,-1,0,0,0,1,2,1],F=[-E-1,-E,-E+1,-1,0,1,E-1,E,E+1],G=Ot=>Ot<0?0:Ot>255?255:Ot;for(let Ot=1;Ot<T-1;Ot++)for(let Vt=1;Vt<E-1;Vt++){const tt=Ot*E+Vt;let At=0,yt=0;At+=V[tt+F[0]]*q[0],yt+=V[tt+F[0]]*Q[0],At+=V[tt+F[1]]*q[1],yt+=V[tt+F[1]]*Q[1],At+=V[tt+F[2]]*q[2],yt+=V[tt+F[2]]*Q[2],At+=V[tt+F[3]]*q[3],yt+=V[tt+F[3]]*Q[3],At+=V[tt+F[5]]*q[5],yt+=V[tt+F[5]]*Q[5],At+=V[tt+F[6]]*q[6],yt+=V[tt+F[6]]*Q[6],At+=V[tt+F[7]]*q[7],yt+=V[tt+F[7]]*Q[7],At+=V[tt+F[8]]*q[8],yt+=V[tt+F[8]]*Q[8];const Mt=nt*At+X*yt,Qt=G(Y+Mt*L),W=tt*4;if(H){const ft=Qt-Y;A[W]=G(k[W]+ft),A[W+1]=G(k[W+1]+ft),A[W+2]=G(k[W+2]+ft),A[W+3]=k[W+3]}else A[W]=A[W+1]=A[W+2]=Qt,A[W+3]=k[W+3]}for(let Ot=0;Ot<E;Ot++){let Vt=Ot*4,tt=((T-1)*E+Ot)*4;A[Vt]=k[Vt],A[Vt+1]=k[Vt+1],A[Vt+2]=k[Vt+2],A[Vt+3]=k[Vt+3],A[tt]=k[tt],A[tt+1]=k[tt+1],A[tt+2]=k[tt+2],A[tt+3]=k[tt+3]}for(let Ot=1;Ot<T-1;Ot++){let Vt=Ot*E*4,tt=(Ot*E+(E-1))*4;A[Vt]=k[Vt],A[Vt+1]=k[Vt+1],A[Vt+2]=k[Vt+2],A[Vt+3]=k[Vt+3],A[tt]=k[tt],A[tt+1]=k[tt+1],A[tt+2]=k[tt+2],A[tt+3]=k[tt+3]}return n};K.addGetterSetter(It,"embossStrength",.5,kt(),K.afterSetFilter);K.addGetterSetter(It,"embossWhiteLevel",.5,kt(),K.afterSetFilter);K.addGetterSetter(It,"embossDirection","top-left",void 0,K.afterSetFilter);K.addGetterSetter(It,"embossBlend",!1,void 0,K.afterSetFilter);function z2(n,t,e,i,s){const l=e-t,c=s-i;if(l===0)return i+c/2;if(c===0)return i;let f=(n-t)/l;return f=c*f+i,f}const FB=function(n){const t=n.data,e=t.length;let i=t[0],s=i,l,c=t[1],f=c,m,g=t[2],A=g,E;const T=this.enhance();if(T===0)return;for(let Y=0;Y<e;Y+=4)l=t[Y+0],l<i?i=l:l>s&&(s=l),m=t[Y+1],m<c?c=m:m>f&&(f=m),E=t[Y+2],E<g?g=E:E>A&&(A=E);s===i&&(s=255,i=0),f===c&&(f=255,c=0),A===g&&(A=255,g=0);let x,R,O,M,H,B;if(T>0)x=s+T*(255-s),R=i-T*(i-0),O=f+T*(255-f),M=c-T*(c-0),H=A+T*(255-A),B=g-T*(g-0);else{const Y=(s+i)*.5;x=s+T*(s-Y),R=i+T*(i-Y);const $=(f+c)*.5;O=f+T*(f-$),M=c+T*(c-$);const nt=(A+g)*.5;H=A+T*(A-nt),B=g+T*(g-nt)}for(let Y=0;Y<e;Y+=4)t[Y+0]=z2(t[Y+0],i,s,R,x),t[Y+1]=z2(t[Y+1],c,f,M,O),t[Y+2]=z2(t[Y+2],g,A,B,H)};K.addGetterSetter(It,"enhance",0,kt(),K.afterSetFilter);const YB=function(n){const t=n.data,e=t.length;for(let i=0;i<e;i+=4){const s=.34*t[i]+.5*t[i+1]+.16*t[i+2];t[i]=s,t[i+1]=s,t[i+2]=s}};K.addGetterSetter(It,"hue",0,kt(),K.afterSetFilter);K.addGetterSetter(It,"saturation",0,kt(),K.afterSetFilter);K.addGetterSetter(It,"luminance",0,kt(),K.afterSetFilter);const QB=function(n){const t=n.data,e=t.length,i=1,s=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=this.luminance()*127,f=i*s*Math.cos(l*Math.PI/180),m=i*s*Math.sin(l*Math.PI/180),g=.299*i+.701*f+.167*m,A=.587*i-.587*f+.33*m,E=.114*i-.114*f-.497*m,T=.299*i-.299*f-.328*m,x=.587*i+.413*f+.035*m,R=.114*i-.114*f+.293*m,O=.299*i-.3*f+1.25*m,M=.587*i-.586*f-1.05*m,H=.114*i+.886*f-.2*m;let B,Y,$,nt;for(let X=0;X<e;X+=4)B=t[X+0],Y=t[X+1],$=t[X+2],nt=t[X+3],t[X+0]=g*B+A*Y+E*$+c,t[X+1]=T*B+x*Y+R*$+c,t[X+2]=O*B+M*Y+H*$+c,t[X+3]=nt},XB=function(n){const t=n.data,e=t.length,i=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),l=Math.abs(this.hue()+360)%360,c=i*s*Math.cos(l*Math.PI/180),f=i*s*Math.sin(l*Math.PI/180),m=.299*i+.701*c+.167*f,g=.587*i-.587*c+.33*f,A=.114*i-.114*c-.497*f,E=.299*i-.299*c-.328*f,T=.587*i+.413*c+.035*f,x=.114*i-.114*c+.293*f,R=.299*i-.3*c+1.25*f,O=.587*i-.586*c-1.05*f,M=.114*i+.886*c-.2*f;for(let H=0;H<e;H+=4){const B=t[H+0],Y=t[H+1],$=t[H+2],nt=t[H+3];t[H+0]=m*B+g*Y+A*$,t[H+1]=E*B+T*Y+x*$,t[H+2]=R*B+O*Y+M*$,t[H+3]=nt}};K.addGetterSetter(It,"hue",0,kt(),K.afterSetFilter);K.addGetterSetter(It,"saturation",0,kt(),K.afterSetFilter);K.addGetterSetter(It,"value",0,kt(),K.afterSetFilter);const KB=function(n){const t=n.data,e=t.length;for(let i=0;i<e;i+=4)t[i]=255-t[i],t[i+1]=255-t[i+1],t[i+2]=255-t[i+2]},WB=function(n,t,e){const i=n.data,s=t.data,l=n.width,c=n.height,f=e.polarCenterX||l/2,m=e.polarCenterY||c/2;let g=Math.sqrt(f*f+m*m),A=l-f,E=c-m;const T=Math.sqrt(A*A+E*E);g=T>g?T:g;const x=c,R=l,O=360/R*Math.PI/180;for(let M=0;M<R;M+=1){const H=Math.sin(M*O),B=Math.cos(M*O);for(let Y=0;Y<x;Y+=1){A=Math.floor(f+g*Y/x*B),E=Math.floor(m+g*Y/x*H);let $=(E*l+A)*4;const nt=i[$+0],X=i[$+1],L=i[$+2],k=i[$+3];$=(M+Y*l)*4,s[$+0]=nt,s[$+1]=X,s[$+2]=L,s[$+3]=k}}},JB=function(n,t,e){const i=n.data,s=t.data,l=n.width,c=n.height,f=e.polarCenterX||l/2,m=e.polarCenterY||c/2;let g=Math.sqrt(f*f+m*m),A=l-f,E=c-m;const T=Math.sqrt(A*A+E*E);g=T>g?T:g;const x=c,R=l,O=0;let M,H;for(A=0;A<l;A+=1)for(E=0;E<c;E+=1){const B=A-f,Y=E-m,$=Math.sqrt(B*B+Y*Y)*x/g;let nt=(Math.atan2(Y,B)*180/Math.PI+360+O)%360;nt=nt*R/360,M=Math.floor(nt),H=Math.floor($);let X=(H*l+M)*4;const L=i[X+0],k=i[X+1],V=i[X+2],q=i[X+3];X=(E*l+A)*4,s[X+0]=L,s[X+1]=k,s[X+2]=V,s[X+3]=q}},ZB=function(n){const t=n.width,e=n.height;let i,s,l,c,f,m,g,A,E,T,x=Math.round(this.kaleidoscopePower());const R=Math.round(this.kaleidoscopeAngle()),O=Math.floor(t*(R%360)/360);if(x<1)return;const M=st.createCanvasElement();M.width=t,M.height=e;const H=M.getContext("2d").getImageData(0,0,t,e);st.releaseCanvas(M),WB(n,H,{polarCenterX:t/2,polarCenterY:e/2});let B=t/Math.pow(2,x);for(;B<=8;)B=B*2,x-=1;B=Math.ceil(B);let Y=B,$=0,nt=Y,X=1;for(O+B>t&&($=Y,nt=0,X=-1),s=0;s<e;s+=1)for(i=$;i!==nt;i+=X)l=Math.round(i+O)%t,E=(t*s+l)*4,f=H.data[E+0],m=H.data[E+1],g=H.data[E+2],A=H.data[E+3],T=(t*s+i)*4,H.data[T+0]=f,H.data[T+1]=m,H.data[T+2]=g,H.data[T+3]=A;for(s=0;s<e;s+=1)for(Y=Math.floor(B),c=0;c<x;c+=1){for(i=0;i<Y+1;i+=1)E=(t*s+i)*4,f=H.data[E+0],m=H.data[E+1],g=H.data[E+2],A=H.data[E+3],T=(t*s+Y*2-i-1)*4,H.data[T+0]=f,H.data[T+1]=m,H.data[T+2]=g,H.data[T+3]=A;Y*=2}JB(H,n,{})};K.addGetterSetter(It,"kaleidoscopePower",2,kt(),K.afterSetFilter);K.addGetterSetter(It,"kaleidoscopeAngle",0,kt(),K.afterSetFilter);function Ry(n,t,e){let i=(e*n.width+t)*4;const s=[];return s.push(n.data[i++],n.data[i++],n.data[i++],n.data[i++]),s}function _g(n,t){return Math.sqrt(Math.pow(n[0]-t[0],2)+Math.pow(n[1]-t[1],2)+Math.pow(n[2]-t[2],2))}function $B(n){const t=[0,0,0];for(let e=0;e<n.length;e++)t[0]+=n[e][0],t[1]+=n[e][1],t[2]+=n[e][2];return t[0]/=n.length,t[1]/=n.length,t[2]/=n.length,t}function tj(n,t){const e=Ry(n,0,0),i=Ry(n,n.width-1,0),s=Ry(n,0,n.height-1),l=Ry(n,n.width-1,n.height-1),c=t||10;if(_g(e,i)<c&&_g(i,l)<c&&_g(l,s)<c&&_g(s,e)<c){const f=$B([i,e,l,s]),m=[];for(let g=0;g<n.width*n.height;g++){const A=_g(f,[n.data[g*4],n.data[g*4+1],n.data[g*4+2]]);m[g]=A<c?0:255}return m}}function ej(n,t){for(let e=0;e<n.width*n.height;e++)n.data[4*e+3]=t[e]}function nj(n,t,e){const i=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(i.length)),l=Math.floor(s/2),c=[];for(let f=0;f<e;f++)for(let m=0;m<t;m++){const g=f*t+m;let A=0;for(let E=0;E<s;E++)for(let T=0;T<s;T++){const x=f+E-l,R=m+T-l;if(x>=0&&x<e&&R>=0&&R<t){const O=x*t+R,M=i[E*s+T];A+=n[O]*M}}c[g]=A===2040?255:0}return c}function ij(n,t,e){const i=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(i.length)),l=Math.floor(s/2),c=[];for(let f=0;f<e;f++)for(let m=0;m<t;m++){const g=f*t+m;let A=0;for(let E=0;E<s;E++)for(let T=0;T<s;T++){const x=f+E-l,R=m+T-l;if(x>=0&&x<e&&R>=0&&R<t){const O=x*t+R,M=i[E*s+T];A+=n[O]*M}}c[g]=A>=1020?255:0}return c}function sj(n,t,e){const i=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(i.length)),l=Math.floor(s/2),c=[];for(let f=0;f<e;f++)for(let m=0;m<t;m++){const g=f*t+m;let A=0;for(let E=0;E<s;E++)for(let T=0;T<s;T++){const x=f+E-l,R=m+T-l;if(x>=0&&x<e&&R>=0&&R<t){const O=x*t+R,M=i[E*s+T];A+=n[O]*M}}c[g]=A}return c}const aj=function(n){const t=this.threshold();let e=tj(n,t);return e&&(e=nj(e,n.width,n.height),e=ij(e,n.width,n.height),e=sj(e,n.width,n.height),ej(n,e)),n};K.addGetterSetter(It,"threshold",0,kt(),K.afterSetFilter);const rj=function(n){const t=this.noise()*255,e=n.data,i=e.length,s=t/2;for(let l=0;l<i;l+=4)e[l+0]+=s-2*s*Math.random(),e[l+1]+=s-2*s*Math.random(),e[l+2]+=s-2*s*Math.random()};K.addGetterSetter(It,"noise",.2,kt(),K.afterSetFilter);const lj=function(n){let t=Math.ceil(this.pixelSize()),e=n.width,i=n.height,s=Math.ceil(e/t),l=Math.ceil(i/t),c=n.data;if(t<=0){st.error("pixelSize value can not be <= 0");return}for(let f=0;f<s;f+=1)for(let m=0;m<l;m+=1){let g=0,A=0,E=0,T=0;const x=f*t,R=x+t,O=m*t,M=O+t;let H=0;for(let B=x;B<R;B+=1)if(!(B>=e))for(let Y=O;Y<M;Y+=1){if(Y>=i)continue;const $=(e*Y+B)*4;g+=c[$+0],A+=c[$+1],E+=c[$+2],T+=c[$+3],H+=1}g=g/H,A=A/H,E=E/H,T=T/H;for(let B=x;B<R;B+=1)if(!(B>=e))for(let Y=O;Y<M;Y+=1){if(Y>=i)continue;const $=(e*Y+B)*4;c[$+0]=g,c[$+1]=A,c[$+2]=E,c[$+3]=T}}};K.addGetterSetter(It,"pixelSize",8,kt(),K.afterSetFilter);const oj=function(n){const t=Math.round(this.levels()*254)+1,e=n.data,i=e.length,s=255/t;for(let l=0;l<i;l+=1)e[l]=Math.floor(e[l]/s)*s};K.addGetterSetter(It,"levels",.5,kt(),K.afterSetFilter);const uj=function(n){const t=n.data,e=t.length,i=this.red(),s=this.green(),l=this.blue();for(let c=0;c<e;c+=4){const f=(.34*t[c]+.5*t[c+1]+.16*t[c+2])/255;t[c]=f*i,t[c+1]=f*s,t[c+2]=f*l,t[c+3]=t[c+3]}};K.addGetterSetter(It,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});K.addGetterSetter(It,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});K.addGetterSetter(It,"blue",0,D8,K.afterSetFilter);const cj=function(n){const t=n.data,e=t.length,i=this.red(),s=this.green(),l=this.blue(),c=this.alpha();for(let f=0;f<e;f+=4){const m=1-c;t[f]=i*c+t[f]*m,t[f+1]=s*c+t[f+1]*m,t[f+2]=l*c+t[f+2]*m}};K.addGetterSetter(It,"red",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});K.addGetterSetter(It,"green",0,function(n){return this._filterUpToDate=!1,n>255?255:n<0?0:Math.round(n)});K.addGetterSetter(It,"blue",0,D8,K.afterSetFilter);K.addGetterSetter(It,"alpha",1,function(n){return this._filterUpToDate=!1,n>1?1:n<0?0:n});const hj=function(n){const t=n.data,e=t.length;for(let i=0;i<e;i+=4){const s=t[i+0],l=t[i+1],c=t[i+2];t[i+0]=Math.min(255,s*.393+l*.769+c*.189),t[i+1]=Math.min(255,s*.349+l*.686+c*.168),t[i+2]=Math.min(255,s*.272+l*.534+c*.131)}},fj=function(n){const e=n.data;for(let i=0;i<e.length;i+=4){const s=e[i],l=e[i+1],c=e[i+2];.2126*s+.7152*l+.0722*c>=128&&(e[i]=255-s,e[i+1]=255-l,e[i+2]=255-c)}return n},dj=function(n){const t=this.threshold()*255,e=n.data,i=e.length;for(let s=0;s<i;s+=1)e[s]=e[s]<t?0:255};K.addGetterSetter(It,"threshold",.5,kt(),K.afterSetFilter);Nm.Util._assign(Nm,{Arc:Fu,Arrow:Xf,Circle:Ym,Ellipse:Sh,Image:Hl,Label:ZS,Tag:Kf,Line:Yu,Path:In,Rect:H0,RegularPolygon:Th,Ring:Wf,Sprite:Po,Star:bh,Text:Mn,TextPath:Ji,Transformer:He,Wedge:Qu,Filters:{Blur:BB,Brightness:HB,Brighten:jB,Contrast:GB,Emboss:qB,Enhance:FB,Grayscale:YB,HSL:QB,HSV:XB,Invert:KB,Kaleidoscope:ZB,Mask:aj,Noise:rj,Pixelate:lj,Posterize:oj,RGB:uj,RGBA:cj,Sepia:hj,Solarize:fj,Threshold:dj}});var B2={exports:{}},j2={exports:{}};var $3;function mj(){return $3||($3=1,(function(n){n.exports=function(t){function e(o,u,p,y){return new ap(o,u,p,y)}function i(){}function s(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(o){var u=o,p=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(p=u.return),o=u.return;while(o)}return u.tag===3?p:null}function c(o){if(l(o)!==o)throw Error(s(188))}function f(o){var u=o.alternate;if(!u){if(u=l(o),u===null)throw Error(s(188));return u!==o?null:o}for(var p=o,y=u;;){var b=p.return;if(b===null)break;var C=b.alternate;if(C===null){if(y=b.return,y!==null){p=y;continue}break}if(b.child===C.child){for(C=b.child;C;){if(C===p)return c(b),o;if(C===y)return c(b),u;C=C.sibling}throw Error(s(188))}if(p.return!==y.return)p=b,y=C;else{for(var P=!1,Z=b.child;Z;){if(Z===p){P=!0,p=b,y=C;break}if(Z===y){P=!0,y=b,p=C;break}Z=Z.sibling}if(!P){for(Z=C.child;Z;){if(Z===p){P=!0,p=C,y=b;break}if(Z===y){P=!0,y=C,p=b;break}Z=Z.sibling}if(!P)throw Error(s(189))}}if(p.alternate!==y)throw Error(s(190))}if(p.tag!==3)throw Error(s(188));return p.stateNode.current===p?o:u}function m(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=m(o),u!==null)return u;o=o.sibling}return null}function g(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(o.tag!==4&&(u=g(o),u!==null))return u;o=o.sibling}return null}function A(o){return o===null||typeof o!="object"?null:(o=El&&o[El]||o["@@iterator"],typeof o=="function"?o:null)}function E(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===uo?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case eu:return"Fragment";case iu:return"Profiler";case nu:return"StrictMode";case pd:return"Suspense";case Al:return"SuspenseList";case ef:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case tu:return"Portal";case Da:return o.displayName||"Context";case tf:return(o._context.displayName||"Context")+".Consumer";case Ac:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case gd:return u=o.displayName||null,u!==null?u:E(o.type)||"Memo";case bs:u=o._payload,o=o._init;try{return E(o(u))}catch{}}return null}function T(o){return{current:o}}function x(o){0>ou||(o.current=Nd[ou],Nd[ou]=null,ou--)}function R(o,u){ou++,Nd[ou]=o.current,o.current=u}function O(o){return o>>>=0,o===0?32:31-(Dd(o)/j_|0)|0}function M(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function H(o,u,p){var y=o.pendingLanes;if(y===0)return 0;var b=0,C=o.suspendedLanes,P=o.pingedLanes;o=o.warmLanes;var Z=y&134217727;return Z!==0?(y=Z&~C,y!==0?b=M(y):(P&=Z,P!==0?b=M(P):p||(p=Z&~o,p!==0&&(b=M(p))))):(Z=y&~C,Z!==0?b=M(Z):P!==0?b=M(P):p||(p=y&~o,p!==0&&(b=M(p)))),b===0?0:u!==0&&u!==b&&(u&C)===0&&(C=b&-b,p=u&-u,C>=p||C===32&&(p&4194048)!==0)?u:b}function B(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function Y(o,u){switch(o){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $(){var o=Rc;return Rc<<=1,(Rc&62914560)===0&&(Rc=4194304),o}function nt(o){for(var u=[],p=0;31>p;p++)u.push(o);return u}function X(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function L(o,u,p,y,b,C){var P=o.pendingLanes;o.pendingLanes=p,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=p,o.entangledLanes&=p,o.errorRecoveryDisabledLanes&=p,o.shellSuspendCounter=0;var Z=o.entanglements,mt=o.expirationTimes,wt=o.hiddenUpdates;for(p=P&~p;0<p;){var Pt=31-qs(p),Rt=1<<Pt;Z[Pt]=0,mt[Pt]=-1;var Ht=wt[Pt];if(Ht!==null)for(wt[Pt]=null,Pt=0;Pt<Ht.length;Pt++){var he=Ht[Pt];he!==null&&(he.lane&=-536870913)}p&=~Rt}y!==0&&k(o,y,0),C!==0&&b===0&&o.tag!==0&&(o.suspendedLanes|=C&~(P&~u))}function k(o,u,p){o.pendingLanes|=u,o.suspendedLanes&=~u;var y=31-qs(u);o.entangledLanes|=u,o.entanglements[y]=o.entanglements[y]|1073741824|p&261930}function V(o,u){var p=o.entangledLanes|=u;for(o=o.entanglements;p;){var y=31-qs(p),b=1<<y;b&u|o[y]&u&&(o[y]|=u),p&=~b}}function q(o,u){var p=u&-u;return p=(p&42)!==0?1:Q(p),(p&(o.suspendedLanes|u))!==0?0:p}function Q(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function F(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function G(o){if(typeof qp=="function"&&q_(o),Fs&&typeof Fs.setStrictMode=="function")try{Fs.setStrictMode(cu,o)}catch{}}function Ot(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}function Vt(o){if(Pd===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);Pd=u&&u[1]||"",Fr=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pd+o+Fr}function tt(o,u){if(!o||hf)return"";hf=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(u){var Rt=function(){throw Error()};if(Object.defineProperty(Rt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Rt,[])}catch(he){var Ht=he}Reflect.construct(o,[],Rt)}else{try{Rt.call()}catch(he){Ht=he}o.call(Rt.prototype)}}else{try{throw Error()}catch(he){Ht=he}(Rt=o())&&typeof Rt.catch=="function"&&Rt.catch(function(){})}}catch(he){if(he&&Ht&&typeof he.stack=="string")return[he.stack,Ht.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var b=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");b&&b.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=y.DetermineComponentFrameRoot(),P=C[0],Z=C[1];if(P&&Z){var mt=P.split(`
`),wt=Z.split(`
`);for(b=y=0;y<mt.length&&!mt[y].includes("DetermineComponentFrameRoot");)y++;for(;b<wt.length&&!wt[b].includes("DetermineComponentFrameRoot");)b++;if(y===mt.length||b===wt.length)for(y=mt.length-1,b=wt.length-1;1<=y&&0<=b&&mt[y]!==wt[b];)b--;for(;1<=y&&0<=b;y--,b--)if(mt[y]!==wt[b]){if(y!==1||b!==1)do if(y--,b--,0>b||mt[y]!==wt[b]){var Pt=`
`+mt[y].replace(" at new "," at ");return o.displayName&&Pt.includes("<anonymous>")&&(Pt=Pt.replace("<anonymous>",o.displayName)),Pt}while(1<=y&&0<=b);break}}}finally{hf=!1,Error.prepareStackTrace=p}return(p=o?o.displayName||o.name:"")?Vt(p):""}function At(o,u){switch(o.tag){case 26:case 27:case 5:return Vt(o.type);case 16:return Vt("Lazy");case 13:return o.child!==u&&u!==null?Vt("Suspense Fallback"):Vt("Suspense");case 19:return Vt("SuspenseList");case 0:case 15:return tt(o.type,!1);case 11:return tt(o.type.render,!1);case 1:return tt(o.type,!0);case 31:return Vt("Activity");default:return""}}function yt(o){try{var u="",p=null;do u+=At(o,p),p=o,o=o.return;while(o);return u}catch(y){return`
Error generating stack: `+y.message+`
`+y.stack}}function Mt(o,u){if(typeof o=="object"&&o!==null){var p=Fp.get(o);return p!==void 0?p:(u={value:o,source:u,stack:yt(u)},Fp.set(o,u),u)}return{value:o,source:u,stack:yt(u)}}function Qt(o,u){bl[Yr++]=ff,bl[Yr++]=ln,ln=o,ff=u}function W(o,u,p){Ma[fa++]=Fi,Ma[fa++]=ur,Ma[fa++]=La,La=o;var y=Fi;o=ur;var b=32-qs(y)-1;y&=~(1<<b),p+=1;var C=32-qs(u)+b;if(30<C){var P=b-b%5;C=(y&(1<<P)-1).toString(32),y>>=P,b-=P,Fi=1<<32-qs(u)+b|p<<b|y,ur=C+o}else Fi=1<<C|p<<b|y,ur=o}function ft(o){o.return!==null&&(Qt(o,1),W(o,1,0))}function bt(o){for(;o===ln;)ln=bl[--Yr],bl[Yr]=null,ff=bl[--Yr],bl[Yr]=null;for(;o===La;)La=Ma[--fa],Ma[fa]=null,ur=Ma[--fa],Ma[fa]=null,Fi=Ma[--fa],Ma[fa]=null}function Ft(o,u){Ma[fa++]=Fi,Ma[fa++]=ur,Ma[fa++]=La,Fi=u.id,ur=u.overflow,La=o}function qt(o,u){R(Yi,u),R(Cl,o),R(Di,null),o=i_(u),x(Di),R(Di,o)}function re(){x(Di),x(Cl),x(Yi)}function ne(o){o.memoizedState!==null&&R(df,o);var u=Di.current,p=Tc(u,o.type);u!==p&&(R(Cl,o),R(Di,p))}function qe(o){Cl.current===o&&(x(Di),x(Cl)),df.current===o&&(x(df),ti?ru._currentValue=au:ru._currentValue2=au)}function De(o){var u=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Ze(Mt(u,o)),Vd}function bi(o,u){if(!Rn)throw Error(s(175));N_(o.stateNode,o.type,o.memoizedProps,u,o)||De(o,!0)}function ea(o){for(vi=o.return;vi;)switch(vi.tag){case 5:case 31:case 13:ws=!1;return;case 27:case 3:ws=!0;return;default:vi=vi.return}}function Nt(o){if(!Rn||o!==vi)return!1;if(!we)return ea(o),we=!0,!1;var u=o.tag;if(yi?u!==3&&u!==27&&(u!==5||wc(o.type)&&!Cs(o.type,o.memoizedProps))&&xn&&De(o):u!==3&&(u!==5||wc(o.type)&&!Cs(o.type,o.memoizedProps))&&xn&&De(o),ea(o),u===13){if(!Rn)throw Error(s(316));if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(s(317));xn=Mp(o)}else if(u===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(s(317));xn=I_(o)}else xn=yi&&u===27?E_(o.type,xn):vi?A_(o.stateNode):null;return!0}function Zi(){Rn&&(xn=vi=null,we=!1)}function $i(){var o=Qr;return o!==null&&(Qs===null?Qs=o:Qs.push.apply(Qs,o),Qr=null),o}function Ze(o){Qr===null?Qr=[o]:Qr.push(o)}function Bi(o,u,p){ti?(R(ka,u._currentValue),u._currentValue=p):(R(ka,u._currentValue2),u._currentValue2=p)}function ds(o){var u=ka.current;ti?o._currentValue=u:o._currentValue2=u,x(ka)}function ql(o,u,p){for(;o!==null;){var y=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,y!==null&&(y.childLanes|=u)):y!==null&&(y.childLanes&u)!==u&&(y.childLanes|=u),o===p)break;o=o.return}}function Ka(o,u,p,y){var b=o.child;for(b!==null&&(b.return=o);b!==null;){var C=b.dependencies;if(C!==null){var P=b.child;C=C.firstContext;t:for(;C!==null;){var Z=C;C=b;for(var mt=0;mt<u.length;mt++)if(Z.context===u[mt]){C.lanes|=p,Z=C.alternate,Z!==null&&(Z.lanes|=p),ql(C.return,p,o),y||(P=null);break t}C=Z.next}}else if(b.tag===18){if(P=b.return,P===null)throw Error(s(341));P.lanes|=p,C=P.alternate,C!==null&&(C.lanes|=p),ql(P,p,o),P=null}else P=b.child;if(P!==null)P.return=b;else for(P=b;P!==null;){if(P===o){P=null;break}if(b=P.sibling,b!==null){b.return=P.return,P=b;break}P=P.return}b=P}}function Ls(o,u,p,y){o=null;for(var b=u,C=!1;b!==null;){if(!C){if((b.flags&524288)!==0)C=!0;else if((b.flags&262144)!==0)break}if(b.tag===10){var P=b.alternate;if(P===null)throw Error(s(387));if(P=P.memoizedProps,P!==null){var Z=b.type;ni(b.pendingProps.value,P.value)||(o!==null?o.push(Z):o=[Z])}}else if(b===df.current){if(P=b.alternate,P===null)throw Error(s(387));P.memoizedState.memoizedState!==b.memoizedState.memoizedState&&(o!==null?o.push(ru):o=[ru])}b=b.return}o!==null&&Ka(u,o,p,y),u.flags|=262144}function Wa(o){for(o=o.firstContext;o!==null;){var u=o.context;if(!ni(ti?u._currentValue:u._currentValue2,o.memoizedValue))return!0;o=o.next}return!1}function ks(o){gn=o,cr=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Ln(o){return Vo(gn,o)}function Qn(o,u){return gn===null&&ks(o),Vo(o,u)}function Vo(o,u){var p=ti?u._currentValue:u._currentValue2;if(u={context:u,memoizedValue:p,next:null},cr===null){if(o===null)throw Error(s(308));cr=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else cr=cr.next=u;return p}function kn(){return{controller:new F_,data:new Map,refCount:0}}function Cn(o){o.refCount--,o.refCount===0&&Ii(Nv,function(){o.controller.abort()})}function Ps(){}function ms(o){o!==$e&&o.next===null&&($e===null?mf=$e=o:$e=$e.next=o),Pa=!0,as||(as=!0,ji())}function _a(o,u){if(!Ud&&Pa){Ud=!0;do for(var p=!1,y=mf;y!==null;){if(o!==0){var b=y.pendingLanes;if(b===0)var C=0;else{var P=y.suspendedLanes,Z=y.pingedLanes;C=(1<<31-qs(42|o)+1)-1,C&=b&~(P&~Z),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(p=!0,ps(y,C))}else C=Re,C=H(y,y===Ee?C:0,y.cancelPendingCommit!==null||y.timeoutHandle!==Gs),(C&3)===0||B(y,C)||(p=!0,ps(y,C));y=y.next}while(p);Ud=!1}}function Xu(){vr()}function vr(){Pa=as=!1;var o=0;po!==0&&su()&&(o=po);for(var u=ss(),p=null,y=mf;y!==null;){var b=y.next,C=Ja(y,u);C===0?(y.next=null,p===null?mf=b:p.next=b,b===null&&($e=p)):(p=y,(o!==0||(C&3)!==0)&&(Pa=!0)),y=b}fi!==0&&fi!==5||_a(o),po!==0&&(po=0)}function Ja(o,u){for(var p=o.suspendedLanes,y=o.pingedLanes,b=o.expirationTimes,C=o.pendingLanes&-62914561;0<C;){var P=31-qs(C),Z=1<<P,mt=b[P];mt===-1?((Z&p)===0||(Z&y)!==0)&&(b[P]=Y(Z,u)):mt<=u&&(o.expiredLanes|=Z),C&=~Z}if(u=Ee,p=Re,p=H(o,o===u?p:0,o.cancelPendingCommit!==null||o.timeoutHandle!==Gs),y=o.callbackNode,p===0||o===u&&(en===2||en===9)||o.cancelPendingCommit!==null)return y!==null&&y!==null&&Od(y),o.callbackNode=null,o.callbackPriority=0;if((p&3)===0||B(o,p)){if(u=p&-p,u===o.callbackPriority)return u;switch(y!==null&&Od(y),F(p)){case 2:case 8:p=G_;break;case 32:p=cf;break;case 268435456:p=Ld;break;default:p=cf}return y=di.bind(null,o),p=uf(p,y),o.callbackPriority=u,o.callbackNode=p,u}return y!==null&&y!==null&&Od(y),o.callbackPriority=2,o.callbackNode=null,2}function di(o,u){if(fi!==0&&fi!==5)return o.callbackNode=null,o.callbackPriority=0,null;var p=o.callbackNode;if(Hr()&&o.callbackNode!==p)return null;var y=Re;return y=H(o,o===Ee?y:0,o.cancelPendingCommit!==null||o.timeoutHandle!==Gs),y===0?null:(or(o,y,u),Ja(o,ss()),o.callbackNode!=null&&o.callbackNode===p?di.bind(null,o):null)}function ps(o,u){if(Hr())return null;or(o,u,!0)}function ji(){_p?yp(function(){(Te&6)!==0?uf(Md,Xu):vr()}):uf(Md,Xu)}function Uo(){if(po===0){var o=wl;o===0&&(o=Id,Id<<=1,(Id&261888)===0&&(Id=256)),po=o}return po}function zo(o,u){if(xc===null){var p=xc=[];Yp=0,wl=Uo(),Ai={status:"pending",value:void 0,then:function(y){p.push(y)}}}return Yp++,u.then(Bo,Bo),u}function Bo(){if(--Yp===0&&xc!==null){Ai!==null&&(Ai.status="fulfilled");var o=xc;xc=null,wl=0,Ai=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function Za(o,u){var p=[],y={status:"pending",value:null,reason:null,then:function(b){p.push(b)}};return o.then(function(){y.status="fulfilled",y.value=u;for(var b=0;b<p.length;b++)(0,p[b])(u)},function(b){for(y.status="rejected",y.reason=b,b=0;b<p.length;b++)(0,p[b])(void 0)}),y}function Vs(){var o=go.current;return o!==null?o:Ee.pooledCache}function ht(o,u){u===null?R(go,go.current):R(go,u.pool)}function St(){var o=Vs();return o===null?null:{parent:ti?Nn._currentValue:Nn._currentValue2,pool:o}}function jt(o,u){if(ni(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var p=Object.keys(o),y=Object.keys(u);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var b=p[y];if(!xv.call(u,b)||!ni(o[b],u[b]))return!1}return!0}function Bt(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Jt(o,u,p){switch(p=o[p],p===void 0?o.push(u):p!==u&&(u.then(Ps,Ps),u=p),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,ts(o),o;default:if(typeof u.status=="string")u.then(Ps,Ps);else{if(o=Ee,o!==null&&100<o.shellSuspendCounter)throw Error(s(482));o=u,o.status="pending",o.then(function(y){if(u.status==="pending"){var b=u;b.status="fulfilled",b.value=y}},function(y){if(u.status==="pending"){var b=u;b.status="rejected",b.reason=y}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,ts(o),o}throw Rs=u,Ei}}function Xe(o){try{var u=o._init;return u(o._payload)}catch(p){throw p!==null&&typeof p=="object"&&typeof p.then=="function"?(Rs=p,Ei):p}}function Pn(){if(Rs===null)throw Error(s(459));var o=Rs;return Rs=null,o}function ts(o){if(o===Ei||o===Ua)throw Error(s(483))}function Vn(o){var u=hu;return hu+=1,_o===null&&(_o=[]),Jt(_o,o,u)}function ya(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function $a(o,u){throw u.$$typeof===$o?Error(s(525)):(o=Object.prototype.toString.call(u),Error(s(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function sl(o){function u(ut,at){if(o){var dt=ut.deletions;dt===null?(ut.deletions=[at],ut.flags|=16):dt.push(at)}}function p(ut,at){if(!o)return null;for(;at!==null;)u(ut,at),at=at.sibling;return null}function y(ut){for(var at=new Map;ut!==null;)ut.key!==null?at.set(ut.key,ut):at.set(ut.index,ut),ut=ut.sibling;return at}function b(ut,at){return ut=ca(ut,at),ut.index=0,ut.sibling=null,ut}function C(ut,at,dt){return ut.index=dt,o?(dt=ut.alternate,dt!==null?(dt=dt.index,dt<at?(ut.flags|=67108866,at):dt):(ut.flags|=67108866,at)):(ut.flags|=1048576,at)}function P(ut){return o&&ut.alternate===null&&(ut.flags|=67108866),ut}function Z(ut,at,dt,Dt){return at===null||at.tag!==6?(at=rp(dt,ut.mode,Dt),at.return=ut,at):(at=b(at,dt),at.return=ut,at)}function mt(ut,at,dt,Dt){var ee=dt.type;return ee===eu?Pt(ut,at,dt.props.children,Dt,dt.key):at!==null&&(at.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===bs&&Xe(ee)===at.type)?(at=b(at,dt.props),ya(at,dt),at.return=ut,at):(at=vl(dt.type,dt.key,dt.props,null,ut.mode,Dt),ya(at,dt),at.return=ut,at)}function wt(ut,at,dt,Dt){return at===null||at.tag!==4||at.stateNode.containerInfo!==dt.containerInfo||at.stateNode.implementation!==dt.implementation?(at=op(dt,ut.mode,Dt),at.return=ut,at):(at=b(at,dt.children||[]),at.return=ut,at)}function Pt(ut,at,dt,Dt,ee){return at===null||at.tag!==7?(at=Na(dt,ut.mode,Dt,ee),at.return=ut,at):(at=b(at,dt),at.return=ut,at)}function Rt(ut,at,dt){if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return at=rp(""+at,ut.mode,dt),at.return=ut,at;if(typeof at=="object"&&at!==null){switch(at.$$typeof){case Gr:return dt=vl(at.type,at.key,at.props,null,ut.mode,dt),ya(dt,at),dt.return=ut,dt;case tu:return at=op(at,ut.mode,dt),at.return=ut,at;case bs:return at=Xe(at),Rt(ut,at,dt)}if(co(at)||A(at))return at=Na(at,ut.mode,dt,null),at.return=ut,at;if(typeof at.then=="function")return Rt(ut,Vn(at),dt);if(at.$$typeof===Da)return Rt(ut,Qn(ut,at),dt);$a(ut,at)}return null}function Ht(ut,at,dt,Dt){var ee=at!==null?at.key:null;if(typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint")return ee!==null?null:Z(ut,at,""+dt,Dt);if(typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case Gr:return dt.key===ee?mt(ut,at,dt,Dt):null;case tu:return dt.key===ee?wt(ut,at,dt,Dt):null;case bs:return dt=Xe(dt),Ht(ut,at,dt,Dt)}if(co(dt)||A(dt))return ee!==null?null:Pt(ut,at,dt,Dt,null);if(typeof dt.then=="function")return Ht(ut,at,Vn(dt),Dt);if(dt.$$typeof===Da)return Ht(ut,at,Qn(ut,dt),Dt);$a(ut,dt)}return null}function he(ut,at,dt,Dt,ee){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number"||typeof Dt=="bigint")return ut=ut.get(dt)||null,Z(at,ut,""+Dt,ee);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case Gr:return ut=ut.get(Dt.key===null?dt:Dt.key)||null,mt(at,ut,Dt,ee);case tu:return ut=ut.get(Dt.key===null?dt:Dt.key)||null,wt(at,ut,Dt,ee);case bs:return Dt=Xe(Dt),he(ut,at,dt,Dt,ee)}if(co(Dt)||A(Dt))return ut=ut.get(dt)||null,Pt(at,ut,Dt,ee,null);if(typeof Dt.then=="function")return he(ut,at,dt,Vn(Dt),ee);if(Dt.$$typeof===Da)return he(ut,at,dt,Qn(at,Dt),ee);$a(at,Dt)}return null}function Oi(ut,at,dt,Dt){for(var ee=null,Fn=null,ie=at,ze=at=0,Mi=null;ie!==null&&ze<dt.length;ze++){ie.index>ze?(Mi=ie,ie=null):Mi=ie.sibling;var Ye=Ht(ut,ie,dt[ze],Dt);if(Ye===null){ie===null&&(ie=Mi);break}o&&ie&&Ye.alternate===null&&u(ut,ie),at=C(Ye,at,ze),Fn===null?ee=Ye:Fn.sibling=Ye,Fn=Ye,ie=Mi}if(ze===dt.length)return p(ut,ie),we&&Qt(ut,ze),ee;if(ie===null){for(;ze<dt.length;ze++)ie=Rt(ut,dt[ze],Dt),ie!==null&&(at=C(ie,at,ze),Fn===null?ee=ie:Fn.sibling=ie,Fn=ie);return we&&Qt(ut,ze),ee}for(ie=y(ie);ze<dt.length;ze++)Mi=he(ie,ut,ze,dt[ze],Dt),Mi!==null&&(o&&Mi.alternate!==null&&ie.delete(Mi.key===null?ze:Mi.key),at=C(Mi,at,ze),Fn===null?ee=Mi:Fn.sibling=Mi,Fn=Mi);return o&&ie.forEach(function(ja){return u(ut,ja)}),we&&Qt(ut,ze),ee}function Pc(ut,at,dt,Dt){if(dt==null)throw Error(s(151));for(var ee=null,Fn=null,ie=at,ze=at=0,Mi=null,Ye=dt.next();ie!==null&&!Ye.done;ze++,Ye=dt.next()){ie.index>ze?(Mi=ie,ie=null):Mi=ie.sibling;var ja=Ht(ut,ie,Ye.value,Dt);if(ja===null){ie===null&&(ie=Mi);break}o&&ie&&ja.alternate===null&&u(ut,ie),at=C(ja,at,ze),Fn===null?ee=ja:Fn.sibling=ja,Fn=ja,ie=Mi}if(Ye.done)return p(ut,ie),we&&Qt(ut,ze),ee;if(ie===null){for(;!Ye.done;ze++,Ye=dt.next())Ye=Rt(ut,Ye.value,Dt),Ye!==null&&(at=C(Ye,at,ze),Fn===null?ee=Ye:Fn.sibling=Ye,Fn=Ye);return we&&Qt(ut,ze),ee}for(ie=y(ie);!Ye.done;ze++,Ye=dt.next())Ye=he(ie,ut,ze,Ye.value,Dt),Ye!==null&&(o&&Ye.alternate!==null&&ie.delete(Ye.key===null?ze:Ye.key),at=C(Ye,at,ze),Fn===null?ee=Ye:Fn.sibling=Ye,Fn=Ye);return o&&ie.forEach(function(Dv){return u(ut,Dv)}),we&&Qt(ut,ze),ee}function Co(ut,at,dt,Dt){if(typeof dt=="object"&&dt!==null&&dt.type===eu&&dt.key===null&&(dt=dt.props.children),typeof dt=="object"&&dt!==null){switch(dt.$$typeof){case Gr:t:{for(var ee=dt.key;at!==null;){if(at.key===ee){if(ee=dt.type,ee===eu){if(at.tag===7){p(ut,at.sibling),Dt=b(at,dt.props.children),Dt.return=ut,ut=Dt;break t}}else if(at.elementType===ee||typeof ee=="object"&&ee!==null&&ee.$$typeof===bs&&Xe(ee)===at.type){p(ut,at.sibling),Dt=b(at,dt.props),ya(Dt,dt),Dt.return=ut,ut=Dt;break t}p(ut,at);break}else u(ut,at);at=at.sibling}dt.type===eu?(Dt=Na(dt.props.children,ut.mode,Dt,dt.key),Dt.return=ut,ut=Dt):(Dt=vl(dt.type,dt.key,dt.props,null,ut.mode,Dt),ya(Dt,dt),Dt.return=ut,ut=Dt)}return P(ut);case tu:t:{for(ee=dt.key;at!==null;){if(at.key===ee)if(at.tag===4&&at.stateNode.containerInfo===dt.containerInfo&&at.stateNode.implementation===dt.implementation){p(ut,at.sibling),Dt=b(at,dt.children||[]),Dt.return=ut,ut=Dt;break t}else{p(ut,at);break}else u(ut,at);at=at.sibling}Dt=op(dt,ut.mode,Dt),Dt.return=ut,ut=Dt}return P(ut);case bs:return dt=Xe(dt),Co(ut,at,dt,Dt)}if(co(dt))return Oi(ut,at,dt,Dt);if(A(dt)){if(ee=A(dt),typeof ee!="function")throw Error(s(150));return dt=ee.call(dt),Pc(ut,at,dt,Dt)}if(typeof dt.then=="function")return Co(ut,at,Vn(dt),Dt);if(dt.$$typeof===Da)return Co(ut,at,Qn(ut,dt),Dt);$a(ut,dt)}return typeof dt=="string"&&dt!==""||typeof dt=="number"||typeof dt=="bigint"?(dt=""+dt,at!==null&&at.tag===6?(p(ut,at.sibling),Dt=b(at,dt),Dt.return=ut,ut=Dt):(p(ut,at),Dt=rp(dt,ut.mode,Dt),Dt.return=ut,ut=Dt),P(ut)):p(ut,at)}return function(ut,at,dt,Dt){try{hu=0;var ee=Co(ut,at,dt,Dt);return _o=null,ee}catch(ie){if(ie===Ei||ie===Ua)throw ie;var Fn=e(29,ie,null,ut.mode);return Fn.lanes=Dt,Fn.return=ut,Fn}}}function Fl(){for(var o=Kr,u=fu=Kr=0;u<o;){var p=Xi[u];Xi[u++]=null;var y=Xi[u];Xi[u++]=null;var b=Xi[u];Xi[u++]=null;var C=Xi[u];if(Xi[u++]=null,y!==null&&b!==null){var P=y.pending;P===null?b.next=b:(b.next=P.next,P.next=b),y.pending=b}C!==0&&er(p,b,C)}}function Yl(o,u,p,y){Xi[Kr++]=o,Xi[Kr++]=u,Xi[Kr++]=p,Xi[Kr++]=y,fu|=y,o.lanes|=y,o=o.alternate,o!==null&&(o.lanes|=y)}function tr(o,u,p,y){return Yl(o,u,p,y),vn(o)}function Ar(o,u){return Yl(o,null,null,u),vn(o)}function er(o,u,p){o.lanes|=p;var y=o.alternate;y!==null&&(y.lanes|=p);for(var b=!1,C=o.return;C!==null;)C.childLanes|=p,y=C.alternate,y!==null&&(y.childLanes|=p),C.tag===22&&(o=C.stateNode,o===null||o._visibility&1||(b=!0)),o=C,C=C.return;return o.tag===3?(C=o.stateNode,b&&u!==null&&(b=31-qs(p),o=C.hiddenUpdates,y=o[b],y===null?o[b]=[u]:y.push(u),u.lane=p|536870912),C):null}function vn(o){if(50<Ge)throw Ge=0,Af=null,Error(s(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}function mi(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function va(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function gs(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Hi(o,u,p){var y=o.updateQueue;if(y===null)return null;if(y=y.shared,(Te&2)!==0){var b=y.pending;return b===null?u.next=u:(u.next=b.next,b.next=u),y.pending=u,u=vn(o),er(o,null,p),u}return Yl(o,y,u,p),vn(o)}function Ql(o,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194048)!==0)){var y=u.lanes;y&=o.pendingLanes,p|=y,u.lanes=p,V(o,p)}}function jo(o,u){var p=o.updateQueue,y=o.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var b=null,C=null;if(p=p.firstBaseUpdate,p!==null){do{var P={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};C===null?b=C=P:C=C.next=P,p=p.next}while(p!==null);C===null?b=C=u:C=C.next=u}else b=C=u;p={baseState:y.baseState,firstBaseUpdate:b,lastBaseUpdate:C,shared:y.shared,callbacks:y.callbacks},o.updateQueue=p;return}o=p.lastBaseUpdate,o===null?p.firstBaseUpdate=u:o.next=u,p.lastBaseUpdate=u}function na(){if(Bd){var o=Ai;if(o!==null)throw o}}function nr(o,u,p,y){Bd=!1;var b=o.updateQueue;da=!1;var C=b.firstBaseUpdate,P=b.lastBaseUpdate,Z=b.shared.pending;if(Z!==null){b.shared.pending=null;var mt=Z,wt=mt.next;mt.next=null,P===null?C=wt:P.next=wt,P=mt;var Pt=o.alternate;Pt!==null&&(Pt=Pt.updateQueue,Z=Pt.lastBaseUpdate,Z!==P&&(Z===null?Pt.firstBaseUpdate=wt:Z.next=wt,Pt.lastBaseUpdate=mt))}if(C!==null){var Rt=b.baseState;P=0,Pt=wt=mt=null,Z=C;do{var Ht=Z.lane&-536870913,he=Ht!==Z.lane;if(he?(Re&Ht)===Ht:(y&Ht)===Ht){Ht!==0&&Ht===wl&&(Bd=!0),Pt!==null&&(Pt=Pt.next={lane:0,tag:Z.tag,payload:Z.payload,callback:null,next:null});t:{var Oi=o,Pc=Z;Ht=u;var Co=p;switch(Pc.tag){case 1:if(Oi=Pc.payload,typeof Oi=="function"){Rt=Oi.call(Co,Rt,Ht);break t}Rt=Oi;break t;case 3:Oi.flags=Oi.flags&-65537|128;case 0:if(Oi=Pc.payload,Ht=typeof Oi=="function"?Oi.call(Co,Rt,Ht):Oi,Ht==null)break t;Rt=md({},Rt,Ht);break t;case 2:da=!0}}Ht=Z.callback,Ht!==null&&(o.flags|=64,he&&(o.flags|=8192),he=b.callbacks,he===null?b.callbacks=[Ht]:he.push(Ht))}else he={lane:Ht,tag:Z.tag,payload:Z.payload,callback:Z.callback,next:null},Pt===null?(wt=Pt=he,mt=Rt):Pt=Pt.next=he,P|=Ht;if(Z=Z.next,Z===null){if(Z=b.shared.pending,Z===null)break;he=Z,Z=he.next,he.next=null,b.lastBaseUpdate=he,b.shared.pending=null}}while(!0);Pt===null&&(mt=Rt),b.baseState=mt,b.firstBaseUpdate=wt,b.lastBaseUpdate=Pt,C===null&&(b.shared.lanes=0),xl|=P,o.lanes=P,o.memoizedState=Rt}}function Er(o,u){if(typeof o!="function")throw Error(s(191,o));o.call(u)}function Sr(o,u){var p=o.callbacks;if(p!==null)for(o.callbacks=null,o=0;o<p.length;o++)Er(p[o],u)}function Xl(o,u){o=Jr,R(yo,o),R(du,u),Jr=o|u.baseLanes}function ia(){R(yo,Jr),R(du,du.current)}function Un(){Jr=yo.current,x(du),x(yo)}function sa(o){var u=o.alternate;R(Kn,Kn.current&1),R(Ys,o),xs===null&&(u===null||du.current!==null||u.memoizedState!==null)&&(xs=o)}function Tr(o){R(Kn,Kn.current),R(Ys,o),xs===null&&(xs=o)}function es(o){o.tag===22?(R(Kn,Kn.current),R(Ys,o),xs===null&&(xs=o)):Gi()}function Gi(){R(Kn,Kn.current),R(Ys,Ys.current)}function _s(o){x(Ys),xs===o&&(xs=null),x(Kn)}function Kl(o){for(var u=o;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||fo(p)||Sd(p)))return u}else if(u.tag===19&&(u.memoizedProps.revealOrder==="forwards"||u.memoizedProps.revealOrder==="backwards"||u.memoizedProps.revealOrder==="unstable_legacy-backwards"||u.memoizedProps.revealOrder==="together")){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function hn(){throw Error(s(321))}function Ku(o,u){if(u===null)return!1;for(var p=0;p<u.length&&p<o.length;p++)if(!ni(o[p],u[p]))return!1;return!0}function br(o,u,p,y,b,C){return Rl=C,me=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,$t.H=o===null||o.memoizedState===null?Hn:Wr,Pe=!1,C=p(y,b),Pe=!1,_e&&(C=aa(u,p,y,b)),al(o),C}function al(o){$t.H=ma;var u=Wt!==null&&Wt.next!==null;if(Rl=0,ue=Wt=me=null,Ae=!1,za=0,hr=null,u)throw Error(s(300));o===null||En||(o=o.dependencies,o!==null&&Wa(o)&&(En=!0))}function aa(o,u,p,y){me=o;var b=0;do{if(_e&&(hr=null),za=0,_e=!1,25<=b)throw Error(s(301));if(b+=1,ue=Wt=null,o.updateQueue!=null){var C=o.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}$t.H=vo,C=u(p,y)}while(_e);return C}function ys(){var o=$t.H,u=o.useState()[0];return u=typeof u.then=="function"?dn(u):u,o=o.useState()[0],(Wt!==null?Wt.memoizedState:null)!==o&&(me.flags|=1024),u}function Wu(){var o=rs!==0;return rs=0,o}function wh(o,u,p){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~p}function Wl(o){if(Ae){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}Ae=!1}Rl=0,ue=Wt=me=null,_e=!1,za=rs=0,hr=null}function pi(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ue===null?me.memoizedState=ue=o:ue=ue.next=o,ue}function fn(){if(Wt===null){var o=me.alternate;o=o!==null?o.memoizedState:null}else o=Wt.next;var u=ue===null?me.memoizedState:ue.next;if(u!==null)ue=u,Wt=o;else{if(o===null)throw me.alternate===null?Error(s(467)):Error(s(310));Wt=o,o={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},ue===null?me.memoizedState=ue=o:ue=ue.next=o}return ue}function Aa(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dn(o){var u=za;return za+=1,hr===null&&(hr=[]),o=Jt(hr,o,u),u=me,(ue===null?u.memoizedState:ue.next)===null&&(u=u.alternate,$t.H=u===null||u.memoizedState===null?Hn:Wr),o}function ir(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return dn(o);if(o.$$typeof===Da)return Ln(o)}throw Error(s(438,String(o)))}function rl(o){var u=null,p=me.updateQueue;if(p!==null&&(u=p.memoCache),u==null){var y=me.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(u={data:y.data.map(function(b){return b.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),p===null&&(p=Aa(),me.updateQueue=p),p.memoCache=u,p=u.data[u.index],p===void 0)for(p=u.data[u.index]=Array(o),y=0;y<o;y++)p[y]=cp;return u.index++,p}function Us(o,u){return typeof u=="function"?u(o):u}function ke(o){var u=fn();return ll(u,Wt,o)}function ll(o,u,p){var y=o.queue;if(y===null)throw Error(s(311));y.lastRenderedReducer=p;var b=o.baseQueue,C=y.pending;if(C!==null){if(b!==null){var P=b.next;b.next=C.next,C.next=P}u.baseQueue=b=C,y.pending=null}if(C=o.baseState,b===null)o.memoizedState=C;else{u=b.next;var Z=P=null,mt=null,wt=u,Pt=!1;do{var Rt=wt.lane&-536870913;if(Rt!==wt.lane?(Re&Rt)===Rt:(Rl&Rt)===Rt){var Ht=wt.revertLane;if(Ht===0)mt!==null&&(mt=mt.next={lane:0,revertLane:0,gesture:null,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null}),Rt===wl&&(Pt=!0);else if((Rl&Ht)===Ht){wt=wt.next,Ht===wl&&(Pt=!0);continue}else Rt={lane:0,revertLane:wt.revertLane,gesture:null,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},mt===null?(Z=mt=Rt,P=C):mt=mt.next=Rt,me.lanes|=Ht,xl|=Ht;Rt=wt.action,Pe&&p(C,Rt),C=wt.hasEagerState?wt.eagerState:p(C,Rt)}else Ht={lane:Rt,revertLane:wt.revertLane,gesture:wt.gesture,action:wt.action,hasEagerState:wt.hasEagerState,eagerState:wt.eagerState,next:null},mt===null?(Z=mt=Ht,P=C):mt=mt.next=Ht,me.lanes|=Rt,xl|=Rt;wt=wt.next}while(wt!==null&&wt!==u);if(mt===null?P=C:mt.next=Z,!ni(C,o.memoizedState)&&(En=!0,Pt&&(p=Ai,p!==null)))throw p;o.memoizedState=C,o.baseState=P,o.baseQueue=mt,y.lastRenderedState=C}return b===null&&(y.lanes=0),[o.memoizedState,y.dispatch]}function Cr(o){var u=fn(),p=u.queue;if(p===null)throw Error(s(311));p.lastRenderedReducer=o;var y=p.dispatch,b=p.pending,C=u.memoizedState;if(b!==null){p.pending=null;var P=b=b.next;do C=o(C,P.action),P=P.next;while(P!==b);ni(C,u.memoizedState)||(En=!0),u.memoizedState=C,u.baseQueue===null&&(u.baseState=C),p.lastRenderedState=C}return[C,y]}function ra(o,u,p){var y=me,b=fn(),C=we;if(C){if(p===void 0)throw Error(s(407));p=p()}else p=u();var P=!ni((Wt||b).memoizedState,p);if(P&&(b.memoizedState=p,En=!0),b=b.queue,Rr(Rh.bind(null,y,b,o),[o]),b.getSnapshot!==u||P||ue!==null&&ue.memoizedState.tag&1){if(y.flags|=2048,wi(9,{destroy:void 0},Ju.bind(null,y,b,p,u),null),Ee===null)throw Error(s(349));C||(Rl&127)!==0||Zf(y,u,p)}return p}function Zf(o,u,p){o.flags|=16384,o={getSnapshot:u,value:p},u=me.updateQueue,u===null?(u=Aa(),me.updateQueue=u,u.stores=[o]):(p=u.stores,p===null?u.stores=[o]:p.push(o))}function Ju(o,u,p,y){u.value=p,u.getSnapshot=y,Zu(u)&&$f(o)}function Rh(o,u,p){return p(function(){Zu(u)&&$f(o)})}function Zu(o){var u=o.getSnapshot;o=o.value;try{var p=u();return!ni(o,p)}catch{return!0}}function $f(o){var u=Ar(o,2);u!==null&&Bn(u,o,2)}function xh(o){var u=pi();if(typeof o=="function"){var p=o;if(o=p(),Pe){G(!0);try{p()}finally{G(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:o},u}function sr(o,u,p,y){return o.baseState=p,ll(o,Wt,typeof y=="function"?y:Us)}function Ci(o,u,p,y,b){if(Xo(o))throw Error(s(485));if(o=u.action,o!==null){var C={payload:b,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(P){C.listeners.push(P)}};$t.T!==null?p(!0):C.isTransition=!1,y(C),p=u.pending,p===null?(C.next=u.pending=C,Ho(u,C)):(C.next=p.next,u.pending=p.next=C)}}function Ho(o,u){var p=u.action,y=u.payload,b=o.state;if(u.isTransition){var C=$t.T,P={};$t.T=P;try{var Z=p(b,y),mt=$t.S;mt!==null&&mt(P,Z),Go(o,u,Z)}catch(wt){vs(o,u,wt)}finally{C!==null&&P.types!==null&&(C.types=P.types),$t.T=C}}else try{C=p(b,y),Go(o,u,C)}catch(wt){vs(o,u,wt)}}function Go(o,u,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(y){wr(o,u,y)},function(y){return vs(o,u,y)}):wr(o,u,p)}function wr(o,u,p){u.status="fulfilled",u.value=p,Nh(u),o.state=p,u=o.pending,u!==null&&(p=u.next,p===u?o.pending=null:(p=p.next,u.next=p,Ho(o,p)))}function vs(o,u,p){var y=o.pending;if(o.pending=null,y!==null){y=y.next;do u.status="rejected",u.reason=p,Nh(u),u=u.next;while(u!==y)}o.action=null}function Nh(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function $u(o,u){return u}function Dh(o,u){if(we){var p=Ee.formState;if(p!==null){t:{var y=me;if(we){if(xn){var b=v_(xn,ws);if(b){xn=A_(b),y=Np(b);break t}}De(y)}y=!1}y&&(u=p[0])}}p=pi(),p.memoizedState=p.baseState=u,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$u,lastRenderedState:u},p.queue=y,p=Ph.bind(null,me,y),y.dispatch=p,y=xh(!1);var C=Qo.bind(null,me,!1,y.queue);return y=pi(),b={state:u,dispatch:null,action:o,pending:null},y.queue=b,p=Ci.bind(null,me,b,C,p),b.dispatch=p,y.memoizedState=o,[u,p,!1]}function As(o){var u=fn();return Ea(u,Wt,o)}function Ea(o,u,p){if(u=ll(o,u,$u)[0],o=ke(Us)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var y=dn(u)}catch(P){throw P===Ei?Ua:P}else y=u;u=fn();var b=u.queue,C=b.dispatch;return p!==u.memoizedState&&(me.flags|=2048,wi(9,{destroy:void 0},Ih.bind(null,b,p),null)),[y,C,o]}function Ih(o,u){o.action=u}function ar(o){var u=fn(),p=Wt;if(p!==null)return Ea(u,p,o);fn(),u=u.memoizedState,p=fn();var y=p.queue.dispatch;return p.memoizedState=o,[u,y,!1]}function wi(o,u,p,y){return o={tag:o,create:p,deps:y,inst:u,next:null},u=me.updateQueue,u===null&&(u=Aa(),me.updateQueue=u),p=u.lastEffect,p===null?u.lastEffect=o.next=o:(y=p.next,p.next=o,o.next=y,u.lastEffect=o),o}function qo(){return fn().memoizedState}function la(o,u,p,y){var b=pi();me.flags|=o,b.memoizedState=wi(1|u,{destroy:void 0},p,y===void 0?null:y)}function rr(o,u,p,y){var b=fn();y=y===void 0?null:y;var C=b.memoizedState.inst;Wt!==null&&y!==null&&Ku(y,Wt.memoizedState.deps)?b.memoizedState=wi(u,C,p,y):(me.flags|=o,b.memoizedState=wi(1|u,C,p,y))}function Jl(o,u){la(8390656,8,o,u)}function Rr(o,u){rr(2048,8,o,u)}function An(o){me.flags|=4;var u=me.updateQueue;if(u===null)u=Aa(),me.updateQueue=u,u.events=[o];else{var p=u.events;p===null?u.events=[o]:p.push(o)}}function qi(o){var u=fn().memoizedState;return An({ref:u,nextImpl:o}),function(){if((Te&2)!==0)throw Error(s(440));return u.impl.apply(void 0,arguments)}}function xr(o,u){return rr(4,2,o,u)}function Zl(o,u){return rr(4,4,o,u)}function ol(o,u){if(typeof u=="function"){o=o();var p=u(o);return function(){typeof p=="function"?p():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function Oh(o,u,p){p=p!=null?p.concat([o]):null,rr(4,4,ol.bind(null,u,o),p)}function Nr(){}function Fo(o,u){var p=fn();u=u===void 0?null:u;var y=p.memoizedState;return u!==null&&Ku(u,y[1])?y[0]:(p.memoizedState=[o,u],o)}function ns(o,u){var p=fn();u=u===void 0?null:u;var y=p.memoizedState;if(u!==null&&Ku(u,y[1]))return y[0];if(y=o(),Pe){G(!0);try{o()}finally{G(!1)}}return p.memoizedState=[y,u],y}function ul(o,u,p){return p===void 0||(Rl&1073741824)!==0&&(Re&261930)===0?o.memoizedState=u:(o.memoizedState=p,o=gl(),me.lanes|=o,xl|=o,p)}function Mh(o,u,p,y){return ni(p,u)?p:du.current!==null?(o=ul(o,p,y),ni(o,u)||(En=!0),o):(Rl&42)===0||(Rl&1073741824)!==0&&(Re&261930)===0?(En=!0,o.memoizedState=p):(o=gl(),me.lanes|=o,xl|=o,u)}function $l(o,u,p,y,b){var C=Ia();Ce(C!==0&&8>C?C:8);var P=$t.T,Z={};$t.T=Z,Qo(o,!1,u,p);try{var mt=b(),wt=$t.S;if(wt!==null&&wt(Z,mt),mt!==null&&typeof mt=="object"&&typeof mt.then=="function"){var Pt=Za(mt,y);lr(o,u,Pt,wn(o))}else lr(o,u,y,wn(o))}catch(Rt){lr(o,u,{then:function(){},status:"rejected",reason:Rt},wn())}finally{Ce(C),P!==null&&Z.types!==null&&(P.types=Z.types),$t.T=P}}function Lh(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:au,baseState:au,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:au},next:null};var p={};return u.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Us,lastRenderedState:p},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function Yo(){return Ln(ru)}function cl(){return fn().memoizedState}function kh(){return fn().memoizedState}function tc(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var p=wn();o=gs(p);var y=Hi(u,o,p);y!==null&&(Bn(y,u,p),Ql(y,u,p)),u={cache:kn()},o.payload=u;return}u=u.return}}function Xm(o,u,p){var y=wn();p={lane:y,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null},Xo(o)?ec(u,p):(p=tr(o,u,p,y),p!==null&&(Bn(p,o,y),nc(p,u,y)))}function Ph(o,u,p){var y=wn();lr(o,u,p,y)}function lr(o,u,p,y){var b={lane:y,revertLane:0,gesture:null,action:p,hasEagerState:!1,eagerState:null,next:null};if(Xo(o))ec(u,b);else{var C=o.alternate;if(o.lanes===0&&(C===null||C.lanes===0)&&(C=u.lastRenderedReducer,C!==null))try{var P=u.lastRenderedState,Z=C(P,p);if(b.hasEagerState=!0,b.eagerState=Z,ni(Z,P))return Yl(o,u,b,0),Ee===null&&Fl(),!1}catch{}if(p=tr(o,u,b,y),p!==null)return Bn(p,o,y),nc(p,u,y),!0}return!1}function Qo(o,u,p,y){if(y={lane:2,revertLane:Uo(),gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},Xo(o)){if(u)throw Error(s(479))}else u=tr(o,p,y,2),u!==null&&Bn(u,o,2)}function Xo(o){var u=o.alternate;return o===me||u!==null&&u===me}function ec(o,u){_e=Ae=!0;var p=o.pending;p===null?u.next=u:(u.next=p.next,p.next=u),o.pending=u}function nc(o,u,p){if((p&4194048)!==0){var y=u.lanes;y&=o.pendingLanes,p|=y,u.lanes=p,V(o,p)}}function ic(o,u,p,y){u=o.memoizedState,p=p(y,u),p=p==null?u:md({},u,p),o.memoizedState=p,o.lanes===0&&(o.updateQueue.baseState=p)}function hl(o,u,p,y,b,C,P){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(y,C,P):u.prototype&&u.prototype.isPureReactComponent?!jt(p,y)||!jt(b,C):!0}function Vh(o,u,p,y){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,y),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,y),u.state!==o&&pf.enqueueReplaceState(u,u.state,null)}function Dr(o,u){var p=u;if("ref"in u){p={};for(var y in u)y!=="ref"&&(p[y]=u[y])}if(o=o.defaultProps){p===u&&(p=md({},p));for(var b in o)p[b]===void 0&&(p[b]=o[b])}return p}function Sa(o,u){try{var p=o.onUncaughtError;p(u.value,{componentStack:u.stack})}catch(y){setTimeout(function(){throw y})}}function sc(o,u,p){try{var y=o.onCaughtError;y(p.value,{componentStack:p.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(b){setTimeout(function(){throw b})}}function ac(o,u,p){return p=gs(p),p.tag=3,p.payload={element:null},p.callback=function(){Sa(o,u)},p}function Uh(o){return o=gs(o),o.tag=3,o}function zh(o,u,p,y){var b=p.type.getDerivedStateFromError;if(typeof b=="function"){var C=y.value;o.payload=function(){return b(C)},o.callback=function(){sc(u,p,y)}}var P=p.stateNode;P!==null&&typeof P.componentDidCatch=="function"&&(o.callback=function(){sc(u,p,y),typeof b!="function"&&(Nl===null?Nl=new Set([this]):Nl.add(this));var Z=y.stack;this.componentDidCatch(y.value,{componentStack:Z!==null?Z:""})})}function rc(o,u,p,y,b){if(p.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(u=p.alternate,u!==null&&Ls(u,p,b,!0),p=Ys.current,p!==null){switch(p.tag){case 31:case 13:return xs===null?gc():p.alternate===null&&qn===0&&(qn=3),p.flags&=-257,p.flags|=65536,p.lanes=b,y===Xr?p.flags|=16384:(u=p.updateQueue,u===null?p.updateQueue=new Set([y]):u.add(y),vc(o,y,b)),!1;case 22:return p.flags|=65536,y===Xr?p.flags|=16384:(u=p.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([y])},p.updateQueue=u):(p=u.retryQueue,p===null?u.retryQueue=new Set([y]):p.add(y)),vc(o,y,b)),!1}throw Error(s(435,p.tag))}return vc(o,y,b),gc(),!1}if(we)return u=Ys.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=b,y!==Vd&&(o=Error(s(422),{cause:y}),Ze(Mt(o,p)))):(y!==Vd&&(u=Error(s(423),{cause:y}),Ze(Mt(u,p))),o=o.current.alternate,o.flags|=65536,b&=-b,o.lanes|=b,y=Mt(y,p),b=ac(o.stateNode,y,b),jo(o,b),qn!==4&&(qn=2)),!1;var C=Error(s(520),{cause:y});if(C=Mt(C,p),_f===null?_f=[C]:_f.push(C),qn!==4&&(qn=2),u===null)return!0;y=Mt(y,p),p=u;do{switch(p.tag){case 3:return p.flags|=65536,o=b&-b,p.lanes|=o,o=ac(p.stateNode,y,o),jo(p,o),!1;case 1:if(u=p.type,C=p.stateNode,(p.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Nl===null||!Nl.has(C))))return p.flags|=65536,b&=-b,p.lanes|=b,b=Uh(b),zh(b,o,p,y),jo(p,b),!1}p=p.return}while(p!==null);return!1}function Ke(o,u,p,y){u.child=o===null?Qp(u,null,p,y):Qi(u,o.child,p,y)}function Bh(o,u,p,y,b){p=p.render;var C=u.ref;if("ref"in y){var P={};for(var Z in y)Z!=="ref"&&(P[Z]=y[Z])}else P=y;return ks(u),y=br(o,u,p,P,C,b),Z=Wu(),o!==null&&!En?(wh(o,u,b),Or(o,u,b)):(we&&Z&&ft(u),u.flags|=1,Ke(o,u,y,b),u.child)}function jh(o,u,p,y,b){if(o===null){var C=p.type;return typeof C=="function"&&!Jo(C)&&C.defaultProps===void 0&&p.compare===null?(u.tag=15,u.type=C,fl(o,u,C,y,b)):(o=vl(p.type,null,y,u,u.mode,b),o.ref=u.ref,o.return=u,u.child=o)}if(C=o.child,!Hh(o,b)){var P=C.memoizedProps;if(p=p.compare,p=p!==null?p:jt,p(P,y)&&o.ref===u.ref)return Or(o,u,b)}return u.flags|=1,o=ca(C,y),o.ref=u.ref,o.return=u,u.child=o}function fl(o,u,p,y,b){if(o!==null){var C=o.memoizedProps;if(jt(C,y)&&o.ref===u.ref)if(En=!1,u.pendingProps=y=C,Hh(o,b))(o.flags&131072)!==0&&(En=!0);else return u.lanes=o.lanes,Or(o,u,b)}return Fe(o,u,p,y,b)}function _(o,u,p,y){var b=y.children,C=o!==null?o.memoizedState:null;if(o===null&&u.stateNode===null&&(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),y.mode==="hidden"){if((u.flags&128)!==0){if(C=C!==null?C.baseLanes|p:p,o!==null){for(y=u.child=o.child,b=0;y!==null;)b=b|y.lanes|y.childLanes,y=y.sibling;y=b&~C}else y=0,u.child=null;return D(o,u,C,p,y)}if((p&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&ht(u,C!==null?C.cachePool:null),C!==null?Xl(u,C):ia(),es(u);else return y=u.lanes=536870912,D(o,u,C!==null?C.baseLanes|p:p,p,y)}else C!==null?(ht(u,C.cachePool),Xl(u,C),Gi(),u.memoizedState=null):(o!==null&&ht(u,null),ia(),Gi());return Ke(o,u,b,p),u.child}function w(o,u){return o!==null&&o.tag===22||u.stateNode!==null||(u.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.sibling}function D(o,u,p,y,b){var C=Vs();return C=C===null?null:{parent:ti?Nn._currentValue:Nn._currentValue2,pool:C},u.memoizedState={baseLanes:p,cachePool:C},o!==null&&ht(u,null),ia(),es(u),o!==null&&Ls(o,u,y,!0),u.childLanes=b,null}function z(o,u){return u=Ta({mode:u.mode,children:u.children},o.mode),u.ref=o.ref,o.child=u,u.return=o,u}function rt(o,u,p){return Qi(u,o.child,null,p),o=z(u,u.pendingProps),o.flags|=2,_s(u),u.memoizedState=null,o}function pt(o,u,p){var y=u.pendingProps,b=(u.flags&128)!==0;if(u.flags&=-129,o===null){if(we){if(y.mode==="hidden")return o=z(u,y),u.lanes=536870912,w(null,o);if(Tr(u),(o=xn)?(o=Ip(o,ws),o!==null&&(u.memoizedState={dehydrated:o,treeContext:La!==null?{id:Fi,overflow:ur}:null,retryLane:536870912,hydrationErrors:null},p=lp(o),p.return=u,u.child=p,vi=u,xn=null)):o=null,o===null)throw De(u);return u.lanes=536870912,null}return z(u,y)}var C=o.memoizedState;if(C!==null){var P=C.dehydrated;if(Tr(u),b)if(u.flags&256)u.flags&=-257,u=rt(o,u,p);else if(u.memoizedState!==null)u.child=o.child,u.flags|=128,u=null;else throw Error(s(558));else if(En||Ls(o,u,p,!1),b=(p&o.childLanes)!==0,En||b){if(y=Ee,y!==null&&(P=q(y,p),P!==0&&P!==C.retryLane))throw C.retryLane=P,Ar(o,P),Bn(y,o,P),Ns;gc(),u=rt(o,u,p)}else o=C.treeContext,Rn&&(xn=b_(P),vi=u,we=!0,Qr=null,ws=!1,o!==null&&Ft(u,o)),u=z(u,y),u.flags|=4096;return u}return o=ca(o.child,{mode:y.mode,children:y.children}),o.ref=u.ref,u.child=o,o.return=u,o}function Lt(o,u){var p=u.ref;if(p===null)o!==null&&o.ref!==null&&(u.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(s(284));(o===null||o.ref!==p)&&(u.flags|=4194816)}}function Fe(o,u,p,y,b){return ks(u),p=br(o,u,p,y,void 0,b),y=Wu(),o!==null&&!En?(wh(o,u,b),Or(o,u,b)):(we&&y&&ft(u),u.flags|=1,Ke(o,u,p,b),u.child)}function $n(o,u,p,y,b,C){return ks(u),u.updateQueue=null,p=aa(u,y,p,b),al(o),y=Wu(),o!==null&&!En?(wh(o,u,C),Or(o,u,C)):(we&&y&&ft(u),u.flags|=1,Ke(o,u,p,C),u.child)}function ye(o,u,p,y,b){if(ks(u),u.stateNode===null){var C=qr,P=p.contextType;typeof P=="object"&&P!==null&&(C=Ln(P)),C=new p(y,C),u.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=pf,u.stateNode=C,C._reactInternals=u,C=u.stateNode,C.props=y,C.state=u.memoizedState,C.refs={},mi(u),P=p.contextType,C.context=typeof P=="object"&&P!==null?Ln(P):qr,C.state=u.memoizedState,P=p.getDerivedStateFromProps,typeof P=="function"&&(ic(u,p,P,y),C.state=u.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(P=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),P!==C.state&&pf.enqueueReplaceState(C,C.state,null),nr(u,y,C,b),na(),C.state=u.memoizedState),typeof C.componentDidMount=="function"&&(u.flags|=4194308),y=!0}else if(o===null){C=u.stateNode;var Z=u.memoizedProps,mt=Dr(p,Z);C.props=mt;var wt=C.context,Pt=p.contextType;P=qr,typeof Pt=="object"&&Pt!==null&&(P=Ln(Pt));var Rt=p.getDerivedStateFromProps;Pt=typeof Rt=="function"||typeof C.getSnapshotBeforeUpdate=="function",Z=u.pendingProps!==Z,Pt||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(Z||wt!==P)&&Vh(u,C,y,P),da=!1;var Ht=u.memoizedState;C.state=Ht,nr(u,y,C,b),na(),wt=u.memoizedState,Z||Ht!==wt||da?(typeof Rt=="function"&&(ic(u,p,Rt,y),wt=u.memoizedState),(mt=da||hl(u,p,mt,y,Ht,wt,P))?(Pt||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(u.flags|=4194308)):(typeof C.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=y,u.memoizedState=wt),C.props=y,C.state=wt,C.context=P,y=mt):(typeof C.componentDidMount=="function"&&(u.flags|=4194308),y=!1)}else{C=u.stateNode,va(o,u),P=u.memoizedProps,Pt=Dr(p,P),C.props=Pt,Rt=u.pendingProps,Ht=C.context,wt=p.contextType,mt=qr,typeof wt=="object"&&wt!==null&&(mt=Ln(wt)),Z=p.getDerivedStateFromProps,(wt=typeof Z=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(P!==Rt||Ht!==mt)&&Vh(u,C,y,mt),da=!1,Ht=u.memoizedState,C.state=Ht,nr(u,y,C,b),na();var he=u.memoizedState;P!==Rt||Ht!==he||da||o!==null&&o.dependencies!==null&&Wa(o.dependencies)?(typeof Z=="function"&&(ic(u,p,Z,y),he=u.memoizedState),(Pt=da||hl(u,p,Pt,y,Ht,he,mt)||o!==null&&o.dependencies!==null&&Wa(o.dependencies))?(wt||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(y,he,mt),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(y,he,mt)),typeof C.componentDidUpdate=="function"&&(u.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof C.componentDidUpdate!="function"||P===o.memoizedProps&&Ht===o.memoizedState||(u.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||P===o.memoizedProps&&Ht===o.memoizedState||(u.flags|=1024),u.memoizedProps=y,u.memoizedState=he),C.props=y,C.state=he,C.context=mt,y=Pt):(typeof C.componentDidUpdate!="function"||P===o.memoizedProps&&Ht===o.memoizedState||(u.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||P===o.memoizedProps&&Ht===o.memoizedState||(u.flags|=1024),y=!1)}return C=y,Lt(o,u),y=(u.flags&128)!==0,C||y?(C=u.stateNode,p=y&&typeof p.getDerivedStateFromError!="function"?null:C.render(),u.flags|=1,o!==null&&y?(u.child=Qi(u,o.child,null,b),u.child=Qi(u,null,p,b)):Ke(o,u,p,b),u.memoizedState=C.state,o=u.child):o=Or(o,u,b),o}function gi(o,u,p,y){return Zi(),u.flags|=256,Ke(o,u,p,y),u.child}function oi(o){return{baseLanes:o,cachePool:St()}}function Ir(o,u,p){return o=o!==null?o.childLanes&~p:0,u&&(o|=Ds),o}function Es(o,u,p){var y=u.pendingProps,b=!1,C=(u.flags&128)!==0,P;if((P=C)||(P=o!==null&&o.memoizedState===null?!1:(Kn.current&2)!==0),P&&(b=!0,u.flags&=-129),P=(u.flags&32)!==0,u.flags&=-33,o===null){if(we){if(b?sa(u):Gi(),(o=xn)?(o=x_(o,ws),o!==null&&(u.memoizedState={dehydrated:o,treeContext:La!==null?{id:Fi,overflow:ur}:null,retryLane:536870912,hydrationErrors:null},p=lp(o),p.return=u,u.child=p,vi=u,xn=null)):o=null,o===null)throw De(u);return Sd(o)?u.lanes=32:u.lanes=536870912,null}var Z=y.children;return y=y.fallback,b?(Gi(),b=u.mode,Z=Ta({mode:"hidden",children:Z},b),y=Na(y,b,p,null),Z.return=u,y.return=u,Z.sibling=y,u.child=Z,y=u.child,y.memoizedState=oi(p),y.childLanes=Ir(o,P,p),u.memoizedState=mu,w(null,y)):(sa(u),dl(u,Z))}var mt=o.memoizedState;if(mt!==null&&(Z=mt.dehydrated,Z!==null)){if(C)u.flags&256?(sa(u),u.flags&=-257,u=Ko(o,u,p)):u.memoizedState!==null?(Gi(),u.child=o.child,u.flags|=128,u=null):(Gi(),Z=y.fallback,b=u.mode,y=Ta({mode:"visible",children:y.children},b),Z=Na(Z,b,p,null),Z.flags|=2,y.return=u,Z.return=u,y.sibling=Z,u.child=y,Qi(u,o.child,null,p),y=u.child,y.memoizedState=oi(p),y.childLanes=Ir(o,P,p),u.memoizedState=mu,u=w(null,y));else if(sa(u),Sd(Z))P=Td(Z).digest,y=Error(s(419)),y.stack="",y.digest=P,Ze({value:y,source:null,stack:null}),u=Ko(o,u,p);else if(En||Ls(o,u,p,!1),P=(p&o.childLanes)!==0,En||P){if(P=Ee,P!==null&&(y=q(P,p),y!==0&&y!==mt.retryLane))throw mt.retryLane=y,Ar(o,y),Bn(P,o,y),Ns;fo(Z)||gc(),u=Ko(o,u,p)}else fo(Z)?(u.flags|=192,u.child=o.child,u=null):(o=mt.treeContext,Rn&&(xn=C_(Z),vi=u,we=!0,Qr=null,ws=!1,o!==null&&Ft(u,o)),u=dl(u,y.children),u.flags|=4096);return u}return b?(Gi(),Z=y.fallback,b=u.mode,mt=o.child,C=mt.sibling,y=ca(mt,{mode:"hidden",children:y.children}),y.subtreeFlags=mt.subtreeFlags&65011712,C!==null?Z=ca(C,Z):(Z=Na(Z,b,p,null),Z.flags|=2),Z.return=u,y.return=u,y.sibling=Z,u.child=y,w(null,y),y=u.child,Z=o.child.memoizedState,Z===null?Z=oi(p):(b=Z.cachePool,b!==null?(mt=ti?Nn._currentValue:Nn._currentValue2,b=b.parent!==mt?{parent:mt,pool:mt}:b):b=St(),Z={baseLanes:Z.baseLanes|p,cachePool:b}),y.memoizedState=Z,y.childLanes=Ir(o,P,p),u.memoizedState=mu,w(o.child,y)):(sa(u),p=o.child,o=p.sibling,p=ca(p,{mode:"visible",children:y.children}),p.return=u,p.sibling=null,o!==null&&(P=u.deletions,P===null?(u.deletions=[o],u.flags|=16):P.push(o)),u.child=p,u.memoizedState=null,p)}function dl(o,u){return u=Ta({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function Ta(o,u){return o=e(22,o,null,u),o.lanes=0,o}function Ko(o,u,p){return Qi(u,o.child,null,p),o=dl(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function G0(o,u,p){o.lanes|=u;var y=o.alternate;y!==null&&(y.lanes|=u),ql(o.return,u,p)}function lc(o,u,p,y,b,C){var P=o.memoizedState;P===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:b,treeForkCount:C}:(P.isBackwards=u,P.rendering=null,P.renderingStartTime=0,P.last=y,P.tail=p,P.tailMode=b,P.treeForkCount=C)}function Km(o,u,p){var y=u.pendingProps,b=y.revealOrder,C=y.tail;y=y.children;var P=Kn.current,Z=(P&2)!==0;if(Z?(P=P&1|2,u.flags|=128):P&=1,R(Kn,P),Ke(o,u,y,p),y=we?ff:0,!Z&&o!==null&&(o.flags&128)!==0)t:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&G0(o,p,u);else if(o.tag===19)G0(o,p,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break t;for(;o.sibling===null;){if(o.return===null||o.return===u)break t;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(b){case"forwards":for(p=u.child,b=null;p!==null;)o=p.alternate,o!==null&&Kl(o)===null&&(b=p),p=p.sibling;p=b,p===null?(b=u.child,u.child=null):(b=p.sibling,p.sibling=null),lc(u,!1,b,p,C,y);break;case"backwards":case"unstable_legacy-backwards":for(p=null,b=u.child,u.child=null;b!==null;){if(o=b.alternate,o!==null&&Kl(o)===null){u.child=b;break}o=b.sibling,b.sibling=p,p=b,b=o}lc(u,!0,p,null,C,y);break;case"together":lc(u,!1,null,null,void 0,y);break;default:u.memoizedState=null}return u.child}function Or(o,u,p){if(o!==null&&(u.dependencies=o.dependencies),xl|=u.lanes,(p&u.childLanes)===0)if(o!==null){if(Ls(o,u,p,!1),(p&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(s(153));if(u.child!==null){for(o=u.child,p=ca(o,o.pendingProps),u.child=p,p.return=u;o.sibling!==null;)o=o.sibling,p=p.sibling=ca(o,o.pendingProps),p.return=u;p.sibling=null}return u.child}function Hh(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&Wa(o)))}function Wm(o,u,p){switch(u.tag){case 3:qt(u,u.stateNode.containerInfo),Bi(u,Nn,o.memoizedState.cache),Zi();break;case 27:case 5:ne(u);break;case 4:qt(u,u.stateNode.containerInfo);break;case 10:Bi(u,u.type,u.memoizedProps.value);break;case 31:if(u.memoizedState!==null)return u.flags|=128,Tr(u),null;break;case 13:var y=u.memoizedState;if(y!==null)return y.dehydrated!==null?(sa(u),u.flags|=128,null):(p&u.child.childLanes)!==0?Es(o,u,p):(sa(u),o=Or(o,u,p),o!==null?o.sibling:null);sa(u);break;case 19:var b=(o.flags&128)!==0;if(y=(p&u.childLanes)!==0,y||(Ls(o,u,p,!1),y=(p&u.childLanes)!==0),b){if(y)return Km(o,u,p);u.flags|=128}if(b=u.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),R(Kn,Kn.current),y)break;return null;case 22:return u.lanes=0,_(o,u,p,u.pendingProps);case 24:Bi(u,Nn,o.memoizedState.cache)}return Or(o,u,p)}function Jm(o,u,p){if(o!==null)if(o.memoizedProps!==u.pendingProps)En=!0;else{if(!Hh(o,p)&&(u.flags&128)===0)return En=!1,Wm(o,u,p);En=(o.flags&131072)!==0}else En=!1,we&&(u.flags&1048576)!==0&&W(u,ff,u.index);switch(u.lanes=0,u.tag){case 16:t:{var y=u.pendingProps;if(o=Xe(u.elementType),u.type=o,typeof o=="function")Jo(o)?(y=Dr(o,y),u.tag=1,u=ye(null,u,o,y,p)):(u.tag=0,u=Fe(null,u,o,y,p));else{if(o!=null){var b=o.$$typeof;if(b===Ac){u.tag=11,u=Bh(null,u,o,y,p);break t}else if(b===gd){u.tag=14,u=jh(null,u,o,y,p);break t}}throw u=E(o)||o,Error(s(306,u,""))}}return u;case 0:return Fe(o,u,u.type,u.pendingProps,p);case 1:return y=u.type,b=Dr(y,u.pendingProps),ye(o,u,y,b,p);case 3:t:{if(qt(u,u.stateNode.containerInfo),o===null)throw Error(s(387));var C=u.pendingProps;b=u.memoizedState,y=b.element,va(o,u),nr(u,C,null,p);var P=u.memoizedState;if(C=P.cache,Bi(u,Nn,C),C!==b.cache&&Ka(u,[Nn],p,!0),na(),C=P.element,Rn&&b.isDehydrated)if(b={element:C,isDehydrated:!1,cache:P.cache},u.updateQueue.baseState=b,u.memoizedState=b,u.flags&256){u=gi(o,u,C,p);break t}else if(C!==y){y=Mt(Error(s(424)),u),Ze(y),u=gi(o,u,C,p);break t}else for(Rn&&(xn=T_(u.stateNode.containerInfo),vi=u,we=!0,Qr=null,ws=!0),p=Qp(u,null,C,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Zi(),C===y){u=Or(o,u,p);break t}Ke(o,u,C,p)}u=u.child}return u;case 26:if(Oa)return Lt(o,u),o===null?(p=Pp(u.type,null,u.pendingProps,null))?u.memoizedState=p:we||(u.stateNode=Rd(u.type,u.pendingProps,Yi.current,u)):u.memoizedState=Pp(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:if(yi)return ne(u),o===null&&yi&&we&&(y=u.stateNode=xd(u.type,u.pendingProps,Yi.current,Di.current,!1),vi=u,ws=!0,xn=Dp(u.type,y,xn)),Ke(o,u,u.pendingProps.children,p),Lt(o,u),o===null&&(u.flags|=4194304),u.child;case 5:return o===null&&we&&(V_(u.type,u.pendingProps,Di.current),(b=y=xn)&&(y=w_(y,u.type,u.pendingProps,ws),y!==null?(u.stateNode=y,vi=u,xn=S_(y),ws=!1,b=!0):b=!1),b||De(u)),ne(u),b=u.type,C=u.pendingProps,P=o!==null?o.memoizedProps:null,y=C.children,Cs(b,C)?y=null:P!==null&&Cs(b,P)&&(u.flags|=32),u.memoizedState!==null&&(b=br(o,u,ys,null,null,p),ti?ru._currentValue=b:ru._currentValue2=b),Lt(o,u),Ke(o,u,y,p),u.child;case 6:return o===null&&we&&(kp(u.pendingProps,Di.current),(o=p=xn)&&(p=R_(p,u.pendingProps,ws),p!==null?(u.stateNode=p,vi=u,xn=null,o=!0):o=!1),o||De(u)),null;case 13:return Es(o,u,p);case 4:return qt(u,u.stateNode.containerInfo),y=u.pendingProps,o===null?u.child=Qi(u,null,y,p):Ke(o,u,y,p),u.child;case 11:return Bh(o,u,u.type,u.pendingProps,p);case 7:return Ke(o,u,u.pendingProps,p),u.child;case 8:return Ke(o,u,u.pendingProps.children,p),u.child;case 12:return Ke(o,u,u.pendingProps.children,p),u.child;case 10:return y=u.pendingProps,Bi(u,u.type,y.value),Ke(o,u,y.children,p),u.child;case 9:return b=u.type._context,y=u.pendingProps.children,ks(u),b=Ln(b),y=y(b),u.flags|=1,Ke(o,u,y,p),u.child;case 14:return jh(o,u,u.type,u.pendingProps,p);case 15:return fl(o,u,u.type,u.pendingProps,p);case 19:return Km(o,u,p);case 31:return pt(o,u,p);case 22:return _(o,u,p,u.pendingProps);case 24:return ks(u),y=Ln(Nn),o===null?(b=Vs(),b===null&&(b=Ee,C=kn(),b.pooledCache=C,C.refCount++,C!==null&&(b.pooledCacheLanes|=p),b=C),u.memoizedState={parent:y,cache:b},mi(u),Bi(u,Nn,b)):((o.lanes&p)!==0&&(va(o,u),nr(u,null,null,p),na()),b=o.memoizedState,C=u.memoizedState,b.parent!==y?(b={parent:y,cache:y},u.memoizedState=b,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=b),Bi(u,Nn,y)):(y=C.cache,Bi(u,Nn,y),y!==b.cache&&Ka(u,[Nn],p,!0))),Ke(o,u,u.pendingProps.children,p),u.child;case 29:throw u.pendingProps}throw Error(s(156,u.tag))}function ba(o){o.flags|=4}function Gh(o){ha&&(o.flags|=8)}function q0(o,u){if(o!==null&&o.child===u.child)return!1;if((u.flags&16)!==0)return!0;for(o=u.child;o!==null;){if((o.flags&8218)!==0||(o.subtreeFlags&8218)!==0)return!0;o=o.sibling}return!1}function Zm(o,u,p,y){if(Oe)for(p=u.child;p!==null;){if(p.tag===5||p.tag===6)sf(o,p.stateNode);else if(!(p.tag===4||yi&&p.tag===27)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}else if(ha)for(var b=u.child;b!==null;){if(b.tag===5){var C=b.stateNode;p&&y&&(C=y_(C,b.type,b.memoizedProps)),sf(o,C)}else if(b.tag===6)C=b.stateNode,p&&y&&(C=xp(C,b.memoizedProps)),sf(o,C);else if(b.tag!==4){if(b.tag===22&&b.memoizedState!==null)C=b.child,C!==null&&(C.return=b),Zm(o,b,!0,!0);else if(b.child!==null){b.child.return=b,b=b.child;continue}}if(b===u)break;for(;b.sibling===null;){if(b.return===null||b.return===u)return;b=b.return}b.sibling.return=b.return,b=b.sibling}}function F0(o,u,p,y){var b=!1;if(ha)for(var C=u.child;C!==null;){if(C.tag===5){var P=C.stateNode;p&&y&&(P=y_(P,C.type,C.memoizedProps)),wp(o,P)}else if(C.tag===6)P=C.stateNode,p&&y&&(P=xp(P,C.memoizedProps)),wp(o,P);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)b=C.child,b!==null&&(b.return=C),F0(o,C,!0,!0),b=!0;else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===u)break;for(;C.sibling===null;){if(C.return===null||C.return===u)return b;C=C.return}C.sibling.return=C.return,C=C.sibling}return b}function Y0(o,u){if(ha&&q0(o,u)){o=u.stateNode;var p=o.containerInfo,y=Cp();F0(y,u,!1,!1),o.pendingChildren=y,ba(u),__(p,y)}}function $m(o,u,p,y){if(Oe)o.memoizedProps!==y&&ba(u);else if(ha){var b=o.stateNode,C=o.memoizedProps;if((o=q0(o,u))||C!==y){var P=Di.current;C=g_(b,p,C,y,!o,null),C===b?u.stateNode=b:(Gh(u),Hs(C,p,y,P)&&ba(u),u.stateNode=C,o&&Zm(C,u,!1,!1))}else u.stateNode=b}}function Ss(o,u,p,y,b){if((o.mode&32)!==0&&(p===null?af(u,y):Cc(u,p,y))){if(o.flags|=16777216,(b&335544128)===b||mp(u,y))if(jn(o.stateNode,u,y))o.flags|=8192;else if(Ie())o.flags|=8192;else throw Rs=Xr,zd}else o.flags&=-16777217}function oc(o,u){if(Bp(u)){if(o.flags|=16777216,!jp(u))if(Ie())o.flags|=8192;else throw Rs=Xr,zd}else o.flags&=-16777217}function qh(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?$():536870912,o.lanes|=u,Lc|=u)}function uc(o,u){if(!we)switch(o.tailMode){case"hidden":u=o.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?o.tail=null:p.sibling=null;break;case"collapsed":p=o.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:y.sibling=null}}function mn(o){var u=o.alternate!==null&&o.alternate.child===o.child,p=0,y=0;if(u)for(var b=o.child;b!==null;)p|=b.lanes|b.childLanes,y|=b.subtreeFlags&65011712,y|=b.flags&65011712,b.return=o,b=b.sibling;else for(b=o.child;b!==null;)p|=b.lanes|b.childLanes,y|=b.subtreeFlags,y|=b.flags,b.return=o,b=b.sibling;return o.subtreeFlags|=y,o.childLanes=p,u}function Q0(o,u,p){var y=u.pendingProps;switch(bt(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mn(u),null;case 1:return mn(u),null;case 3:return p=u.stateNode,y=null,o!==null&&(y=o.memoizedState.cache),u.memoizedState.cache!==y&&(u.flags|=2048),ds(Nn),re(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(o===null||o.child===null)&&(Nt(u)?ba(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,$i())),Y0(o,u),mn(u),null;case 26:if(Oa){var b=u.type,C=u.memoizedState;return o===null?(ba(u),C!==null?(mn(u),oc(u,C)):(mn(u),Ss(u,b,null,y,p))):C?C!==o.memoizedState?(ba(u),mn(u),oc(u,C)):(mn(u),u.flags&=-16777217):(C=o.memoizedProps,Oe?C!==y&&ba(u):$m(o,u,b,y),mn(u),Ss(u,b,C,y,p)),null}case 27:if(yi){if(qe(u),p=Yi.current,b=u.type,o!==null&&u.stateNode!=null)Oe?o.memoizedProps!==y&&ba(u):$m(o,u,b,y);else{if(!y){if(u.stateNode===null)throw Error(s(166));return mn(u),null}o=Di.current,Nt(u)?bi(u,o):(o=xd(b,y,p,o,!0),u.stateNode=o,ba(u))}return mn(u),null}case 5:if(qe(u),b=u.type,o!==null&&u.stateNode!=null)$m(o,u,b,y);else{if(!y){if(u.stateNode===null)throw Error(s(166));return mn(u),null}if(C=Di.current,Nt(u))bi(u,C),L_(u.stateNode,b,y,C)&&(u.flags|=64);else{var P=fp(b,y,Yi.current,C,u);Gh(u),Zm(P,u,!1,!1),u.stateNode=P,Hs(P,b,y,C)&&ba(u)}}return mn(u),Ss(u,u.type,o===null?null:o.memoizedProps,u.pendingProps,p),null;case 6:if(o&&u.stateNode!=null)p=o.memoizedProps,Oe?p!==y&&ba(u):ha&&(p!==y?(o=Yi.current,p=Di.current,Gh(u),u.stateNode=Sl(y,o,p,u)):u.stateNode=o.stateNode);else{if(typeof y!="string"&&u.stateNode===null)throw Error(s(166));if(o=Yi.current,p=Di.current,Nt(u)){if(!Rn)throw Error(s(176));if(o=u.stateNode,p=u.memoizedProps,y=null,b=vi,b!==null)switch(b.tag){case 27:case 5:y=b.memoizedProps}Cv(o,p,u,y)||De(u,!0)}else Gh(u),u.stateNode=Sl(y,o,p,u)}return mn(u),null;case 31:if(p=u.memoizedState,o===null||o.memoizedState!==null){if(y=Nt(u),p!==null){if(o===null){if(!y)throw Error(s(318));if(!Rn)throw Error(s(556));if(o=u.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(s(557));Op(o,u)}else Zi(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;mn(u),o=!1}else p=$i(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=p),o=!0;if(!o)return u.flags&256?(_s(u),u):(_s(u),null);if((u.flags&128)!==0)throw Error(s(558))}return mn(u),null;case 13:if(y=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(b=Nt(u),y!==null&&y.dehydrated!==null){if(o===null){if(!b)throw Error(s(318));if(!Rn)throw Error(s(344));if(b=u.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(s(317));D_(b,u)}else Zi(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;mn(u),b=!1}else b=$i(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=b),b=!0;if(!b)return u.flags&256?(_s(u),u):(_s(u),null)}return _s(u),(u.flags&128)!==0?(u.lanes=p,u):(p=y!==null,o=o!==null&&o.memoizedState!==null,p&&(y=u.child,b=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(b=y.alternate.memoizedState.cachePool.pool),C=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(C=y.memoizedState.cachePool.pool),C!==b&&(y.flags|=2048)),p!==o&&p&&(u.child.flags|=8192),qh(u,u.updateQueue),mn(u),null);case 4:return re(),Y0(o,u),o===null&&rn(u.stateNode.containerInfo),mn(u),null;case 10:return ds(u.type),mn(u),null;case 19:if(x(Kn),y=u.memoizedState,y===null)return mn(u),null;if(b=(u.flags&128)!==0,C=y.rendering,C===null)if(b)uc(y,!1);else{if(qn!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(C=Kl(o),C!==null){for(u.flags|=128,uc(y,!1),o=C.updateQueue,u.updateQueue=o,qh(u,o),u.subtreeFlags=0,o=p,p=u.child;p!==null;)hd(p,o),p=p.sibling;return R(Kn,Kn.current&1|2),we&&Qt(u,y.treeForkCount),u.child}o=o.sibling}y.tail!==null&&ss()>bo&&(u.flags|=128,b=!0,uc(y,!1),u.lanes=4194304)}else{if(!b)if(o=Kl(C),o!==null){if(u.flags|=128,b=!0,o=o.updateQueue,u.updateQueue=o,qh(u,o),uc(y,!0),y.tail===null&&y.tailMode==="hidden"&&!C.alternate&&!we)return mn(u),null}else 2*ss()-y.renderingStartTime>bo&&p!==536870912&&(u.flags|=128,b=!0,uc(y,!1),u.lanes=4194304);y.isBackwards?(C.sibling=u.child,u.child=C):(o=y.last,o!==null?o.sibling=C:u.child=C,y.last=C)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=ss(),o.sibling=null,p=Kn.current,R(Kn,b?p&1|2:p&1),we&&Qt(u,y.treeForkCount),o):(mn(u),null);case 22:case 23:return _s(u),Un(),y=u.memoizedState!==null,o!==null?o.memoizedState!==null!==y&&(u.flags|=8192):y&&(u.flags|=8192),y?(p&536870912)!==0&&(u.flags&128)===0&&(mn(u),u.subtreeFlags&6&&(u.flags|=8192)):mn(u),p=u.updateQueue,p!==null&&qh(u,p.retryQueue),p=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==p&&(u.flags|=2048),o!==null&&x(go),null;case 24:return p=null,o!==null&&(p=o.memoizedState.cache),u.memoizedState.cache!==p&&(u.flags|=2048),ds(Nn),mn(u),null;case 25:return null;case 30:return null}throw Error(s(156,u.tag))}function tp(o,u){switch(bt(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return ds(Nn),re(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return qe(u),null;case 31:if(u.memoizedState!==null){if(_s(u),u.alternate===null)throw Error(s(340));Zi()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 13:if(_s(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(s(340));Zi()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return x(Kn),null;case 4:return re(),null;case 10:return ds(u.type),null;case 22:case 23:return _s(u),Un(),o!==null&&x(go),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return ds(Nn),null;case 25:return null;default:return null}}function X0(o,u){switch(bt(u),u.tag){case 3:ds(Nn),re();break;case 26:case 27:case 5:qe(u);break;case 4:re();break;case 31:u.memoizedState!==null&&_s(u);break;case 13:_s(u);break;case 19:x(Kn);break;case 10:ds(u.type);break;case 22:case 23:_s(u),Un(),o!==null&&x(go);break;case 24:ds(Nn)}}function Mr(o,u){try{var p=u.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var b=y.next;p=b;do{if((p.tag&o)===o){y=void 0;var C=p.create,P=p.inst;y=C(),P.destroy=y}p=p.next}while(p!==b)}}catch(Z){ae(u,u.return,Z)}}function Lr(o,u,p){try{var y=u.updateQueue,b=y!==null?y.lastEffect:null;if(b!==null){var C=b.next;y=C;do{if((y.tag&o)===o){var P=y.inst,Z=P.destroy;if(Z!==void 0){P.destroy=void 0,b=u;var mt=p,wt=Z;try{wt()}catch(Pt){ae(b,mt,Pt)}}}y=y.next}while(y!==C)}}catch(Pt){ae(u,u.return,Pt)}}function cc(o){var u=o.updateQueue;if(u!==null){var p=o.stateNode;try{Sr(u,p)}catch(y){ae(o,o.return,y)}}}function td(o,u,p){p.props=Dr(o.type,o.memoizedProps),p.state=o.memoizedState;try{p.componentWillUnmount()}catch(y){ae(o,u,y)}}function hc(o,u){try{var p=o.ref;if(p!==null){switch(o.tag){case 26:case 27:case 5:var y=Sc(o.stateNode);break;case 30:y=o.stateNode;break;default:y=o.stateNode}typeof p=="function"?o.refCleanup=p(y):p.current=y}}catch(b){ae(o,u,b)}}function is(o,u){var p=o.ref,y=o.refCleanup;if(p!==null)if(typeof y=="function")try{y()}catch(b){ae(o,u,b)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(b){ae(o,u,b)}else p.current=null}function Wo(o){var u=o.type,p=o.memoizedProps,y=o.stateNode;try{o_(y,u,p,o)}catch(b){ae(o,o.return,b)}}function Fh(o,u,p){try{u_(o.stateNode,o.type,p,u,o)}catch(y){ae(o,o.return,y)}}function ep(o){return o.tag===5||o.tag===3||(Oa?o.tag===26:!1)||(yi?o.tag===27&&lu(o.type):!1)||o.tag===4}function ml(o){t:for(;;){for(;o.sibling===null;){if(o.return===null||ep(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(yi&&o.tag===27&&lu(o.type)||o.flags&2||o.child===null||o.tag===4)continue t;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function ed(o,u,p){var y=o.tag;if(y===5||y===6)o=o.stateNode,u?h_(p,o,u):Ep(p,o);else if(y!==4&&(yi&&y===27&&lu(o.type)&&(p=o.stateNode,u=null),o=o.child,o!==null))for(ed(o,u,p),o=o.sibling;o!==null;)ed(o,u,p),o=o.sibling}function Yh(o,u,p){var y=o.tag;if(y===5||y===6)o=o.stateNode,u?c_(p,o,u):Ap(p,o);else if(y!==4&&(yi&&y===27&&lu(o.type)&&(p=o.stateNode),o=o.child,o!==null))for(Yh(o,u,p),o=o.sibling;o!==null;)Yh(o,u,p),o=o.sibling}function np(o,u,p){o=o.containerInfo;try{Rp(o,p)}catch(y){ae(u,u.return,y)}}function K0(o){var u=o.stateNode,p=o.memoizedProps;try{ci(o.type,p,u,o)}catch(y){ae(o,o.return,y)}}function Ev(o,u){for(_d(o.containerInfo),ii=u;ii!==null;)if(o=ii,u=o.child,(o.subtreeFlags&1028)!==0&&u!==null)u.return=o,ii=u;else for(;ii!==null;){o=ii;var p=o.alternate;switch(u=o.flags,o.tag){case 0:if((u&4)!==0&&(u=o.updateQueue,u=u!==null?u.events:null,u!==null))for(var y=0;y<u.length;y++){var b=u[y];b.ref.impl=b.nextImpl}break;case 11:case 15:break;case 1:if((u&1024)!==0&&p!==null){u=void 0,y=o,b=p.memoizedProps,p=p.memoizedState;var C=y.stateNode;try{var P=Dr(y.type,b);u=C.getSnapshotBeforeUpdate(P,p),C.__reactInternalSnapshotBeforeUpdate=u}catch(Z){ae(y,y.return,Z)}}break;case 3:(u&1024)!==0&&Oe&&bp(o.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(s(163))}if(u=o.sibling,u!==null){u.return=o.return,ii=u;break}ii=o.return}}function W0(o,u,p){var y=p.flags;switch(p.tag){case 0:case 11:case 15:Ts(o,p),y&4&&Mr(5,p);break;case 1:if(Ts(o,p),y&4)if(o=p.stateNode,u===null)try{o.componentDidMount()}catch(P){ae(p,p.return,P)}else{var b=Dr(p.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(b,u,o.__reactInternalSnapshotBeforeUpdate)}catch(P){ae(p,p.return,P)}}y&64&&cc(p),y&512&&hc(p,p.return);break;case 3:if(Ts(o,p),y&64&&(y=p.updateQueue,y!==null)){if(o=null,p.child!==null)switch(p.child.tag){case 27:case 5:o=Sc(p.child.stateNode);break;case 1:o=p.child.stateNode}try{Sr(y,o)}catch(P){ae(p,p.return,P)}}break;case 27:yi&&u===null&&y&4&&K0(p);case 26:case 5:if(Ts(o,p),u===null){if(y&4)Wo(p);else if(y&64){o=p.type,u=p.memoizedProps,b=p.stateNode;try{O_(b,o,u,p)}catch(P){ae(p,p.return,P)}}}y&512&&hc(p,p.return);break;case 12:Ts(o,p);break;case 31:Ts(o,p),y&4&&wa(o,p);break;case 13:Ts(o,p),y&4&&Xh(o,p),y&64&&(y=p.memoizedState,y!==null&&(y=y.dehydrated,y!==null&&(p=Sv.bind(null,p),bd(y,p))));break;case 22:if(y=p.memoizedState!==null||Wn,!y){u=u!==null&&u.memoizedState!==null||Jn,b=Wn;var C=Jn;Wn=y,(Jn=u)&&!C?xa(o,p,(p.subtreeFlags&8772)!==0):Ts(o,p),Wn=b,Jn=C}break;case 30:break;default:Ts(o,p)}}function ip(o){var u=o.alternate;u!==null&&(o.alternate=null,ip(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&yd(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function Ca(o,u,p){for(p=p.child;p!==null;)Qh(o,u,p),p=p.sibling}function Qh(o,u,p){if(Fs&&typeof Fs.onCommitFiberUnmount=="function")try{Fs.onCommitFiberUnmount(cu,p)}catch{}switch(p.tag){case 26:if(Oa){Jn||is(p,u),Ca(o,u,p),p.memoizedState?mo(p.memoizedState):p.stateNode&&zp(p.stateNode);break}case 27:if(yi){Jn||is(p,u);var y=Gn,b=si;lu(p.type)&&(Gn=p.stateNode,si=!1),Ca(o,u,p),Ni(p.stateNode),Gn=y,si=b;break}case 5:Jn||is(p,u);case 6:if(Oe){if(y=Gn,b=si,Gn=null,Ca(o,u,p),Gn=y,si=b,Gn!==null)if(si)try{Sp(Gn,p.stateNode)}catch(C){ae(p,u,C)}else try{f_(Gn,p.stateNode)}catch(C){ae(p,u,C)}}else Ca(o,u,p);break;case 18:Oe&&Gn!==null&&(si?Cd(Gn,p.stateNode):Lp(Gn,p.stateNode));break;case 4:Oe?(y=Gn,b=si,Gn=p.stateNode.containerInfo,si=!0,Ca(o,u,p),Gn=y,si=b):(ha&&np(p.stateNode,p,Cp()),Ca(o,u,p));break;case 0:case 11:case 14:case 15:Lr(2,p,u),Jn||Lr(4,p,u),Ca(o,u,p);break;case 1:Jn||(is(p,u),y=p.stateNode,typeof y.componentWillUnmount=="function"&&td(p,u,y)),Ca(o,u,p);break;case 21:Ca(o,u,p);break;case 22:Jn=(y=Jn)||p.memoizedState!==null,Ca(o,u,p),Jn=y;break;default:Ca(o,u,p)}}function wa(o,u){if(Rn&&u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{wv(o)}catch(p){ae(u,u.return,p)}}}function Xh(o,u){if(Rn&&u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{Rv(o)}catch(p){ae(u,u.return,p)}}function Ra(o){switch(o.tag){case 31:case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new Kp),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new Kp),u;default:throw Error(s(435,o.tag))}}function pl(o,u){var p=Ra(o);u.forEach(function(y){if(!p.has(y)){p.add(y);var b=Tv.bind(null,o,y);y.then(b,b)}})}function Ri(o,u){var p=u.deletions;if(p!==null)for(var y=0;y<p.length;y++){var b=p[y],C=o,P=u;if(Oe){var Z=P;t:for(;Z!==null;){switch(Z.tag){case 27:if(yi){if(lu(Z.type)){Gn=Z.stateNode,si=!1;break t}break}case 5:Gn=Z.stateNode,si=!1;break t;case 3:case 4:Gn=Z.stateNode.containerInfo,si=!0;break t}Z=Z.return}if(Gn===null)throw Error(s(160));Qh(C,P,b),Gn=null,si=!1}else Qh(C,P,b);C=b.alternate,C!==null&&(C.return=null),b.return=null}if(u.subtreeFlags&13886)for(u=u.child;u!==null;)Kh(u,o),u=u.sibling}function Kh(o,u){var p=o.alternate,y=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:Ri(u,o),xi(o),y&4&&(Lr(3,o,o.return),Mr(3,o),Lr(5,o,o.return));break;case 1:Ri(u,o),xi(o),y&512&&(Jn||p===null||is(p,p.return)),y&64&&Wn&&(o=o.updateQueue,o!==null&&(y=o.callbacks,y!==null&&(p=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=p===null?y:p.concat(y))));break;case 26:if(Oa){var b=tn;if(Ri(u,o),xi(o),y&512&&(Jn||p===null||is(p,p.return)),y&4){y=p!==null?p.memoizedState:null;var C=o.memoizedState;p===null?C===null?o.stateNode===null?o.stateNode=U_(b,o.type,o.memoizedProps,o):Up(b,o.type,o.stateNode):o.stateNode=Vp(b,C,o.memoizedProps):y!==C?(y===null?p.stateNode!==null&&zp(p.stateNode):mo(y),C===null?Up(b,o.type,o.stateNode):Vp(b,C,o.memoizedProps)):C===null&&o.stateNode!==null&&Fh(o,o.memoizedProps,p.memoizedProps)}break}case 27:if(yi){Ri(u,o),xi(o),y&512&&(Jn||p===null||is(p,p.return)),p!==null&&y&4&&Fh(o,o.memoizedProps,p.memoizedProps);break}case 5:if(Ri(u,o),xi(o),y&512&&(Jn||p===null||is(p,p.return)),Oe){if(o.flags&32){b=o.stateNode;try{Tp(b)}catch(Rt){ae(o,o.return,Rt)}}y&4&&o.stateNode!=null&&(b=o.memoizedProps,Fh(o,b,p!==null?p.memoizedProps:b)),y&1024&&(Nc=!0)}else ha&&o.alternate!==null&&(o.alternate.stateNode=o.stateNode);break;case 6:if(Ri(u,o),xi(o),y&4&&Oe){if(o.stateNode===null)throw Error(s(162));y=o.memoizedProps,p=p!==null?p.memoizedProps:y,b=o.stateNode;try{l_(b,p,y)}catch(Rt){ae(o,o.return,Rt)}}break;case 3:if(Oa?(z_(),b=tn,tn=of(u.containerInfo),Ri(u,o),tn=b):Ri(u,o),xi(o),y&4){if(Oe&&Rn&&p!==null&&p.memoizedState.isDehydrated)try{M_(u.containerInfo)}catch(Rt){ae(o,o.return,Rt)}if(ha){y=u.containerInfo,p=u.pendingChildren;try{Rp(y,p)}catch(Rt){ae(o,o.return,Rt)}}}Nc&&(Nc=!1,nd(o));break;case 4:Oa?(p=tn,tn=of(o.stateNode.containerInfo),Ri(u,o),xi(o),tn=p):(Ri(u,o),xi(o)),y&4&&ha&&np(o.stateNode,o,o.stateNode.pendingChildren);break;case 12:Ri(u,o),xi(o);break;case 31:Ri(u,o),xi(o),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,pl(o,y)));break;case 13:Ri(u,o),xi(o),o.child.flags&8192&&o.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(yf=ss()),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,pl(o,y)));break;case 22:b=o.memoizedState!==null;var P=p!==null&&p.memoizedState!==null,Z=Wn,mt=Jn;if(Wn=Z||b,Jn=mt||P,Ri(u,o),Jn=mt,Wn=Z,xi(o),y&8192&&(u=o.stateNode,u._visibility=b?u._visibility&-2:u._visibility|1,b&&(p===null||P||Wn||Jn||to(o)),Oe)){t:if(p=null,Oe)for(u=o;;){if(u.tag===5||Oa&&u.tag===26){if(p===null){P=p=u;try{C=P.stateNode,b?bv(C):m_(P.stateNode,P.memoizedProps)}catch(Rt){ae(P,P.return,Rt)}}}else if(u.tag===6){if(p===null){P=u;try{var wt=P.stateNode;b?d_(wt):p_(wt,P.memoizedProps)}catch(Rt){ae(P,P.return,Rt)}}}else if(u.tag===18){if(p===null){P=u;try{var Pt=P.stateNode;b?k_(Pt):P_(P.stateNode)}catch(Rt){ae(P,P.return,Rt)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break t;for(;u.sibling===null;){if(u.return===null||u.return===o)break t;p===u&&(p=null),u=u.return}p===u&&(p=null),u.sibling.return=u.return,u=u.sibling}}y&4&&(y=o.updateQueue,y!==null&&(p=y.retryQueue,p!==null&&(y.retryQueue=null,pl(o,p))));break;case 19:Ri(u,o),xi(o),y&4&&(y=o.updateQueue,y!==null&&(o.updateQueue=null,pl(o,y)));break;case 30:break;case 21:break;default:Ri(u,o),xi(o)}}function xi(o){var u=o.flags;if(u&2){try{for(var p,y=o.return;y!==null;){if(ep(y)){p=y;break}y=y.return}if(Oe){if(p==null)throw Error(s(160));switch(p.tag){case 27:if(yi){var b=p.stateNode,C=ml(o);Yh(o,C,b);break}case 5:var P=p.stateNode;p.flags&32&&(Tp(P),p.flags&=-33);var Z=ml(o);Yh(o,Z,P);break;case 3:case 4:var mt=p.stateNode.containerInfo,wt=ml(o);ed(o,wt,mt);break;default:throw Error(s(161))}}}catch(Pt){ae(o,o.return,Pt)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function nd(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;nd(u),u.tag===5&&u.flags&1024&&gp(u.stateNode),o=o.sibling}}function Ts(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)W0(o,u.alternate,u),u=u.sibling}function to(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:Lr(4,u,u.return),to(u);break;case 1:is(u,u.return);var p=u.stateNode;typeof p.componentWillUnmount=="function"&&td(u,u.return,p),to(u);break;case 27:yi&&Ni(u.stateNode);case 26:case 5:is(u,u.return),to(u);break;case 22:u.memoizedState===null&&to(u);break;case 30:to(u);break;default:to(u)}o=o.sibling}}function xa(o,u,p){for(p=p&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var y=u.alternate,b=o,C=u,P=C.flags;switch(C.tag){case 0:case 11:case 15:xa(b,C,p),Mr(4,C);break;case 1:if(xa(b,C,p),y=C,b=y.stateNode,typeof b.componentDidMount=="function")try{b.componentDidMount()}catch(wt){ae(y,y.return,wt)}if(y=C,b=y.updateQueue,b!==null){var Z=y.stateNode;try{var mt=b.shared.hiddenCallbacks;if(mt!==null)for(b.shared.hiddenCallbacks=null,b=0;b<mt.length;b++)Er(mt[b],Z)}catch(wt){ae(y,y.return,wt)}}p&&P&64&&cc(C),hc(C,C.return);break;case 27:yi&&K0(C);case 26:case 5:xa(b,C,p),p&&y===null&&P&4&&Wo(C),hc(C,C.return);break;case 12:xa(b,C,p);break;case 31:xa(b,C,p),p&&P&4&&wa(b,C);break;case 13:xa(b,C,p),p&&P&4&&Xh(b,C);break;case 22:C.memoizedState===null&&xa(b,C,p),hc(C,C.return);break;case 30:break;default:xa(b,C,p)}u=u.sibling}}function eo(o,u){var p=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(p=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==p&&(o!=null&&o.refCount++,p!=null&&Cn(p))}function sp(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&Cn(o))}function zn(o,u,p,y){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)id(o,u,p,y),u=u.sibling}function id(o,u,p,y){var b=u.flags;switch(u.tag){case 0:case 11:case 15:zn(o,u,p,y),b&2048&&Mr(9,u);break;case 1:zn(o,u,p,y);break;case 3:zn(o,u,p,y),b&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&Cn(o)));break;case 12:if(b&2048){zn(o,u,p,y),o=u.stateNode;try{var C=u.memoizedProps,P=C.id,Z=C.onPostCommit;typeof Z=="function"&&Z(P,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(mt){ae(u,u.return,mt)}}else zn(o,u,p,y);break;case 31:zn(o,u,p,y);break;case 13:zn(o,u,p,y);break;case 23:break;case 22:C=u.stateNode,P=u.alternate,u.memoizedState!==null?C._visibility&2?zn(o,u,p,y):fc(o,u):C._visibility&2?zn(o,u,p,y):(C._visibility|=2,zs(o,u,p,y,(u.subtreeFlags&10256)!==0||!1)),b&2048&&eo(P,u);break;case 24:zn(o,u,p,y),b&2048&&sp(u.alternate,u);break;default:zn(o,u,p,y)}}function zs(o,u,p,y,b){for(b=b&&((u.subtreeFlags&10256)!==0||!1),u=u.child;u!==null;){var C=o,P=u,Z=p,mt=y,wt=P.flags;switch(P.tag){case 0:case 11:case 15:zs(C,P,Z,mt,b),Mr(8,P);break;case 23:break;case 22:var Pt=P.stateNode;P.memoizedState!==null?Pt._visibility&2?zs(C,P,Z,mt,b):fc(C,P):(Pt._visibility|=2,zs(C,P,Z,mt,b)),b&&wt&2048&&eo(P.alternate,P);break;case 24:zs(C,P,Z,mt,b),b&&wt&2048&&sp(P.alternate,P);break;default:zs(C,P,Z,mt,b)}u=u.sibling}}function fc(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var p=o,y=u,b=y.flags;switch(y.tag){case 22:fc(p,y),b&2048&&eo(y.alternate,y);break;case 24:fc(p,y),b&2048&&sp(y.alternate,y);break;default:fc(p,y)}u=u.sibling}}function kr(o,u,p){if(o.subtreeFlags&pa)for(o=o.child;o!==null;)no(o,u,p),o=o.sibling}function no(o,u,p){switch(o.tag){case 26:if(kr(o,u,p),o.flags&pa)if(o.memoizedState!==null)B_(p,tn,o.memoizedState,o.memoizedProps);else{var y=o.stateNode,b=o.type;o=o.memoizedProps,((u&335544128)===u||mp(b,o))&&vd(p,y,b,o)}break;case 5:kr(o,u,p),o.flags&pa&&(y=o.stateNode,b=o.type,o=o.memoizedProps,((u&335544128)===u||mp(b,o))&&vd(p,y,b,o));break;case 3:case 4:Oa?(y=tn,tn=of(o.stateNode.containerInfo),kr(o,u,p),tn=y):kr(o,u,p);break;case 22:o.memoizedState===null&&(y=o.alternate,y!==null&&y.memoizedState!==null?(y=pa,pa=16777216,kr(o,u,p),pa=y):kr(o,u,p));break;default:kr(o,u,p)}}function sd(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function dc(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var y=u[p];ii=y,oa(y,o)}sd(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ad(o),o=o.sibling}function ad(o){switch(o.tag){case 0:case 11:case 15:dc(o),o.flags&2048&&Lr(9,o,o.return);break;case 3:dc(o);break;case 12:dc(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&2&&(o.return===null||o.return.tag!==13)?(u._visibility&=-3,Wh(o)):dc(o);break;default:dc(o)}}function Wh(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var p=0;p<u.length;p++){var y=u[p];ii=y,oa(y,o)}sd(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:Lr(8,u,u.return),Wh(u);break;case 22:p=u.stateNode,p._visibility&2&&(p._visibility&=-3,Wh(u));break;default:Wh(u)}o=o.sibling}}function oa(o,u){for(;ii!==null;){var p=ii;switch(p.tag){case 0:case 11:case 15:Lr(8,p,u);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var y=p.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:Cn(p.memoizedState.cache)}if(y=p.child,y!==null)y.return=p,ii=y;else t:for(p=o;ii!==null;){y=ii;var b=y.sibling,C=y.return;if(ip(y),y===p){ii=null;break t}if(b!==null){b.return=C,ii=b;break t}ii=C}}}function io(o){var u=de(o);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(s(364));return u}if(o=ei(o),o===null)throw Error(s(362));return o.stateNode.current}function so(o,u){var p=o.tag;switch(u.$$typeof){case Ba:if(o.type===u.value)return!0;break;case Ic:t:{for(u=u.value,o=[o,0],p=0;p<o.length;){var y=o[p++],b=y.tag,C=o[p++],P=u[C];if(b!==5&&b!==26&&b!==27||!ho(y)){for(;P!=null&&so(y,P);)C++,P=u[C];if(C===u.length){u=!0;break t}else for(y=y.child;y!==null;)o.push(y,C),y=y.sibling}}u=!1}return u;case Oc:if((p===5||p===26||p===27)&&vp(o.stateNode,u.value))return!0;break;case Ao:if((p===5||p===6||p===26||p===27)&&(o=rf(o),o!==null&&0<=o.indexOf(u.value)))return!0;break;case gf:if((p===5||p===26||p===27)&&(o=o.memoizedProps["data-testname"],typeof o=="string"&&o.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(s(365))}return!1}function mc(o){switch(o.$$typeof){case Ba:return"<"+(E(o.value)||"Unknown")+">";case Ic:return":has("+(mc(o)||"")+")";case Oc:return'[role="'+o.value+'"]';case Ao:return'"'+o.value+'"';case gf:return'[data-testname="'+o.value+'"]';default:throw Error(s(365))}}function pc(o,u){var p=[];o=[o,0];for(var y=0;y<o.length;){var b=o[y++],C=b.tag,P=o[y++],Z=u[P];if(C!==5&&C!==26&&C!==27||!ho(b)){for(;Z!=null&&so(b,Z);)P++,Z=u[P];if(P===u.length)p.push(b);else for(b=b.child;b!==null;)o.push(b,P),b=b.sibling}}return p}function Bs(o,u){if(!_i)throw Error(s(363));o=io(o),o=pc(o,u),u=[],o=Array.from(o);for(var p=0;p<o.length;){var y=o[p++],b=y.tag;if(b===5||b===26||b===27)ho(y)||u.push(y.stateNode);else for(y=y.child;y!==null;)o.push(y),y=y.sibling}return u}function wn(){return(Te&2)!==0&&Re!==0?Re&-Re:$t.T!==null?Uo():bc()}function gl(){if(Ds===0)if((Re&536870912)===0||we){var o=uu;uu<<=1,(uu&3932160)===0&&(uu=262144),Ds=o}else Ds=536870912;return o=Ys.current,o!==null&&(o.flags|=32),Ds}function Bn(o,u,p){(o===Ee&&(en===2||en===9)||o.cancelPendingCommit!==null)&&(Xn(o,0),Vr(o,Re,Ds,!1)),X(o,p),((Te&2)===0||o!==Ee)&&(o===Ee&&((Te&2)===0&&(To|=p),qn===4&&Vr(o,Re,Ds,!1)),ms(o))}function or(o,u,p){if((Te&6)!==0)throw Error(s(327));var y=!p&&(u&127)===0&&(u&o.expiredLanes)===0||B(o,u),b=y?$0(o,u):Ur(o,u,!0),C=y;do{if(b===0){Eo&&!y&&Vr(o,u,0,!1);break}else{if(p=o.current.alternate,C&&!J0(p)){b=Ur(o,u,!1),C=!1;continue}if(b===2){if(C=u,o.errorRecoveryDisabledLanes&C)var P=0;else P=o.pendingLanes&-536870913,P=P!==0?P:P&536870912?536870912:0;if(P!==0){u=P;t:{var Z=o;b=_f;var mt=Rn&&Z.current.memoizedState.isDehydrated;if(mt&&(Xn(Z,P).flags|=256),P=Ur(Z,P,!1),P!==2){if(So&&!mt){Z.errorRecoveryDisabledLanes|=C,To|=C,b=4;break t}C=Qs,Qs=b,C!==null&&(Qs===null?Qs=C:Qs.push.apply(Qs,C))}b=P}if(C=!1,b!==2)continue}}if(b===1){Xn(o,0),Vr(o,u,0,!0);break}t:{switch(y=o,C=b,C){case 0:case 1:throw Error(s(345));case 4:if((u&4194048)!==u)break;case 6:Vr(y,u,Ds,!fr);break t;case 2:Qs=null;break;case 3:case 5:break;default:throw Error(s(329))}if((u&62914560)===u&&(b=yf+300-ss(),10<b)){if(Vr(y,u,Ds,!fr),H(y,0,!0)!==0)break t;Zr=u,y.timeoutHandle=dp(Pr.bind(null,y,p,Qs,vf,jd,u,Ds,To,Lc,fr,C,"Throttled",-0,0),b);break t}Pr(y,p,Qs,vf,jd,u,Ds,To,Lc,fr,C,null,-0,0)}}break}while(!0);ms(o)}function Pr(o,u,p,y,b,C,P,Z,mt,wt,Pt,Rt,Ht,he){if(o.timeoutHandle=Gs,Rt=u.subtreeFlags,Rt&8192||(Rt&16785408)===16785408){Rt=pp(),no(u,C,Rt);var Oi=(C&62914560)===C?yf-ss():(C&4194048)===C?gu-ss():0;if(Oi=r_(Rt,Oi),Oi!==null){Zr=C,o.cancelPendingCommit=Oi(Br.bind(null,o,u,C,p,y,b,P,Z,mt,Pt,Rt,null,Ht,he)),Vr(o,C,P,!wt);return}}Br(o,u,C,p,y,b,P,Z,mt)}function J0(o){for(var u=o;;){var p=u.tag;if((p===0||p===11||p===15)&&u.flags&16384&&(p=u.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var y=0;y<p.length;y++){var b=p[y],C=b.getSnapshot;b=b.value;try{if(!ni(C(),b))return!1}catch{return!1}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Vr(o,u,p,y){u&=~Mc,u&=~To,o.suspendedLanes|=u,o.pingedLanes&=~u,y&&(o.warmLanes|=u),y=o.expirationTimes;for(var b=u;0<b;){var C=31-qs(b),P=1<<C;y[C]=-1,b&=~P}p!==0&&k(o,p,u)}function rd(){return(Te&6)===0?(_a(0),!1):!0}function ld(){if(be!==null){if(en===0)var o=be.return;else o=be,cr=gn=null,Wl(o),_o=null,hu=0,o=be;for(;o!==null;)X0(o.alternate,o),o=o.return;be=null}}function Xn(o,u){var p=o.timeoutHandle;p!==Gs&&(o.timeoutHandle=Gs,a_(p)),p=o.cancelPendingCommit,p!==null&&(o.cancelPendingCommit=null,p()),Zr=0,ld(),Ee=o,be=p=ca(o.current,null),Re=u,en=0,hi=null,fr=!1,Eo=B(o,u),So=!1,Lc=Ds=Mc=To=xl=qn=0,Qs=_f=null,jd=!1,(u&8)!==0&&(u|=u&32);var y=o.entangledLanes;if(y!==0)for(o=o.entanglements,y&=u;0<y;){var b=31-qs(y),C=1<<b;u|=o[b],y&=~C}return Jr=u,Fl(),p}function pn(o,u){me=null,$t.H=ma,u===Ei||u===Ua?(u=Pn(),en=3):u===zd?(u=Pn(),en=4):en=u===Ns?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,hi=u,be===null&&(qn=1,Sa(o,Mt(u,o.current)))}function Ie(){var o=Ys.current;return o===null?!0:(Re&4194048)===Re?xs===null:(Re&62914560)===Re||(Re&536870912)!==0?o===xs:!1}function _l(){var o=$t.H;return $t.H=ma,o===null?ma:o}function ua(){var o=$t.A;return $t.A=Dc,o}function gc(){qn=4,fr||(Re&4194048)!==Re&&Ys.current!==null||(Eo=!0),(xl&134217727)===0&&(To&134217727)===0||Ee===null||Vr(Ee,Re,Ds,!1)}function Ur(o,u,p){var y=Te;Te|=2;var b=_l(),C=ua();(Ee!==o||Re!==u)&&(vf=null,Xn(o,u)),u=!1;var P=qn;t:do try{if(en!==0&&be!==null){var Z=be,mt=hi;switch(en){case 8:ld(),P=6;break t;case 3:case 2:case 9:case 6:Ys.current===null&&(u=!0);var wt=en;if(en=0,hi=null,zr(o,Z,mt,wt),p&&Eo){P=0;break t}break;default:wt=en,en=0,hi=null,zr(o,Z,mt,wt)}}Z0(),P=qn;break}catch(Pt){pn(o,Pt)}while(!0);return u&&o.shellSuspendCounter++,cr=gn=null,Te=y,$t.H=b,$t.A=C,be===null&&(Ee=null,Re=0,Fl()),P}function Z0(){for(;be!==null;)ao(be)}function $0(o,u){var p=Te;Te|=2;var y=_l(),b=ua();Ee!==o||Re!==u?(vf=null,bo=ss()+500,Xn(o,u)):Eo=B(o,u);t:do try{if(en!==0&&be!==null){u=be;var C=hi;e:switch(en){case 1:en=0,hi=null,zr(o,u,C,1);break;case 2:case 9:if(Bt(C)){en=0,hi=null,od(u);break}u=function(){en!==2&&en!==9||Ee!==o||(en=7),ms(o)},C.then(u,u);break t;case 3:en=7;break t;case 4:en=5;break t;case 7:Bt(C)?(en=0,hi=null,od(u)):(en=0,hi=null,zr(o,u,C,7));break;case 5:var P=null;switch(be.tag){case 26:P=be.memoizedState;case 5:case 27:var Z=be,mt=Z.type,wt=Z.pendingProps;if(P?jp(P):jn(Z.stateNode,mt,wt)){en=0,hi=null;var Pt=Z.sibling;if(Pt!==null)be=Pt;else{var Rt=Z.return;Rt!==null?(be=Rt,yc(Rt)):be=null}break e}}en=0,hi=null,zr(o,u,C,5);break;case 6:en=0,hi=null,zr(o,u,C,6);break;case 8:ld(),qn=6;break t;default:throw Error(s(462))}}_c();break}catch(Ht){pn(o,Ht)}while(!0);return cr=gn=null,$t.H=y,$t.A=b,Te=p,be!==null?0:(Ee=null,Re=0,Fl(),qn)}function _c(){for(;be!==null&&!H_();)ao(be)}function ao(o){var u=Jm(o.alternate,o,Jr);o.memoizedProps=o.pendingProps,u===null?yc(o):be=u}function od(o){var u=o,p=u.alternate;switch(u.tag){case 15:case 0:u=$n(p,u,u.pendingProps,u.type,void 0,Re);break;case 11:u=$n(p,u,u.pendingProps,u.type.render,u.ref,Re);break;case 5:Wl(u);default:X0(p,u),u=be=hd(u,Jr),u=Jm(p,u,Jr)}o.memoizedProps=o.pendingProps,u===null?yc(o):be=u}function zr(o,u,p,y){cr=gn=null,Wl(u),_o=null,hu=0;var b=u.return;try{if(rc(o,b,u,p,Re)){qn=1,Sa(o,Mt(p,o.current)),be=null;return}}catch(C){if(b!==null)throw be=b,C;qn=1,Sa(o,Mt(p,o.current)),be=null;return}u.flags&32768?(we||y===1?o=!0:Eo||(Re&536870912)!==0?o=!1:(fr=o=!0,(y===2||y===9||y===3||y===6)&&(y=Ys.current,y!==null&&y.tag===13&&(y.flags|=16384))),ro(u,o)):yc(u)}function yc(o){var u=o;do{if((u.flags&32768)!==0){ro(u,fr);return}o=u.return;var p=Q0(u.alternate,u,Jr);if(p!==null){be=p;return}if(u=u.sibling,u!==null){be=u;return}be=u=o}while(u!==null);qn===0&&(qn=5)}function ro(o,u){do{var p=tp(o.alternate,o);if(p!==null){p.flags&=32767,be=p;return}if(p=o.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!u&&(o=o.sibling,o!==null)){be=o;return}be=o=p}while(o!==null);qn=6,be=null}function Br(o,u,p,y,b,C,P,Z,mt){o.cancelPendingCommit=null;do Hr();while(fi!==0);if((Te&6)!==0)throw Error(s(327));if(u!==null){if(u===o.current)throw Error(s(177));if(C=u.lanes|u.childLanes,C|=fu,L(o,p,C,P,Z,mt),o===Ee&&(be=Ee=null,Re=0),_u=u,Dl=o,Zr=p,kc=C,Hd=b,Wp=y,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,ui(cf,function(){return Jh(),null})):(o.callbackNode=null,o.callbackPriority=0),y=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||y){y=$t.T,$t.T=null,b=Ia(),Ce(2),P=Te,Te|=4;try{Ev(o,u,p)}finally{Te=P,Ce(b),$t.T=y}}fi=1,yl(),jr(),ud()}}function yl(){if(fi===1){fi=0;var o=Dl,u=_u,p=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||p){p=$t.T,$t.T=null;var y=Ia();Ce(2);var b=Te;Te|=4;try{Kh(u,o),s_(o.containerInfo)}finally{Te=b,Ce(y),$t.T=p}}o.current=u,fi=2}}function jr(){if(fi===2){fi=0;var o=Dl,u=_u,p=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||p){p=$t.T,$t.T=null;var y=Ia();Ce(2);var b=Te;Te|=4;try{W0(o,u.alternate,u)}finally{Te=b,Ce(y),$t.T=p}}fi=3}}function ud(){if(fi===4||fi===3){fi=0,Gp();var o=Dl,u=_u,p=Zr,y=Wp;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?fi=5:(fi=0,_u=Dl=null,cd(o,o.pendingLanes));var b=o.pendingLanes;if(b===0&&(Nl=null),F(p),u=u.stateNode,Fs&&typeof Fs.onCommitFiberRoot=="function")try{Fs.onCommitFiberRoot(cu,u,void 0,(u.current.flags&128)===128)}catch{}if(y!==null){u=$t.T,b=Ia(),Ce(2),$t.T=null;try{for(var C=o.onRecoverableError,P=0;P<y.length;P++){var Z=y[P];C(Z.value,{componentStack:Z.stack})}}finally{$t.T=u,Ce(b)}}(Zr&3)!==0&&Hr(),ms(o),b=o.pendingLanes,(p&261930)!==0&&(b&42)!==0?o===Af?Ge++:(Ge=0,Af=o):Ge=0,Rn&&lf(),_a(0)}}function cd(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,Cn(u)))}function Hr(){return yl(),jr(),ud(),Jh()}function Jh(){if(fi!==5)return!1;var o=Dl,u=kc;kc=0;var p=F(Zr),y=32>p?32:p;p=$t.T;var b=Ia();try{Ce(y),$t.T=null,y=Hd,Hd=null;var C=Dl,P=Zr;if(fi=0,_u=Dl=null,Zr=0,(Te&6)!==0)throw Error(s(331));var Z=Te;if(Te|=4,ad(C.current),id(C,C.current,P,y),Te=Z,_a(0,!1),Fs&&typeof Fs.onPostCommitFiberRoot=="function")try{Fs.onPostCommitFiberRoot(cu,C)}catch{}return!0}finally{Ce(b),$t.T=p,cd(o,u)}}function lo(o,u,p){u=Mt(p,u),u=ac(o.stateNode,u,2),o=Hi(o,u,2),o!==null&&(X(o,2),ms(o))}function ae(o,u,p){if(o.tag===3)lo(o,o,p);else for(;u!==null;){if(u.tag===3){lo(u,o,p);break}else if(u.tag===1){var y=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Nl===null||!Nl.has(y))){o=Mt(p,o),p=Uh(2),y=Hi(u,p,2),y!==null&&(zh(p,y,u,o),X(y,2),ms(y));break}}u=u.return}}function vc(o,u,p){var y=o.pingCache;if(y===null){y=o.pingCache=new ga;var b=new Set;y.set(u,b)}else b=y.get(u),b===void 0&&(b=new Set,y.set(u,b));b.has(p)||(So=!0,b.add(p),o=t_.bind(null,o,u,p),u.then(o,o))}function t_(o,u,p){var y=o.pingCache;y!==null&&y.delete(u),o.pingedLanes|=o.suspendedLanes&p,o.warmLanes&=~p,Ee===o&&(Re&p)===p&&(qn===4||qn===3&&(Re&62914560)===Re&&300>ss()-yf?(Te&2)===0&&Xn(o,0):Mc|=p,Lc===Re&&(Lc=0)),ms(o)}function e_(o,u){u===0&&(u=$()),o=Ar(o,u),o!==null&&(X(o,u),ms(o))}function Sv(o){var u=o.memoizedState,p=0;u!==null&&(p=u.retryLane),e_(o,p)}function Tv(o,u){var p=0;switch(o.tag){case 31:case 13:var y=o.stateNode,b=o.memoizedState;b!==null&&(p=b.retryLane);break;case 19:y=o.stateNode;break;case 22:y=o.stateNode._retryCache;break;default:throw Error(s(314))}y!==null&&y.delete(u),e_(o,p)}function ui(o,u){return uf(o,u)}function ap(o,u,p,y){this.tag=o,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jo(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ca(o,u){var p=o.alternate;return p===null?(p=e(o.tag,u,o.key,o.mode),p.elementType=o.elementType,p.type=o.type,p.stateNode=o.stateNode,p.alternate=o,o.alternate=p):(p.pendingProps=u,p.type=o.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=o.flags&65011712,p.childLanes=o.childLanes,p.lanes=o.lanes,p.child=o.child,p.memoizedProps=o.memoizedProps,p.memoizedState=o.memoizedState,p.updateQueue=o.updateQueue,u=o.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=o.sibling,p.index=o.index,p.ref=o.ref,p.refCleanup=o.refCleanup,p}function hd(o,u){o.flags&=65011714;var p=o.alternate;return p===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=p.childLanes,o.lanes=p.lanes,o.child=p.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=p.memoizedProps,o.memoizedState=p.memoizedState,o.updateQueue=p.updateQueue,o.type=p.type,u=p.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function vl(o,u,p,y,b,C){var P=0;if(y=o,typeof o=="function")Jo(o)&&(P=1);else if(typeof o=="string")P=Oa&&yi?wd(o,p,Di.current)?26:Hp(o)?27:5:Oa?wd(o,p,Di.current)?26:5:yi&&Hp(o)?27:5;else t:switch(o){case ef:return o=e(31,p,u,b),o.elementType=ef,o.lanes=C,o;case eu:return Na(p.children,b,C,u);case nu:P=8,b|=24;break;case iu:return o=e(12,p,u,b|2),o.elementType=iu,o.lanes=C,o;case pd:return o=e(13,p,u,b),o.elementType=pd,o.lanes=C,o;case Al:return o=e(19,p,u,b),o.elementType=Al,o.lanes=C,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case Da:P=10;break t;case tf:P=9;break t;case Ac:P=11;break t;case gd:P=14;break t;case bs:P=16,y=null;break t}P=29,p=Error(s(130,o===null?"null":typeof o,"")),y=null}return u=e(P,p,u,b),u.elementType=o,u.type=y,u.lanes=C,u}function Na(o,u,p,y){return o=e(7,o,y,u),o.lanes=p,o}function rp(o,u,p){return o=e(6,o,null,u),o.lanes=p,o}function lp(o){var u=e(18,null,null,0);return u.stateNode=o,u}function op(o,u,p){return u=e(4,o.children!==null?o.children:[],o.key,u),u.lanes=p,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}function n_(o,u,p,y,b,C,P,Z,mt){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Gs,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=nt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nt(0),this.hiddenUpdates=nt(null),this.identifierPrefix=y,this.onUncaughtError=b,this.onCaughtError=C,this.onRecoverableError=P,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=mt,this.incompleteTransitions=new Map}function oo(o,u,p,y,b,C,P,Z,mt,wt,Pt,Rt){return o=new n_(o,u,p,P,mt,wt,Pt,Rt,Z),u=1,C===!0&&(u|=24),C=e(3,null,null,u),o.current=C,C.stateNode=o,u=kn(),u.refCount++,o.pooledCache=u,u.refCount++,C.memoizedState={element:y,isDehydrated:p,cache:u},mi(C),o}function fd(o){return o?(o=qr,o):qr}function Zh(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(s(188)):(o=Object.keys(o).join(","),Error(s(268,o)));return o=f(u),o=o!==null?m(o):null,o===null?null:Sc(o.stateNode)}function up(o,u,p,y,b,C){b=fd(b),y.context===null?y.context=b:y.pendingContext=b,y=gs(u),y.payload={element:p},C=C===void 0?null:C,C!==null&&(y.callback=C),p=Hi(o,y,u),p!==null&&(Bn(p,o,u),Ql(p,o,u))}function Zo(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var p=o.retryLane;o.retryLane=p!==0&&p<u?p:u}}function $h(o,u){Zo(o,u),(o=o.alternate)&&Zo(o,u)}var ve={},dd=D1(),js=ZA(),md=Object.assign,$o=Symbol.for("react.element"),Gr=Symbol.for("react.transitional.element"),tu=Symbol.for("react.portal"),eu=Symbol.for("react.fragment"),nu=Symbol.for("react.strict_mode"),iu=Symbol.for("react.profiler"),tf=Symbol.for("react.consumer"),Da=Symbol.for("react.context"),Ac=Symbol.for("react.forward_ref"),pd=Symbol.for("react.suspense"),Al=Symbol.for("react.suspense_list"),gd=Symbol.for("react.memo"),bs=Symbol.for("react.lazy"),ef=Symbol.for("react.activity"),cp=Symbol.for("react.memo_cache_sentinel"),El=Symbol.iterator,uo=Symbol.for("react.client.reference"),co=Array.isArray,$t=dd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,hp=t.rendererVersion,nf=t.rendererPackageName,Ec=t.extraDevToolsConfig,Sc=t.getPublicInstance,i_=t.getRootHostContext,Tc=t.getChildHostContext,_d=t.prepareForCommit,s_=t.resetAfterCommit,fp=t.createInstance;t.cloneMutableInstance;var sf=t.appendInitialChild,Hs=t.finalizeInitialChildren,Cs=t.shouldSetTextContent,Sl=t.createTextInstance;t.cloneMutableTextInstance;var dp=t.scheduleTimeout,a_=t.cancelTimeout,Gs=t.noTimeout,ti=t.isPrimaryRenderer;t.warnsIfNotActing;var Oe=t.supportsMutation,ha=t.supportsPersistence,Rn=t.supportsHydration,de=t.getInstanceFromNode;t.beforeActiveInstanceBlur;var rn=t.preparePortalMount;t.prepareScopeUpdate,t.getInstanceFromScope;var Ce=t.setCurrentUpdatePriority,Ia=t.getCurrentUpdatePriority,bc=t.resolveUpdatePriority;t.trackSchedulerEvent,t.resolveEventType,t.resolveEventTimeStamp;var su=t.shouldAttemptEagerTransition,yd=t.detachDeletedInstance;t.requestPostPaintCallback;var af=t.maySuspendCommit,Cc=t.maySuspendCommitOnUpdate,mp=t.maySuspendCommitInSyncRender,jn=t.preloadInstance,pp=t.startSuspendingCommit,vd=t.suspendInstance;t.suspendOnActiveViewTransition;var r_=t.waitForCommitToBeReady;t.getSuspendedCommitReason;var au=t.NotPendingTransition,ru=t.HostTransitionContext,gp=t.resetFormInstance;t.bindToConsole;var _p=t.supportsMicrotasks,yp=t.scheduleMicrotask,_i=t.supportsTestSelectors,ei=t.findFiberRoot,Ad=t.getBoundingRect,rf=t.getTextContent,ho=t.isHiddenSubtree,vp=t.matchAccessibilityRole,Tl=t.setFocusIfFocusable,Ed=t.setupIntersectionObserver,Ap=t.appendChild,Ep=t.appendChildToContainer,l_=t.commitTextUpdate,o_=t.commitMount,u_=t.commitUpdate,c_=t.insertBefore,h_=t.insertInContainerBefore,f_=t.removeChild,Sp=t.removeChildFromContainer,Tp=t.resetTextContent,bv=t.hideInstance,d_=t.hideTextInstance,m_=t.unhideInstance,p_=t.unhideTextInstance;t.cancelViewTransitionName,t.cancelRootViewTransitionName,t.restoreRootViewTransitionName,t.cloneRootViewTransitionContainer,t.removeRootViewTransitionClone,t.measureClonedInstance,t.hasInstanceChanged,t.hasInstanceAffectedParent,t.startViewTransition,t.startGestureTransition,t.stopViewTransition,t.getCurrentGestureOffset,t.createViewTransitionInstance;var bp=t.clearContainer;t.createFragmentInstance,t.updateFragmentInstanceFiber,t.commitNewChildToFragmentInstance,t.deleteChildFromFragmentInstance;var g_=t.cloneInstance,Cp=t.createContainerChildSet,wp=t.appendChildToContainerChildSet,__=t.finalizeContainerChildren,Rp=t.replaceContainerChildren,y_=t.cloneHiddenInstance,xp=t.cloneHiddenTextInstance,fo=t.isSuspenseInstancePending,Sd=t.isSuspenseInstanceFallback,Td=t.getSuspenseInstanceFallbackErrorDetails,bd=t.registerSuspenseInstanceRetry,v_=t.canHydrateFormStateMarker,Np=t.isFormStateMarkerMatching,A_=t.getNextHydratableSibling,E_=t.getNextHydratableSiblingAfterSingleton,S_=t.getFirstHydratableChild,T_=t.getFirstHydratableChildWithinContainer,b_=t.getFirstHydratableChildWithinActivityInstance,C_=t.getFirstHydratableChildWithinSuspenseInstance,Dp=t.getFirstHydratableChildWithinSingleton,w_=t.canHydrateInstance,R_=t.canHydrateTextInstance,Ip=t.canHydrateActivityInstance,x_=t.canHydrateSuspenseInstance,N_=t.hydrateInstance,Cv=t.hydrateTextInstance,Op=t.hydrateActivityInstance,D_=t.hydrateSuspenseInstance,I_=t.getNextHydratableInstanceAfterActivityInstance,Mp=t.getNextHydratableInstanceAfterSuspenseInstance,O_=t.commitHydratedInstance,M_=t.commitHydratedContainer,wv=t.commitHydratedActivityInstance,Rv=t.commitHydratedSuspenseInstance,L_=t.finalizeHydratedChildren,lf=t.flushHydrationEvents;t.clearActivityBoundary;var Lp=t.clearSuspenseBoundary;t.clearActivityBoundaryFromContainer;var Cd=t.clearSuspenseBoundaryFromContainer,k_=t.hideDehydratedBoundary,P_=t.unhideDehydratedBoundary,wc=t.shouldDeleteUnhydratedTailInstances;t.diffHydratedPropsForDevWarnings,t.diffHydratedTextForDevWarnings,t.describeHydratableInstanceForDevWarnings;var V_=t.validateHydratableInstance,kp=t.validateHydratableTextInstance,Oa=t.supportsResources,wd=t.isHostHoistableType,of=t.getHoistableRoot,Pp=t.getResource,Vp=t.acquireResource,mo=t.releaseResource,U_=t.hydrateHoistable,Up=t.mountHoistable,zp=t.unmountHoistable,Rd=t.createHoistableInstance,z_=t.prepareToCommitHoistables,Bp=t.mayResourceSuspendCommit,jp=t.preloadResource,B_=t.suspendResource,yi=t.supportsSingletons,xd=t.resolveSingletonInstance,ci=t.acquireSingletonInstance,Ni=t.releaseSingletonInstance,Hp=t.isHostSingletonType,lu=t.isSingletonScope,Nd=[],ou=-1,qr={},qs=Math.clz32?Math.clz32:O,Dd=Math.log,j_=Math.LN2,Id=256,uu=262144,Rc=4194304,uf=js.unstable_scheduleCallback,Od=js.unstable_cancelCallback,H_=js.unstable_shouldYield,Gp=js.unstable_requestPaint,ss=js.unstable_now,Md=js.unstable_ImmediatePriority,G_=js.unstable_UserBlockingPriority,cf=js.unstable_NormalPriority,Ld=js.unstable_IdlePriority,qp=js.log,q_=js.unstable_setDisableYieldValue,cu=null,Fs=null,ni=typeof Object.is=="function"?Object.is:Ot,kd=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},xv=Object.prototype.hasOwnProperty,Pd,Fr,hf=!1,Fp=new WeakMap,bl=[],Yr=0,ln=null,ff=0,Ma=[],fa=0,La=null,Fi=1,ur="",Di=T(null),Cl=T(null),Yi=T(null),df=T(null),vi=null,xn=null,we=!1,Qr=null,ws=!1,Vd=Error(s(519)),ka=T(null),gn=null,cr=null,F_=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(p,y){o.push(y)}};this.abort=function(){u.aborted=!0,o.forEach(function(p){return p()})}},Ii=js.unstable_scheduleCallback,Nv=js.unstable_NormalPriority,Nn={$$typeof:Da,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},mf=null,$e=null,as=!1,Pa=!1,Ud=!1,po=0,xc=null,Yp=0,wl=0,Ai=null,Va=$t.S;$t.S=function(o,u){gu=ss(),typeof u=="object"&&u!==null&&typeof u.then=="function"&&zo(o,u),Va!==null&&Va(o,u)};var go=T(null),Ei=Error(s(460)),zd=Error(s(474)),Ua=Error(s(542)),Xr={then:function(){}},Rs=null,_o=null,hu=0,Qi=sl(!0),Qp=sl(!1),Xi=[],Kr=0,fu=0,da=!1,Bd=!1,du=T(null),yo=T(0),Ys=T(null),xs=null,Kn=T(0),Rl=0,me=null,Wt=null,ue=null,Ae=!1,_e=!1,Pe=!1,rs=0,za=0,hr=null,Xp=0,ma={readContext:Ln,use:ir,useCallback:hn,useContext:hn,useEffect:hn,useImperativeHandle:hn,useLayoutEffect:hn,useInsertionEffect:hn,useMemo:hn,useReducer:hn,useRef:hn,useState:hn,useDebugValue:hn,useDeferredValue:hn,useTransition:hn,useSyncExternalStore:hn,useId:hn,useHostTransitionStatus:hn,useFormState:hn,useActionState:hn,useOptimistic:hn,useMemoCache:hn,useCacheRefresh:hn};ma.useEffectEvent=hn;var Hn={readContext:Ln,use:ir,useCallback:function(o,u){return pi().memoizedState=[o,u===void 0?null:u],o},useContext:Ln,useEffect:Jl,useImperativeHandle:function(o,u,p){p=p!=null?p.concat([o]):null,la(4194308,4,ol.bind(null,u,o),p)},useLayoutEffect:function(o,u){return la(4194308,4,o,u)},useInsertionEffect:function(o,u){la(4,2,o,u)},useMemo:function(o,u){var p=pi();u=u===void 0?null:u;var y=o();if(Pe){G(!0);try{o()}finally{G(!1)}}return p.memoizedState=[y,u],y},useReducer:function(o,u,p){var y=pi();if(p!==void 0){var b=p(u);if(Pe){G(!0);try{p(u)}finally{G(!1)}}}else b=u;return y.memoizedState=y.baseState=b,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:b},y.queue=o,o=o.dispatch=Xm.bind(null,me,o),[y.memoizedState,o]},useRef:function(o){var u=pi();return o={current:o},u.memoizedState=o},useState:function(o){o=xh(o);var u=o.queue,p=Ph.bind(null,me,u);return u.dispatch=p,[o.memoizedState,p]},useDebugValue:Nr,useDeferredValue:function(o,u){var p=pi();return ul(p,o,u)},useTransition:function(){var o=xh(!1);return o=$l.bind(null,me,o.queue,!0,!1),pi().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,p){var y=me,b=pi();if(we){if(p===void 0)throw Error(s(407));p=p()}else{if(p=u(),Ee===null)throw Error(s(349));(Re&127)!==0||Zf(y,u,p)}b.memoizedState=p;var C={value:p,getSnapshot:u};return b.queue=C,Jl(Rh.bind(null,y,C,o),[o]),y.flags|=2048,wi(9,{destroy:void 0},Ju.bind(null,y,C,p,u),null),p},useId:function(){var o=pi(),u=Ee.identifierPrefix;if(we){var p=ur,y=Fi;p=(y&~(1<<32-qs(y)-1)).toString(32)+p,u="_"+u+"R_"+p,p=rs++,0<p&&(u+="H"+p.toString(32)),u+="_"}else p=Xp++,u="_"+u+"r_"+p.toString(32)+"_";return o.memoizedState=u},useHostTransitionStatus:Yo,useFormState:Dh,useActionState:Dh,useOptimistic:function(o){var u=pi();u.memoizedState=u.baseState=o;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=p,u=Qo.bind(null,me,!0,p),p.dispatch=u,[o,u]},useMemoCache:rl,useCacheRefresh:function(){return pi().memoizedState=tc.bind(null,me)},useEffectEvent:function(o){var u=pi(),p={impl:o};return u.memoizedState=p,function(){if((Te&2)!==0)throw Error(s(440));return p.impl.apply(void 0,arguments)}}},Wr={readContext:Ln,use:ir,useCallback:Fo,useContext:Ln,useEffect:Rr,useImperativeHandle:Oh,useInsertionEffect:xr,useLayoutEffect:Zl,useMemo:ns,useReducer:ke,useRef:qo,useState:function(){return ke(Us)},useDebugValue:Nr,useDeferredValue:function(o,u){var p=fn();return Mh(p,Wt.memoizedState,o,u)},useTransition:function(){var o=ke(Us)[0],u=fn().memoizedState;return[typeof o=="boolean"?o:dn(o),u]},useSyncExternalStore:ra,useId:cl,useHostTransitionStatus:Yo,useFormState:As,useActionState:As,useOptimistic:function(o,u){var p=fn();return sr(p,Wt,o,u)},useMemoCache:rl,useCacheRefresh:kh};Wr.useEffectEvent=qi;var vo={readContext:Ln,use:ir,useCallback:Fo,useContext:Ln,useEffect:Rr,useImperativeHandle:Oh,useInsertionEffect:xr,useLayoutEffect:Zl,useMemo:ns,useReducer:Cr,useRef:qo,useState:function(){return Cr(Us)},useDebugValue:Nr,useDeferredValue:function(o,u){var p=fn();return Wt===null?ul(p,o,u):Mh(p,Wt.memoizedState,o,u)},useTransition:function(){var o=Cr(Us)[0],u=fn().memoizedState;return[typeof o=="boolean"?o:dn(o),u]},useSyncExternalStore:ra,useId:cl,useHostTransitionStatus:Yo,useFormState:ar,useActionState:ar,useOptimistic:function(o,u){var p=fn();return Wt!==null?sr(p,Wt,o,u):(p.baseState=o,[o,p.queue.dispatch])},useMemoCache:rl,useCacheRefresh:kh};vo.useEffectEvent=qi;var pf={enqueueSetState:function(o,u,p){o=o._reactInternals;var y=wn(),b=gs(y);b.payload=u,p!=null&&(b.callback=p),u=Hi(o,b,y),u!==null&&(Bn(u,o,y),Ql(u,o,y))},enqueueReplaceState:function(o,u,p){o=o._reactInternals;var y=wn(),b=gs(y);b.tag=1,b.payload=u,p!=null&&(b.callback=p),u=Hi(o,b,y),u!==null&&(Bn(u,o,y),Ql(u,o,y))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var p=wn(),y=gs(p);y.tag=2,u!=null&&(y.callback=u),u=Hi(o,y,p),u!==null&&(Bn(u,o,p),Ql(u,o,p))}},Ns=Error(s(461)),En=!1,mu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},Wn=!1,Jn=!1,Nc=!1,Kp=typeof WeakSet=="function"?WeakSet:Set,ii=null,Gn=null,si=!1,tn=null,pa=8192,Dc={getCacheForType:function(o){var u=Ln(Nn),p=u.data.get(o);return p===void 0&&(p=o(),u.data.set(o,p)),p},cacheSignal:function(){return Ln(Nn).controller.signal}},Ba=0,Ic=1,Oc=2,gf=3,Ao=4;if(typeof Symbol=="function"&&Symbol.for){var pu=Symbol.for;Ba=pu("selector.component"),Ic=pu("selector.has_pseudo_class"),Oc=pu("selector.role"),gf=pu("selector.test_id"),Ao=pu("selector.text")}var ga=typeof WeakMap=="function"?WeakMap:Map,Te=0,Ee=null,be=null,Re=0,en=0,hi=null,fr=!1,Eo=!1,So=!1,Jr=0,qn=0,xl=0,To=0,Mc=0,Ds=0,Lc=0,_f=null,Qs=null,jd=!1,yf=0,gu=0,bo=1/0,vf=null,Nl=null,fi=0,Dl=null,_u=null,Zr=0,kc=0,Hd=null,Wp=null,Ge=0,Af=null;return ve.attemptContinuousHydration=function(o){if(o.tag===13||o.tag===31){var u=Ar(o,67108864);u!==null&&Bn(u,o,67108864),$h(o,67108864)}},ve.attemptHydrationAtCurrentPriority=function(o){if(o.tag===13||o.tag===31){var u=wn();u=Q(u);var p=Ar(o,u);p!==null&&Bn(p,o,u),$h(o,u)}},ve.attemptSynchronousHydration=function(o){switch(o.tag){case 3:if(o=o.stateNode,o.current.memoizedState.isDehydrated){var u=M(o.pendingLanes);if(u!==0){for(o.pendingLanes|=2,o.entangledLanes|=2;u;){var p=1<<31-qs(u);o.entanglements[1]|=p,u&=~p}ms(o),(Te&6)===0&&(bo=ss()+500,_a(0))}}break;case 31:case 13:u=Ar(o,2),u!==null&&Bn(u,o,2),rd(),$h(o,2)}},ve.batchedUpdates=function(o,u){return o(u)},ve.createComponentSelector=function(o){return{$$typeof:Ba,value:o}},ve.createContainer=function(o,u,p,y,b,C,P,Z,mt,wt){return oo(o,u,!1,null,p,y,C,null,P,Z,mt,wt)},ve.createHasPseudoClassSelector=function(o){return{$$typeof:Ic,value:o}},ve.createHydrationContainer=function(o,u,p,y,b,C,P,Z,mt,wt,Pt,Rt,Ht,he){return o=oo(p,y,!0,o,b,C,Z,he,mt,wt,Pt,Rt),o.context=fd(null),p=o.current,y=wn(),y=Q(y),b=gs(y),b.callback=u??null,Hi(p,b,y),u=y,o.current.lanes=u,X(o,u),ms(o),o},ve.createPortal=function(o,u,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:tu,key:y==null?null:""+y,children:o,containerInfo:u,implementation:p}},ve.createRoleSelector=function(o){return{$$typeof:Oc,value:o}},ve.createTestNameSelector=function(o){return{$$typeof:gf,value:o}},ve.createTextSelector=function(o){return{$$typeof:Ao,value:o}},ve.defaultOnCaughtError=function(o){console.error(o)},ve.defaultOnRecoverableError=function(o){kd(o)},ve.defaultOnUncaughtError=function(o){kd(o)},ve.deferredUpdates=function(o){var u=$t.T,p=Ia();try{return Ce(32),$t.T=null,o()}finally{Ce(p),$t.T=u}},ve.discreteUpdates=function(o,u,p,y,b){var C=$t.T,P=Ia();try{return Ce(2),$t.T=null,o(u,p,y,b)}finally{Ce(P),$t.T=C,Te===0&&(bo=ss()+500)}},ve.findAllNodes=Bs,ve.findBoundingRects=function(o,u){if(!_i)throw Error(s(363));u=Bs(o,u),o=[];for(var p=0;p<u.length;p++)o.push(Ad(u[p]));for(u=o.length-1;0<u;u--){p=o[u];for(var y=p.x,b=y+p.width,C=p.y,P=C+p.height,Z=u-1;0<=Z;Z--)if(u!==Z){var mt=o[Z],wt=mt.x,Pt=wt+mt.width,Rt=mt.y,Ht=Rt+mt.height;if(y>=wt&&C>=Rt&&b<=Pt&&P<=Ht){o.splice(u,1);break}else if(y!==wt||p.width!==mt.width||Ht<C||Rt>P){if(!(C!==Rt||p.height!==mt.height||Pt<y||wt>b)){wt>y&&(mt.width+=wt-y,mt.x=y),Pt<b&&(mt.width=b-wt),o.splice(u,1);break}}else{Rt>C&&(mt.height+=Rt-C,mt.y=C),Ht<P&&(mt.height=P-Rt),o.splice(u,1);break}}}return o},ve.findHostInstance=Zh,ve.findHostInstanceWithNoPortals=function(o){return o=f(o),o=o!==null?g(o):null,o===null?null:Sc(o.stateNode)},ve.findHostInstanceWithWarning=function(o){return Zh(o)},ve.flushPassiveEffects=Hr,ve.flushSyncFromReconciler=function(o){var u=Te;Te|=1;var p=$t.T,y=Ia();try{if(Ce(2),$t.T=null,o)return o()}finally{Ce(y),$t.T=p,Te=u,(Te&6)===0&&_a(0)}},ve.flushSyncWork=rd,ve.focusWithin=function(o,u){if(!_i)throw Error(s(363));for(o=io(o),u=pc(o,u),u=Array.from(u),o=0;o<u.length;){var p=u[o++],y=p.tag;if(!ho(p)){if((y===5||y===26||y===27)&&Tl(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},ve.getFindAllNodesFailureDescription=function(o,u){if(!_i)throw Error(s(363));var p=0,y=[];o=[io(o),0];for(var b=0;b<o.length;){var C=o[b++],P=C.tag,Z=o[b++],mt=u[Z];if((P!==5&&P!==26&&P!==27||!ho(C))&&(so(C,mt)&&(y.push(mc(mt)),Z++,Z>p&&(p=Z)),Z<u.length))for(C=C.child;C!==null;)o.push(C,Z),C=C.sibling}if(p<u.length){for(o=[];p<u.length;p++)o.push(mc(u[p]));return`findAllNodes was able to match part of the selector:
  `+(y.join(" > ")+`

No matching component was found for:
  `)+o.join(" > ")}return null},ve.getPublicRootInstance=function(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 27:case 5:return Sc(o.child.stateNode);default:return o.child.stateNode}},ve.injectIntoDevTools=function(){var o={bundleType:0,version:hp,rendererPackageName:nf,currentDispatcherRef:$t,reconcilerVersion:"19.2.0"};if(Ec!==null&&(o.rendererConfig=Ec),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")o=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)o=!0;else{try{cu=u.inject(o),Fs=u}catch{}o=!!u.checkDCE}}return o},ve.isAlreadyRendering=function(){return(Te&6)!==0},ve.observeVisibleRects=function(o,u,p,y){if(!_i)throw Error(s(363));o=Bs(o,u);var b=Ed(o,p,y).disconnect;return{disconnect:function(){b()}}},ve.shouldError=function(){return null},ve.shouldSuspend=function(){return!1},ve.startHostTransition=function(o,u,p,y){if(o.tag!==5)throw Error(s(476));var b=Lh(o).queue;$l(o,b,u,au,p===null?i:function(){var C=Lh(o);return C.next===null&&(C=o.alternate.memoizedState),lr(o,C.next.queue,{},wn()),p(y)})},ve.updateContainer=function(o,u,p,y){var b=u.current,C=wn();return up(b,C,o,u,p,y),C},ve.updateContainerSync=function(o,u,p,y){return up(u.current,2,o,u,p,y),2},ve},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})})(j2)),j2.exports}var tC;function pj(){return tC||(tC=1,B2.exports=mj()),B2.exports}var gj=pj();const _j=oC(gj);var H2={exports:{}},vu={};var eC;function yj(){return eC||(eC=1,vu.ConcurrentRoot=1,vu.ContinuousEventPriority=8,vu.DefaultEventPriority=32,vu.DiscreteEventPriority=2,vu.IdleEventPriority=268435456,vu.LegacyRoot=0,vu.NoEventPriority=0),vu}var nC;function vj(){return nC||(nC=1,H2.exports=yj()),H2.exports}var vv=vj();const iC={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let sC=!1,aC=!1;const N1=".react-konva-event",Aj=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,Ej=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Sj={};function Av(n,t,e=Sj){if(!sC&&"zIndex"in t&&(console.warn(Ej),sC=!0),!aC&&t.draggable){var i=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;i&&!s&&(console.warn(Aj),aC=!0)}for(var l in e)if(!iC[l]){var c=l.slice(0,2)==="on",f=e[l]!==t[l];if(c&&f){var m=l.substr(2).toLowerCase();m.substr(0,7)==="content"&&(m="content"+m.substr(7,1).toUpperCase()+m.substr(8)),n.off(m,e[l])}var g=!t.hasOwnProperty(l);g&&n.setAttr(l,void 0)}var A=t._useStrictMode,E={},T=!1;const x={};for(var l in t)if(!iC[l]){var c=l.slice(0,2)==="on",R=e[l]!==t[l];if(c&&R){var m=l.substr(2).toLowerCase();m.substr(0,7)==="content"&&(m="content"+m.substr(7,1).toUpperCase()+m.substr(8)),t[l]&&(x[m]=t[l])}!c&&(t[l]!==e[l]||A&&t[l]!==n.getAttr(l))&&(T=!0,E[l]=t[l])}T&&(n.setAttrs(E),Ch(n));for(var m in x)n.off(m+N1),n.on(m+N1,x[m])}function Ch(n){if(!Ut.autoDrawEnabled){var t=n.getLayer()||n.getStage();t&&t.batchDraw()}}var G2=ZA();const ow={},Tj={};Nm.Node.prototype._applyProps=Av;let uw=vv.DefaultEventPriority;function bj(n,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}n.add(t),Ch(n)}function Cj(n,t,e){let i=Nm[n];i||(console.error(`Konva has no node with the type ${n}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${n}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),i=Nm.Group);const s={},l={};for(var c in t)if(c!=="ref"){var f=c.slice(0,2)==="on";f?l[c]=t[c]:s[c]=t[c]}const m=new i(s);return Av(m,l),m}function wj(n,t,e){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${n}"`)}function Rj(n,t,e){return!1}function xj(n){return n}function Nj(){return null}function Dj(){return null}function Ij(n,t,e,i){return Tj}function Oj(){}function Mj(n){}function Lj(n,t){return!1}function kj(){return ow}function Pj(){return ow}const Vj=setTimeout,Uj=clearTimeout,zj=!0,Bj=n=>{n()},jj=-1;function Hj(n,t){return!1}const Gj=!1,qj=!1,Fj=!0,Yj=!1,Qj=!1;function Xj(n,t){t.parent===n?t.moveToTop():n.add(t),Ch(n)}function Kj(n,t){t.parent===n?t.moveToTop():n.add(t),Ch(n)}function cw(n,t,e){t._remove(),n.add(t),t.setZIndex(e.getZIndex()),Ch(n)}function Wj(n,t,e){cw(n,t,e)}function Jj(n,t){t.destroy(),t.off(N1),Ch(n)}function Zj(n,t){t.destroy(),t.off(N1),Ch(n)}function $j(n,t,e){console.error(`Text components are not yet supported in ReactKonva. You text is: "${e}"`)}function tH(n,t,e){}function eH(n,t,e,i){Av(n,i,e)}function nH(n){n.hide(),Ch(n)}function iH(n){}function sH(n,t){(t.visible==null||t.visible)&&n.show()}function aH(n,t){}function rH(n){}function lH(){}function oH(){return null}function uH(){}function cH(){}function hH(){return vv.DefaultEventPriority}function fH(){}function dH(){return null}function mH(n){uw=n}function pH(){return uw}function gH(){return vv.DiscreteEventPriority}function _H(){return!1}function yH(){}function vH(){return null}function AH(){return-1.1}function EH(){}function SH(){return!1}function TH(){return!0}function bH(){}function CH(){}function wH(){return null}const RH=null,xH=Ki.createContext(null);function NH(){}const DH=Object.freeze(Object.defineProperty({__proto__:null,HostTransitionContext:xH,NotPendingTransition:RH,afterActiveInstanceBlur:cH,appendChild:Xj,appendChildToContainer:Kj,appendInitialChild:bj,beforeActiveInstanceBlur:uH,cancelTimeout:Uj,clearContainer:rH,commitMount:tH,commitTextUpdate:$j,commitUpdate:eH,createInstance:Cj,createTextInstance:wj,detachDeletedInstance:lH,finalizeInitialChildren:Rj,getChildHostContext:Pj,getCurrentEventPriority:hH,getCurrentUpdatePriority:pH,getInstanceFromNode:oH,getInstanceFromScope:dH,getPublicInstance:xj,getRootHostContext:kj,hideInstance:nH,hideTextInstance:iH,idlePriority:G2.unstable_IdlePriority,insertBefore:cw,insertInContainerBefore:Wj,isPrimaryRenderer:Gj,maySuspendCommit:SH,noTimeout:jj,now:G2.unstable_now,preloadInstance:TH,prepareForCommit:Nj,preparePortalMount:Dj,prepareScopeUpdate:fH,prepareUpdate:Ij,removeChild:Jj,removeChildFromContainer:Zj,requestPostPaintCallback:EH,resetAfterCommit:Oj,resetFormInstance:NH,resetTextContent:Mj,resolveEventTimeStamp:AH,resolveEventType:vH,resolveUpdatePriority:gH,run:G2.unstable_runWithPriority,scheduleMicrotask:Bj,scheduleTimeout:Vj,setCurrentUpdatePriority:mH,shouldAttemptEagerTransition:_H,shouldDeprioritizeSubtree:Lj,shouldSetTextContent:Hj,startSuspendingCommit:bH,supportsHydration:Qj,supportsMicrotasks:zj,supportsMutation:Fj,supportsPersistence:Yj,suspendInstance:CH,trackSchedulerEvent:yH,unhideInstance:sH,unhideTextInstance:aH,waitForCommitToBeReady:wH,warnsIfNotActing:qj},Symbol.toStringTag,{value:"Module"}));function hw(n,t,e){if(!n)return;if(e(n)===!0)return n;let i=n.child;for(;i;){const s=hw(i,t,e);if(s)return s;i=i.sibling}}function fw(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const $S=fw(j.createContext(null));class dw extends j.Component{render(){return j.createElement($S.Provider,{value:this._reactInternals},this.props.children)}}function IH(){const n=j.useContext($S);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=j.useId();return j.useMemo(()=>{for(const e of[n,n?.alternate]){if(!e)continue;const i=hw(e,!1,s=>{let l=s.memoizedState;for(;l;){if(l.memoizedState===t)return!0;l=l.next}});if(i)return i}},[n,t])}const OH=Symbol.for("react.context"),MH=n=>n!==null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===OH;function LH(){const n=IH(),[t]=j.useState(()=>new Map);t.clear();let e=n;for(;e;){const i=e.type;MH(i)&&i!==$S&&!t.has(i)&&t.set(i,j.use(fw(i))),e=e.return}return t}function kH(){const n=LH();return j.useMemo(()=>Array.from(n.keys()).reduce((t,e)=>i=>j.createElement(t,null,j.createElement(e.Provider,{...i,value:n.get(e)})),t=>j.createElement(dw,{...t})),[n])}if(Ki.version.indexOf("19")===-1)throw new Error("react-konva version 19 is only compatible with React 19. Make sure to have the last version of react-konva and react or downgrade react-konva to version 18.");function PH(n){const t=Ki.useRef({});return Ki.useLayoutEffect(()=>{t.current=n}),Ki.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const VH=()=>{const n=Ki.useRef(0);return Ki.useMemo(()=>{n.current++},[]),n.current>1},UH=n=>{const t=Ki.useRef(null),e=Ki.useRef(null),i=Ki.useRef(null),s=PH(n),l=kH(),c=Ki.useRef(null),f=A=>{const{forwardedRef:E}=n;E&&(typeof E=="function"?E(A):E.current=A)},m=VH(),g=()=>{f(null),yg.updateContainer(null,i.current,null),e.current?.destroy(),e.current=null};return Ki.useLayoutEffect(()=>(c.current&&(clearTimeout(c.current),c.current=null),e.current?f(e.current):(e.current=new Nm.Stage({width:n.width,height:n.height,container:t.current}),f(e.current),i.current=yg.createContainer(e.current,vv.ConcurrentRoot,null,!1,null,"",console.error,console.error,console.error,null),yg.updateContainer(Ki.createElement(l,{},n.children),i.current,null,()=>{})),()=>{m?c.current=setTimeout(g,0):g()}),[]),Ki.useLayoutEffect(()=>{f(e.current),Av(e.current,n,s),yg.flushSyncFromReconciler(()=>{yg.updateContainer(Ki.createElement(l,{},n.children),i.current,null)})}),Ki.createElement("div",{ref:t,id:n.id,accessKey:n.accessKey,className:n.className,role:n.role,style:n.style,tabIndex:n.tabIndex,title:n.title})},mw="Layer",Gl="Group",Bu="Rect",pw="Circle",zH="Ellipse",gw="Line",Dm="Text",Qm="Transformer",yg=_j(DH),BH=Ki.forwardRef((n,t)=>Ki.createElement(dw,{},Ki.createElement(UH,{...n,forwardedRef:t})));function _w(n,t,e){return{x:(n-e.x)/e.scale,y:(t-e.y)/e.scale}}function t4(n,t,e){return{x:e.x+n*e.scale,y:e.y+t*e.scale}}const jH=.001,HH=1e-4,q2="#fafafa",Ha=20,GH="rgba(0, 0, 0, 0.12)",qH=1;function FH({width:n,height:t,viewport:e}){const i=j.useMemo(()=>{const{x:s,y:l,scale:c}=e,f=-s/c-Ha,m=-l/c-Ha,g=(-s+n)/c+Ha,A=(-l+t)/c+Ha,E=Math.floor(f/Ha)*Ha,T=Math.floor(m/Ha)*Ha,x=Math.ceil(g/Ha)*Ha,R=Math.ceil(A/Ha)*Ha,O=[];for(let M=E;M<=x;M+=Ha)for(let H=T;H<=R;H+=Ha)O.push(I.jsx(pw,{x:M,y:H,radius:qH,fill:GH,listening:!1,perfectDrawEnabled:!1},`${M},${H}`));return O},[n,t,e]);return I.jsx(Gl,{listening:!1,children:i})}function YH({width:n,height:t,viewport:e,onViewportChange:i,onMouseMove:s,onBackgroundClick:l,showGrid:c=!0,creationToolActive:f=!1,editingTextOpen:m=!1,children:g,cursorLayer:A}){const E=j.useRef(null),T=j.useRef(e);T.current=e;const[x,R]=j.useState(!1),O=j.useRef({x:0,y:0,vx:0,vy:0,scale:1}),M=j.useRef(!1),H=j.useRef(null),B=j.useRef(null),Y=j.useCallback(V=>{if(m)return;V.evt.preventDefault();const q=E.current;if(!q)return;const Q=q.getPointerPosition();if(!Q)return;const F=1-V.evt.deltaY*jH,G=Math.max(HH,e.scale*F),Ot={x:(Q.x-e.x)/e.scale,y:(Q.y-e.y)/e.scale},Vt=Q.x-Ot.x*G,tt=Q.y-Ot.y*G;i({x:Vt,y:tt,scale:G})},[e,i,m]),$=j.useCallback(V=>{if(m){M.current=!1;return}const q=V.target,Q=q.name();if(Q==="background"||Q==="stageFill"||q===q.getStage()){const G=E.current;if(G){const Ot=G.getPointerPosition();Ot&&(R(!0),M.current=!1,B.current=null,O.current={x:Ot.x,y:Ot.y,vx:e.x,vy:e.y,scale:e.scale})}}},[e,m]),nt=j.useCallback(V=>{if(!x)return;M.current=!0;const q=E.current;if(!q)return;const Q=q.getPointerPosition();if(!Q)return;const{x:F,y:G}=O.current,Ot=Q.x-F,Vt=Q.y-G;B.current={dx:Ot,dy:Vt},H.current===null&&(H.current=requestAnimationFrame(()=>{H.current=null;const tt=B.current;if(!tt)return;const{vx:At,vy:yt,scale:Mt}=O.current;i({x:At+tt.dx,y:yt+tt.dy,scale:Mt})}))},[x,i]),X=j.useCallback(()=>{if(x){H.current!==null&&(cancelAnimationFrame(H.current),H.current=null);const V=B.current;if(V){const{vx:q,vy:Q,scale:F}=O.current;i({x:q+V.dx,y:Q+V.dy,scale:F})}R(!1)}},[x,i]),L=j.useCallback(V=>{nt(V),x||s?.(V)},[nt,s,x]),k=j.useCallback(V=>{if(M.current)return;const q=V.target,Q=q.name();if((Q==="background"||Q==="stageFill"||q===q.getStage())&&l){const G=E.current;if(G){const Ot=G.getPointerPosition();if(Ot){const Vt=_w(Ot.x,Ot.y,T.current),tt=V.evt;l({x:Vt.x,y:Vt.y,clientX:tt.clientX,clientY:tt.clientY})}}}},[l]);return I.jsxs(BH,{ref:E,width:n,height:t,onWheel:Y,onMouseDown:$,onMouseUp:X,onMouseLeave:X,onMouseMove:L,onClick:k,style:{cursor:x?"grabbing":"grab",background:q2},children:[I.jsxs(mw,{listening:!0,children:[I.jsx(Bu,{x:0,y:0,width:n,height:t,fill:q2,listening:!0,name:"stageFill"}),I.jsxs(Gl,{x:e.x,y:e.y,scaleX:e.scale,scaleY:e.scale,draggable:!1,children:[I.jsx(Bu,{x:-5e3,y:-5e3,width:2e4,height:2e4,fill:q2,listening:!0,name:"background"}),c&&I.jsx(FH,{width:n,height:t,viewport:e}),g]})]}),A]})}const QH=j.memo(YH),on=20,xy=36;function XH(n,t){if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0}function KH(n,t){return n.x===t.x&&n.y===t.y&&n.scale===t.scale}function WH({objects:n,viewport:t,selectedIds:e,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:c,onStickyDoubleClick:f,onTextDoubleClick:m,canEdit:g}){const A=j.useMemo(()=>Object.values(n).sort((E,T)=>{const x=E.createdAt?.toMillis?.()??0,R=T.createdAt?.toMillis?.()??0;return x-R}),[n]);return I.jsx(I.Fragment,{children:A.map(E=>{const T=e.has(E.objectId),x=g&&c&&(E.type==="sticky"||E.type==="rectangle"||E.type==="circle"||E.type==="triangle"||E.type==="line"||E.type==="text");return E.type==="sticky"?I.jsx($H,{obj:E,viewport:t,canEdit:g,selected:T,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:x?c:void 0,onStickyDoubleClick:f},E.objectId):E.type==="rectangle"?I.jsx(tG,{obj:E,viewport:t,canEdit:g,selected:T,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:x?c:void 0},E.objectId):E.type==="circle"?I.jsx(eG,{obj:E,viewport:t,canEdit:g,selected:T,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:x?c:void 0},E.objectId):E.type==="triangle"?I.jsx(nG,{obj:E,viewport:t,canEdit:g,selected:T,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:x?c:void 0},E.objectId):E.type==="line"?I.jsx(iG,{obj:E,viewport:t,canEdit:g,selected:T,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:x?c:void 0},E.objectId):E.type==="text"?I.jsx(sG,{obj:E,viewport:t,canEdit:g,selected:T,isPointerTool:i,onObjectDragEnd:s,onObjectClick:l,onObjectResizeEnd:x?c:void 0,onTextDoubleClick:m},E.objectId):E.type==="emoji"?I.jsx(aG,{obj:E,viewport:t,canEdit:g,selected:e.has(E.objectId),isPointerTool:i,onObjectDragEnd:s,onObjectClick:l},E.objectId):null})})}function JH(n,t){return!(n.objects!==t.objects||!XH(n.selectedIds,t.selectedIds)||!KH(n.viewport,t.viewport)||n.isPointerTool!==t.isPointerTool||n.canEdit!==t.canEdit||n.onObjectDragEnd!==t.onObjectDragEnd||n.onObjectClick!==t.onObjectClick||n.onObjectResizeEnd!==t.onObjectResizeEnd||n.onStickyDoubleClick!==t.onStickyDoubleClick||n.onTextDoubleClick!==t.onTextDoubleClick)}const ZH=j.memo(WH,JH),Jf=(n,t,e,i,s,l,c)=>({listening:c,draggable:e&&c&&i,onDragEnd:f=>{const m=f.target,g=m.getAbsolutePosition(),A=_w(g.x,g.y,t);s(n,A.x,A.y),m.position({x:A.x,y:A.y})},onClick:f=>l(n,{ctrlKey:f.evt.ctrlKey})});function $H({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c,onObjectResizeEnd:f,onStickyDoubleClick:m}){const g=j.useRef(null),A=j.useRef(null),{objectId:E,position:T,dimensions:x,content:R,fillColor:O,textStyle:M}=n;j.useEffect(()=>{i&&f&&A.current&&g.current&&A.current.nodes([g.current])},[i,f]);const H=()=>{const B=g.current;if(!B||!f)return;const Y=B.scaleX(),$=B.scaleY();B.scaleX(1),B.scaleY(1);const nt=B.findOne("Rect");if(nt){const X=Math.max(on,nt.width()*Y),L=Math.max(on,nt.height()*$);nt.width(X),nt.height(L);const k=B.findOne("Text");k&&(k.width(X-8),k.height(L-8)),f(E,{position:{x:B.x(),y:B.y()},dimensions:{width:X,height:L}})}};return I.jsxs(I.Fragment,{children:[I.jsxs(Gl,{ref:g,x:T.x,y:T.y,...Jf(E,t,e,i,l,c,s),onDblClick:e?()=>m(E):void 0,onTransformEnd:f?H:void 0,children:[I.jsx(Bu,{width:x.width,height:x.height,fill:O,stroke:i?"#4f46e5":"#d1d5db",strokeWidth:i?3:1,shadowColor:"black",shadowBlur:6,shadowOffset:{x:1,y:2},shadowOpacity:.12,perfectDrawEnabled:!1}),I.jsx(Dm,{x:4,y:4,width:x.width-8,height:x.height-8,text:R||"",fontSize:M.fontSize,fontFamily:M.fontFamily,fill:M.fontColor,fontStyle:M.bold&&M.italic?"bold italic":M.bold?"bold":M.italic?"italic":"normal",align:M.textAlign,verticalAlign:"top",padding:4,listening:!1,perfectDrawEnabled:!1})]}),i&&f&&I.jsx(Qm,{ref:A,rotateEnabled:!1,boundBoxFunc:(B,Y)=>Math.abs(Y.width)<on||Math.abs(Y.height)<on?B:Y})]})}function tG({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c,onObjectResizeEnd:f}){const m=j.useRef(null),g=j.useRef(null),{objectId:A,position:E,dimensions:T}=n;j.useEffect(()=>{i&&f&&g.current&&m.current&&g.current.nodes([m.current])},[i,f]);const x=()=>{const R=m.current;if(!R||!f)return;const O=R.scaleX(),M=R.scaleY();R.scaleX(1),R.scaleY(1);const H=R.findOne("Rect");if(H){const B=Math.max(on,H.width()*O),Y=Math.max(on,H.height()*M);H.width(B),H.height(Y),f(A,{position:{x:R.x(),y:R.y()},dimensions:{width:B,height:Y}})}};return I.jsxs(I.Fragment,{children:[I.jsx(Gl,{ref:m,x:E.x,y:E.y,...Jf(A,t,e,i,l,c,s),onTransformEnd:f?x:void 0,children:I.jsx(Bu,{width:T.width,height:T.height,fill:"transparent",stroke:i?"#4f46e5":"black",strokeWidth:i?3:2,perfectDrawEnabled:!1})}),i&&f&&I.jsx(Qm,{ref:g,rotateEnabled:!1,boundBoxFunc:(R,O)=>Math.abs(O.width)<on||Math.abs(O.height)<on?R:O})]})}function eG({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c,onObjectResizeEnd:f}){const m=j.useRef(null),g=j.useRef(null),{objectId:A,position:E,dimensions:T}=n,x=T.width/2,R=T.height/2;j.useEffect(()=>{i&&f&&g.current&&m.current&&g.current.nodes([m.current])},[i,f]);const O=()=>{const M=m.current;if(!M||!f)return;const H=M.scaleX(),B=M.scaleY();M.scaleX(1),M.scaleY(1);const Y=M.findOne("Ellipse");if(Y){const $=Math.max(on,T.width*H),nt=Math.max(on,T.height*B),X=$/2,L=nt/2;Y.setAttrs({x:X,y:L,radiusX:X,radiusY:L}),f(A,{position:{x:M.x(),y:M.y()},dimensions:{width:$,height:nt}})}};return I.jsxs(I.Fragment,{children:[I.jsx(Gl,{ref:m,x:E.x,y:E.y,...Jf(A,t,e,i,l,c,s),onTransformEnd:f?O:void 0,children:I.jsx(zH,{x,y:R,radiusX:x,radiusY:R,fill:"transparent",stroke:i?"#4f46e5":"black",strokeWidth:i?3:2,perfectDrawEnabled:!1})}),i&&f&&I.jsx(Qm,{ref:g,rotateEnabled:!1,boundBoxFunc:(M,H)=>Math.abs(H.width)<on||Math.abs(H.height)<on?M:H})]})}function nG({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c,onObjectResizeEnd:f}){const m=j.useRef(null),g=j.useRef(null),{objectId:A,position:E,dimensions:T}=n,x=[0,T.height,T.width/2,0,T.width,T.height];j.useEffect(()=>{i&&f&&g.current&&m.current&&g.current.nodes([m.current])},[i,f]);const R=()=>{const O=m.current;if(!O||!f)return;const M=O.scaleX(),H=O.scaleY();O.scaleX(1),O.scaleY(1);const B=O.findOne("Line");if(B){const Y=Math.max(on,T.width*M),$=Math.max(on,T.height*H),nt=[0,$,Y/2,0,Y,$];B.points(nt),f(A,{position:{x:O.x(),y:O.y()},dimensions:{width:Y,height:$}})}};return I.jsxs(I.Fragment,{children:[I.jsx(Gl,{ref:m,x:E.x,y:E.y,...Jf(A,t,e,i,l,c,s),onTransformEnd:f?R:void 0,children:I.jsx(gw,{points:x,fill:"transparent",stroke:i?"#4f46e5":"black",strokeWidth:i?3:2,closed:!0,perfectDrawEnabled:!1})}),i&&f&&I.jsx(Qm,{ref:g,rotateEnabled:!1,boundBoxFunc:(O,M)=>Math.abs(M.width)<on||Math.abs(M.height)<on?O:M})]})}function iG({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c,onObjectResizeEnd:f}){const m=j.useRef(null),g=j.useRef(null),{objectId:A,start:E,end:T,strokeColor:x,strokeWidth:R}=n,O=Math.min(E.x,T.x),M=Math.min(E.y,T.y),H=Math.abs(T.x-E.x)||on,B=Math.abs(T.y-E.y)||on,Y=Math.max(H,xy),$=Math.max(B,xy),nt=[E.x-O,E.y-M,T.x-O,T.y-M];j.useEffect(()=>{i&&f&&g.current&&m.current&&g.current.nodes([m.current])},[i,f]);const X=()=>{const L=m.current;if(!L||!f)return;const k=L.scaleX(),V=L.scaleY();L.scaleX(1),L.scaleY(1);const q={x:L.x(),y:L.y()},Q=T.x>=E.x?1:-1,F=T.y>=E.y?1:-1;let G=Y*k*Q,Ot=$*V*F;Math.abs(G)<on&&Math.abs(Ot)<on&&(G=H>=B?Q*on:0,Ot=H>=B?0:F*on);const Vt={x:q.x+G,y:q.y+Ot},tt=Math.abs(G)||on,At=Math.abs(Ot)||on,yt=L.findOne("Rect");yt&&(yt.width(Math.max(tt,xy)),yt.height(Math.max(At,xy)));const Mt=L.findOne("Line");Mt&&(Mt.points([0,0,G,Ot]),f(A,{start:q,end:Vt}))};return I.jsxs(I.Fragment,{children:[I.jsxs(Gl,{ref:m,x:O,y:M,...Jf(A,t,e,i,l,c,s),onTransformEnd:f?X:void 0,children:[I.jsx(Bu,{width:Y,height:$,fill:"transparent",stroke:"transparent",listening:s,perfectDrawEnabled:!1}),I.jsx(gw,{points:nt,stroke:i?"#4f46e5":x??"#000",strokeWidth:i?3:R??2,perfectDrawEnabled:!1,listening:!1})]}),i&&f&&I.jsx(Qm,{ref:g,rotateEnabled:!1,anchorSize:12,anchorStrokeWidth:2,boundBoxFunc:(L,k)=>Math.abs(k.width)<on||Math.abs(k.height)<on?L:k})]})}function sG({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c,onObjectResizeEnd:f,onTextDoubleClick:m}){const g=j.useRef(null),A=j.useRef(null),{objectId:E,position:T,dimensions:x,content:R,textStyle:O}=n,M=O?.fontSize??16;j.useEffect(()=>{i&&f&&A.current&&g.current&&A.current.nodes([g.current])},[i,f]);const H=()=>{const B=g.current;if(!B||!f)return;const Y=B.scaleX(),$=B.scaleY();B.scaleX(1),B.scaleY(1);const nt=B.findOne("Rect");if(nt){const X=Math.max(on,nt.width()*Y),L=Math.max(on,nt.height()*$);nt.width(X),nt.height(L);const k=B.findOne("Text");k&&(k.width(X-8),k.height(L-8)),f(E,{position:{x:B.x(),y:B.y()},dimensions:{width:X,height:L}})}};return I.jsxs(I.Fragment,{children:[I.jsxs(Gl,{ref:g,x:T.x,y:T.y,...Jf(E,t,e,i,l,c,s),onDblClick:e?()=>m(E):void 0,onTransformEnd:f?H:void 0,children:[I.jsx(Bu,{width:x.width,height:x.height,fill:"transparent",stroke:i?"#4f46e5":"transparent",strokeWidth:i?3:1,perfectDrawEnabled:!1}),I.jsx(Dm,{x:4,y:4,width:x.width-8,height:x.height-8,text:R||"",fontSize:M,fontFamily:O?.fontFamily??"Arial",fill:R?O?.fontColor??"#1a1a1a":"#9ca3af",align:O?.textAlign??"left",verticalAlign:"top",padding:4,listening:!1,perfectDrawEnabled:!1})]}),i&&f&&I.jsx(Qm,{ref:A,rotateEnabled:!1,boundBoxFunc:(B,Y)=>Math.abs(Y.width)<on||Math.abs(Y.height)<on?B:Y})]})}function aG({obj:n,viewport:t,canEdit:e,selected:i,isPointerTool:s,onObjectDragEnd:l,onObjectClick:c}){const{objectId:f,position:m,emoji:g,fontSize:A=32}=n;return I.jsxs(Gl,{x:m.x,y:m.y,...Jf(f,t,e,i,l,c,s),children:[I.jsx(Dm,{text:g,fontSize:A,listening:!1,perfectDrawEnabled:!1}),i&&I.jsx(Bu,{x:-4,y:-4,width:A+8,height:A+8,stroke:"#4f46e5",strokeWidth:2,fill:"transparent",listening:!1,perfectDrawEnabled:!1})]})}const rG=5e3;function lG(n,t){return n?n.includes("@")?n.split("@")[0]:n:t.slice(0,8)}function oG({cursors:n,viewport:t,currentUserId:e}){const[i,s]=j.useState(()=>Date.now());j.useEffect(()=>{const c=setInterval(()=>s(Date.now()),500);return()=>clearInterval(c)},[]);const l=n.filter(c=>c.userId===e?!1:c.lastUpdated==null?!0:i-c.lastUpdated<rG);return I.jsx(mw,{listening:!1,children:l.map(c=>{const f=t.x+c.x*t.scale,m=t.y+c.y*t.scale;return I.jsxs(Gl,{x:f,y:m,children:[I.jsx(pw,{radius:6,fill:c.color,listening:!1}),I.jsx(Dm,{x:10,y:-6,text:lG(c.displayName,c.userId),fontSize:12,fontFamily:"Inter, system-ui, sans-serif",fill:"#1a1a1a",listening:!1})]},c.userId)})})}const uG=j.memo(oG);function cG(n){return n?n.includes("@")?n.split("@")[0]:n:"Anonymous"}function hG({comments:n,onCommentClick:t,isPointerTool:e}){return I.jsx(I.Fragment,{children:n.map(i=>{const s=cG(i.authorName),l=18,c=8,f=l+4+s.length*6+c*2,m=l+c*2;return I.jsxs(Gl,{x:i.position.x,y:i.position.y,listening:e,onClick:g=>{g.cancelBubble=!0,t(i)},onTap:g=>{g.cancelBubble=!0,t(i)},children:[I.jsx(Bu,{x:-c,y:-c,width:f,height:m,fill:"transparent",listening:!0}),I.jsx(Bu,{x:0,y:0,width:l,height:l,fill:"#fff",stroke:"#4f46e5",strokeWidth:1.5,cornerRadius:3,listening:!1}),I.jsx(Dm,{x:4,y:2,text:"T",fontSize:12,fontStyle:"bold",fill:"#4f46e5",listening:!1}),I.jsx(Dm,{x:l+4,y:2,text:s,fontSize:10,fill:"#374151",listening:!1})]},i.id)})})}const fG="/assets/ai-icon-q1BpoY3z.png",dG="/assets/pointer-icon-IPPLXpJe.png",mG="/assets/formats-icon-kYqTQfys.png",pG="/assets/sticky-icon-x5X3FZKq.png",gG="/assets/templates-icon-CnL5fU05.png",_G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAOxAAADsQBlSsOGwAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAA6/SURBVHic7d1bzGx3XcfhT8sGWqgcgkoVFJFDQQ6BEJBGPAAiES8MwSrxkBiNaDDGGCXeEokHYjSg4ULkoBgjYoIaE+QQKgaxCVgkcpY22krAIoFWWqBQWi+mBKht9+zd7vc/6/09T7Kyb7/zZjLrs9esmSkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAO8dZqwds2FnVo6unVU+sLqgeVN2juufCXQDH0XU3H1dWH67eWV1cvb+6aeGuzRIAp+6bq+dVP1V9++ItANNdXv1Z9cfVxxZv2RQBsL/zqxdWP13dfekSAG7p+upV7V6nP7F2yjbcZfWADTiren7119V3VSfWzgHgVpxo93bsz1VXV5eunXP4XAG4ffetXl398OohAJyS11c/U12zesihEgC37ZuqN1aPXT0EgNPygeqZ1UdXDzlEAuDWPaD6p+rbFu8A4I75j+opuUHw/zl79YADdN/qTTn5AxwHD67+vrr36iGHRgB8rbOqV1aPWj0EgDvNY6tXrB5xaHwK4Gs9v/rV1SMAuNN9R7u3Ad69esihcA/AV9y/+lB1n9VDADgjPl09It8TULkC8NV+r92NIgAcT+e2+7r2N6wecghcAdg5v92douesHgLAGfX56iH5VICbAG/2Czn5A0xwTvWzq0ccAlcAdn+Dj7QrQgCOv8uqhzf8VwRdAajH5OQPMMlDq0euHrGaAKinrh4AwJF72uoBqwmA3a9HATDL+Nd+AVAXrB4AwJEb/9ovAOpbVg8A4Mh96+oBqwmA+rrVAwA4cvdaPWA1HwOsG/N3AJjmpob/J9iJb/jnQAEGG30OHF0/ADCVAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMdGL1APb20eqS1SNY5oHVhatH7OmSds9XZrqw3fMVDt5NGzled6b+AGzCRa1/Du57XHSG/gZsw+ta/xzc9xjNWwAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAKgvrR6wp63sBGa7cfWAPY1/TRUAdd3qAXv6zOoBAHu4dvWAPY1/TRUAdfXqAXvayk5gtq28Vm1l5xkjAOry1QP2dNnqAQB78Jq6EQKgPrB6wJ4+tHoAwB4+uHrAnray84wRAPWO1QP28PnqXatHAOzhndX1q0fs4e2rB6wmAOriDv+u1X+uPrd6BMAePltdsnrESXypetvqEasJgLqqw38ivHb1AIBT8LrVA07i4up/Vo9YTQDs/OnqAbfjs9VfrR4BcAr+ssO+annIr/lHRgDs/EV1xeoRt+Hl+bgKsC2fql61esRtuDL/qaoEwJd9sXrx6hG34rrqd1ePADgNL+4wrwK8qPrC6hGHQAB8xcurf1094hZeVH1s9QiA0/Bf1W+vHnELl1avXj2Cw/SEdh+5u+kAjn+p7nZmHy4bclHrn5P7Hhedob8B23P3dv+xWv2cvKnd1YjHndmHuy2uAHytS6sXrB5RXVP9WC5TAdt2fbvXskP43v1fqd6zegSH7yWtq9Trqx848w+RjXEFgC17Wmuvrr7szD9Ejouzq9e05uT/nCN4fGyPAGDrLmr3GnfUz8c/ydVuTtFZ7e7AP6on6dXV04/kkbFFAoDj4Bnt3uI8qufi77R7LYfT8uzq053ZJ+ml1UOP6gGxSQKA4+JhnfkbA/+3eu5RPSCOtwd0Zt4SuK56Ybs7ZeH2CACOk7tWv9zu5sA7+/n3d9WDju6hMMX3Vm/pzjnxv6RdWMA+BADH0QOrP2j3led39Hn3puq7j3Y+Ez2y+q3q/e3/5Pxc9dbqedV9jn4yGycAOM7uW/18ux/pOZVPC7yv+s3qEUc/efvcHHHHnV89sbqg3WWn86p7trtv4Jrq8uqD1bs6zK/FZBsu6vB/Ye3LfjTftc7pO7d6UruT+kOre7ULhOvavWVwZfXhdq+p/71oI8CRcQUAuFP5bCQADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAwkAABgIAEAAAMJAAAYSAAAwEACAAAGEgAAMJAAAICBBAAADCQAAGAgAQAAAwkAABhIAADAQAIAAAYSAAAwkAAAgIEEAAAMJAAAYCABAAADCQAAGEgAAMBAAgAABhIAADCQAACAgQQAAAx01uoBcETOrh5z83FB9Y3VedVdV446BQ+sLlw9Yk+XVB9dPWJPX6yura6qPly9t3pfdePKUXAUBADH2YnqmdVPVs+o7rd2DhvxyerN1Z/f/O8Na+cAsK9zq1+qrqhucjjuwPGf1S9W5wTAQXt69aHWnzgcx+u4rHpWABycc6qXtv5E4Tjex2uqewTHgHsAOA7Or95QPX71EEa4tPqhdjcOwmYJALbuQdVbq4esHsIol7V7u+nK1UPgdAkAtuzrq7dXj1g9hJE+Uj2l+sTqIXA6fBEQW3Wien1O/qzzsOq11V1WD4HT4YnLVv1Gu8/3w0oPbndz4NsW74BT5i0AtujR1bvbzrf4cbzdUD2h+rfVQ+BUeAuALXpZTv4cjhPV768eAafKFQC25vuqf1g9Am7F97S7KRU2wRUAtubXVg+A2/CC1QPgVLgCwJbcv92vzJ1YPQRuxQ3tfrXRFwSxCa4AsCU/kpM/h+tE9ezVI2BfAoAtefrqAXASnqNshrcA2JJPVN+wegTcjqva/TYFHDwBwFbcr/rk6hGwh/tVn1o9Ak7GWwBsxUNXD4A9+WEqNkEAsBX3WT0A9uS5yiYIALbiHqsHwJ7OWz0A9iEA2IovrB4Ae/r86gGwDwHAVnxm9QDYk+cqmyAA2IorVw+APV2xegDsw8cA2Yqzq2urc1cPgdvx2Xb3ANy0egicjCsAbMWN1aWrR8BJvCsnfzZCALAlF68eACfhp6rZDAHAlvzt6gFwEn+zegDsyz0AbM37qketHgG34r3VY1ePgH25AsDW/OHqAXAbXrp6AJwKVwDYmrtXl1cPWD0EvsoV1cPzhVVsiCsAbM311a+vHgG38IKc/NkYVwDYorOqN1ffv3oIVG+sfnD1CDhVAoCtun/1nur81UMY7arq8dXHVw+BU+UtALbqquq5+eEV1vlc9Zyc/NkoAcCW/WP1E9UNq4cwzherH6/esXoIwGTPaPcLbDc5HEdwXFs9KwAOwhOqy1p/cnAc7+Pfq8cFwEG5d/WKdj8ctPpE4Thex5eqP6ruFQAH68ntfjho9UnDcTyOt1RPCoDNeHL1yuqa1p9EHNs6rm53Nek7g2PK9wAwwTnVhdVTq0dXF7T7/oDzqrst3MV6X2h3U9/H272//952P+l7SbtvnQQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATuL/ANILJbw2b9d5AAAAAElFTkSuQmCC",yG="/assets/shapes-icon-BpiwLWZS.png",vG="/assets/emoji-icon-DGWSzL21.png",AG="/assets/comment-icon-D2tnyNZ6.png",EG="/assets/link-icon-BaLUL97h.png",SG="/assets/redo-icon-B46labgb.png",TG="/assets/undo-icon-i2DOfIDT.png",bG="/assets/pencil-icon-D_gGFYx7.png";function CG({activeTool:n,onToolSelect:t,onEmojiSelect:e,onUndo:i,onRedo:s,canEdit:l}){const[c,f]=j.useState(!1),[m,g]=j.useState(!1),[A,E]=j.useState(!1),[T,x]=j.useState(!1),[R,O]=j.useState(!1),M=j.useRef(null),H=j.useRef(null),B=j.useRef(null),Y=j.useRef(null),$=j.useRef(null),nt=()=>{f(!1),g(!1),E(!1),x(!1),O(!1)};j.useEffect(()=>{function L(k){M.current?.contains(k.target)||H.current?.contains(k.target)||B.current?.contains(k.target)||Y.current?.contains(k.target)||$.current?.contains(k.target)||nt()}return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]);const X=["rectangle","circle","triangle","line"];return I.jsxs("div",{className:"whiteboard-toolbar",children:[I.jsx("span",{className:"toolbar-icon-wrap",title:"AI Template Generator - Coming Soon",children:I.jsx("button",{type:"button",className:"toolbar-icon-btn disabled",disabled:!0,children:I.jsx("img",{src:fG,alt:"AI",width:20,height:20})})}),I.jsx("button",{type:"button",className:`toolbar-icon-btn ${n==="pointer"?"active":""}`,onClick:()=>{nt(),t("pointer")},title:"Select",children:I.jsx("img",{src:dG,alt:"Select",width:20,height:20})}),I.jsxs("div",{className:"toolbar-dropdown",ref:M,children:[I.jsx("button",{type:"button",className:"toolbar-icon-btn",onClick:()=>{nt(),f(L=>!L)},title:"Formats & Flows",children:I.jsx("img",{src:mG,alt:"Formats & Flows",width:20,height:20})}),c&&I.jsxs("div",{className:"toolbar-dropdown-panel",children:[I.jsx("p",{className:"toolbar-coming-soon",children:"Coming Soon"}),I.jsx("p",{className:"toolbar-dropdown-hint",children:"Doc, Slides, Table, Timeline, Kanban, Flow Chart"})]})]}),I.jsxs("div",{className:"toolbar-dropdown",ref:H,children:[I.jsx("button",{type:"button",className:"toolbar-icon-btn",onClick:()=>{nt(),g(L=>!L)},title:"Templates",children:I.jsx("img",{src:gG,alt:"Templates",width:20,height:20})}),m&&I.jsx("div",{className:"toolbar-dropdown-panel",children:I.jsx("p",{className:"toolbar-coming-soon",children:"Templates Coming Soon"})})]}),I.jsx("button",{type:"button",className:`toolbar-icon-btn ${n==="sticky"?"active":""}`,onClick:()=>{nt(),t("sticky")},disabled:!l,title:"Sticky Note",children:I.jsx("img",{src:pG,alt:"Sticky Note",width:20,height:20})}),I.jsx("button",{type:"button",className:`toolbar-icon-btn ${n==="text"?"active":""}`,onClick:()=>{nt(),t(n==="text"?"pointer":"text")},disabled:!l,title:"Text Box",children:I.jsx("img",{src:_G,alt:"Text Box",width:20,height:20})}),I.jsxs("div",{className:"toolbar-dropdown",ref:B,children:[I.jsx("button",{type:"button",className:`toolbar-icon-btn ${X.includes(n)?"active":""}`,onClick:()=>{nt(),E(L=>!L)},disabled:!l,title:"Shapes",children:I.jsx("img",{src:yG,alt:"Shapes",width:20,height:20})}),A&&I.jsx("div",{className:"toolbar-dropdown-panel",children:X.map(L=>I.jsx("button",{type:"button",className:"toolbar-dropdown-item",onClick:()=>{t(L),E(!1)},children:L.charAt(0).toUpperCase()+L.slice(1)},L))})]}),I.jsxs("div",{className:"toolbar-dropdown",ref:Y,children:[I.jsx("button",{type:"button",className:`toolbar-icon-btn ${n==="pen"?"active":""}`,onClick:()=>{nt(),x(L=>!L),T||t("pen")},disabled:!l,title:"Pen",children:I.jsx("img",{src:bG,alt:"Pen",width:20,height:20})}),T&&I.jsxs("div",{className:"toolbar-dropdown-panel",children:[I.jsx("button",{type:"button",className:"toolbar-dropdown-item",disabled:!0,children:"Pen (Coming Soon)"}),I.jsx("button",{type:"button",className:"toolbar-dropdown-item",disabled:!0,children:"Highlighter (Coming Soon)"}),I.jsx("button",{type:"button",className:"toolbar-dropdown-item",disabled:!0,children:"Eraser (Coming Soon)"}),I.jsx("button",{type:"button",className:"toolbar-dropdown-item",disabled:!0,children:"Lasso (Coming Soon)"})]})]}),I.jsxs("div",{className:"toolbar-dropdown",ref:$,children:[I.jsx("button",{type:"button",className:`toolbar-icon-btn ${n==="emoji"?"active":""}`,onClick:()=>{nt(),O(L=>!L)},disabled:!l,title:"Stickers / Emojis",children:I.jsx("img",{src:vG,alt:"Stickers / Emojis",width:20,height:20})}),R&&I.jsxs("div",{className:"toolbar-dropdown-panel toolbar-emoji-panel",children:[I.jsx("p",{className:"toolbar-coming-soon",children:"Emoji Picker Coming Soon"}),I.jsx("div",{className:"toolbar-emoji-preview",children:["","","","",""].map(L=>I.jsx("button",{type:"button",className:"toolbar-emoji-btn",onClick:()=>{t("emoji"),e?.(L),O(!1)},title:`Place ${L}`,children:L},L))})]})]}),I.jsx("button",{type:"button",className:`toolbar-icon-btn ${n==="comment"?"active":""}`,onClick:()=>{nt(),t("comment")},disabled:!l,title:"Comment",children:I.jsx("img",{src:AG,alt:"Comment",width:20,height:20})}),I.jsx("span",{className:"toolbar-icon-wrap",title:"Upload - Coming Soon",children:I.jsx("button",{type:"button",className:"toolbar-icon-btn disabled",disabled:!0,children:I.jsx("img",{src:EG,alt:"Upload",width:20,height:20})})}),I.jsx("div",{className:"toolbar-divider"}),I.jsx("button",{type:"button",className:"toolbar-icon-btn",title:"Undo (Z)",onClick:()=>i?.(),disabled:!l,children:I.jsx("img",{src:TG,alt:"Undo",width:20,height:20})}),I.jsx("button",{type:"button",className:"toolbar-icon-btn",title:"Redo (Z)",onClick:()=>s?.(),disabled:!l,children:I.jsx("img",{src:SG,alt:"Redo",width:20,height:20})})]})}const wG="/assets/reaction-icon-BOtQgXzF.png",RG="/assets/share-icon-ko8Xib63.png";function xG({boardName:n,onBoardNameChange:t,onShareClick:e,canEdit:i,canShare:s,publicAccess:l="none"}){const[c,f]=j.useState(!1),[m,g]=j.useState(n),A=j.useRef(null),[E,T]=j.useState(!1),x=j.useRef(null);j.useEffect(()=>{g(n)},[n]),j.useEffect(()=>{c&&A.current?.focus()},[c]),j.useEffect(()=>{function O(M){x.current?.contains(M.target)||T(!1)}return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const R=["","","","","",""];return I.jsxs(I.Fragment,{children:[I.jsxs("nav",{className:"whiteboard-nav-left",children:[I.jsx(rE,{to:"/dashboard",className:"whiteboard-nav-brand",children:"Vellum"}),I.jsxs("div",{className:"whiteboard-nav-board-name",children:[(l==="view"||l==="edit")&&I.jsx("span",{className:"whiteboard-nav-public-badge",title:l==="edit"?"Anyone with the link can edit":"Anyone with the link can view",children:"Public"}),c&&i?I.jsx("input",{ref:A,type:"text",value:m,onChange:O=>g(O.target.value),onBlur:()=>{f(!1);const O=m.trim();O&&O!==n&&t?.(O)},onKeyDown:O=>{if(O.key==="Enter"){f(!1);const M=m.trim();M&&M!==n&&t?.(M)}},className:"whiteboard-nav-name-input"}):I.jsx("button",{type:"button",className:"whiteboard-nav-name-btn",onClick:()=>i&&f(!0),children:n||"Untitled Board"})]})]}),I.jsxs("nav",{className:"whiteboard-nav-right",children:[I.jsxs("div",{className:"whiteboard-nav-reactions",ref:x,children:[I.jsx("button",{type:"button",className:"whiteboard-nav-btn",onClick:()=>T(O=>!O),title:"Reactions",children:I.jsx("img",{src:wG,alt:"Reactions",width:20,height:20})}),E&&I.jsxs("div",{className:"whiteboard-nav-reactions-panel",children:[I.jsx("p",{className:"whiteboard-nav-reactions-label",children:"Quick reactions"}),I.jsx("div",{className:"whiteboard-nav-reactions-grid",children:R.map(O=>I.jsx("button",{type:"button",className:"whiteboard-nav-emoji-btn",onClick:()=>T(!1),children:O},O))}),I.jsx("p",{className:"whiteboard-nav-coming-soon",children:"Stickers, Timer, Voting - Coming Soon"})]})]}),s&&I.jsxs("button",{type:"button",className:"whiteboard-nav-btn whiteboard-nav-share",onClick:e,title:"Share",children:[I.jsx("img",{src:RG,alt:"",width:20,height:20}),"Share"]})]})]})}const NG="/assets/grid-icon-7S24i3vX.png";function DG({showGrid:n,onGridToggle:t,zoom:e,onZoomIn:i,onZoomOut:s}){const l=Math.round(e*100);return I.jsxs("div",{className:"whiteboard-controls",children:[I.jsx("button",{type:"button",className:`whiteboard-control-btn ${n?"active":""}`,onClick:t,title:n?"Hide grid":"Show grid",children:I.jsx("img",{src:NG,alt:"",width:18,height:18})}),I.jsxs("div",{className:"whiteboard-zoom",children:[I.jsx("button",{type:"button",className:"whiteboard-zoom-btn",onClick:s,title:"Zoom out",disabled:l<=10,"aria-label":"Zoom out",children:""}),I.jsxs("span",{className:"whiteboard-zoom-value",children:[l,"%"]}),I.jsx("button",{type:"button",className:"whiteboard-zoom-btn",onClick:i,title:"Zoom in",disabled:l>=400,"aria-label":"Zoom in",children:"+"})]})]})}function IG({sticky:n,viewport:t,onSave:e,onCancel:i}){const s=j.useRef(null),{x:l,y:c}=t4(n.position.x,n.position.y,t),f=n.dimensions.width*t.scale,m=n.dimensions.height*t.scale;return j.useEffect(()=>{s.current?.focus(),s.current?.select()},[]),I.jsx("div",{style:{position:"absolute",left:l,top:c,width:f,height:m,zIndex:1e3,padding:4,boxSizing:"border-box"},children:I.jsx("textarea",{ref:s,defaultValue:n.content,onBlur:g=>e(g.target.value),onKeyDown:g=>{g.key==="Escape"&&i()},style:{width:"100%",height:"100%",padding:8,margin:0,border:"2px solid #4f46e5",borderRadius:4,fontSize:n.textStyle.fontSize,fontFamily:n.textStyle.fontFamily,color:n.textStyle.fontColor,fontWeight:n.textStyle.bold?"bold":"normal",fontStyle:n.textStyle.italic?"italic":"normal",textAlign:n.textStyle.textAlign,resize:"none",outline:"none",background:n.fillColor,boxSizing:"border-box"}})})}function OG({editingText:n,onCommit:t,onCancel:e}){const i=j.useRef(null);j.useEffect(()=>{i.current?.focus()},[]);const s=c=>{if(c.key==="Escape"){c.preventDefault(),e();return}(c.metaKey||c.ctrlKey)&&c.key==="Enter"&&(c.preventDefault(),t(i.current?.value??""))},l=()=>{t(i.current?.value??"")};return I.jsx("textarea",{ref:i,defaultValue:n.value,placeholder:"Text",onBlur:l,onKeyDown:s,style:{position:"fixed",left:n.screenX,top:n.screenY,width:"200px",minHeight:"40px",fontSize:"16px",fontFamily:"Arial, sans-serif",padding:8,margin:0,border:"2px solid #4f46e5",borderRadius:4,resize:"none",outline:"none",background:"#fff",boxSizing:"border-box",zIndex:1e3}})}function MG({position:n,viewport:t,canvasWidth:e,canvasHeight:i,containerRef:s,onSave:l,onCancel:c}){const[f,m]=j.useState(""),g=j.useRef(null);if(j.useEffect(()=>{m("")},[n]),j.useEffect(()=>{g.current?.focus()},[n]),!n)return null;const{x:A,y:E}=t4(n.x,n.y,t),T=s.current?.getBoundingClientRect(),x=T?T.left+A:A,R=T?T.top+E:E,O=12,M=T?T.left+e:e,H=T?T.top+i:i;let B=x+O,Y=R;return B+280>M&&(B=x-280-O),Y+180>H&&(Y=H-180),Y<8&&(Y=8),I.jsx("div",{className:"comment-modal-overlay",onClick:$=>$.target===$.currentTarget&&c(),children:I.jsxs("div",{className:"comment-modal comment-modal-inline",style:{left:B,top:Y},onClick:$=>$.stopPropagation(),children:[I.jsx("h3",{children:"Add Comment"}),I.jsx("textarea",{ref:g,value:f,onChange:$=>m($.target.value),placeholder:"Write a comment...",rows:3}),I.jsxs("div",{className:"comment-modal-actions",children:[I.jsx("button",{type:"button",className:"comment-btn-cancel",onClick:c,children:"Cancel"}),I.jsx("button",{type:"button",className:"comment-btn-save",onClick:()=>{const $=f.trim();$&&l($),c()},disabled:!f.trim(),children:"Done"})]})]})})}const yw=(...n)=>n.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();const LG=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const kG=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase());const rC=n=>{const t=kG(n);return t.charAt(0).toUpperCase()+t.slice(1)};var PG={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const VG=n=>{for(const t in n)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const UG=j.forwardRef(({color:n="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:s="",children:l,iconNode:c,...f},m)=>j.createElement("svg",{ref:m,...PG,width:t,height:t,stroke:n,strokeWidth:i?Number(e)*24/Number(t):e,className:yw("lucide",s),...!l&&!VG(f)&&{"aria-hidden":"true"},...f},[...c.map(([g,A])=>j.createElement(g,A)),...Array.isArray(l)?l:[l]]));const zG=(n,t)=>{const e=j.forwardRef(({className:i,...s},l)=>j.createElement(UG,{ref:l,iconNode:t,className:yw(`lucide-${LG(rC(n))}`,`lucide-${n}`,i),...s}));return e.displayName=rC(n),e};const BG=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],jG=zG("trash-2",BG);function HG({comment:n,currentUserId:t,onReply:e,onDelete:i,onClose:s}){const[l,c]=j.useState("");if(!n)return null;const f=t!=null&&n.authorId===t,m=()=>{const g=l.trim();g&&(e(g),c(""))};return I.jsx("div",{className:"comment-thread-overlay",onClick:g=>g.target===g.currentTarget&&s(),children:I.jsxs("div",{className:"comment-thread-modal",children:[I.jsxs("div",{className:"comment-thread-header",children:[I.jsx("h3",{children:"Comment"}),I.jsxs("div",{className:"comment-thread-header-actions",children:[f&&i&&I.jsx("button",{type:"button",className:"comment-btn-delete",onClick:i,title:"Delete comment","aria-label":"Delete comment",children:I.jsx(jG,{size:18})}),I.jsx("button",{type:"button",className:"comment-btn-done",onClick:s,children:"Done"})]})]}),I.jsxs("div",{className:"comment-thread-main",children:[I.jsx("div",{className:"comment-thread-author",children:n.authorName||"Anonymous"}),I.jsx("p",{className:"comment-thread-text",children:n.text})]}),n.replies.length>0&&I.jsx("div",{className:"comment-thread-replies",children:n.replies.map((g,A)=>I.jsxs("div",{className:"comment-thread-reply",children:[I.jsx("span",{className:"comment-thread-reply-author",children:g.authorName||"Anonymous"}),I.jsx("p",{children:g.text})]},A))}),I.jsxs("div",{className:"comment-thread-input",children:[I.jsx("textarea",{value:l,onChange:g=>c(g.target.value),placeholder:"Write a reply...",rows:2}),I.jsx("button",{type:"button",className:"comment-btn-reply",onClick:m,disabled:!l.trim(),children:"Reply"})]})]})})}function GG(){const{boardId:n}=qR(),t=zf(),{user:e}=BS(),i=j.useRef(null),[s,l]=j.useState(null),[c,f]=j.useState(!1),[m,g]=j.useState(null),[A,E]=j.useState(!0),[T,x]=j.useState(!1),[R,O]=j.useState({}),[M,H]=j.useState([]),[,B]=j.useState([]),[Y,$]=j.useState([]),[nt,X]=j.useState({x:0,y:0,scale:1}),[L,k]=j.useState("pointer"),[V,q]=j.useState(new Set),[Q,F]=j.useState(null),[G,Ot]=j.useState(null),[Vt,tt]=j.useState(!1),[At,yt]=j.useState(null),[Mt,Qt]=j.useState(null),[W,ft]=j.useState(null),[bt,Ft]=j.useState(()=>{try{const ht=localStorage.getItem("vellum:showGrid");return ht===null?!0:ht==="true"}catch{return!0}}),[qt,re]=j.useState(()=>({width:typeof window<"u"?window.innerWidth:800,height:typeof window<"u"?window.innerHeight:600})),ne=j.useRef([]),qe=j.useRef([]),De=j.useRef(!1),bi=j.useRef(!1),ea=j.useRef(nt);ea.current=nt;const Nt=n??"";j.useEffect(()=>{if(!Nt)return;let ht=!1;return jU(Nt).then(St=>{ht||!St||(ne.current=St.undoStack,qe.current=St.redoStack)}),()=>{ht=!0}},[Nt]),j.useEffect(()=>{if(!Nt||!e)return;const ht=e.uid;let St=!1;async function jt(){try{const Bt=await zu(Nt);if(St)return;if(!Bt){f(!0),l(null),g(null);return}if(Bt.ownerId===ht){l(Bt),f(!1),g(null);const Pn=await UA(Nt);St||x(Pn);return}const Jt=await qS(Nt);if(St)return;if(Jt===null){const Pn=await AU(Nt);if(St)return;Pn?(l(Bt),g(Pn),f(!1)):(f(!0),l(Bt),g(null));return}l(Bt),f(!1),g(null);const Xe=await UA(Nt);St||x(Xe)}catch(Bt){St||(console.error("[BoardPage] load error:",Bt),f(!0),l(null),g(null))}finally{St||E(!1)}}return jt(),()=>{St=!0}},[Nt,e?.uid]),j.useEffect(()=>{!Nt||!e||HU(Nt)},[Nt,e]),j.useEffect(()=>{if(!(!Nt||!e)&&i.current){const ht=(qt.width/2-nt.x)/nt.scale,St=(qt.height/2-nt.y)/nt.scale;w3(Nt,ht,St)}},[Nt,e,qt,nt]),j.useEffect(()=>Nt?OU(Nt,O):void 0,[Nt]),j.useEffect(()=>Nt?UU(Nt,H):void 0,[Nt]),j.useEffect(()=>Nt?GU(Nt,B):void 0,[Nt]);const Zi=j.useRef([]),$i=j.useCallback(ht=>{const St=Zi.current;if(St.length!==ht.length){Zi.current=ht,$(ht);return}const jt=St.map(Jt=>`${Jt.userId}:${Jt.x.toFixed(0)}:${Jt.y.toFixed(0)}`).sort().join("|"),Bt=ht.map(Jt=>`${Jt.userId}:${Jt.x.toFixed(0)}:${Jt.y.toFixed(0)}`).sort().join("|");jt!==Bt&&(Zi.current=ht,$(ht))},[]);j.useEffect(()=>Nt?qU(Nt,$i):void 0,[Nt,$i]),j.useEffect(()=>{const ht=i.current;if(!ht)return;const St=()=>re({width:window.innerWidth,height:window.innerHeight}),jt=new ResizeObserver(Bt=>{const Jt=Bt[0]?.contentRect;Jt?.width&&Jt?.height?re({width:Jt.width,height:Jt.height}):St()});return jt.observe(ht),window.addEventListener("resize",St),St(),()=>{jt.disconnect(),window.removeEventListener("resize",St)}},[]);const Ze=j.useCallback(ht=>{ne.current=ne.current.slice(-99).concat(ht),qe.current=[],Nt&&N2(Nt,ne.current,qe.current)},[Nt]),Bi=j.useCallback(async()=>{const ht=ne.current.pop();if(!(!ht||!Nt||!T))try{if(ht.type==="create")await x2(Nt,ht.objectId),qe.current.push(ht);else if(ht.type==="update")await Sf(Nt,ht.objectId,ht.from),qe.current.push({...ht,from:ht.to,to:ht.from});else if(ht.type==="delete"){const St=MU(ht.deleted);await LU(Nt,ht.objectId,St),qe.current.push(ht)}else if(ht.type==="deleteComment"){const{id:St,boardId:jt,...Bt}=ht.deleted;await VU(Nt,ht.commentId,Bt),qe.current.push(ht)}N2(Nt,ne.current,qe.current)}catch(St){console.error("[undo]",St),ne.current.push(ht)}},[Nt,T]),ds=j.useCallback(async()=>{const ht=qe.current.pop();if(!(!ht||!Nt||!T))try{if(ht.type==="create"){const St=await _y(Nt,ht.createInput);ne.current.push({...ht,objectId:St})}else ht.type==="update"?(await Sf(Nt,ht.objectId,ht.to),ne.current.push({...ht,from:ht.to,to:ht.from})):ht.type==="delete"?(await x2(Nt,ht.objectId),ne.current.push(ht)):ht.type==="deleteComment"&&(await S3(Nt,ht.commentId),ne.current.push(ht));N2(Nt,ne.current,qe.current)}catch(St){console.error("[redo]",St),qe.current.push(ht)}},[Nt,T]);j.useEffect(()=>{const ht=St=>{St.key==="Escape"&&(k("pointer"),q(new Set),yt(null),Qt(null)),(St.key==="Delete"||St.key==="Backspace")&&V.size>0&&T&&(St.preventDefault(),V.forEach(jt=>{const Bt=R[jt];Bt&&Ze({type:"delete",objectId:jt,deleted:Bt}),x2(Nt,jt)}),q(new Set)),(St.metaKey||St.ctrlKey)&&St.key==="z"&&(St.preventDefault(),St.shiftKey?ds():Bi())};return window.addEventListener("keydown",ht),()=>window.removeEventListener("keydown",ht)},[Nt,T,V,R,Ze,Bi,ds]);const ql=j.useMemo(()=>I.jsx(uG,{cursors:Y,viewport:nt,currentUserId:e?.uid??""}),[Y,nt,e?.uid]),Ka=j.useRef(0),Ls=100,Wa=j.useCallback(ht=>{if(!Nt||G!=null)return;const St=Date.now();if(St-Ka.current<Ls)return;Ka.current=St;const jt=ht.target.getStage();if(!jt?.getPointerPosition)return;const Bt=jt.getPointerPosition();if(!Bt)return;const Jt=ea.current,Xe=(Bt.x-Jt.x)/Jt.scale,Pn=(Bt.y-Jt.y)/Jt.scale;w3(Nt,Xe,Pn)},[Nt,G]),ks=j.useCallback(()=>{const ht=qt.width,St=qt.height;return{x:(ht/2-nt.x)/nt.scale,y:(St/2-nt.y)/nt.scale}},[qt,nt]),Ln=j.useCallback(async(ht,St,jt)=>{if(!Nt||!T)return;const Bt=R[ht];if(Bt){if(Bt.type==="line"){const Jt=Bt,Xe=Math.min(Jt.start.x,Jt.end.x),Pn=Math.min(Jt.start.y,Jt.end.y),ts=St-Xe,Vn=jt-Pn,ya={start:{x:Jt.start.x+ts,y:Jt.start.y+Vn},end:{x:Jt.end.x+ts,y:Jt.end.y+Vn}};Ze({type:"update",objectId:ht,from:{start:Jt.start,end:Jt.end},to:ya}),await Sf(Nt,ht,ya)}else if("position"in Bt){const Jt={position:Bt.position},Xe={position:{x:St,y:jt}};Ze({type:"update",objectId:ht,from:Jt,to:Xe}),O(Pn=>{const ts=Pn[ht];return!ts||!("position"in ts)?Pn:{...Pn,[ht]:{...ts,position:{x:St,y:jt}}}}),await Sf(Nt,ht,Xe)}}},[Nt,T,R,Ze]),Qn=j.useCallback((ht,St)=>{q(jt=>{const Bt=new Set(jt);if(St.ctrlKey)Bt.has(ht)?Bt.delete(ht):Bt.add(ht);else return new Set([ht]);return Bt})},[]),Vo=j.useCallback(async(ht,St)=>{if(!Nt||!T)return;const jt=R[ht];if(!jt)return;const Bt="start"in St?{start:jt.start,end:jt.end}:{position:jt.position,dimensions:jt.dimensions};Ze({type:"update",objectId:ht,from:Bt,to:St}),O(Jt=>{const Xe=Jt[ht];return Xe?"start"in St?{...Jt,[ht]:{...Xe,start:St.start,end:St.end}}:{...Jt,[ht]:{...Xe,position:St.position,dimensions:St.dimensions}}:Jt}),await Sf(Nt,ht,St)},[Nt,T,R,Ze]),kn=j.useCallback(async ht=>{if(L==="pointer"&&(De.current||bi.current)){De.current=!1,bi.current=!1,k("pointer"),q(new Set);return}if(Q||G){F(null),Ot(null),k("pointer"),q(new Set);return}q(new Set);const{x:St,y:jt}=ht;if(L==="comment"&&T&&yt({x:St,y:jt}),L==="text"&&T){const{clientX:Bt,clientY:Jt}=ht;Bt!=null&&Jt!=null&&Ot({id:null,screenX:Bt,screenY:Jt,canvasX:St,canvasY:jt,value:"",isNew:!0})}else if((L==="sticky"||L==="rectangle"||L==="circle"||L==="triangle"||L==="line")&&T){let Bt=null;if(L==="sticky"?Bt={type:"sticky",position:{x:St-100,y:jt-100},dimensions:{width:200,height:200},fillColor:"#fef08a"}:L==="rectangle"?Bt={type:"rectangle",position:{x:St-75,y:jt-50},dimensions:{width:150,height:100}}:L==="circle"?Bt={type:"circle",position:{x:St-50,y:jt-50},dimensions:{width:100,height:100}}:L==="triangle"?Bt={type:"triangle",position:{x:St-50,y:jt-40},dimensions:{width:100,height:80}}:L==="line"&&(Bt={type:"line",start:{x:St-50,y:jt},end:{x:St+50,y:jt}}),Bt){const Jt=await _y(Nt,Bt);Ze({type:"create",objectId:Jt,createInput:Bt})}}if(L==="emoji"&&T){const Bt=W??"",Jt={type:"emoji",position:{x:St-16,y:jt-16},emoji:Bt},Xe=await _y(Nt,Jt);Ze({type:"create",objectId:Xe,createInput:Jt})}},[Nt,L,T,W,Ze,Q,G]),Cn=j.useCallback(ht=>{T&&F(ht)},[T]),Ps=j.useCallback(ht=>{if(!T)return;const St=R[ht];if(!St||St.type!=="text")return;const jt=t4(St.position.x,St.position.y,nt),Bt=i.current?.getBoundingClientRect(),Jt=Bt?Bt.left+jt.x:jt.x,Xe=Bt?Bt.top+jt.y:jt.y;Ot({id:ht,screenX:Jt,screenY:Xe,canvasX:St.position.x,canvasY:St.position.y,value:St.content??"",isNew:!1})},[T,R,nt]),ms=j.useCallback(async(ht,St)=>{if(!Nt||!T)return;const jt=R[ht],Bt=jt&&jt.type==="sticky"?jt.content:"";Ze({type:"update",objectId:ht,from:{content:Bt},to:{content:St}}),await Sf(Nt,ht,{content:St}),De.current=!0,F(null)},[Nt,T,R,Ze]),_a=j.useCallback(async ht=>{if(!Nt||!T||!G)return;const St=ht.trim();if(G.isNew){if(St===""){Ot(null),bi.current=!0,k("pointer");return}const jt={type:"text",position:{x:G.canvasX,y:G.canvasY},dimensions:{width:200,height:40},content:St},Bt=await _y(Nt,jt);Ze({type:"create",objectId:Bt,createInput:jt})}else{const jt=G.id,Bt=R[jt],Jt=Bt&&Bt.type==="text"?Bt.content:"",Xe=St;Ze({type:"update",objectId:jt,from:{content:Jt},to:{content:Xe}}),await Sf(Nt,jt,{content:Xe})}bi.current=!0,Ot(null),k("pointer")},[Nt,T,G,R,Ze]),Xu=j.useCallback(()=>{Ot(null),bi.current=!0,k("pointer")},[]),vr=j.useCallback(async ht=>{!Nt||!T||!At||(await kU(Nt,At,ht),yt(null))},[Nt,T,At]),Ja=j.useCallback(async ht=>{!Nt||!Mt||await PU(Nt,Mt.id,ht)},[Nt,Mt]),di=j.useCallback(async()=>{!Nt||!Mt||(Ze({type:"deleteComment",commentId:Mt.id,deleted:Mt}),await S3(Nt,Mt.id),Qt(null))},[Nt,Mt,Ze]),ps=j.useCallback(()=>{const ht=ks(),St=Math.min(4,nt.scale*1.2),jt=qt.width,Bt=qt.height;X({x:jt/2-ht.x*St,y:Bt/2-ht.y*St,scale:St})},[nt,qt,ks]),ji=j.useCallback(()=>{const ht=ks(),St=Math.max(.1,nt.scale/1.2),jt=qt.width,Bt=qt.height;X({x:jt/2-ht.x*St,y:Bt/2-ht.y*St,scale:St})},[nt,qt,ks]),Uo=j.useCallback(ht=>{De.current=!1,bi.current=!1,k(ht)},[]),zo=j.useCallback(ht=>{ft(ht)},[]),Bo=j.useCallback(async ht=>{!Nt||!s||s.ownerId!==e?.uid||(await GS(Nt,{name:ht}),l(St=>St?{...St,name:ht}:null))},[Nt,s,e?.uid]),Za=Q?R[Q]:null,Vs=Za?.type==="sticky";return e?A?I.jsx("div",{className:"board-page-loading",children:"Loading board"}):m&&s?I.jsxs("div",{className:"board-page-denied board-page-invite",children:[I.jsxs("p",{children:["You've been invited to ",I.jsx("strong",{children:s.name||"Untitled Board"}),"."]}),I.jsx("p",{className:"board-page-invite-sub",children:"Accept the invite to view and collaborate."}),I.jsxs("div",{className:"board-page-denied-actions",children:[I.jsx("button",{type:"button",className:"board-page-btn-primary",onClick:async()=>{try{await b8(Nt,m.id),g(null),window.location.reload()}catch(ht){alert(ht instanceof Error?ht.message:"Failed to accept invite")}},children:"Accept invite"}),I.jsx("button",{type:"button",onClick:()=>t("/dashboard"),children:"Back to Dashboard"})]})]}):c?I.jsxs("div",{className:"board-page-denied",children:[I.jsxs("p",{children:["You don't have access to this board",s?` (${s.name||"Untitled Board"})`:"","."]}),I.jsx("p",{className:"board-page-denied-hint",children:'Ask the owner to invite you or enable "Anyone with the link can view/edit" in Share settings.'}),I.jsx("button",{type:"button",onClick:()=>t("/dashboard"),children:"Back to Dashboard"})]}):s?I.jsxs("div",{className:"board-page",children:[I.jsx(xG,{boardName:s.name||"Untitled Board",onBoardNameChange:Bo,onShareClick:()=>tt(!0),canEdit:T,canShare:s.ownerId===e.uid,publicAccess:s.publicAccess??"none"}),I.jsxs("div",{ref:i,className:"board-canvas-container",children:[I.jsxs(QH,{width:qt.width,height:qt.height,viewport:nt,onViewportChange:X,onMouseMove:Wa,onBackgroundClick:kn,showGrid:bt,creationToolActive:L!=="pointer",editingTextOpen:G!=null,cursorLayer:ql,children:[I.jsx(ZH,{objects:R,viewport:nt,selectedIds:V,isPointerTool:L==="pointer",onObjectDragEnd:Ln,onObjectClick:Qn,onObjectResizeEnd:Vo,onStickyDoubleClick:Cn,onTextDoubleClick:Ps,canEdit:T}),I.jsx(hG,{comments:M,isPointerTool:L==="pointer",onCommentClick:ht=>{yt(null),Qt(ht)}})]}),I.jsx(CG,{activeTool:L,onToolSelect:Uo,onEmojiSelect:zo,onUndo:Bi,onRedo:ds,canEdit:T}),I.jsx(DG,{showGrid:bt,onGridToggle:()=>{Ft(ht=>{const St=!ht;try{localStorage.setItem("vellum:showGrid",String(St))}catch{}return St})},zoom:nt.scale,onZoomIn:ps,onZoomOut:ji}),Vs&&Q&&Za&&I.jsx(IG,{sticky:Za,viewport:nt,onSave:ht=>ms(Q,ht),onCancel:()=>F(null)}),G&&I.jsx(OG,{editingText:G,onCommit:_a,onCancel:Xu}),I.jsx(MG,{position:At,viewport:nt,canvasWidth:qt.width,canvasHeight:qt.height,containerRef:i,onSave:vr,onCancel:()=>yt(null)}),I.jsx(HG,{comment:M.find(ht=>ht.id===Mt?.id)??Mt,currentUserId:e.uid,onReply:Ja,onDelete:di,onClose:()=>Qt(null)}),Vt&&I.jsx(C8,{boardId:Nt,onClose:()=>tt(!1),onBoardUpdated:async()=>{const ht=await zu(Nt);ht&&l(ht)}})]})]}):null:null}function lC({children:n}){const{user:t,loading:e}=BS(),i=Lo();return e?I.jsx("div",{className:"app-loading",children:"Loading"}):t?I.jsx(I.Fragment,{children:n}):I.jsx(SC,{to:"/login",state:{from:i.pathname},replace:!0})}function qG(){return I.jsxs(a7,{children:[I.jsx(Jd,{path:"/",element:I.jsx(hU,{})}),I.jsx(Jd,{path:"/login",element:I.jsx(fU,{})}),I.jsx(Jd,{path:"/dashboard",element:I.jsx(lC,{children:I.jsx(DU,{})})}),I.jsx(Jd,{path:"/board/:boardId",element:I.jsx(lC,{children:I.jsx(GG,{})})}),I.jsx(Jd,{path:"*",element:I.jsx(SC,{to:"/",replace:!0})})]})}function FG(){return I.jsx(N7,{children:I.jsx(cU,{children:I.jsx(qG,{})})})}lR.createRoot(document.getElementById("root")).render(I.jsx(j.StrictMode,{children:I.jsx(FG,{})}));
